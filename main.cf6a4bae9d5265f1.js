(self.webpackChunkagora_video_call_sample=self.webpackChunkagora_video_call_sample||[]).push([[179],{937:($u,m_,ig)=>{"use strict";function U(e){return"function"==typeof e}function Go(e){const n=e(a=>{Error.call(a),a.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const xs=Go(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((a,u)=>`${u+1}) ${a.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function rt(e,r){if(e){const n=e.indexOf(r);0<=n&&e.splice(n,1)}}class Hr{constructor(r){this.initialTeardown=r,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let r;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const d of n)d.remove(this);else n.remove(this);const{initialTeardown:a}=this;if(U(a))try{a()}catch(d){r=d instanceof xs?d.errors:[d]}const{_finalizers:u}=this;if(u){this._finalizers=null;for(const d of u)try{Aa(d)}catch(m){r=r??[],m instanceof xs?r=[...r,...m.errors]:r.push(m)}}if(r)throw new xs(r)}}add(r){var n;if(r&&r!==this)if(this.closed)Aa(r);else{if(r instanceof Hr){if(r.closed||r._hasParent(this))return;r._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(r)}}_hasParent(r){const{_parentage:n}=this;return n===r||Array.isArray(n)&&n.includes(r)}_addParent(r){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(r),n):n?[n,r]:r}_removeParent(r){const{_parentage:n}=this;n===r?this._parentage=null:Array.isArray(n)&&rt(n,r)}remove(r){const{_finalizers:n}=this;n&&rt(n,r),r instanceof Hr&&r._removeParent(this)}}Hr.EMPTY=(()=>{const e=new Hr;return e.closed=!0,e})();const An=Hr.EMPTY;function _r(e){return e instanceof Hr||e&&"closed"in e&&U(e.remove)&&U(e.add)&&U(e.unsubscribe)}function Aa(e){U(e)?e():e.unsubscribe()}const Ho={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},qc={setTimeout(e,r,...n){const{delegate:a}=qc;return a?.setTimeout?a.setTimeout(e,r,...n):setTimeout(e,r,...n)},clearTimeout(e){const{delegate:r}=qc;return(r?.clearTimeout||clearTimeout)(e)},delegate:void 0};function io(e){qc.setTimeout(()=>{const{onUnhandledError:r}=Ho;if(!r)throw e;r(e)})}function id(){}const Dw=rc("C",void 0,void 0);function rc(e,r,n){return{kind:e,value:r,error:n}}let ic=null;function ma(e){if(Ho.useDeprecatedSynchronousErrorHandling){const r=!ic;if(r&&(ic={errorThrown:!1,error:null}),e(),r){const{errorThrown:n,error:a}=ic;if(ic=null,n)throw a}}else e()}class __ extends Hr{constructor(r){super(),this.isStopped=!1,r?(this.destination=r,_r(r)&&r.add(this)):this.destination=od}static create(r,n,a){return new Dn(r,n,a)}next(r){this.isStopped?UC(function oU(e){return rc("N",e,void 0)}(r),this):this._next(r)}error(r){this.isStopped?UC(function ww(e){return rc("E",void 0,e)}(r),this):(this.isStopped=!0,this._error(r))}complete(){this.isStopped?UC(Dw,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(r){this.destination.next(r)}_error(r){try{this.destination.error(r)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const sU=Function.prototype.bind;function og(e,r){return sU.call(e,r)}class aU{constructor(r){this.partialObserver=r}next(r){const{partialObserver:n}=this;if(n.next)try{n.next(r)}catch(a){sg(a)}}error(r){const{partialObserver:n}=this;if(n.error)try{n.error(r)}catch(a){sg(a)}else sg(r)}complete(){const{partialObserver:r}=this;if(r.complete)try{r.complete()}catch(n){sg(n)}}}class Dn extends __{constructor(r,n,a){let u;if(super(),U(r)||!r)u={next:r??void 0,error:n??void 0,complete:a??void 0};else{let d;this&&Ho.useDeprecatedNextContext?(d=Object.create(r),d.unsubscribe=()=>this.unsubscribe(),u={next:r.next&&og(r.next,d),error:r.error&&og(r.error,d),complete:r.complete&&og(r.complete,d)}):u=r}this.destination=new aU(u)}}function sg(e){Ho.useDeprecatedSynchronousErrorHandling?function Nw(e){Ho.useDeprecatedSynchronousErrorHandling&&ic&&(ic.errorThrown=!0,ic.error=e)}(e):io(e)}function UC(e,r){const{onStoppedNotification:n}=Ho;n&&qc.setTimeout(()=>n(e,r))}const od={closed:!0,next:id,error:function cU(e){throw e},complete:id},VC="function"==typeof Symbol&&Symbol.observable||"@@observable";function Jc(e){return e}function E_(e){return 0===e.length?Jc:1===e.length?e[0]:function(n){return e.reduce((a,u)=>u(a),n)}}let Kn=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){const a=new e;return a.source=this,a.operator=n,a}subscribe(n,a,u){const d=function v_(e){return e&&e instanceof __||function lU(e){return e&&U(e.next)&&U(e.error)&&U(e.complete)}(e)&&_r(e)}(n)?n:new Dn(n,a,u);return ma(()=>{const{operator:m,source:E}=this;d.add(m?m.call(d,E):E?this._subscribe(d):this._trySubscribe(d))}),d}_trySubscribe(n){try{return this._subscribe(n)}catch(a){n.error(a)}}forEach(n,a){return new(a=jC(a))((u,d)=>{const m=new Dn({next:E=>{try{n(E)}catch(C){d(C),m.unsubscribe()}},error:d,complete:u});this.subscribe(m)})}_subscribe(n){var a;return null===(a=this.source)||void 0===a?void 0:a.subscribe(n)}[VC](){return this}pipe(...n){return E_(n)(this)}toPromise(n){return new(n=jC(n))((a,u)=>{let d;this.subscribe(m=>d=m,m=>u(m),()=>a(d))})}}return e.create=r=>new e(r),e})();function jC(e){var r;return null!==(r=e??Ho.Promise)&&void 0!==r?r:Promise}const dU=Go(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Or=(()=>{class e extends Kn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const a=new xh(this,this);return a.operator=n,a}_throwIfClosed(){if(this.closed)throw new dU}next(n){ma(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const a of this.currentObservers)a.next(n)}})}error(n){ma(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:a}=this;for(;a.length;)a.shift().error(n)}})}complete(){ma(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:a,isStopped:u,observers:d}=this;return a||u?An:(this.currentObservers=null,d.push(n),new Hr(()=>{this.currentObservers=null,rt(d,n)}))}_checkFinalizedStatuses(n){const{hasError:a,thrownError:u,isStopped:d}=this;a?n.error(u):d&&n.complete()}asObservable(){const n=new Kn;return n.source=this,n}}return e.create=(r,n)=>new xh(r,n),e})();class xh extends Or{constructor(r,n){super(),this.destination=r,this.source=n}next(r){var n,a;null===(a=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===a||a.call(n,r)}error(r){var n,a;null===(a=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===a||a.call(n,r)}complete(){var r,n;null===(n=null===(r=this.destination)||void 0===r?void 0:r.complete)||void 0===n||n.call(r)}_subscribe(r){var n,a;return null!==(a=null===(n=this.source)||void 0===n?void 0:n.subscribe(r))&&void 0!==a?a:An}}function Er(e){return U(e?.lift)}function Wr(e){return r=>{if(Er(r))return r.lift(function(n){try{return e(n,this)}catch(a){this.error(a)}});throw new TypeError("Unable to lift unknown Observable type")}}function tn(e,r,n,a,u){return new QC(e,r,n,a,u)}class QC extends __{constructor(r,n,a,u,d,m){super(r),this.onFinalize=d,this.shouldUnsubscribe=m,this._next=n?function(E){try{n(E)}catch(C){r.error(C)}}:super._next,this._error=u?function(E){try{u(E)}catch(C){r.error(C)}finally{this.unsubscribe()}}:super._error,this._complete=a?function(){try{a()}catch(E){r.error(E)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(r=this.onFinalize)||void 0===r||r.call(this))}}}function Ot(e,r){return Wr((n,a)=>{let u=0;n.subscribe(tn(a,d=>{a.next(e.call(r,d,u++))}))})}function sd(e){return this instanceof sd?(this.v=e,this):new sd(e)}function _U(e,r,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var u,a=n.apply(e,r||[]),d=[];return u={},m("next"),m("throw"),m("return"),u[Symbol.asyncIterator]=function(){return this},u;function m(F){a[F]&&(u[F]=function(H){return new Promise(function($,oe){d.push([F,H,$,oe])>1||E(F,H)})})}function E(F,H){try{!function C(F){F.value instanceof sd?Promise.resolve(F.value.v).then(I,w):M(d[0][2],F)}(a[F](H))}catch($){M(d[0][3],$)}}function I(F){E("next",F)}function w(F){E("throw",F)}function M(F,H){F(H),d.shift(),d.length&&E(d[0][0],d[0][1])}}function EU(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=e[Symbol.asyncIterator];return r?r.call(e):(e=function WC(e){var r="function"==typeof Symbol&&Symbol.iterator,n=r&&e[r],a=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n);function a(d){n[d]=e[d]&&function(m){return new Promise(function(E,C){!function u(d,m,E,C){Promise.resolve(C).then(function(I){d({value:I,done:E})},m)}(E,C,(m=e[d](m)).done,m.value)})}}}const KC=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function cg(e){return U(e?.then)}function y_(e){return U(e[VC])}function I_(e){return Symbol.asyncIterator&&U(e?.[Symbol.asyncIterator])}function S_(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const ug=function CU(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function YC(e){return U(e?.[ug])}function Lw(e){return _U(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:a,done:u}=yield sd(n.read());if(u)return yield sd(void 0);yield yield sd(a)}}finally{n.releaseLock()}})}function b_(e){return U(e?.getReader)}function Wi(e){if(e instanceof Kn)return e;if(null!=e){if(y_(e))return function xw(e){return new Kn(r=>{const n=e[VC]();if(U(n.subscribe))return n.subscribe(r);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(KC(e))return function qC(e){return new Kn(r=>{for(let n=0;n<e.length&&!r.closed;n++)r.next(e[n]);r.complete()})}(e);if(cg(e))return function Bw(e){return new Kn(r=>{e.then(n=>{r.closed||(r.next(n),r.complete())},n=>r.error(n)).then(null,io)})}(e);if(I_(e))return Fw(e);if(YC(e))return function yU(e){return new Kn(r=>{for(const n of e)if(r.next(n),r.closed)return;r.complete()})}(e);if(b_(e))return function ad(e){return Fw(Lw(e))}(e)}throw S_(e)}function Fw(e){return new Kn(r=>{(function IU(e,r){var n,a,u,d;return function Pw(e,r,n,a){return new(n||(n=Promise))(function(d,m){function E(w){try{I(a.next(w))}catch(M){m(M)}}function C(w){try{I(a.throw(w))}catch(M){m(M)}}function I(w){w.done?d(w.value):function u(d){return d instanceof n?d:new n(function(m){m(d)})}(w.value).then(E,C)}I((a=a.apply(e,r||[])).next())})}(this,void 0,void 0,function*(){try{for(n=EU(e);!(a=yield n.next()).done;)if(r.next(a.value),r.closed)return}catch(m){u={error:m}}finally{try{a&&!a.done&&(d=n.return)&&(yield d.call(n))}finally{if(u)throw u.error}}r.complete()})})(e,r).catch(n=>r.error(n))})}function $c(e,r,n,a=0,u=!1){const d=r.schedule(function(){n(),u?e.add(this.schedule(null,a)):this.unsubscribe()},a);if(e.add(d),!u)return d}function di(e,r,n=1/0){return U(r)?di((a,u)=>Ot((d,m)=>r(a,d,u,m))(Wi(e(a,u))),n):("number"==typeof r&&(n=r),Wr((a,u)=>function Ki(e,r,n,a,u,d,m,E){const C=[];let I=0,w=0,M=!1;const F=()=>{M&&!C.length&&!I&&r.complete()},H=oe=>I<a?$(oe):C.push(oe),$=oe=>{d&&r.next(oe),I++;let he=!1;Wi(n(oe,w++)).subscribe(tn(r,Ae=>{u?.(Ae),d?H(Ae):r.next(Ae)},()=>{he=!0},void 0,()=>{if(he)try{for(I--;C.length&&I<a;){const Ae=C.shift();m?$c(r,m,()=>$(Ae)):$(Ae)}F()}catch(Ae){r.error(Ae)}}))};return e.subscribe(tn(r,H,()=>{M=!0,F()})),()=>{E?.()}}(a,u,e,n)))}function Fh(e=1/0){return di(Jc,e)}const _a=new Kn(e=>e.complete());function Uw(e){return e&&U(e.schedule)}function zC(e){return e[e.length-1]}function lg(e){return U(zC(e))?e.pop():void 0}function dg(e){return Uw(zC(e))?e.pop():void 0}function $C(e,r=0){return Wr((n,a)=>{n.subscribe(tn(a,u=>$c(a,e,()=>a.next(u),r),()=>$c(a,e,()=>a.complete(),r),u=>$c(a,e,()=>a.error(u),r)))})}function Uh(e,r=0){return Wr((n,a)=>{a.add(e.schedule(()=>n.subscribe(a),r))})}function Qw(e,r){if(!e)throw new Error("Iterable cannot be null");return new Kn(n=>{$c(n,r,()=>{const a=e[Symbol.asyncIterator]();$c(n,r,()=>{a.next().then(u=>{u.done?n.complete():n.next(u.value)})},0,!0)})})}function pi(e,r){return r?function Hw(e,r){if(null!=e){if(y_(e))return function cd(e,r){return Wi(e).pipe(Uh(r),$C(r))}(e,r);if(KC(e))return function SU(e,r){return new Kn(n=>{let a=0;return r.schedule(function(){a===e.length?n.complete():(n.next(e[a++]),n.closed||this.schedule())})})}(e,r);if(cg(e))return function jw(e,r){return Wi(e).pipe(Uh(r),$C(r))}(e,r);if(I_(e))return Qw(e,r);if(YC(e))return function hi(e,r){return new Kn(n=>{let a;return $c(n,r,()=>{a=e[ug](),$c(n,r,()=>{let u,d;try{({value:u,done:d}=a.next())}catch(m){return void n.error(m)}d?n.complete():n.next(u)},0,!0)}),()=>U(a?.return)&&a.return()})}(e,r);if(b_(e))return function Gw(e,r){return Qw(Lw(e),r)}(e,r)}throw S_(e)}(e,r):Wi(e)}function Ww(...e){const r=dg(e),n=function Vw(e,r){return"number"==typeof zC(e)?e.pop():r}(e,1/0),a=e;return a.length?1===a.length?Wi(a[0]):Fh(n)(pi(a,r)):_a}function Kw(e={}){const{connector:r=(()=>new Or),resetOnError:n=!0,resetOnComplete:a=!0,resetOnRefCountZero:u=!0}=e;return d=>{let m,E,C,I=0,w=!1,M=!1;const F=()=>{E?.unsubscribe(),E=void 0},H=()=>{F(),m=C=void 0,w=M=!1},$=()=>{const oe=m;H(),oe?.unsubscribe()};return Wr((oe,he)=>{I++,!M&&!w&&F();const Ae=C=C??r();he.add(()=>{I--,0===I&&!M&&!w&&(E=XC($,u))}),Ae.subscribe(he),!m&&I>0&&(m=new Dn({next:Ce=>Ae.next(Ce),error:Ce=>{M=!0,F(),E=XC(H,n,Ce),Ae.error(Ce)},complete:()=>{w=!0,F(),E=XC(H,a),Ae.complete()}}),Wi(oe).subscribe(m))})(d)}}function XC(e,r,...n){if(!0===r)return void e();if(!1===r)return;const a=new Dn({next:()=>{a.unsubscribe(),e()}});return r(...n).subscribe(a)}function Zn(e){for(let r in e)if(e[r]===Zn)return r;throw Error("Could not find renamed property on target object.")}function ZC(e,r){for(const n in r)r.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=r[n])}function er(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(er).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const r=e.toString();if(null==r)return""+r;const n=r.indexOf("\n");return-1===n?r:r.substring(0,n)}function Vh(e,r){return null==e||""===e?null===r?"":r:null==r||""===r?e:e+" "+r}const Yw=Zn({__forward_ref__:Zn});function mn(e){return e.__forward_ref__=mn,e.toString=function(){return er(this())},e}function Pt(e){return jh(e)?e():e}function jh(e){return"function"==typeof e&&e.hasOwnProperty(Yw)&&e.__forward_ref__===mn}class Be extends Error{constructor(r,n){super(function T_(e,r){return`NG0${Math.abs(e)}${r?": "+r.trim():""}`}(r,n)),this.code=r}}function Ut(e){return"string"==typeof e?e:null==e?"":String(e)}function R_(e,r){throw new Be(-201,!1)}function Wo(e,r){null==e&&function Bn(e,r,n,a){throw new Error(`ASSERTION ERROR: ${e}`+(null==a?"":` [Expected=> ${n} ${a} ${r} <=Actual]`))}(r,e,null,"!=")}function ot(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Nn(e){return{providers:e.providers||[],imports:e.imports||[]}}function D_(e){return Us(e,ud)||Us(e,hg)}function Us(e,r){return e.hasOwnProperty(r)?e[r]:null}function Jw(e){return e&&(e.hasOwnProperty(ld)||e.hasOwnProperty(w_))?e[ld]:null}const ud=Zn({\u0275prov:Zn}),ld=Zn({\u0275inj:Zn}),hg=Zn({ngInjectableDef:Zn}),w_=Zn({ngInjectorDef:Zn});var bt=(()=>((bt=bt||{})[bt.Default=0]="Default",bt[bt.Host=1]="Host",bt[bt.Self=2]="Self",bt[bt.SkipSelf=4]="SkipSelf",bt[bt.Optional=8]="Optional",bt))();let ny;function Vs(e){const r=ny;return ny=e,r}function $w(e,r,n){const a=D_(e);return a&&"root"==a.providedIn?void 0===a.value?a.value=a.factory():a.value:n&bt.Optional?null:void 0!==r?r:void R_(er(e))}function Xc(e){return{toString:e}.toString()}var ss=(()=>((ss=ss||{})[ss.OnPush=0]="OnPush",ss[ss.Default=1]="Default",ss))(),Ea=(()=>{return(e=Ea||(Ea={}))[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",Ea;var e})();const Yn=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Xu={},_n=[],N_=Zn({\u0275cmp:Zn}),ry=Zn({\u0275dir:Zn}),O_=Zn({\u0275pipe:Zn}),P_=Zn({\u0275mod:Zn}),Zc=Zn({\u0275fac:Zn}),va=Zn({__NG_ELEMENT_ID__:Zn});let PU=0;function So(e){return Xc(()=>{const n=!0===e.standalone,a={},u={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:a,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===ss.OnPush,directiveDefs:null,pipeDefs:null,standalone:n,dependencies:n&&e.dependencies||null,getStandaloneInjector:null,selectors:e.selectors||_n,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Ea.Emulated,id:"c"+PU++,styles:e.styles||_n,_:null,setInput:null,schemas:e.schemas||null,tView:null},d=e.dependencies,m=e.features;return u.inputs=iy(e.inputs,a),u.outputs=iy(e.outputs),m&&m.forEach(E=>E(u)),u.directiveDefs=d?()=>("function"==typeof d?d():d).map(dd).filter(as):null,u.pipeDefs=d?()=>("function"==typeof d?d():d).map(so).filter(as):null,u})}function dd(e){return On(e)||bo(e)}function as(e){return null!==e}function Sn(e){return Xc(()=>({type:e.type,bootstrap:e.bootstrap||_n,declarations:e.declarations||_n,imports:e.imports||_n,exports:e.exports||_n,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function iy(e,r){if(null==e)return Xu;const n={};for(const a in e)if(e.hasOwnProperty(a)){let u=e[a],d=u;Array.isArray(u)&&(d=u[1],u=u[0]),n[u]=a,r&&(r[u]=d)}return n}const We=So;function On(e){return e[N_]||null}function bo(e){return e[ry]||null}function so(e){return e[O_]||null}function Ko(e,r){const n=e[P_]||null;if(!n&&!0===r)throw new Error(`Type ${er(e)} does not have '\u0275mod' property.`);return n}function Yo(e){return Array.isArray(e)&&"object"==typeof e[1]}function Gs(e){return Array.isArray(e)&&!0===e[1]}function cy(e){return 0!=(8&e.flags)}function L_(e){return 2==(2&e.flags)}function x_(e){return 1==(1&e.flags)}function ya(e){return null!==e.template}function BU(e){return 0!=(256&e[2])}function Ii(e,r){return e.hasOwnProperty(Zc)?e[Zc]:null}class UU{constructor(r,n,a){this.previousValue=r,this.currentValue=n,this.firstChange=a}isFirstChange(){return this.firstChange}}function Fi(){return ly}function ly(e){return e.type.prototype.ngOnChanges&&(e.setInput=F_),oN}function oN(){const e=aN(this),r=e?.current;if(r){const n=e.previous;if(n===Xu)e.previous=r;else for(let a in r)n[a]=r[a];e.current=null,this.ngOnChanges(r)}}function F_(e,r,n,a){const u=aN(e)||function VU(e,r){return e[sN]=r}(e,{previous:Xu,current:null}),d=u.current||(u.current={}),m=u.previous,E=this.declaredInputs[n],C=m[E];d[E]=new UU(C&&C.currentValue,r,m===Xu),e[a]=r}Fi.ngInherit=!0;const sN="__ngSimpleChanges__";function aN(e){return e[sN]||null}function fi(e){for(;Array.isArray(e);)e=e[0];return e}function mg(e,r){return fi(r[e])}function ls(e,r){return fi(r[e.index])}function Cr(e,r){return e.data[r]}function qo(e,r){const n=r[e];return Yo(n)?n:n[0]}function j_(e){return 64==(64&e[2])}function el(e,r){return null==r?null:e[r]}function nr(e){e[18]=0}function To(e,r){e[5]+=r;let n=e,a=e[3];for(;null!==a&&(1===r&&1===n[5]||-1===r&&0===n[5]);)a[5]+=r,n=a,a=a[3]}const Mt={lFrame:gN(null),bindingsEnabled:!0};function Q_(){return Mt.bindingsEnabled}function ve(){return Mt.lFrame.lView}function fn(){return Mt.lFrame.tView}function rr(e){return Mt.lFrame.contextLView=e,e[8]}function an(e){return Mt.lFrame.contextLView=null,e}function qr(){let e=hy();for(;null!==e&&64===e.type;)e=e.parent;return e}function hy(){return Mt.lFrame.currentTNode}function sc(e,r){const n=Mt.lFrame;n.currentTNode=e,n.isParent=r}function ac(){return Mt.lFrame.isParent}function Kh(){Mt.lFrame.isParent=!1}function Yh(){return Mt.lFrame.bindingIndex++}function Ia(e){const r=Mt.lFrame,n=r.bindingIndex;return r.bindingIndex=r.bindingIndex+e,n}function YU(e,r){const n=Mt.lFrame;n.bindingIndex=n.bindingRootIndex=e,py(r)}function py(e){Mt.lFrame.currentDirectiveIndex=e}function ru(){return Mt.lFrame.currentQueryIndex}function gy(e){Mt.lFrame.currentQueryIndex=e}function ds(e){const r=e[1];return 2===r.type?r.declTNode:1===r.type?e[6]:null}function cc(e,r,n){if(n&bt.SkipSelf){let u=r,d=e;for(;!(u=u.parent,null!==u||n&bt.Host||(u=ds(d),null===u||(d=d[15],10&u.type))););if(null===u)return!1;r=u,e=d}const a=Mt.lFrame=H_();return a.currentTNode=r,a.lView=e,!0}function vg(e){const r=H_(),n=e[1];Mt.lFrame=r,r.currentTNode=n.firstChild,r.lView=e,r.tView=n,r.contextLView=e,r.bindingIndex=n.bindingStartIndex,r.inI18n=!1}function H_(){const e=Mt.lFrame,r=null===e?null:e.child;return null===r?gN(e):r}function gN(e){const r={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=r),r}function Ay(){const e=Mt.lFrame;return Mt.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const Ws=Ay;function iu(){const e=Ay();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function ao(){return Mt.lFrame.selectedIndex}function ou(e){Mt.lFrame.selectedIndex=e}function yr(){const e=Mt.lFrame;return Cr(e.tView,e.selectedIndex)}function hs(){Mt.lFrame.currentNamespace="svg"}function W_(e,r){for(let n=r.directiveStart,a=r.directiveEnd;n<a;n++){const d=e.data[n].type.prototype,{ngAfterContentInit:m,ngAfterContentChecked:E,ngAfterViewInit:C,ngAfterViewChecked:I,ngOnDestroy:w}=d;m&&(e.contentHooks||(e.contentHooks=[])).push(-n,m),E&&((e.contentHooks||(e.contentHooks=[])).push(n,E),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,E)),C&&(e.viewHooks||(e.viewHooks=[])).push(-n,C),I&&((e.viewHooks||(e.viewHooks=[])).push(n,I),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,I)),null!=w&&(e.destroyHooks||(e.destroyHooks=[])).push(n,w)}}function K_(e,r,n){EN(e,r,3,n)}function Y_(e,r,n,a){(3&e[2])===n&&EN(e,r,n,a)}function Ey(e,r){let n=e[2];(3&n)===r&&(n&=2047,n+=1,e[2]=n)}function EN(e,r,n,a){const d=a??-1,m=r.length-1;let E=0;for(let C=void 0!==a?65535&e[18]:0;C<m;C++)if("number"==typeof r[C+1]){if(E=r[C],null!=a&&E>=a)break}else r[C]<0&&(e[18]+=65536),(E<d||-1==d)&&(vy(e,n,r,C),e[18]=(4294901760&e[18])+C+2),C++}function vy(e,r,n,a){const u=n[a]<0,d=n[a+1],E=e[u?-n[a]:n[a]];if(u){if(e[2]>>11<e[18]>>16&&(3&e[2])===r){e[2]+=2048;try{d.call(E)}finally{}}}else try{d.call(E)}finally{}}class nl{constructor(r,n,a){this.factory=r,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=a}}function Jh(e,r,n){let a=0;for(;a<n.length;){const u=n[a];if("number"==typeof u){if(0!==u)break;a++;const d=n[a++],m=n[a++],E=n[a++];e.setAttribute(r,m,E,d)}else{const d=u,m=n[++a];yg(d)?e.setProperty(r,d,m):e.setAttribute(r,d,m),a++}}return a}function yN(e){return 3===e||4===e||6===e}function yg(e){return 64===e.charCodeAt(0)}function Ig(e,r){if(null!==r&&0!==r.length)if(null===e||0===e.length)e=r.slice();else{let n=-1;for(let a=0;a<r.length;a++){const u=r[a];"number"==typeof u?n=u:0===n||IN(e,n,u,null,-1===n||2===n?r[++a]:null)}}return e}function IN(e,r,n,a,u){let d=0,m=e.length;if(-1===r)m=-1;else for(;d<e.length;){const E=e[d++];if("number"==typeof E){if(E===r){m=-1;break}if(E>r){m=d-1;break}}}for(;d<e.length;){const E=e[d];if("number"==typeof E)break;if(E===n){if(null===a)return void(null!==u&&(e[d+1]=u));if(a===e[d+1])return void(e[d+2]=u)}d++,null!==a&&d++,null!==u&&d++}-1!==m&&(e.splice(m,0,r),d=m+1),e.splice(d++,0,n),null!==a&&e.splice(d++,0,a),null!==u&&e.splice(d++,0,u)}function SN(e){return-1!==e}function md(e){return 32767&e}function _d(e,r){let n=function yy(e){return e>>16}(e),a=r;for(;n>0;)a=a[15],n--;return a}let Iy=!0;function q_(e){const r=Iy;return Iy=e,r}let qi=0;const uc={};function Sg(e,r){const n=bg(e,r);if(-1!==n)return n;const a=r[1];a.firstCreatePass&&(e.injectorIndex=r.length,Sy(a.data,e),Sy(r,null),Sy(a.blueprint,null));const u=J_(e,r),d=e.injectorIndex;if(SN(u)){const m=md(u),E=_d(u,r),C=E[1].data;for(let I=0;I<8;I++)r[d+I]=E[m+I]|C[m+I]}return r[d+8]=u,d}function Sy(e,r){e.push(0,0,0,0,0,0,0,0,r)}function bg(e,r){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===r[e.injectorIndex+8]?-1:e.injectorIndex}function J_(e,r){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,a=null,u=r;for(;null!==u;){if(a=NN(u),null===a)return-1;if(n++,u=u[15],-1!==a.injectorIndex)return a.injectorIndex|n<<16}return-1}function z_(e,r,n){!function XU(e,r,n){let a;"string"==typeof n?a=n.charCodeAt(0)||0:n.hasOwnProperty(va)&&(a=n[va]),null==a&&(a=n[va]=qi++);const u=255&a;r.data[e+(u>>5)]|=1<<u}(e,r,n)}function DN(e,r,n){if(n&bt.Optional||void 0!==e)return e;R_()}function by(e,r,n,a){if(n&bt.Optional&&void 0===a&&(a=null),0==(n&(bt.Self|bt.Host))){const u=e[9],d=Vs(void 0);try{return u?u.get(r,a,n&bt.Optional):$w(r,a,n&bt.Optional)}finally{Vs(d)}}return DN(a,0,n)}function Ty(e,r,n,a=bt.Default,u){if(null!==e){if(1024&r[2]){const m=function e4(e,r,n,a,u){let d=e,m=r;for(;null!==d&&null!==m&&1024&m[2]&&!(256&m[2]);){const E=zh(d,m,n,a|bt.Self,uc);if(E!==uc)return E;let C=d.parent;if(!C){const I=m[21];if(I){const w=I.get(n,uc,a);if(w!==uc)return w}C=NN(m),m=m[15]}d=C}return u}(e,r,n,a,uc);if(m!==uc)return m}const d=zh(e,r,n,a,uc);if(d!==uc)return d}return by(r,n,a,u)}function zh(e,r,n,a,u){const d=function Jr(e){if("string"==typeof e)return e.charCodeAt(0)||0;const r=e.hasOwnProperty(va)?e[va]:void 0;return"number"==typeof r?r>=0?255&r:ZU:r}(n);if("function"==typeof d){if(!cc(r,e,a))return a&bt.Host?DN(u,0,a):by(r,n,a,u);try{const m=d(a);if(null!=m||a&bt.Optional)return m;R_()}finally{Ws()}}else if("number"==typeof d){let m=null,E=bg(e,r),C=-1,I=a&bt.Host?r[16][6]:null;for((-1===E||a&bt.SkipSelf)&&(C=-1===E?J_(e,r):r[E+8],-1!==C&&Ry(a,!1)?(m=r[1],E=md(C),r=_d(C,r)):E=-1);-1!==E;){const w=r[1];if(wN(d,E,w.data)){const M=Ed(E,r,n,m,a,I);if(M!==uc)return M}C=r[E+8],-1!==C&&Ry(a,r[1].data[E+8]===I)&&wN(d,E,r)?(m=w,E=md(C),r=_d(C,r)):E=-1}}return u}function Ed(e,r,n,a,u,d){const m=r[1],E=m.data[e+8],w=Tg(E,m,n,null==a?L_(E)&&Iy:a!=m&&0!=(3&E.type),u&bt.Host&&d===E);return null!==w?Rg(r,m,w,E):uc}function Tg(e,r,n,a,u){const d=e.providerIndexes,m=r.data,E=1048575&d,C=e.directiveStart,w=d>>20,F=u?E+w:e.directiveEnd;for(let H=a?E:E+w;H<F;H++){const $=m[H];if(H<C&&n===$||H>=C&&$.type===n)return H}if(u){const H=m[C];if(H&&ya(H)&&H.type===n)return C}return null}function Rg(e,r,n,a){let u=e[n];const d=r.data;if(function JU(e){return e instanceof nl}(u)){const m=u;m.resolving&&function bU(e,r){const n=r?`. Dependency path: ${r.join(" > ")} > ${e}`:"";throw new Be(-200,`Circular dependency in DI detected for ${e}${n}`)}(function wn(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Ut(e)}(d[n]));const E=q_(m.canSeeViewProviders);m.resolving=!0;const C=m.injectImpl?Vs(m.injectImpl):null;cc(e,a,bt.Default);try{u=e[n]=m.factory(void 0,d,e,a),r.firstCreatePass&&n>=a.directiveStart&&function _N(e,r,n){const{ngOnChanges:a,ngOnInit:u,ngDoCheck:d}=r.type.prototype;if(a){const m=ly(r);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,m),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,m)}u&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,u),d&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,d),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,d))}(n,d[n],r)}finally{null!==C&&Vs(C),q_(E),m.resolving=!1,Ws()}}return u}function wN(e,r,n){return!!(n[r+(e>>5)]&1<<e)}function Ry(e,r){return!(e&bt.Self||e&bt.Host&&r)}class vd{constructor(r,n){this._tNode=r,this._lView=n}get(r,n,a){return Ty(this._tNode,this._lView,r,a,n)}}function ZU(){return new vd(qr(),ve())}function Dy(e){return jh(e)?()=>{const r=Dy(Pt(e));return r&&r()}:Ii(e)}function NN(e){const r=e[1],n=r.type;return 2===n?r.declTNode:1===n?e[6]:null}const au="__parameters__";function rl(e,r,n){return Xc(()=>{const a=function wy(e){return function(...n){if(e){const a=e(...n);for(const u in a)this[u]=a[u]}}}(r);function u(...d){if(this instanceof u)return a.apply(this,d),this;const m=new u(...d);return E.annotation=m,E;function E(C,I,w){const M=C.hasOwnProperty(au)?C[au]:Object.defineProperty(C,au,{value:[]})[au];for(;M.length<=w;)M.push(null);return(M[w]=M[w]||[]).push(m),C}}return n&&(u.prototype=Object.create(n.prototype)),u.prototype.ngMetadataName=e,u.annotationCls=u,u})}class Et{constructor(r,n){this._desc=r,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=ot({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function ps(e,r){void 0===r&&(r=e);for(let n=0;n<e.length;n++){let a=e[n];Array.isArray(a)?(r===e&&(r=e.slice(0,n)),ps(a,r)):r!==e&&r.push(a)}return r}function lc(e,r){e.forEach(n=>Array.isArray(n)?lc(n,r):r(n))}function PN(e,r,n){r>=e.length?e.push(n):e.splice(r,0,n)}function X_(e,r){return r>=e.length-1?e.pop():e.splice(r,1)[0]}function wg(e,r){const n=[];for(let a=0;a<e;a++)n.push(r);return n}function fs(e,r,n){let a=Zh(e,r);return a>=0?e[1|a]=n:(a=~a,function MN(e,r,n,a){let u=e.length;if(u==r)e.push(n,a);else if(1===u)e.push(a,e[0]),e[0]=n;else{for(u--,e.push(e[u-1],e[u]);u>r;)e[u]=e[u-2],u--;e[r]=n,e[r+1]=a}}(e,a,r,n)),a}function Ro(e,r){const n=Zh(e,r);if(n>=0)return e[1|n]}function Zh(e,r){return function LN(e,r,n){let a=0,u=e.length>>n;for(;u!==a;){const d=a+(u-a>>1),m=e[d<<n];if(r===m)return d<<n;m>r?u=d:a=d+1}return~(u<<n)}(e,r,1)}const Ng={},uu="__NG_DI_FLAG__",Sd="ngTempTokenPath",a4=/\n/gm,BN="__source";let Og;function Ta(e){const r=Og;return Og=e,r}function u4(e,r=bt.Default){if(void 0===Og)throw new Be(-203,!1);return null===Og?$w(e,void 0,r):Og.get(e,r&bt.Optional?null:void 0,r)}function Fe(e,r=bt.Default){return(function zw(){return ny}()||u4)(Pt(e),r)}function Zr(e,r=bt.Default){return"number"!=typeof r&&(r=0|(r.optional&&8)|(r.host&&1)|(r.self&&2)|(r.skipSelf&&4)),Fe(e,r)}function ei(e){const r=[];for(let n=0;n<e.length;n++){const a=Pt(e[n]);if(Array.isArray(a)){if(0===a.length)throw new Be(900,!1);let u,d=bt.Default;for(let m=0;m<a.length;m++){const E=a[m],C=l4(E);"number"==typeof C?-1===C?u=E.token:d|=C:u=E}r.push(Fe(u,d))}else r.push(Fe(a))}return r}function Pg(e,r){return e[uu]=r,e.prototype[uu]=r,e}function l4(e){return e[uu]}const Mg=Pg(rl("Optional"),8),kg=Pg(rl("SkipSelf"),4);var Jo=(()=>((Jo=Jo||{})[Jo.Important=1]="Important",Jo[Jo.DashCase=2]="DashCase",Jo))();const Gy=new Map;let T4=0;const Ky="__ngContext__";function Ji(e,r){Yo(r)?(e[Ky]=r[20],function sE(e){Gy.set(e[20],e)}(r)):e[Ky]=r}function tp(e,r){return undefined(e,r)}function Bg(e){const r=e[3];return Gs(r)?r[3]:r}function Jy(e){return zN(e[13])}function zy(e){return zN(e[4])}function zN(e){for(;null!==e&&!Gs(e);)e=e[4];return e}function al(e,r,n,a,u){if(null!=a){let d,m=!1;Gs(a)?d=a:Yo(a)&&(m=!0,a=a[0]);const E=fi(a);0===e&&null!==n?null==u?n2(r,n,E):Dd(r,n,E,u||null,!0):1===e&&null!==n?Dd(r,n,E,u||null,!0):2===e?function nI(e,r,n){const a=np(e,r);a&&function U4(e,r,n,a){e.removeChild(r,n,a)}(e,a,r,n)}(r,E,m):3===e&&r.destroyNode(E),null!=d&&function G4(e,r,n,a,u){const d=n[7];d!==fi(n)&&al(r,e,a,d,u);for(let E=10;E<n.length;E++){const C=n[E];lu(C[1],C,e,r,a,d)}}(r,e,d,n,u)}}function Fg(e,r,n){return e.createElement(r,n)}function uE(e,r){const n=e[9],a=n.indexOf(r),u=r[3];512&r[2]&&(r[2]&=-513,To(u,-1)),n.splice(a,1)}function Ug(e,r){if(e.length<=10)return;const n=10+r,a=e[n];if(a){const u=a[17];null!==u&&u!==e&&uE(u,a),r>0&&(e[n-1][4]=a[4]);const d=X_(e,10+r);!function Zy(e,r){lu(e,r,r[11],2,null,null),r[0]=null,r[6]=null}(a[1],a);const m=d[19];null!==m&&m.detachView(d[1]),a[3]=null,a[4]=null,a[2]&=-65}return a}function cl(e,r){if(!(128&r[2])){const n=r[11];n.destroyNode&&lu(e,r,n,3,null,null),function cE(e){let r=e[13];if(!r)return lE(e[1],e);for(;r;){let n=null;if(Yo(r))n=r[13];else{const a=r[10];a&&(n=a)}if(!n){for(;r&&!r[4]&&r!==e;)Yo(r)&&lE(r[1],r),r=r[3];null===r&&(r=e),Yo(r)&&lE(r[1],r),n=r&&r[4]}r=n}}(r)}}function lE(e,r){if(!(128&r[2])){r[2]&=-65,r[2]|=128,function Vg(e,r){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let a=0;a<n.length;a+=2){const u=r[n[a]];if(!(u instanceof nl)){const d=n[a+1];if(Array.isArray(d))for(let m=0;m<d.length;m+=2){const E=u[d[m]],C=d[m+1];try{C.call(E)}finally{}}else try{d.call(u)}finally{}}}}(e,r),function ZN(e,r){const n=e.cleanup,a=r[7];let u=-1;if(null!==n)for(let d=0;d<n.length-1;d+=2)if("string"==typeof n[d]){const m=n[d+1],E="function"==typeof m?m(r):fi(r[m]),C=a[u=n[d+2]],I=n[d+3];"boolean"==typeof I?E.removeEventListener(n[d],C,I):I>=0?a[u=I]():a[u=-I].unsubscribe(),d+=2}else{const m=a[u=n[d+1]];n[d].call(m)}if(null!==a){for(let d=u+1;d<a.length;d++)(0,a[d])();r[7]=null}}(e,r),1===r[1].type&&r[11].destroy();const n=r[17];if(null!==n&&Gs(r[3])){n!==r[3]&&uE(n,r);const a=r[19];null!==a&&a.detachView(e)}!function D4(e){Gy.delete(e[20])}(r)}}function e2(e,r,n){return function t2(e,r,n){let a=r;for(;null!==a&&40&a.type;)a=(r=a).parent;if(null===a)return n[0];if(2&a.flags){const u=e.data[a.directiveStart].encapsulation;if(u===Ea.None||u===Ea.Emulated)return null}return ls(a,n)}(e,r.parent,n)}function Dd(e,r,n,a,u){e.insertBefore(r,n,a,u)}function n2(e,r,n){e.appendChild(r,n)}function r2(e,r,n,a,u){null!==a?Dd(e,r,n,a,u):n2(e,r,n)}function np(e,r){return e.parentNode(r)}function jg(e,r,n){return s2(e,r,n)}let du,s2=function o2(e,r,n){return 40&e.type?ls(e,n):null};function rp(e,r,n,a){const u=e2(e,a,r),d=r[11],E=jg(a.parent||r[6],a,r);if(null!=u)if(Array.isArray(n))for(let C=0;C<n.length;C++)r2(d,u,n[C],E,!1);else r2(d,u,n,E,!1)}function Qg(e,r){if(null!==r){const n=r.type;if(3&n)return ls(r,e);if(4&n)return tI(-1,e[r.index]);if(8&n){const a=r.child;if(null!==a)return Qg(e,a);{const u=e[r.index];return Gs(u)?tI(-1,u):fi(u)}}if(32&n)return tp(r,e)()||fi(e[r.index]);{const a=hE(e,r);return null!==a?Array.isArray(a)?a[0]:Qg(Bg(e[16]),a):Qg(e,r.next)}}return null}function hE(e,r){return null!==r?e[16][6].projection[r.projection]:null}function tI(e,r){const n=10+e+1;if(n<r.length){const a=r[n],u=a[1].firstChild;if(null!==u)return Qg(a,u)}return r[7]}function pE(e,r,n,a,u,d,m){for(;null!=n;){const E=a[n.index],C=n.type;if(m&&0===r&&(E&&Ji(fi(E),a),n.flags|=4),64!=(64&n.flags))if(8&C)pE(e,r,n.child,a,u,d,!1),al(r,e,u,E,d);else if(32&C){const I=tp(n,a);let w;for(;w=I();)al(r,e,u,w,d);al(r,e,u,E,d)}else 16&C?c2(e,r,a,n,u,d):al(r,e,u,E,d);n=m?n.projectionNext:n.next}}function lu(e,r,n,a,u,d){pE(n,a,e.firstChild,r,u,d,!1)}function c2(e,r,n,a,u,d){const m=n[16],C=m[6].projection[a.projection];if(Array.isArray(C))for(let I=0;I<C.length;I++)al(r,e,u,C[I],d);else pE(e,r,C,m[3],u,d,!0)}function u2(e,r,n){e.setAttribute(r,"style",n)}function rI(e,r,n){""===n?e.removeAttribute(r,"class"):e.setAttribute(r,"class",n)}function hu(e){return e instanceof class h2{constructor(r){this.changingThisBreaksApplicationSecurity=r}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?e.changingThisBreaksApplicationSecurity:e}const mI=new Et("ENVIRONMENT_INITIALIZER"),CE=new Et("INJECTOR",-1),I2=new Et("INJECTOR_DEF_TYPES");class _I{get(r,n=Ng){if(n===Ng){const a=new Error(`NullInjectorError: No provider for ${er(r)}!`);throw a.name="NullInjectorError",a}return n}}function S2(...e){return{\u0275providers:b2(0,e)}}function b2(e,...r){const n=[],a=new Set;let u;return lc(r,d=>{const m=d;EI(m,n,[],a)&&(u||(u=[]),u.push(m))}),void 0!==u&&T2(u,n),n}function T2(e,r){for(let n=0;n<e.length;n++){const{providers:u}=e[n];lc(u,d=>{r.push(d)})}}function EI(e,r,n,a){if(!(e=Pt(e)))return!1;let u=null,d=Jw(e);const m=!d&&On(e);if(d||m){if(m&&!m.standalone)return!1;u=e}else{const C=e.ngModule;if(d=Jw(C),!d)return!1;u=C}const E=a.has(u);if(m){if(E)return!1;if(a.add(u),m.dependencies){const C="function"==typeof m.dependencies?m.dependencies():m.dependencies;for(const I of C)EI(I,r,n,a)}}else{if(!d)return!1;{if(null!=d.imports&&!E){let I;a.add(u);try{lc(d.imports,w=>{EI(w,r,n,a)&&(I||(I=[]),I.push(w))})}finally{}void 0!==I&&T2(I,r)}if(!E){const I=Ii(u)||(()=>new u);r.push({provide:u,useFactory:I,deps:_n},{provide:I2,useValue:u,multi:!0},{provide:mI,useValue:()=>Fe(u),multi:!0})}const C=d.providers;null==C||E||lc(C,w=>{r.push(w)})}}return u!==e&&void 0!==e.providers}const u8=Zn({provide:String,useValue:Zn});function yE(e){return null!==e&&"object"==typeof e&&u8 in e}function Nd(e){return"function"==typeof e}const sp=new Et("Set Injector scope."),fc={},CI={};let IE;function Yg(){return void 0===IE&&(IE=new _I),IE}class Ks{}class Od extends Ks{constructor(r,n,a,u){super(),this.parent=n,this.source=a,this.scopes=u,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,SI(r,m=>this.processProvider(m)),this.records.set(CE,ap(void 0,this)),u.has("environment")&&this.records.set(Ks,ap(void 0,this));const d=this.records.get(sp);null!=d&&"string"==typeof d.value&&this.scopes.add(d.value),this.injectorDefTypes=new Set(this.get(I2.multi,_n,bt.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const r of this._ngOnDestroyHooks)r.ngOnDestroy();for(const r of this._onDestroyHooks)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(r){this._onDestroyHooks.push(r)}runInContext(r){this.assertNotDestroyed();const n=Ta(this),a=Vs(void 0);try{return r()}finally{Ta(n),Vs(a)}}get(r,n=Ng,a=bt.Default){this.assertNotDestroyed();const u=Ta(this),d=Vs(void 0);try{if(!(a&bt.SkipSelf)){let E=this.records.get(r);if(void 0===E){const C=function N2(e){return"function"==typeof e||"object"==typeof e&&e instanceof Et}(r)&&D_(r);E=C&&this.injectableDefInScope(C)?ap(yI(r),fc):null,this.records.set(r,E)}if(null!=E)return this.hydrate(r,E)}return(a&bt.Self?Yg():this.parent).get(r,n=a&bt.Optional&&n===Ng?null:n)}catch(m){if("NullInjectorError"===m.name){if((m[Sd]=m[Sd]||[]).unshift(er(r)),u)throw m;return function My(e,r,n,a){const u=e[Sd];throw r[BN]&&u.unshift(r[BN]),e.message=function d4(e,r,n,a=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let u=er(r);if(Array.isArray(r))u=r.map(er).join(" -> ");else if("object"==typeof r){let d=[];for(let m in r)if(r.hasOwnProperty(m)){let E=r[m];d.push(m+":"+("string"==typeof E?JSON.stringify(E):er(E)))}u=`{${d.join(", ")}}`}return`${n}${a?"("+a+")":""}[${u}]: ${e.replace(a4,"\n  ")}`}("\n"+e.message,u,n,a),e.ngTokenPath=u,e[Sd]=null,e}(m,r,"R3InjectorError",this.source)}throw m}finally{Vs(d),Ta(u)}}resolveInjectorInitializers(){const r=Ta(this),n=Vs(void 0);try{const a=this.get(mI.multi,_n,bt.Self);for(const u of a)u()}finally{Ta(r),Vs(n)}}toString(){const r=[],n=this.records;for(const a of n.keys())r.push(er(a));return`R3Injector[${r.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Be(205,!1)}processProvider(r){let n=Nd(r=Pt(r))?r:Pt(r&&r.provide);const a=function II(e){return yE(e)?ap(void 0,e.useValue):ap(qg(e),fc)}(r);if(Nd(r)||!0!==r.multi)this.records.get(n);else{let u=this.records.get(n);u||(u=ap(void 0,fc,!0),u.factory=()=>ei(u.multi),this.records.set(n,u)),n=r,u.multi.push(r)}this.records.set(n,a)}hydrate(r,n){return n.value===fc&&(n.value=CI,n.value=n.factory()),"object"==typeof n.value&&n.value&&function w2(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(r){if(!r.providedIn)return!1;const n=Pt(r.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}}function yI(e){const r=D_(e),n=null!==r?r.factory:Ii(e);if(null!==n)return n;if(e instanceof Et)throw new Be(204,!1);if(e instanceof Function)return function l8(e){const r=e.length;if(r>0)throw wg(r,"?"),new Be(204,!1);const n=function OU(e){const r=e&&(e[ud]||e[hg]);if(r){const n=function ty(e){if(e.hasOwnProperty("name"))return e.name;const r=(""+e).match(/^function\s*([^\s(]+)/);return null===r?"":r[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),r}return null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new Be(204,!1)}function qg(e,r,n){let a;if(Nd(e)){const u=Pt(e);return Ii(u)||yI(u)}if(yE(e))a=()=>Pt(e.useValue);else if(function vI(e){return!(!e||!e.useFactory)}(e))a=()=>e.useFactory(...ei(e.deps||[]));else if(function Ra(e){return!(!e||!e.useExisting)}(e))a=()=>Fe(Pt(e.useExisting));else{const u=Pt(e&&(e.useClass||e.provide));if(!function D2(e){return!!e.deps}(e))return Ii(u)||yI(u);a=()=>new u(...ei(e.deps))}return a}function ap(e,r,n=!1){return{factory:e,value:r,multi:n?[]:void 0}}function d8(e){return!!e.\u0275providers}function SI(e,r){for(const n of e)Array.isArray(n)?SI(n,r):d8(n)?SI(n.\u0275providers,r):r(n)}class Jg{}class p8{resolveComponentFactory(r){throw function h8(e){const r=Error(`No component factory found for ${er(e)}. Did you add it to @NgModule.entryComponents?`);return r.ngComponent=e,r}(r)}}let zg=(()=>{class e{}return e.NULL=new p8,e})();function f8(){return Pd(qr(),ve())}function Pd(e,r){return new Qn(ls(e,r))}let Qn=(()=>{class e{constructor(n){this.nativeElement=n}}return e.__NG_ELEMENT_ID__=f8,e})();function g8(e){return e instanceof Qn?e.nativeElement:e}class SE{}let gs=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>function A8(){const e=ve(),n=qo(qr().index,e);return(Yo(n)?n:e)[11]}(),e})(),m8=(()=>{class e{}return e.\u0275prov=ot({token:e,providedIn:"root",factory:()=>null}),e})();class $g{constructor(r){this.full=r,this.major=r.split(".")[0],this.minor=r.split(".")[1],this.patch=r.split(".").slice(2).join(".")}}const _8=new $g("14.2.12"),bI={};function RI(e){return e.ngOriginalError}class cp{constructor(){this._console=console}handleError(r){const n=this._findOriginalError(r);this._console.error("ERROR",r),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(r){let n=r&&RI(r);for(;n&&RI(n);)n=RI(n);return n||null}}function Da(e){return e instanceof Function?e():e}function x2(e,r,n){let a=e.length;for(;;){const u=e.indexOf(r,n);if(-1===u)return u;if(0===u||e.charCodeAt(u-1)<=32){const d=r.length;if(u+d===a||e.charCodeAt(u+d)<=32)return u}n=u+1}}const Xg="ng-template";function R8(e,r,n){let a=0;for(;a<e.length;){let u=e[a++];if(n&&"class"===u){if(u=e[a],-1!==x2(u.toLowerCase(),r,0))return!0}else if(1===u){for(;a<e.length&&"string"==typeof(u=e[a++]);)if(u.toLowerCase()===r)return!0;return!1}}return!1}function B2(e){return 4===e.type&&e.value!==Xg}function D8(e,r,n){return r===(4!==e.type||n?e.value:Xg)}function w8(e,r,n){let a=4;const u=e.attrs||[],d=function P8(e){for(let r=0;r<e.length;r++)if(yN(e[r]))return r;return e.length}(u);let m=!1;for(let E=0;E<r.length;E++){const C=r[E];if("number"!=typeof C){if(!m)if(4&a){if(a=2|1&a,""!==C&&!D8(e,C,n)||""===C&&1===r.length){if(wa(a))return!1;m=!0}}else{const I=8&a?C:r[++E];if(8&a&&null!==e.attrs){if(!R8(e.attrs,I,n)){if(wa(a))return!1;m=!0}continue}const M=N8(8&a?"class":C,u,B2(e),n);if(-1===M){if(wa(a))return!1;m=!0;continue}if(""!==I){let F;F=M>d?"":u[M+1].toLowerCase();const H=8&a?F:null;if(H&&-1!==x2(H,I,0)||2&a&&I!==F){if(wa(a))return!1;m=!0}}}}else{if(!m&&!wa(a)&&!wa(C))return!1;if(m&&wa(C))continue;m=!1,a=C|1&a}}return wa(a)||m}function wa(e){return 0==(1&e)}function N8(e,r,n,a){if(null===r)return-1;let u=0;if(a||!n){let d=!1;for(;u<r.length;){const m=r[u];if(m===e)return u;if(3===m||6===m)d=!0;else{if(1===m||2===m){let E=r[++u];for(;"string"==typeof E;)E=r[++u];continue}if(4===m)break;if(0===m){u+=4;continue}}u+=d?1:2}return-1}return function M8(e,r){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const a=e[n];if("number"==typeof a)return-1;if(a===r)return n;n++}return-1}(r,e)}function NI(e,r,n=!1){for(let a=0;a<r.length;a++)if(w8(e,r[a],n))return!0;return!1}function TE(e,r){e:for(let n=0;n<r.length;n++){const a=r[n];if(e.length===a.length){for(let u=0;u<e.length;u++)if(e[u]!==a[u])continue e;return!0}}return!1}function F2(e,r){return e?":not("+r.trim()+")":r}function k8(e){let r=e[0],n=1,a=2,u="",d=!1;for(;n<e.length;){let m=e[n];if("string"==typeof m)if(2&a){const E=e[++n];u+="["+m+(E.length>0?'="'+E+'"':"")+"]"}else 8&a?u+="."+m:4&a&&(u+=" "+m);else""!==u&&!wa(m)&&(r+=F2(d,u),u=""),a=m,d=d||!wa(a);n++}return""!==u&&(r+=F2(d,u)),r}const Vt={};function $e(e){U2(fn(),ve(),ao()+e,!1)}function U2(e,r,n,a){if(!a)if(3==(3&r[2])){const d=e.preOrderCheckHooks;null!==d&&K_(r,d,n)}else{const d=e.preOrderHooks;null!==d&&Y_(r,d,0,n)}ou(n)}function G2(e,r=null,n=null,a){const u=PI(e,r,n,a);return u.resolveInjectorInitializers(),u}function PI(e,r=null,n=null,a,u=new Set){const d=[n||_n,S2(e)];return a=a||("object"==typeof e?void 0:er(e)),new Od(d,r||Yg(),a||null,u)}let gi=(()=>{class e{static create(n,a){if(Array.isArray(n))return G2({name:""},a,n,"");{const u=n.name??"";return G2({name:u},n.parent,n.providers,u)}}}return e.THROW_IF_NOT_FOUND=Ng,e.NULL=new _I,e.\u0275prov=ot({token:e,providedIn:"any",factory:()=>Fe(CE)}),e.__NG_ELEMENT_ID__=-1,e})();function se(e,r=bt.Default){const n=ve();return null===n?Fe(e,r):Ty(qr(),n,Pt(e),r)}function kI(){throw new Error("invalid")}function kE(e,r){return e<<17|r<<2}function Na(e){return e>>17&32767}function xE(e){return 2|e}function fu(e){return(131068&e)>>2}function BE(e,r){return-131069&e|r<<2}function LI(e){return 1|e}function WE(e,r){const n=e.contentQueries;if(null!==n)for(let a=0;a<n.length;a+=2){const u=n[a],d=n[a+1];if(-1!==d){const m=e.data[d];gy(u),m.contentQueries(2,r[d],d)}}}function iA(e,r,n,a,u,d,m,E,C,I,w){const M=r.blueprint.slice();return M[0]=u,M[2]=76|a,(null!==w||e&&1024&e[2])&&(M[2]|=1024),nr(M),M[3]=M[15]=e,M[8]=n,M[10]=m||e&&e[10],M[11]=E||e&&e[11],M[12]=C||e&&e[12]||null,M[9]=I||e&&e[9]||null,M[6]=d,M[20]=function R4(){return T4++}(),M[21]=w,M[16]=2==r.type?e[16]:M,M}function hp(e,r,n,a,u){let d=e.data[r];if(null===d)d=function KE(e,r,n,a,u){const d=hy(),m=ac(),C=e.data[r]=function n5(e,r,n,a,u,d){return{type:n,index:a,insertBeforeIndex:null,injectorIndex:r?r.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:u,attrs:d,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:r,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,m?d:d&&d.parent,n,r,a,u);return null===e.firstChild&&(e.firstChild=C),null!==d&&(m?null==d.child&&null!==C.parent&&(d.child=C):null===d.next&&(d.next=C)),C}(e,r,n,a,u),function KU(){return Mt.lFrame.inI18n}()&&(d.flags|=64);else if(64&d.type){d.type=n,d.value=a,d.attrs=u;const m=function Wh(){const e=Mt.lFrame,r=e.currentTNode;return e.isParent?r:r.parent}();d.injectorIndex=null===m?-1:m.injectorIndex}return sc(d,!0),d}function hl(e,r,n,a){if(0===n)return-1;const u=r.length;for(let d=0;d<n;d++)r.push(a),e.blueprint.push(a),e.data.push(null);return u}function HI(e,r,n){vg(r);try{const a=e.viewQuery;null!==a&&ev(1,a,n);const u=e.template;null!==u&&qE(e,r,u,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&WE(e,r),e.staticViewQueries&&ev(2,e.viewQuery,n);const d=e.components;null!==d&&function Z8(e,r){for(let n=0;n<r.length;n++)d5(e,r[n])}(r,d)}catch(a){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),a}finally{r[2]&=-5,iu()}}function YE(e,r,n,a){const u=r[2];if(128!=(128&u)){vg(r);try{nr(r),function fN(e){return Mt.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&qE(e,r,n,2,a);const m=3==(3&u);if(m){const I=e.preOrderCheckHooks;null!==I&&K_(r,I,null)}else{const I=e.preOrderHooks;null!==I&&Y_(r,I,0,null),Ey(r,0)}if(function l5(e){for(let r=Jy(e);null!==r;r=zy(r)){if(!r[2])continue;const n=r[9];for(let a=0;a<n.length;a++){const u=n[a],d=u[3];0==(512&u[2])&&To(d,1),u[2]|=512}}}(r),function u5(e){for(let r=Jy(e);null!==r;r=zy(r))for(let n=10;n<r.length;n++){const a=r[n],u=a[1];j_(a)&&YE(u,a,u.template,a[8])}}(r),null!==e.contentQueries&&WE(e,r),m){const I=e.contentCheckHooks;null!==I&&K_(r,I)}else{const I=e.contentHooks;null!==I&&Y_(r,I,1),Ey(r,1)}!function HE(e,r){const n=e.hostBindingOpCodes;if(null!==n)try{for(let a=0;a<n.length;a++){const u=n[a];if(u<0)ou(~u);else{const d=u,m=n[++a],E=n[++a];YU(m,d),E(2,r[d])}}}finally{ou(-1)}}(e,r);const E=e.components;null!==E&&function X8(e,r){for(let n=0;n<r.length;n++)hO(e,r[n])}(r,E);const C=e.viewQuery;if(null!==C&&ev(2,C,a),m){const I=e.viewCheckHooks;null!==I&&K_(r,I)}else{const I=e.viewHooks;null!==I&&Y_(r,I,2),Ey(r,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),r[2]&=-41,512&r[2]&&(r[2]&=-513,To(r[3],-1))}finally{iu()}}}function qE(e,r,n,a,u){const d=ao(),m=2&a;try{ou(-1),m&&r.length>22&&U2(e,r,22,!1),n(a,u)}finally{ou(d)}}function JE(e,r,n){if(cy(r)){const u=r.directiveEnd;for(let d=r.directiveStart;d<u;d++){const m=e.data[d];m.contentQueries&&m.contentQueries(1,n[d],d)}}}function WI(e,r,n){!Q_()||(function r5(e,r,n,a){const u=n.directiveStart,d=n.directiveEnd;e.firstCreatePass||Sg(n,r),Ji(a,r);const m=n.initialInputs;for(let E=u;E<d;E++){const C=e.data[E],I=ya(C);I&&s5(r,n,C);const w=Rg(r,e,E,n);Ji(w,r),null!==m&&a5(0,E-u,w,C,0,m),I&&(qo(n.index,r)[8]=w)}}(e,r,n,ls(n,r)),128==(128&n.flags)&&function fp(e,r,n){const a=n.directiveStart,u=n.directiveEnd,d=n.index,m=function G_(){return Mt.lFrame.currentDirectiveIndex}();try{ou(d);for(let E=a;E<u;E++){const C=e.data[E],I=r[E];py(E),(null!==C.hostBindings||0!==C.hostVars||null!==C.hostAttrs)&&cO(C,I)}}finally{ou(-1),py(m)}}(e,r,n))}function KI(e,r,n=ls){const a=r.localNames;if(null!==a){let u=r.index+1;for(let d=0;d<a.length;d+=2){const m=a[d+1],E=-1===m?n(r,e):e[m];e[u++]=E}}}function YI(e){const r=e.tView;return null===r||r.incompleteFirstPass?e.tView=oA(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):r}function oA(e,r,n,a,u,d,m,E,C,I){const w=22+a,M=w+u,F=function e5(e,r){const n=[];for(let a=0;a<r;a++)n.push(a<e?null:Vt);return n}(w,M),H="function"==typeof I?I():I;return F[1]={type:e,blueprint:F,template:n,queries:null,viewQuery:E,declTNode:r,data:F.slice().fill(null,w),bindingStartIndex:w,expandoStartIndex:M,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof d?d():d,pipeRegistry:"function"==typeof m?m():m,firstChild:null,schemas:C,consts:H,incompleteFirstPass:!1}}function qI(e,r,n,a){const u=pO(r);null===n?u.push(a):(u.push(n),e.firstCreatePass&&fO(e).push(a,u.length-1))}function Ld(e,r,n){for(let a in e)if(e.hasOwnProperty(a)){const u=e[a];(n=null===n?{}:n).hasOwnProperty(a)?n[a].push(r,u):n[a]=[r,u]}return n}function pl(e,r){const a=r.directiveEnd,u=e.data,d=r.attrs,m=[];let E=null,C=null;for(let I=r.directiveStart;I<a;I++){const w=u[I],M=w.inputs,F=null===d||B2(r)?null:c5(M,d);m.push(F),E=Ld(M,I,E),C=Ld(w.outputs,I,C)}null!==E&&(E.hasOwnProperty("class")&&(r.flags|=16),E.hasOwnProperty("style")&&(r.flags|=32)),r.initialInputs=m,r.inputs=E,r.outputs=C}function zo(e,r,n,a,u,d,m,E){const C=ls(r,n);let w,I=r.inputs;!E&&null!=I&&(w=I[a])?(tv(e,n,w,a,u),L_(r)&&xd(n,r.index)):3&r.type&&(a=function oO(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(a),u=null!=m?m(u,r.value||"",a):u,d.setProperty(C,a,u))}function xd(e,r){const n=qo(r,e);16&n[2]||(n[2]|=32)}function zI(e,r,n,a){let u=!1;if(Q_()){const d=function i5(e,r,n){const a=e.directiveRegistry;let u=null;if(a)for(let d=0;d<a.length;d++){const m=a[d];NI(n,m.selectors,!1)&&(u||(u=[]),z_(Sg(n,r),e,m.type),ya(m)?(uO(e,n),u.unshift(m)):u.push(m))}return u}(e,r,n),m=null===a?null:{"":-1};if(null!==d){u=!0,$E(n,e.data.length,d.length);for(let w=0;w<d.length;w++){const M=d[w];M.providersResolver&&M.providersResolver(M)}let E=!1,C=!1,I=hl(e,r,d.length,null);for(let w=0;w<d.length;w++){const M=d[w];n.mergedAttrs=Ig(n.mergedAttrs,M.hostAttrs),$I(e,n,r,I,M),o5(I,M,m),null!==M.contentQueries&&(n.flags|=8),(null!==M.hostBindings||null!==M.hostAttrs||0!==M.hostVars)&&(n.flags|=128);const F=M.type.prototype;!E&&(F.ngOnChanges||F.ngOnInit||F.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),E=!0),!C&&(F.ngOnChanges||F.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),C=!0),I++}pl(e,n)}m&&function lO(e,r,n){if(r){const a=e.localNames=[];for(let u=0;u<r.length;u+=2){const d=n[r[u+1]];if(null==d)throw new Be(-301,!1);a.push(r[u],d)}}}(n,a,m)}return n.mergedAttrs=Ig(n.mergedAttrs,n.attrs),u}function zE(e,r,n,a,u,d){const m=d.hostBindings;if(m){let E=e.hostBindingOpCodes;null===E&&(E=e.hostBindingOpCodes=[]);const C=~r.index;(function aO(e){let r=e.length;for(;r>0;){const n=e[--r];if("number"==typeof n&&n<0)return n}return 0})(E)!=C&&E.push(C),E.push(a,u,m)}}function cO(e,r){null!==e.hostBindings&&e.hostBindings(1,r)}function uO(e,r){r.flags|=2,(e.components||(e.components=[])).push(r.index)}function o5(e,r,n){if(n){if(r.exportAs)for(let a=0;a<r.exportAs.length;a++)n[r.exportAs[a]]=e;ya(r)&&(n[""]=e)}}function $E(e,r,n){e.flags|=1,e.directiveStart=r,e.directiveEnd=r+n,e.providerIndexes=r}function $I(e,r,n,a,u){e.data[a]=u;const d=u.factory||(u.factory=Ii(u.type)),m=new nl(d,ya(u),se);e.blueprint[a]=m,n[a]=m,zE(e,r,0,a,hl(e,n,u.hostVars,Vt),u)}function s5(e,r,n){const a=ls(r,e),u=YI(n),d=e[10],m=XE(e,iA(e,u,null,n.onPush?32:16,a,r,d,d.createRenderer(a,n),null,null,null));e[r.index]=m}function Oa(e,r,n,a,u,d){const m=ls(e,r);!function XI(e,r,n,a,u,d,m){if(null==d)e.removeAttribute(r,u,n);else{const E=null==m?Ut(d):m(d,a||"",u);e.setAttribute(r,u,E,n)}}(r[11],m,d,e.value,n,a,u)}function a5(e,r,n,a,u,d){const m=d[r];if(null!==m){const E=a.setInput;for(let C=0;C<m.length;){const I=m[C++],w=m[C++],M=m[C++];null!==E?a.setInput(n,M,I,w):n[w]=M}}}function c5(e,r){let n=null,a=0;for(;a<r.length;){const u=r[a];if(0!==u)if(5!==u){if("number"==typeof u)break;e.hasOwnProperty(u)&&(null===n&&(n=[]),n.push(u,e[u],r[a+1])),a+=2}else a+=2;else a+=4}return n}function dO(e,r,n,a){return new Array(e,!0,!1,r,null,0,a,n,null,null)}function hO(e,r){const n=qo(r,e);if(j_(n)){const a=n[1];48&n[2]?YE(a,n,a.template,n[8]):n[5]>0&&gu(n)}}function gu(e){for(let a=Jy(e);null!==a;a=zy(a))for(let u=10;u<a.length;u++){const d=a[u];if(j_(d))if(512&d[2]){const m=d[1];YE(m,d,m.template,d[8])}else d[5]>0&&gu(d)}const n=e[1].components;if(null!==n)for(let a=0;a<n.length;a++){const u=qo(n[a],e);j_(u)&&u[5]>0&&gu(u)}}function d5(e,r){const n=qo(r,e),a=n[1];(function h5(e,r){for(let n=r.length;n<e.blueprint.length;n++)r.push(e.blueprint[n])})(a,n),HI(a,n,n[8])}function XE(e,r){return e[13]?e[14][4]=r:e[13]=r,e[14]=r,r}function ZI(e){for(;e;){e[2]|=32;const r=Bg(e);if(BU(e)&&!r)return e;e=r}return null}function ZE(e,r,n,a=!0){const u=r[10];u.begin&&u.begin();try{YE(e,r,e.template,n)}catch(m){throw a&&AO(r,m),m}finally{u.end&&u.end()}}function ev(e,r,n){gy(0),r(e,n)}function pO(e){return e[7]||(e[7]=[])}function fO(e){return e.cleanup||(e.cleanup=[])}function AO(e,r){const n=e[9],a=n?n.get(cp,null):null;a&&a.handleError(r)}function tv(e,r,n,a,u){for(let d=0;d<n.length;){const m=n[d++],E=n[d++],C=r[m],I=e.data[m];null!==I.setInput?I.setInput(C,u,a,E):C[E]=u}}function nv(e,r,n){let a=n?e.styles:null,u=n?e.classes:null,d=0;if(null!==r)for(let m=0;m<r.length;m++){const E=r[m];"number"==typeof E?d=E:1==d?u=Vh(u,E):2==d&&(a=Vh(a,E+": "+r[++m]+";"))}n?e.styles=a:e.stylesWithoutHost=a,n?e.classes=u:e.classesWithoutHost=u}function Bd(e,r,n,a,u=!1){for(;null!==n;){const d=r[n.index];if(null!==d&&a.push(fi(d)),Gs(d))for(let E=10;E<d.length;E++){const C=d[E],I=C[1].firstChild;null!==I&&Bd(C[1],C,I,a)}const m=n.type;if(8&m)Bd(e,r,n.child,a);else if(32&m){const E=tp(n,r);let C;for(;C=E();)a.push(C)}else if(16&m){const E=hE(r,n);if(Array.isArray(E))a.push(...E);else{const C=Bg(r[16]);Bd(C[1],C,E,a,!0)}}n=u?n.projectionNext:n.next}return a}class Fd{constructor(r,n){this._lView=r,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const r=this._lView,n=r[1];return Bd(n,r,n.firstChild,[])}get context(){return this._lView[8]}set context(r){this._lView[8]=r}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const r=this._lView[3];if(Gs(r)){const n=r[8],a=n?n.indexOf(this):-1;a>-1&&(Ug(r,a),X_(n,a))}this._attachedToViewContainer=!1}cl(this._lView[1],this._lView)}onDestroy(r){qI(this._lView[1],this._lView,null,r)}markForCheck(){ZI(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){ZE(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Be(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function eI(e,r){lu(e,r,r[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(r){if(this._attachedToViewContainer)throw new Be(902,!1);this._appRef=r}}class mO extends Fd{constructor(r){super(r),this._view=r}detectChanges(){const r=this._view;ZE(r[1],r,r[8],!1)}checkNoChanges(){}get context(){return null}}class gp extends zg{constructor(r){super(),this.ngModule=r}resolveComponentFactory(r){const n=On(r);return new sA(n,this.ngModule)}}function eS(e){const r=[];for(let n in e)e.hasOwnProperty(n)&&r.push({propName:e[n],templateName:n});return r}class _O{constructor(r,n){this.injector=r,this.parentInjector=n}get(r,n,a){const u=this.injector.get(r,bI,a);return u!==bI||n===bI?u:this.parentInjector.get(r,n,a)}}class sA extends Jg{constructor(r,n){super(),this.componentDef=r,this.ngModule=n,this.componentType=r.type,this.selector=function RE(e){return e.map(k8).join(",")}(r.selectors),this.ngContentSelectors=r.ngContentSelectors?r.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return eS(this.componentDef.inputs)}get outputs(){return eS(this.componentDef.outputs)}create(r,n,a,u){let d=(u=u||this.ngModule)instanceof Ks?u:u?.injector;d&&null!==this.componentDef.getStandaloneInjector&&(d=this.componentDef.getStandaloneInjector(d)||d);const m=d?new _O(r,d):r,E=m.get(SE,null);if(null===E)throw new Be(407,!1);const C=m.get(m8,null),I=E.createRenderer(null,this.componentDef),w=this.componentDef.selectors[0][0]||"div",M=a?function t5(e,r,n){return e.selectRootElement(r,n===Ea.ShadowDom)}(I,a,this.componentDef.encapsulation):Fg(I,w,function p5(e){const r=e.toLowerCase();return"svg"===r?"svg":"math"===r?"math":null}(w)),F=this.componentDef.onPush?288:272,H=oA(0,null,null,1,0,null,null,null,null,null),$=iA(null,H,null,F,null,null,E,I,C,m,null);let oe,he;vg($);try{const Ae=function m5(e,r,n,a,u,d){const m=n[1];n[22]=e;const C=hp(m,22,2,"#host",null),I=C.mergedAttrs=r.hostAttrs;null!==I&&(nv(C,I,!0),null!==e&&(Jh(u,e,I),null!==C.classes&&rI(u,e,C.classes),null!==C.styles&&u2(u,e,C.styles)));const w=a.createRenderer(e,r),M=iA(n,YI(r),null,r.onPush?32:16,n[22],C,a,w,d||null,null,null);return m.firstCreatePass&&(z_(Sg(C,n),m,r.type),uO(m,C),$E(C,n.length,1)),XE(n,M),n[22]=M}(M,this.componentDef,$,E,I);if(M)if(a)Jh(I,M,["ng-version",_8.full]);else{const{attrs:Ce,classes:ge}=function L8(e){const r=[],n=[];let a=1,u=2;for(;a<e.length;){let d=e[a];if("string"==typeof d)2===u?""!==d&&r.push(d,e[++a]):8===u&&n.push(d);else{if(!wa(u))break;u=d}a++}return{attrs:r,classes:n}}(this.componentDef.selectors[0]);Ce&&Jh(I,M,Ce),ge&&ge.length>0&&rI(I,M,ge.join(" "))}if(he=Cr(H,22),void 0!==n){const Ce=he.projection=[];for(let ge=0;ge<this.ngContentSelectors.length;ge++){const De=n[ge];Ce.push(null!=De?Array.from(De):null)}}oe=function _5(e,r,n,a){const u=n[1],d=function sO(e,r,n){const a=qr();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),$I(e,a,r,hl(e,r,1,null),n),pl(e,a));const u=Rg(r,e,a.directiveStart,a);Ji(u,r);const d=ls(a,r);return d&&Ji(d,r),u}(u,n,r);if(e[8]=n[8]=d,null!==a)for(const E of a)E(d,r);if(r.contentQueries){const E=qr();r.contentQueries(1,d,E.directiveStart)}const m=qr();return!u.firstCreatePass||null===r.hostBindings&&null===r.hostAttrs||(ou(m.index),zE(n[1],m,0,m.directiveStart,m.directiveEnd,r),cO(r,d)),d}(Ae,this.componentDef,$,[vO]),HI(H,$,null)}finally{iu()}return new g5(this.componentType,oe,Pd(he,$),$,he)}}class g5 extends class O2{}{constructor(r,n,a,u,d){super(),this.location=a,this._rootLView=u,this._tNode=d,this.instance=n,this.hostView=this.changeDetectorRef=new mO(u),this.componentType=r}setInput(r,n){const a=this._tNode.inputs;let u;if(null!==a&&(u=a[r])){const d=this._rootLView;tv(d[1],d,u,r,n),xd(d,this._tNode.index)}}get injector(){return new vd(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(r){this.hostView.onDestroy(r)}}function vO(){const e=qr();W_(ve()[1],e)}function Pn(e){let r=function CO(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0;const a=[e];for(;r;){let u;if(ya(e))u=r.\u0275cmp||r.\u0275dir;else{if(r.\u0275cmp)throw new Be(903,!1);u=r.\u0275dir}if(u){if(n){a.push(u);const m=e;m.inputs=tS(e.inputs),m.declaredInputs=tS(e.declaredInputs),m.outputs=tS(e.outputs);const E=u.hostBindings;E&&C5(e,E);const C=u.viewQuery,I=u.contentQueries;if(C&&v5(e,C),I&&yO(e,I),ZC(e.inputs,u.inputs),ZC(e.declaredInputs,u.declaredInputs),ZC(e.outputs,u.outputs),ya(u)&&u.data.animation){const w=e.data;w.animation=(w.animation||[]).concat(u.data.animation)}}const d=u.features;if(d)for(let m=0;m<d.length;m++){const E=d[m];E&&E.ngInherit&&E(e),E===Pn&&(n=!1)}}r=Object.getPrototypeOf(r)}!function E5(e){let r=0,n=null;for(let a=e.length-1;a>=0;a--){const u=e[a];u.hostVars=r+=u.hostVars,u.hostAttrs=Ig(u.hostAttrs,n=Ig(n,u.hostAttrs))}}(a)}function tS(e){return e===Xu?{}:e===_n?[]:e}function v5(e,r){const n=e.viewQuery;e.viewQuery=n?(a,u)=>{r(a,u),n(a,u)}:r}function yO(e,r){const n=e.contentQueries;e.contentQueries=n?(a,u,d)=>{r(a,u,d),n(a,u,d)}:r}function C5(e,r){const n=e.hostBindings;e.hostBindings=n?(a,u)=>{r(a,u),n(a,u)}:r}let aA=null;function Ud(){if(!aA){const e=Yn.Symbol;if(e&&e.iterator)aA=e.iterator;else{const r=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<r.length;++n){const a=r[n];"entries"!==a&&"size"!==a&&Map.prototype[a]===Map.prototype.entries&&(aA=a)}}}return aA}function cA(e){return!!rS(e)&&(Array.isArray(e)||!(e instanceof Map)&&Ud()in e)}function rS(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function zi(e,r,n){return!Object.is(e[r],n)&&(e[r]=n,!0)}function Mn(e,r,n,a){const u=ve();return zi(u,Yh(),r)&&(fn(),Oa(yr(),u,e,r,n,a)),Mn}function mc(e,r,n,a){return zi(e,Yh(),n)?r+Ut(n)+a:Vt}function ke(e,r,n,a,u,d,m,E){const C=ve(),I=fn(),w=e+22,M=I.firstCreatePass?function T5(e,r,n,a,u,d,m,E,C){const I=r.consts,w=hp(r,e,4,m||null,el(I,E));zI(r,n,w,el(I,C)),W_(r,w);const M=w.tViews=oA(2,w,a,u,d,r.directiveRegistry,r.pipeRegistry,null,r.schemas,I);return null!==r.queries&&(r.queries.template(r,w),M.queries=r.queries.embeddedTView(w)),w}(w,I,C,r,n,a,u,d,m):I.data[w];sc(M,!1);const F=C[11].createComment("");rp(I,C,F,M),Ji(F,C),XE(C,C[w]=dO(F,C,F,M)),x_(M)&&WI(I,C,M),null!=m&&KI(C,M,E)}function qn(e){return function tu(e,r){return e[r]}(function hN(){return Mt.lFrame.contextLView}(),22+e)}function Ue(e,r,n){const a=ve();return zi(a,Yh(),r)&&zo(fn(),yr(),a,e,r,a[11],n,!1),Ue}function aS(e,r,n,a,u){const m=u?"class":"style";tv(e,n,r.inputs[m],m,a)}function Ge(e,r,n,a){const u=ve(),d=fn(),m=22+e,E=u[11],C=u[m]=Fg(E,r,function _y(){return Mt.lFrame.currentNamespace}()),I=d.firstCreatePass?function R5(e,r,n,a,u,d,m){const E=r.consts,I=hp(r,e,2,u,el(E,d));return zI(r,n,I,el(E,m)),null!==I.attrs&&nv(I,I.attrs,!1),null!==I.mergedAttrs&&nv(I,I.mergedAttrs,!0),null!==r.queries&&r.queries.elementStart(r,I),I}(m,d,u,0,r,n,a):d.data[m];sc(I,!0);const w=I.mergedAttrs;null!==w&&Jh(E,C,w);const M=I.classes;null!==M&&rI(E,C,M);const F=I.styles;return null!==F&&u2(E,C,F),64!=(64&I.flags)&&rp(d,u,C,I),0===function uN(){return Mt.lFrame.elementDepthCount}()&&Ji(C,u),function lN(){Mt.lFrame.elementDepthCount++}(),x_(I)&&(WI(d,u,I),JE(d,I,u)),null!==a&&KI(u,I),Ge}function He(){let e=qr();ac()?Kh():(e=e.parent,sc(e,!1));const r=e;!function dN(){Mt.lFrame.elementDepthCount--}();const n=fn();return n.firstCreatePass&&(W_(n,e),cy(e)&&n.queries.elementEnd(e)),null!=r.classesWithoutHost&&function $U(e){return 0!=(16&e.flags)}(r)&&aS(n,r,ve(),r.classesWithoutHost,!0),null!=r.stylesWithoutHost&&function Cy(e){return 0!=(32&e.flags)}(r)&&aS(n,r,ve(),r.stylesWithoutHost,!1),He}function Ir(e,r,n,a){return Ge(e,r,n,a),He(),Ir}function Ep(e,r,n){const a=ve(),u=fn(),d=e+22,m=u.firstCreatePass?function cS(e,r,n,a,u){const d=r.consts,m=el(d,a),E=hp(r,e,8,"ng-container",m);return null!==m&&nv(E,m,!0),zI(r,n,E,el(d,u)),null!==r.queries&&r.queries.elementStart(r,E),E}(d,u,a,r,n):u.data[d];sc(m,!0);const E=a[d]=a[11].createComment("");return rp(u,a,E,m),Ji(E,a),x_(m)&&(WI(u,a,m),JE(u,m,a)),null!=n&&KI(a,m),Ep}function Qd(){let e=qr();const r=fn();return ac()?Kh():(e=e.parent,sc(e,!1)),r.firstCreatePass&&(W_(r,e),cy(e)&&r.queries.elementEnd(e)),Qd}function Ri(){return ve()}function _u(e){return!!e&&"function"==typeof e.then}const lA=function PO(e){return!!e&&"function"==typeof e.subscribe};function kt(e,r,n,a){const u=ve(),d=fn(),m=qr();return function vp(e,r,n,a,u,d,m,E){const C=x_(a),w=e.firstCreatePass&&fO(e),M=r[8],F=pO(r);let H=!0;if(3&a.type||E){const he=ls(a,r),Ae=E?E(he):he,Ce=F.length,ge=E?Ze=>E(fi(Ze[a.index])):a.index;let De=null;if(!E&&C&&(De=function MO(e,r,n,a){const u=e.cleanup;if(null!=u)for(let d=0;d<u.length-1;d+=2){const m=u[d];if(m===n&&u[d+1]===a){const E=r[7],C=u[d+2];return E.length>C?E[C]:null}"string"==typeof m&&(d+=2)}return null}(e,r,u,a.index)),null!==De)(De.__ngLastListenerFn__||De).__ngNextListenerFn__=d,De.__ngLastListenerFn__=d,H=!1;else{d=Cp(a,r,M,d,!1);const Ze=n.listen(Ae,u,d);F.push(d,Ze),w&&w.push(u,ge,Ce,Ce+1)}}else d=Cp(a,r,M,d,!1);const $=a.outputs;let oe;if(H&&null!==$&&(oe=$[u])){const he=oe.length;if(he)for(let Ae=0;Ae<he;Ae+=2){const lt=r[oe[Ae]][oe[Ae+1]].subscribe(d),pn=F.length;F.push(d,lt),w&&w.push(u,a.index,pn,-(pn+1))}}}(d,u,u[11],m,e,r,0,a),kt}function gl(e,r,n,a){try{return!1!==n(a)}catch(u){return AO(e,u),!1}}function Cp(e,r,n,a,u){return function d(m){if(m===Function)return a;ZI(2&e.flags?qo(e.index,r):r);let C=gl(r,0,a,m),I=d.__ngNextListenerFn__;for(;I;)C=gl(r,0,I,m)&&C,I=I.__ngNextListenerFn__;return u&&!1===C&&(m.preventDefault(),m.returnValue=!1),C}}function nt(e=1){return function AN(e){return(Mt.lFrame.contextLView=function my(e,r){for(;e>0;)r=r[15],e--;return r}(e,Mt.lFrame.contextLView))[8]}(e)}function lS(e,r){let n=null;const a=function O8(e){const r=e.attrs;if(null!=r){const n=r.indexOf(5);if(0==(1&n))return r[n+1]}return null}(e);for(let u=0;u<r.length;u++){const d=r[u];if("*"!==d){if(null===a?NI(e,d,!0):TE(a,d))return u}else n=u}return n}function yp(e){const r=ve()[16][6];if(!r.projection){const a=r.projection=wg(e?e.length:1,null),u=a.slice();let d=r.child;for(;null!==d;){const m=e?lS(d,e):0;null!==m&&(u[m]?u[m].projectionNext=d:a[m]=d,u[m]=d),d=d.next}}}function Ip(e,r=0,n){const a=ve(),u=fn(),d=hp(u,22+e,16,null,n||null);null===d.projection&&(d.projection=r),Kh(),64!=(64&d.flags)&&function Q4(e,r,n){c2(r[11],0,r,n,e2(e,n,r),jg(n.parent||r[6],n,r))}(u,a,d)}function Sp(e,r,n){return bp(e,"",r,"",n),Sp}function bp(e,r,n,a,u){const d=ve(),m=mc(d,r,n,a);return m!==Vt&&zo(fn(),yr(),d,e,m,d[11],u,!1),bp}function pS(e,r,n,a,u){const d=e[n+1],m=null===r;let E=a?Na(d):fu(d),C=!1;for(;0!==E&&(!1===C||m);){const w=e[E+1];UO(e[E],r)&&(C=!0,e[E+1]=a?LI(w):xE(w)),E=a?Na(w):fu(w)}C&&(e[n+1]=a?xE(d):LI(d))}function UO(e,r){return null===e||null==r||(Array.isArray(e)?e[1]:e)===r||!(!Array.isArray(e)||"string"!=typeof r)&&Zh(e,r)>=0}const Ai={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function dA(e){return e.substring(Ai.key,Ai.keyEnd)}function QO(e,r){const n=Ai.textEnd;return n===r?-1:(r=Ai.keyEnd=function w5(e,r,n){for(;r<n&&e.charCodeAt(r)>32;)r++;return r}(e,Ai.key=r,n),Rp(e,r,n))}function Rp(e,r,n){for(;r<n&&e.charCodeAt(r)<=32;)r++;return r}function pr(e,r){return function ka(e,r,n,a){const u=ve(),d=fn(),m=Ia(2);d.firstUpdatePass&&HO(d,e,m,a),r!==Vt&&zi(u,m,r)&&WO(d,d.data[ao()],u,u[11],e,u[m+1]=function F5(e,r){return null==e||("string"==typeof r?e+=r:"object"==typeof e&&(e=er(hu(e)))),e}(r,n),a,m)}(e,r,null,!0),pr}function Js(e){!function Vi(e,r,n,a){const u=fn(),d=Ia(2);u.firstUpdatePass&&HO(u,null,d,a);const m=ve();if(n!==Vt&&zi(m,d,n)){const E=u.data[ao()];if(KO(E,a)&&!sv(u,d)){let C=a?E.classesWithoutHost:E.stylesWithoutHost;null!==C&&(n=Vh(C,n||"")),aS(u,E,m,n,a)}else!function B5(e,r,n,a,u,d,m,E){u===Vt&&(u=_n);let C=0,I=0,w=0<u.length?u[0]:null,M=0<d.length?d[0]:null;for(;null!==w||null!==M;){const F=C<u.length?u[C+1]:void 0,H=I<d.length?d[I+1]:void 0;let oe,$=null;w===M?(C+=2,I+=2,F!==H&&($=M,oe=H)):null===M||null!==w&&w<M?(C+=2,$=w):(I+=2,$=M,oe=H),null!==$&&WO(e,r,n,a,$,oe,m,E),w=C<u.length?u[C]:null,M=I<d.length?d[I]:null}}(u,E,m,m[11],m[d+1],m[d+1]=function x5(e,r,n){if(null==n||""===n)return _n;const a=[],u=hu(n);if(Array.isArray(u))for(let d=0;d<u.length;d++)e(a,u[d],!0);else if("object"==typeof u)for(const d in u)u.hasOwnProperty(d)&&e(a,d,u[d]);else"string"==typeof u&&r(a,u);return a}(e,r,n),a,d)}}(fs,Ui,e,!0)}function Ui(e,r){for(let n=function jO(e){return function GO(e){Ai.key=0,Ai.keyEnd=0,Ai.value=0,Ai.valueEnd=0,Ai.textEnd=e.length}(e),QO(e,Rp(e,0,Ai.textEnd))}(r);n>=0;n=QO(r,n))fs(e,dA(r),!0)}function sv(e,r){return r>=e.expandoStartIndex}function HO(e,r,n,a){const u=e.data;if(null===u[n+1]){const d=u[ao()],m=sv(e,n);KO(d,a)&&null===r&&!m&&(r=!1),r=function k5(e,r,n,a){const u=function fy(e){const r=Mt.lFrame.currentDirectiveIndex;return-1===r?null:e[r]}(e);let d=a?r.residualClasses:r.residualStyles;if(null===u)0===(a?r.classBindings:r.styleBindings)&&(n=fA(n=mS(null,e,r,n,a),r.attrs,a),d=null);else{const m=r.directiveStylingLast;if(-1===m||e[m]!==u)if(n=mS(u,e,r,n,a),null===d){let C=function L5(e,r,n){const a=n?r.classBindings:r.styleBindings;if(0!==fu(a))return e[Na(a)]}(e,r,a);void 0!==C&&Array.isArray(C)&&(C=mS(null,e,r,C[1],a),C=fA(C,r.attrs,a),function AS(e,r,n,a){e[Na(n?r.classBindings:r.styleBindings)]=a}(e,r,a,C))}else d=function av(e,r,n){let a;const u=r.directiveEnd;for(let d=1+r.directiveStylingLast;d<u;d++)a=fA(a,e[d].hostAttrs,n);return fA(a,r.attrs,n)}(e,r,a)}return void 0!==d&&(a?r.residualClasses=d:r.residualStyles=d),n}(u,d,r,a),function D5(e,r,n,a,u,d){let m=d?r.classBindings:r.styleBindings,E=Na(m),C=fu(m);e[a]=n;let w,I=!1;if(Array.isArray(n)){const M=n;w=M[1],(null===w||Zh(M,w)>0)&&(I=!0)}else w=n;if(u)if(0!==C){const F=Na(e[E+1]);e[a+1]=kE(F,E),0!==F&&(e[F+1]=BE(e[F+1],a)),e[E+1]=function Y8(e,r){return 131071&e|r<<17}(e[E+1],a)}else e[a+1]=kE(E,0),0!==E&&(e[E+1]=BE(e[E+1],a)),E=a;else e[a+1]=kE(C,0),0===E?E=a:e[C+1]=BE(e[C+1],a),C=a;I&&(e[a+1]=xE(e[a+1])),pS(e,w,a,!0),pS(e,w,a,!1),function hS(e,r,n,a,u){const d=u?e.residualClasses:e.residualStyles;null!=d&&"string"==typeof r&&Zh(d,r)>=0&&(n[a+1]=LI(n[a+1]))}(r,w,e,a,d),m=kE(E,C),d?r.classBindings=m:r.styleBindings=m}(u,d,r,n,m,a)}}function mS(e,r,n,a,u){let d=null;const m=n.directiveEnd;let E=n.directiveStylingLast;for(-1===E?E=n.directiveStart:E++;E<m&&(d=r[E],a=fA(a,d.hostAttrs,u),d!==e);)E++;return null!==e&&(n.directiveStylingLast=E),a}function fA(e,r,n){const a=n?1:2;let u=-1;if(null!==r)for(let d=0;d<r.length;d++){const m=r[d];"number"==typeof m?u=m:u===a&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),fs(e,m,!!n||r[++d]))}return void 0===e?null:e}function WO(e,r,n,a,u,d,m,E){if(!(3&r.type))return;const C=e.data,I=C[E+1];Dp(function $2(e){return 1==(1&e)}(I)?ES(C,r,n,u,fu(I),m):void 0)||(Dp(d)||function LE(e){return 2==(2&e)}(I)&&(d=ES(C,null,n,u,E,m)),function H4(e,r,n,a,u){if(r)u?e.addClass(n,a):e.removeClass(n,a);else{let d=-1===a.indexOf("-")?void 0:Jo.DashCase;null==u?e.removeStyle(n,a,d):("string"==typeof u&&u.endsWith("!important")&&(u=u.slice(0,-10),d|=Jo.Important),e.setStyle(n,a,u,d))}}(a,m,mg(ao(),n),u,d))}function ES(e,r,n,a,u,d){const m=null===r;let E;for(;u>0;){const C=e[u],I=Array.isArray(C),w=I?C[1]:C,M=null===w;let F=n[u+1];F===Vt&&(F=M?_n:void 0);let H=M?Ro(F,a):w===a?F:void 0;if(I&&!Dp(H)&&(H=Ro(C,a)),Dp(H)&&(E=H,m))return E;const $=e[u+1];u=m?Na($):fu($)}if(null!==r){let C=d?r.residualClasses:r.residualStyles;null!=C&&(E=Ro(C,a))}return E}function Dp(e){return void 0!==e}function KO(e,r){return 0!=(e.flags&(r?16:32))}function ti(e,r=""){const n=ve(),a=fn(),u=e+22,d=a.firstCreatePass?hp(a,u,1,r,null):a.data[u],m=n[u]=function Xy(e,r){return e.createText(r)}(n[11],r);rp(a,n,m,d),sc(d,!1)}function ml(e){return gA("",e,""),ml}function gA(e,r,n){const a=ve(),u=mc(a,e,r,n);return u!==Vt&&function Ac(e,r,n){const a=mg(r,e);!function $N(e,r,n){e.setValue(r,n)}(e[11],a,n)}(a,ao(),u),gA}function _l(e,r,n){const a=ve();return zi(a,Yh(),r)&&zo(fn(),yr(),a,e,r,a[11],n,!0),_l}const Op="en-US";let wS=Op;function CA(e,r,n,a,u){if(e=Pt(e),Array.isArray(e))for(let d=0;d<e.length;d++)CA(e[d],r,n,a,u);else{const d=fn(),m=ve();let E=Nd(e)?e:Pt(e.provide),C=qg(e);const I=qr(),w=1048575&I.providerIndexes,M=I.directiveStart,F=I.providerIndexes>>20;if(Nd(e)||!e.multi){const H=new nl(C,u,se),$=Tv(E,r,u?w:w+F,M);-1===$?(z_(Sg(I,m),d,E),GS(d,e,r.length),r.push(E),I.directiveStart++,I.directiveEnd++,u&&(I.providerIndexes+=1048576),n.push(H),m.push(H)):(n[$]=H,m[$]=H)}else{const H=Tv(E,r,w+F,M),$=Tv(E,r,w,w+F),oe=H>=0&&n[H],he=$>=0&&n[$];if(u&&!he||!u&&!oe){z_(Sg(I,m),d,E);const Ae=function mV(e,r,n,a,u){const d=new nl(e,n,se);return d.multi=[],d.index=r,d.componentProviders=0,yA(d,u,a&&!n),d}(u?HS:Rv,n.length,u,a,C);!u&&he&&(n[$].providerFactory=Ae),GS(d,e,r.length,0),r.push(E),I.directiveStart++,I.directiveEnd++,u&&(I.providerIndexes+=1048576),n.push(Ae),m.push(Ae)}else GS(d,e,H>-1?H:$,yA(n[u?$:H],C,!u&&a));!u&&a&&he&&n[$].componentProviders++}}}function GS(e,r,n,a){const u=Nd(r),d=function R2(e){return!!e.useClass}(r);if(u||d){const C=(d?Pt(r.useClass):r).prototype.ngOnDestroy;if(C){const I=e.destroyHooks||(e.destroyHooks=[]);if(!u&&r.multi){const w=I.indexOf(n);-1===w?I.push(n,[a,C]):I[w+1].push(a,C)}else I.push(n,C)}}}function yA(e,r,n){return n&&e.componentProviders++,e.multi.push(r)-1}function Tv(e,r,n,a){for(let u=n;u<a;u++)if(r[u]===e)return u;return-1}function Rv(e,r,n,a){return WS(this.multi,[])}function HS(e,r,n,a){const u=this.multi;let d;if(this.providerFactory){const m=this.providerFactory.componentProviders,E=Rg(n,n[1],this.providerFactory.index,a);d=E.slice(0,m),WS(u,d);for(let C=m;C<E.length;C++)d.push(E[C])}else d=[],WS(u,d);return d}function WS(e,r){for(let n=0;n<e.length;n++)r.push((0,e[n])());return r}function fr(e,r=[]){return n=>{n.providersResolver=(a,u)=>function TP(e,r,n){const a=fn();if(a.firstCreatePass){const u=ya(e);CA(n,a.data,a.blueprint,u,!0),CA(r,a.data,a.blueprint,u,!1)}}(a,u?u(e):e,r)}}class El{}class Bp{}class KS extends El{constructor(r,n){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new gp(this);const a=Ko(r);this._bootstrapComponents=Da(a.bootstrap),this._r3Injector=PI(r,n,[{provide:El,useValue:this},{provide:zg,useValue:this.componentFactoryResolver}],er(r),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(r)}get injector(){return this._r3Injector}destroy(){const r=this._r3Injector;!r.destroyed&&r.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(r){this.destroyCbs.push(r)}}class Dv extends Bp{constructor(r){super(),this.moduleType=r}create(r){return new KS(this.moduleType,r)}}class DP extends El{constructor(r,n,a){super(),this.componentFactoryResolver=new gp(this),this.instance=null;const u=new Od([...r,{provide:El,useValue:this},{provide:zg,useValue:this.componentFactoryResolver}],n||Yg(),a,new Set(["environment"]));this.injector=u,u.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(r){this.injector.onDestroy(r)}}function IA(e,r,n=null){return new DP(e,r,n).injector}let wP=(()=>{class e{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n.id)){const a=b2(0,n.type),u=a.length>0?IA([a],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n.id,u)}return this.cachedInjectors.get(n.id)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}}return e.\u0275prov=ot({token:e,providedIn:"environment",factory:()=>new e(Fe(Ks))}),e})();function NP(e){e.getStandaloneInjector=r=>r.get(wP).getOrCreateStandaloneInjector(e)}function wo(e,r,n,a){return function $S(e,r,n,a,u,d){const m=r+n;return zi(e,m,u)?function Pa(e,r,n){return e[r]=n}(e,m+1,d?a.call(d,u):a(u)):function bA(e,r){const n=e[r];return n===Vt?void 0:n}(e,m+1)}(ve(),function bi(){const e=Mt.lFrame;let r=e.bindingRootIndex;return-1===r&&(r=e.bindingRootIndex=e.tView.bindingStartIndex),r}(),e,r,n,a)}function ZS(e){return r=>{setTimeout(e,void 0,r)}}const Ft=class XS extends Or{constructor(r=!1){super(),this.__isAsync=r}emit(r){super.next(r)}subscribe(r,n,a){let u=r,d=n||(()=>null),m=a;if(r&&"object"==typeof r){const C=r;u=C.next?.bind(C),d=C.error?.bind(C),m=C.complete?.bind(C)}this.__isAsync&&(d=ZS(d),u&&(u=ZS(u)),m&&(m=ZS(m)));const E=super.subscribe({next:u,error:d,complete:m});return r instanceof Hr&&r.add(E),E}};function BV(){return this._results[Ud()]()}class DA{constructor(r=!1){this._emitDistinctChangesOnly=r,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=Ud(),a=DA.prototype;a[n]||(a[n]=BV)}get changes(){return this._changes||(this._changes=new Ft)}get(r){return this._results[r]}map(r){return this._results.map(r)}filter(r){return this._results.filter(r)}find(r){return this._results.find(r)}reduce(r,n){return this._results.reduce(r,n)}forEach(r){this._results.forEach(r)}some(r){return this._results.some(r)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(r,n){const a=this;a.dirty=!1;const u=ps(r);(this._changesDetected=!function t4(e,r,n){if(e.length!==r.length)return!1;for(let a=0;a<e.length;a++){let u=e[a],d=r[a];if(n&&(u=n(u),d=n(d)),d!==u)return!1}return!0}(a._results,u,n))&&(a._results=u,a.length=u.length,a.last=u[this.length-1],a.first=u[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let gr=(()=>{class e{}return e.__NG_ELEMENT_ID__=QP,e})();const jP=gr,FV=class extends jP{constructor(r,n,a){super(),this._declarationLView=r,this._declarationTContainer=n,this.elementRef=a}createEmbeddedView(r,n){const a=this._declarationTContainer.tViews,u=iA(this._declarationLView,a,r,16,null,a.declTNode,null,null,null,null,n||null);u[17]=this._declarationLView[this._declarationTContainer.index];const m=this._declarationLView[19];return null!==m&&(u[19]=m.createEmbeddedView(a)),HI(a,u,r),new Fd(u)}};function QP(){return Ov(qr(),ve())}function Ov(e,r){return 4&e.type?new FV(r,e,Pd(e,r)):null}let As=(()=>{class e{}return e.__NG_ELEMENT_ID__=UV,e})();function UV(){return wA(qr(),ve())}const VV=As,GP=class extends VV{constructor(r,n,a){super(),this._lContainer=r,this._hostTNode=n,this._hostLView=a}get element(){return Pd(this._hostTNode,this._hostLView)}get injector(){return new vd(this._hostTNode,this._hostLView)}get parentInjector(){const r=J_(this._hostTNode,this._hostLView);if(SN(r)){const n=_d(r,this._hostLView),a=md(r);return new vd(n[1].data[a+8],n)}return new vd(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(r){const n=HP(this._lContainer);return null!==n&&n[r]||null}get length(){return this._lContainer.length-10}createEmbeddedView(r,n,a){let u,d;"number"==typeof a?u=a:null!=a&&(u=a.index,d=a.injector);const m=r.createEmbeddedView(n||{},d);return this.insert(m,u),m}createComponent(r,n,a,u,d){const m=r&&!function Dg(e){return"function"==typeof e}(r);let E;if(m)E=n;else{const M=n||{};E=M.index,a=M.injector,u=M.projectableNodes,d=M.environmentInjector||M.ngModuleRef}const C=m?r:new sA(On(r)),I=a||this.parentInjector;if(!d&&null==C.ngModule){const F=(m?I:this.parentInjector).get(Ks,null);F&&(d=F)}const w=C.create(I,u,void 0,d);return this.insert(w.hostView,E),w}insert(r,n){const a=r._lView,u=a[1];if(function dy(e){return Gs(e[3])}(a)){const w=this.indexOf(r);if(-1!==w)this.detach(w);else{const M=a[3],F=new GP(M,M[6],M[3]);F.detach(F.indexOf(r))}}const d=this._adjustIndex(n),m=this._lContainer;!function B4(e,r,n,a){const u=10+a,d=n.length;a>0&&(n[u-1][4]=r),a<d-10?(r[4]=n[u],PN(n,10+a,r)):(n.push(r),r[4]=null),r[3]=n;const m=r[17];null!==m&&n!==m&&function F4(e,r){const n=e[9];r[16]!==r[3][3][16]&&(e[2]=!0),null===n?e[9]=[r]:n.push(r)}(m,r);const E=r[19];null!==E&&E.insertView(e),r[2]|=64}(u,a,m,d);const E=tI(d,m),C=a[11],I=np(C,m[7]);return null!==I&&function XN(e,r,n,a,u,d){a[0]=u,a[6]=r,lu(e,a,n,1,u,d)}(u,m[6],C,a,I,E),r.attachToViewContainerRef(),PN(Pv(m),d,r),r}move(r,n){return this.insert(r,n)}indexOf(r){const n=HP(this._lContainer);return null!==n?n.indexOf(r):-1}remove(r){const n=this._adjustIndex(r,-1),a=Ug(this._lContainer,n);a&&(X_(Pv(this._lContainer),n),cl(a[1],a))}detach(r){const n=this._adjustIndex(r,-1),a=Ug(this._lContainer,n);return a&&null!=X_(Pv(this._lContainer),n)?new Fd(a):null}_adjustIndex(r,n=0){return r??this.length+n}};function HP(e){return e[8]}function Pv(e){return e[8]||(e[8]=[])}function wA(e,r){let n;const a=r[e.index];if(Gs(a))n=a;else{let u;if(8&e.type)u=fi(a);else{const d=r[11];u=d.createComment("");const m=ls(e,r);Dd(d,np(d,m),u,function j4(e,r){return e.nextSibling(r)}(d,m),!1)}r[e.index]=n=dO(a,r,u,e),XE(r,n)}return new GP(n,e,r)}class tb{constructor(r){this.queryList=r,this.matches=null}clone(){return new tb(this.queryList)}setDirty(){this.queryList.setDirty()}}class nb{constructor(r=[]){this.queries=r}createEmbeddedView(r){const n=r.queries;if(null!==n){const a=null!==r.contentQueries?r.contentQueries[0]:n.length,u=[];for(let d=0;d<a;d++){const m=n.getByIndex(d);u.push(this.queries[m.indexInDeclarationView].clone())}return new nb(u)}return null}insertView(r){this.dirtyQueriesWithMatches(r)}detachView(r){this.dirtyQueriesWithMatches(r)}dirtyQueriesWithMatches(r){for(let n=0;n<this.queries.length;n++)null!==Yd(r,n).matches&&this.queries[n].setDirty()}}class WP{constructor(r,n,a=null){this.predicate=r,this.flags=n,this.read=a}}class rb{constructor(r=[]){this.queries=r}elementStart(r,n){for(let a=0;a<this.queries.length;a++)this.queries[a].elementStart(r,n)}elementEnd(r){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(r)}embeddedTView(r){let n=null;for(let a=0;a<this.length;a++){const u=null!==n?n.length:0,d=this.getByIndex(a).embeddedTView(r,u);d&&(d.indexInDeclarationView=a,null!==n?n.push(d):n=[d])}return null!==n?new rb(n):null}template(r,n){for(let a=0;a<this.queries.length;a++)this.queries[a].template(r,n)}getByIndex(r){return this.queries[r]}get length(){return this.queries.length}track(r){this.queries.push(r)}}class ib{constructor(r,n=-1){this.metadata=r,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(r,n){this.isApplyingToNode(n)&&this.matchTNode(r,n)}elementEnd(r){this._declarationNodeIndex===r.index&&(this._appliesToNextNode=!1)}template(r,n){this.elementStart(r,n)}embeddedTView(r,n){return this.isApplyingToNode(r)?(this.crossesNgTemplate=!0,this.addMatch(-r.index,n),new ib(this.metadata)):null}isApplyingToNode(r){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let a=r.parent;for(;null!==a&&8&a.type&&a.index!==n;)a=a.parent;return n===(null!==a?a.index:-1)}return this._appliesToNextNode}matchTNode(r,n){const a=this.metadata.predicate;if(Array.isArray(a))for(let u=0;u<a.length;u++){const d=a[u];this.matchTNodeWithReadOption(r,n,KP(n,d)),this.matchTNodeWithReadOption(r,n,Tg(n,r,d,!1,!1))}else a===gr?4&n.type&&this.matchTNodeWithReadOption(r,n,-1):this.matchTNodeWithReadOption(r,n,Tg(n,r,a,!1,!1))}matchTNodeWithReadOption(r,n,a){if(null!==a){const u=this.metadata.read;if(null!==u)if(u===Qn||u===As||u===gr&&4&n.type)this.addMatch(n.index,-2);else{const d=Tg(n,r,u,!1,!1);null!==d&&this.addMatch(n.index,d)}else this.addMatch(n.index,a)}}addMatch(r,n){null===this.matches?this.matches=[r,n]:this.matches.push(r,n)}}function KP(e,r){const n=e.localNames;if(null!==n)for(let a=0;a<n.length;a+=2)if(n[a]===r)return n[a+1];return null}function YP(e,r,n,a){return-1===n?function QV(e,r){return 11&e.type?Pd(e,r):4&e.type?Ov(e,r):null}(r,e):-2===n?function GV(e,r,n){return n===Qn?Pd(r,e):n===gr?Ov(r,e):n===As?wA(r,e):void 0}(e,r,a):Rg(e,e[1],n,r)}function ob(e,r,n,a){const u=r[19].queries[a];if(null===u.matches){const d=e.data,m=n.matches,E=[];for(let C=0;C<m.length;C+=2){const I=m[C];E.push(I<0?null:YP(r,d[I],m[C+1],n.metadata.read))}u.matches=E}return u.matches}function sb(e,r,n,a){const u=e.queries.getByIndex(n),d=u.matches;if(null!==d){const m=ob(e,r,u,n);for(let E=0;E<d.length;E+=2){const C=d[E];if(C>0)a.push(m[E/2]);else{const I=d[E+1],w=r[-C];for(let M=10;M<w.length;M++){const F=w[M];F[17]===F[3]&&sb(F[1],F,I,a)}if(null!==w[9]){const M=w[9];for(let F=0;F<M.length;F++){const H=M[F];sb(H[1],H,I,a)}}}}}return a}function kr(e){const r=ve(),n=fn(),a=ru();gy(a+1);const u=Yd(n,a);if(e.dirty&&function cN(e){return 4==(4&e[2])}(r)===(2==(2&u.metadata.flags))){if(null===u.matches)e.reset([]);else{const d=u.crossesNgTemplate?sb(n,r,a,[]):ob(n,r,u,a);e.reset(d,g8),e.notifyOnChanges()}return!0}return!1}function ab(e,r,n){const a=fn();a.firstCreatePass&&(function JP(e,r,n){null===e.queries&&(e.queries=new rb),e.queries.track(new ib(r,n))}(a,new WP(e,r,n),-1),2==(2&r)&&(a.staticViewQueries=!0)),function cb(e,r,n){const a=new DA(4==(4&n));qI(e,r,a,a.destroy),null===r[19]&&(r[19]=new nb),r[19].queries.push(new tb(a))}(a,ve(),r)}function Yd(e,r){return e.queries.getByIndex(r)}function xr(e,r){return Ov(e,r)}function OA(...e){}const PA=new Et("Application Initializer");let Qv=(()=>{class e{constructor(n){this.appInits=n,this.resolve=OA,this.reject=OA,this.initialized=!1,this.done=!1,this.donePromise=new Promise((a,u)=>{this.resolve=a,this.reject=u})}runInitializers(){if(this.initialized)return;const n=[],a=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let u=0;u<this.appInits.length;u++){const d=this.appInits[u]();if(_u(d))n.push(d);else if(lA(d)){const m=new Promise((E,C)=>{d.subscribe({complete:E,error:C})});n.push(m)}}Promise.all(n).then(()=>{a()}).catch(u=>{this.reject(u)}),0===n.length&&a(),this.initialized=!0}}return e.\u0275fac=function(n){return new(n||e)(Fe(PA,8))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const MA=new Et("AppId",{providedIn:"root",factory:function Gv(){return`${mb()}${mb()}${mb()}`}});function mb(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const gM=new Et("Platform Initializer"),Hv=new Et("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),AM=new Et("appBootstrapListener");let ZV=(()=>{class e{log(n){console.log(n)}warn(n){console.warn(n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})();const Cu=new Et("LocaleId",{providedIn:"root",factory:()=>Zr(Cu,bt.Optional|bt.SkipSelf)||function mM(){return typeof $localize<"u"&&$localize.locale||Op}()});class t6{constructor(r,n){this.ngModuleFactory=r,this.componentFactories=n}}let _b=(()=>{class e{compileModuleSync(n){return new Dv(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const a=this.compileModuleSync(n),d=Da(Ko(n).declarations).reduce((m,E)=>{const C=On(E);return C&&m.push(new sA(C)),m},[]);return new t6(a,d)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const vM=(()=>Promise.resolve(0))();function Wv(e){typeof Zone>"u"?vM.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class Gn{constructor({enableLongStackTrace:r=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:a=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ft(!1),this.onMicrotaskEmpty=new Ft(!1),this.onStable=new Ft(!1),this.onError=new Ft(!1),typeof Zone>"u")throw new Be(908,!1);Zone.assertZonePatched();const u=this;if(u._nesting=0,u._outer=u._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const d=Zone.AsyncStackTaggingZoneSpec;u._inner=u._inner.fork(new d("Angular"))}Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!a&&n,u.shouldCoalesceRunChangeDetection=a,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function r6(){let e=Yn.requestAnimationFrame,r=Yn.cancelAnimationFrame;if(typeof Zone<"u"&&e&&r){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const a=r[Zone.__symbol__("OriginalDelegate")];a&&(r=a)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:r}}().nativeRequestAnimationFrame,function yM(e){const r=()=>{!function i6(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Yn,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,yb(e),e.isCheckStableRunning=!0,Cb(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),yb(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,a,u,d,m,E)=>{try{return IM(e),n.invokeTask(u,d,m,E)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===d.type||e.shouldCoalesceRunChangeDetection)&&r(),Ib(e)}},onInvoke:(n,a,u,d,m,E,C)=>{try{return IM(e),n.invoke(u,d,m,E,C)}finally{e.shouldCoalesceRunChangeDetection&&r(),Ib(e)}},onHasTask:(n,a,u,d)=>{n.hasTask(u,d),a===u&&("microTask"==d.change?(e._hasPendingMicrotasks=d.microTask,yb(e),Cb(e)):"macroTask"==d.change&&(e.hasPendingMacrotasks=d.macroTask))},onHandleError:(n,a,u,d)=>(n.handleError(u,d),e.runOutsideAngular(()=>e.onError.emit(d)),!1)})}(u)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Gn.isInAngularZone())throw new Be(909,!1)}static assertNotInAngularZone(){if(Gn.isInAngularZone())throw new Be(909,!1)}run(r,n,a){return this._inner.run(r,n,a)}runTask(r,n,a,u){const d=this._inner,m=d.scheduleEventTask("NgZoneEvent: "+u,r,CM,OA,OA);try{return d.runTask(m,n,a)}finally{d.cancelTask(m)}}runGuarded(r,n,a){return this._inner.runGuarded(r,n,a)}runOutsideAngular(r){return this._outer.run(r)}}const CM={};function Cb(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function yb(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function IM(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Ib(e){e._nesting--,Cb(e)}class o6{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ft,this.onMicrotaskEmpty=new Ft,this.onStable=new Ft,this.onError=new Ft}run(r,n,a){return r.apply(n,a)}runGuarded(r,n,a){return r.apply(n,a)}runOutsideAngular(r){return r()}runTask(r,n,a,u){return r.apply(n,a)}}const Sb=new Et(""),Vp=new Et("");let Kv,bb=(()=>{class e{constructor(n,a,u){this._ngZone=n,this.registry=a,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Kv||(function kA(e){Kv=e}(u),u.addToWindow(a)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Gn.assertNotInAngularZone(),Wv(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Wv(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(a=>!a.updateCb||!a.updateCb(n)||(clearTimeout(a.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,a,u){let d=-1;a&&a>0&&(d=setTimeout(()=>{this._callbacks=this._callbacks.filter(m=>m.timeoutId!==d),n(this._didWork,this.getPendingTasks())},a)),this._callbacks.push({doneCb:n,timeoutId:d,updateCb:u})}whenStable(n,a,u){if(u&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,a,u),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,a,u){return[]}}return e.\u0275fac=function(n){return new(n||e)(Fe(Gn),Fe(Tb),Fe(Vp))},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})(),Tb=(()=>{class e{constructor(){this._applications=new Map}registerApplication(n,a){this._applications.set(n,a)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,a=!0){return Kv?.findTestabilityInTree(this,n,a)??null}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})(),$s=null;const zd=new Et("AllowMultipleToken"),Yv=new Et("PlatformDestroyListeners");class bM{constructor(r,n){this.name=r,this.token=n}}function qv(e,r,n=[]){const a=`Platform: ${r}`,u=new Et(a);return(d=[])=>{let m=Db();if(!m||m.injector.get(zd,!1)){const E=[...n,...d,{provide:u,useValue:!0}];e?e(E):function TM(e){if($s&&!$s.get(zd,!1))throw new Be(400,!1);$s=e;const r=e.get(wM);(function DM(e){const r=e.get(gM,null);r&&r.forEach(n=>n())})(e)}(function Rb(e=[],r){return gi.create({name:r,providers:[{provide:sp,useValue:"platform"},{provide:Yv,useValue:new Set([()=>$s=null])},...e]})}(E,a))}return function a6(e){const r=Db();if(!r)throw new Be(401,!1);return r}()}}function Db(){return $s?.get(wM)??null}let wM=(()=>{class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,a){const u=function NM(e,r){let n;return n="noop"===e?new o6:("zone.js"===e?void 0:e)||new Gn(r),n}(a?.ngZone,function wb(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!e||!e.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!e||!e.ngZoneRunCoalescing)||!1}}(a)),d=[{provide:Gn,useValue:u}];return u.run(()=>{const m=gi.create({providers:d,parent:this.injector,name:n.moduleType.name}),E=n.create(m),C=E.injector.get(cp,null);if(!C)throw new Be(402,!1);return u.runOutsideAngular(()=>{const I=u.onError.subscribe({next:w=>{C.handleError(w)}});E.onDestroy(()=>{LA(this._modules,E),I.unsubscribe()})}),function OM(e,r,n){try{const a=n();return _u(a)?a.catch(u=>{throw r.runOutsideAngular(()=>e.handleError(u)),u}):a}catch(a){throw r.runOutsideAngular(()=>e.handleError(a)),a}}(C,u,()=>{const I=E.injector.get(Qv);return I.runInitializers(),I.donePromise.then(()=>(function NS(e){Wo(e,"Expected localeId to be defined"),"string"==typeof e&&(wS=e.toLowerCase().replace(/_/g,"-"))}(E.injector.get(Cu,Op)||Op),this._moduleDoBootstrap(E),E))})})}bootstrapModule(n,a=[]){const u=Nb({},a);return function SM(e,r,n){const a=new Dv(n);return Promise.resolve(a)}(0,0,n).then(d=>this.bootstrapModuleFactory(d,u))}_moduleDoBootstrap(n){const a=n.injector.get($d);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(u=>a.bootstrap(u));else{if(!n.instance.ngDoBootstrap)throw new Be(403,!1);n.instance.ngDoBootstrap(a)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Be(404,!1);this._modules.slice().forEach(a=>a.destroy()),this._destroyListeners.forEach(a=>a());const n=this._injector.get(Yv,null);n&&(n.forEach(a=>a()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(n){return new(n||e)(Fe(gi))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})();function Nb(e,r){return Array.isArray(r)?r.reduce(Nb,e):{...e,...r}}let $d=(()=>{class e{constructor(n,a,u){this._zone=n,this._injector=a,this._exceptionHandler=u,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const d=new Kn(E=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{E.next(this._stable),E.complete()})}),m=new Kn(E=>{let C;this._zone.runOutsideAngular(()=>{C=this._zone.onStable.subscribe(()=>{Gn.assertNotInAngularZone(),Wv(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,E.next(!0))})})});const I=this._zone.onUnstable.subscribe(()=>{Gn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{E.next(!1)}))});return()=>{C.unsubscribe(),I.unsubscribe()}});this.isStable=Ww(d,m.pipe(Kw()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,a){const u=n instanceof Jg;if(!this._injector.get(Qv).done)throw!u&&function Qh(e){const r=On(e)||bo(e)||so(e);return null!==r&&r.standalone}(n),new Be(405,false);let m;m=u?n:this._injector.get(zg).resolveComponentFactory(n),this.componentTypes.push(m.componentType);const E=function s6(e){return e.isBoundToModule}(m)?void 0:this._injector.get(El),I=m.create(gi.NULL,[],a||m.selector,E),w=I.location.nativeElement,M=I.injector.get(Sb,null);return M?.registerApplication(w),I.onDestroy(()=>{this.detachView(I.hostView),LA(this.components,I),M?.unregisterApplication(w)}),this._loadComponent(I),I}tick(){if(this._runningTick)throw new Be(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const a=n;this._views.push(a),a.attachToAppRef(this)}detachView(n){const a=n;LA(this._views,a),a.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(AM,[]).concat(this._bootstrapListeners).forEach(u=>u(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>LA(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new Be(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return e.\u0275fac=function(n){return new(n||e)(Fe(Gn),Fe(Ks),Fe(cp))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function LA(e,r){const n=e.indexOf(r);n>-1&&e.splice(n,1)}let Jv=!0,ms=(()=>{class e{}return e.__NG_ELEMENT_ID__=xA,e})();function xA(e){return function l6(e,r,n){if(L_(e)&&!n){const a=qo(e.index,r);return new Fd(a,a)}return 47&e.type?new Fd(r[16],r):null}(qr(),ve(),16==(16&e))}class BM{constructor(){}supports(r){return cA(r)}create(r){return new FM(r)}}const xb=(e,r)=>r;class FM{constructor(r){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=r||xb}forEachItem(r){let n;for(n=this._itHead;null!==n;n=n._next)r(n)}forEachOperation(r){let n=this._itHead,a=this._removalsHead,u=0,d=null;for(;n||a;){const m=!a||n&&n.currentIndex<Bb(a,u,d)?n:a,E=Bb(m,u,d),C=m.currentIndex;if(m===a)u--,a=a._nextRemoved;else if(n=n._next,null==m.previousIndex)u++;else{d||(d=[]);const I=E-u,w=C-u;if(I!=w){for(let F=0;F<I;F++){const H=F<d.length?d[F]:d[F]=0,$=H+F;w<=$&&$<I&&(d[F]=H+1)}d[m.previousIndex]=w-I}}E!==C&&r(m,E,C)}}forEachPreviousItem(r){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)r(n)}forEachAddedItem(r){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)r(n)}forEachMovedItem(r){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)r(n)}forEachRemovedItem(r){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)r(n)}forEachIdentityChange(r){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)r(n)}diff(r){if(null==r&&(r=[]),!cA(r))throw new Be(900,!1);return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let u,d,m,n=this._itHead,a=!1;if(Array.isArray(r)){this.length=r.length;for(let E=0;E<this.length;E++)d=r[E],m=this._trackByFn(E,d),null!==n&&Object.is(n.trackById,m)?(a&&(n=this._verifyReinsertion(n,d,m,E)),Object.is(n.item,d)||this._addIdentityChange(n,d)):(n=this._mismatch(n,d,m,E),a=!0),n=n._next}else u=0,function SO(e,r){if(Array.isArray(e))for(let n=0;n<e.length;n++)r(e[n]);else{const n=e[Ud()]();let a;for(;!(a=n.next()).done;)r(a.value)}}(r,E=>{m=this._trackByFn(u,E),null!==n&&Object.is(n.trackById,m)?(a&&(n=this._verifyReinsertion(n,E,m,u)),Object.is(n.item,E)||this._addIdentityChange(n,E)):(n=this._mismatch(n,E,m,u),a=!0),n=n._next,u++}),this.length=u;return this._truncate(n),this.collection=r,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let r;for(r=this._previousItHead=this._itHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._additionsHead;null!==r;r=r._nextAdded)r.previousIndex=r.currentIndex;for(this._additionsHead=this._additionsTail=null,r=this._movesHead;null!==r;r=r._nextMoved)r.previousIndex=r.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(r,n,a,u){let d;return null===r?d=this._itTail:(d=r._prev,this._remove(r)),null!==(r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(a,null))?(Object.is(r.item,n)||this._addIdentityChange(r,n),this._reinsertAfter(r,d,u)):null!==(r=null===this._linkedRecords?null:this._linkedRecords.get(a,u))?(Object.is(r.item,n)||this._addIdentityChange(r,n),this._moveAfter(r,d,u)):r=this._addAfter(new UM(n,a),d,u),r}_verifyReinsertion(r,n,a,u){let d=null===this._unlinkedRecords?null:this._unlinkedRecords.get(a,null);return null!==d?r=this._reinsertAfter(d,r._prev,u):r.currentIndex!=u&&(r.currentIndex=u,this._addToMoves(r,u)),r}_truncate(r){for(;null!==r;){const n=r._next;this._addToRemovals(this._unlink(r)),r=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(r,n,a){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(r);const u=r._prevRemoved,d=r._nextRemoved;return null===u?this._removalsHead=d:u._nextRemoved=d,null===d?this._removalsTail=u:d._prevRemoved=u,this._insertAfter(r,n,a),this._addToMoves(r,a),r}_moveAfter(r,n,a){return this._unlink(r),this._insertAfter(r,n,a),this._addToMoves(r,a),r}_addAfter(r,n,a){return this._insertAfter(r,n,a),this._additionsTail=null===this._additionsTail?this._additionsHead=r:this._additionsTail._nextAdded=r,r}_insertAfter(r,n,a){const u=null===n?this._itHead:n._next;return r._next=u,r._prev=n,null===u?this._itTail=r:u._prev=r,null===n?this._itHead=r:n._next=r,null===this._linkedRecords&&(this._linkedRecords=new FA),this._linkedRecords.put(r),r.currentIndex=a,r}_remove(r){return this._addToRemovals(this._unlink(r))}_unlink(r){null!==this._linkedRecords&&this._linkedRecords.remove(r);const n=r._prev,a=r._next;return null===n?this._itHead=a:n._next=a,null===a?this._itTail=n:a._prev=n,r}_addToMoves(r,n){return r.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=r:this._movesTail._nextMoved=r),r}_addToRemovals(r){return null===this._unlinkedRecords&&(this._unlinkedRecords=new FA),this._unlinkedRecords.put(r),r.currentIndex=null,r._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=r,r._prevRemoved=null):(r._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=r),r}_addIdentityChange(r,n){return r.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=r:this._identityChangesTail._nextIdentityChange=r,r}}class UM{constructor(r,n){this.item=r,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class VM{constructor(){this._head=null,this._tail=null}add(r){null===this._head?(this._head=this._tail=r,r._nextDup=null,r._prevDup=null):(this._tail._nextDup=r,r._prevDup=this._tail,r._nextDup=null,this._tail=r)}get(r,n){let a;for(a=this._head;null!==a;a=a._nextDup)if((null===n||n<=a.currentIndex)&&Object.is(a.trackById,r))return a;return null}remove(r){const n=r._prevDup,a=r._nextDup;return null===n?this._head=a:n._nextDup=a,null===a?this._tail=n:a._prevDup=n,null===this._head}}class FA{constructor(){this.map=new Map}put(r){const n=r.trackById;let a=this.map.get(n);a||(a=new VM,this.map.set(n,a)),a.add(r)}get(r,n){const u=this.map.get(r);return u?u.get(r,n):null}remove(r){const n=r.trackById;return this.map.get(n).remove(r)&&this.map.delete(n),r}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Bb(e,r,n){const a=e.previousIndex;if(null===a)return a;let u=0;return n&&a<n.length&&(u=n[a]),a+r+u}class Fb{constructor(){}supports(r){return r instanceof Map||rS(r)}create(){return new f6}}class f6{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(r){let n;for(n=this._mapHead;null!==n;n=n._next)r(n)}forEachPreviousItem(r){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)r(n)}forEachChangedItem(r){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)r(n)}forEachAddedItem(r){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)r(n)}forEachRemovedItem(r){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)r(n)}diff(r){if(r){if(!(r instanceof Map||rS(r)))throw new Be(900,!1)}else r=new Map;return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(r,(a,u)=>{if(n&&n.key===u)this._maybeAddToChanges(n,a),this._appendAfter=n,n=n._next;else{const d=this._getOrCreateRecordForKey(u,a);n=this._insertBeforeOrAppend(n,d)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let a=n;null!==a;a=a._nextRemoved)a===this._mapHead&&(this._mapHead=null),this._records.delete(a.key),a._nextRemoved=a._next,a.previousValue=a.currentValue,a.currentValue=null,a._prev=null,a._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(r,n){if(r){const a=r._prev;return n._next=r,n._prev=a,r._prev=n,a&&(a._next=n),r===this._mapHead&&(this._mapHead=n),this._appendAfter=r,r}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(r,n){if(this._records.has(r)){const u=this._records.get(r);this._maybeAddToChanges(u,n);const d=u._prev,m=u._next;return d&&(d._next=m),m&&(m._prev=d),u._next=null,u._prev=null,u}const a=new Ub(r);return this._records.set(r,a),a.currentValue=n,this._addToAdditions(a),a}_reset(){if(this.isDirty){let r;for(this._previousMapHead=this._mapHead,r=this._previousMapHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._changesHead;null!==r;r=r._nextChanged)r.previousValue=r.currentValue;for(r=this._additionsHead;null!=r;r=r._nextAdded)r.previousValue=r.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(r,n){Object.is(n,r.currentValue)||(r.previousValue=r.currentValue,r.currentValue=n,this._addToChanges(r))}_addToAdditions(r){null===this._additionsHead?this._additionsHead=this._additionsTail=r:(this._additionsTail._nextAdded=r,this._additionsTail=r)}_addToChanges(r){null===this._changesHead?this._changesHead=this._changesTail=r:(this._changesTail._nextChanged=r,this._changesTail=r)}_forEach(r,n){r instanceof Map?r.forEach(n):Object.keys(r).forEach(a=>n(r[a],a))}}class Ub{constructor(r){this.key=r,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Vb(){return new e1([new BM])}let e1=(()=>{class e{constructor(n){this.factories=n}static create(n,a){if(null!=a){const u=a.factories.slice();n=n.concat(u)}return new e(n)}static extend(n){return{provide:e,useFactory:a=>e.create(n,a||Vb()),deps:[[e,new kg,new Mg]]}}find(n){const a=this.factories.find(u=>u.supports(n));if(null!=a)return a;throw new Be(901,!1)}}return e.\u0275prov=ot({token:e,providedIn:"root",factory:Vb}),e})();function jM(){return new UA([new Fb])}let UA=(()=>{class e{constructor(n){this.factories=n}static create(n,a){if(a){const u=a.factories.slice();n=n.concat(u)}return new e(n)}static extend(n){return{provide:e,useFactory:a=>e.create(n,a||jM()),deps:[[e,new kg,new Mg]]}}find(n){const a=this.factories.find(u=>u.supports(n));if(a)return a;throw new Be(901,!1)}}return e.\u0275prov=ot({token:e,providedIn:"root",factory:jM}),e})();const HM=qv(null,"core",[]);let WM=(()=>{class e{constructor(n){}}return e.\u0275fac=function(n){return new(n||e)(Fe($d))},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({}),e})();function Gb(e,r){const n=On(e),a=r.elementInjector||Yg();return new sA(n).create(a,r.projectableNodes,r.hostElement,r.environmentInjector)}let Qp=null;function Xo(){return Qp}const Br=new Et("DocumentToken");let Hb=(()=>{class e{historyGo(n){throw new Error("Not implemented")}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=ot({token:e,factory:function(){return function C6(){return Fe(t1)}()},providedIn:"platform"}),e})();const KM=new Et("Location Initialized");let t1=(()=>{class e extends Hb{constructor(n){super(),this._doc=n,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Xo().getBaseHref(this._doc)}onPopState(n){const a=Xo().getGlobalEventTarget(this._doc,"window");return a.addEventListener("popstate",n,!1),()=>a.removeEventListener("popstate",n)}onHashChange(n){const a=Xo().getGlobalEventTarget(this._doc,"window");return a.addEventListener("hashchange",n,!1),()=>a.removeEventListener("hashchange",n)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(n){this.location.pathname=n}pushState(n,a,u){YM()?this._history.pushState(n,a,u):this.location.hash=u}replaceState(n,a,u){YM()?this._history.replaceState(n,a,u):this.location.hash=u}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return e.\u0275fac=function(n){return new(n||e)(Fe(Br))},e.\u0275prov=ot({token:e,factory:function(){return function y6(){return new t1(Fe(Br))}()},providedIn:"platform"}),e})();function YM(){return!!window.history.pushState}function n1(e,r){if(0==e.length)return r;if(0==r.length)return e;let n=0;return e.endsWith("/")&&n++,r.startsWith("/")&&n++,2==n?e+r.substring(1):1==n?e+r:e+"/"+r}function r1(e){const r=e.match(/#|\?|$/),n=r&&r.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function bu(e){return e&&"?"!==e[0]?"?"+e:e}let Tu=(()=>{class e{historyGo(n){throw new Error("Not implemented")}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=ot({token:e,factory:function(){return Zr(JM)},providedIn:"root"}),e})();const qM=new Et("appBaseHref");let JM=(()=>{class e extends Tu{constructor(n,a){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=a??this._platformLocation.getBaseHrefFromDOM()??Zr(Br).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return n1(this._baseHref,n)}path(n=!1){const a=this._platformLocation.pathname+bu(this._platformLocation.search),u=this._platformLocation.hash;return u&&n?`${a}${u}`:a}pushState(n,a,u,d){const m=this.prepareExternalUrl(u+bu(d));this._platformLocation.pushState(n,a,m)}replaceState(n,a,u,d){const m=this.prepareExternalUrl(u+bu(d));this._platformLocation.replaceState(n,a,m)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return e.\u0275fac=function(n){return new(n||e)(Fe(Hb),Fe(qM,8))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),i1=(()=>{class e extends Tu{constructor(n,a){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=a&&(this._baseHref=a)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let a=this._platformLocation.hash;return null==a&&(a="#"),a.length>0?a.substring(1):a}prepareExternalUrl(n){const a=n1(this._baseHref,n);return a.length>0?"#"+a:a}pushState(n,a,u,d){let m=this.prepareExternalUrl(u+bu(d));0==m.length&&(m=this._platformLocation.pathname),this._platformLocation.pushState(n,a,m)}replaceState(n,a,u,d){let m=this.prepareExternalUrl(u+bu(d));0==m.length&&(m=this._platformLocation.pathname),this._platformLocation.replaceState(n,a,m)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return e.\u0275fac=function(n){return new(n||e)(Fe(Hb),Fe(qM,8))},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})(),o1=(()=>{class e{constructor(n){this._subject=new Ft,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const a=this._locationStrategy.getBaseHref();this._baseHref=r1(Wb(a)),this._locationStrategy.onPopState(u=>{this._subject.emit({url:this.path(!0),pop:!0,state:u.state,type:u.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,a=""){return this.path()==this.normalize(n+bu(a))}normalize(n){return e.stripTrailingSlash(function yc(e,r){return e&&r.startsWith(e)?r.substring(e.length):r}(this._baseHref,Wb(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,a="",u=null){this._locationStrategy.pushState(u,"",n,a),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+bu(a)),u)}replaceState(n,a="",u=null){this._locationStrategy.replaceState(u,"",n,a),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+bu(a)),u)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(a=>{this._notifyUrlChangeListeners(a.url,a.state)})),()=>{const a=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(a,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",a){this._urlChangeListeners.forEach(u=>u(n,a))}subscribe(n,a,u){return this._subject.subscribe({next:n,error:a,complete:u})}}return e.normalizeQueryParams=bu,e.joinWithSlash=n1,e.stripTrailingSlash=r1,e.\u0275fac=function(n){return new(n||e)(Fe(Tu))},e.\u0275prov=ot({token:e,factory:function(){return function I6(){return new o1(Fe(Tu))}()},providedIn:"root"}),e})();function Wb(e){return e.replace(/\/index.html$/,"")}function A1(e,r){r=encodeURIComponent(r);for(const n of e.split(";")){const a=n.indexOf("="),[u,d]=-1==a?[n,""]:[n.slice(0,a),n.slice(a+1)];if(u.trim()===r)return decodeURIComponent(d)}return null}let m1=(()=>{class e{constructor(n,a,u,d){this._iterableDiffers=n,this._keyValueDiffers=a,this._ngEl=u,this._renderer=d,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(n){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof n?n.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(n){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof n?n.split(/\s+/):n,this._rawClass&&(cA(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const n=this._iterableDiffer.diff(this._rawClass);n&&this._applyIterableChanges(n)}else if(this._keyValueDiffer){const n=this._keyValueDiffer.diff(this._rawClass);n&&this._applyKeyValueChanges(n)}}_applyKeyValueChanges(n){n.forEachAddedItem(a=>this._toggleClass(a.key,a.currentValue)),n.forEachChangedItem(a=>this._toggleClass(a.key,a.currentValue)),n.forEachRemovedItem(a=>{a.previousValue&&this._toggleClass(a.key,!1)})}_applyIterableChanges(n){n.forEachAddedItem(a=>{if("string"!=typeof a.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${er(a.item)}`);this._toggleClass(a.item,!0)}),n.forEachRemovedItem(a=>this._toggleClass(a.item,!1))}_applyClasses(n){n&&(Array.isArray(n)||n instanceof Set?n.forEach(a=>this._toggleClass(a,!0)):Object.keys(n).forEach(a=>this._toggleClass(a,!!n[a])))}_removeClasses(n){n&&(Array.isArray(n)||n instanceof Set?n.forEach(a=>this._toggleClass(a,!1)):Object.keys(n).forEach(a=>this._toggleClass(a,!1)))}_toggleClass(n,a){(n=n.trim())&&n.split(/\s+/g).forEach(u=>{a?this._renderer.addClass(this._ngEl.nativeElement,u):this._renderer.removeClass(this._ngEl.nativeElement,u)})}}return e.\u0275fac=function(n){return new(n||e)(se(e1),se(UA),se(Qn),se(gs))},e.\u0275dir=We({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),e})();class F6{constructor(r,n,a,u){this.$implicit=r,this.ngForOf=n,this.index=a,this.count=u}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let zp=(()=>{class e{constructor(n,a,u){this._viewContainer=n,this._template=a,this._differs=u,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const a=this._viewContainer;n.forEachOperation((u,d,m)=>{if(null==u.previousIndex)a.createEmbeddedView(this._template,new F6(u.item,this._ngForOf,-1,-1),null===m?void 0:m);else if(null==m)a.remove(null===d?void 0:d);else if(null!==d){const E=a.get(d);a.move(E,m),$b(E,u)}});for(let u=0,d=a.length;u<d;u++){const E=a.get(u).context;E.index=u,E.count=d,E.ngForOf=this._ngForOf}n.forEachIdentityChange(u=>{$b(a.get(u.currentIndex),u)})}static ngTemplateContextGuard(n,a){return!0}}return e.\u0275fac=function(n){return new(n||e)(se(As),se(gr),se(e1))},e.\u0275dir=We({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),e})();function $b(e,r){e.context.$implicit=r.item}let Sl=(()=>{class e{constructor(n,a){this._viewContainer=n,this._context=new U6,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=a}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){E1("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){E1("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,a){return!0}}return e.\u0275fac=function(n){return new(n||e)(se(As),se(gr))},e.\u0275dir=We({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),e})();class U6{constructor(){this.$implicit=null,this.ngIf=null}}function E1(e,r){if(r&&!r.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${er(r)}'.`)}let Du=(()=>{class e{constructor(n){this._viewContainerRef=n,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(n){if(n.ngTemplateOutlet||n.ngTemplateOutletInjector){const a=this._viewContainerRef;if(this._viewRef&&a.remove(a.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:u,ngTemplateOutletContext:d,ngTemplateOutletInjector:m}=this;this._viewRef=a.createEmbeddedView(u,d,m?{injector:m}:void 0)}else this._viewRef=null}else this._viewRef&&n.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return e.\u0275fac=function(n){return new(n||e)(se(As))},e.\u0275dir=We({type:e,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Fi]}),e})(),vs=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({}),e})();let bk=(()=>{class e{}return e.\u0275prov=ot({token:e,providedIn:"root",factory:()=>new Y6(Fe(Br),window)}),e})();class Y6{constructor(r,n){this.document=r,this.window=n,this.offset=()=>[0,0]}setOffset(r){this.offset=Array.isArray(r)?()=>r:r}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(r){this.supportsScrolling()&&this.window.scrollTo(r[0],r[1])}scrollToAnchor(r){if(!this.supportsScrolling())return;const n=function q6(e,r){const n=e.getElementById(r)||e.getElementsByName(r)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow)){const a=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let u=a.currentNode;for(;u;){const d=u.shadowRoot;if(d){const m=d.getElementById(r)||d.querySelector(`[name="${r}"]`);if(m)return m}u=a.nextNode()}}return null}(this.document,r);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(r){if(this.supportScrollRestoration()){const n=this.window.history;n&&n.scrollRestoration&&(n.scrollRestoration=r)}}scrollToElement(r){const n=r.getBoundingClientRect(),a=n.left+this.window.pageXOffset,u=n.top+this.window.pageYOffset,d=this.offset();this.window.scrollTo(a-d[0],u-d[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const r=ZA(this.window.history)||ZA(Object.getPrototypeOf(this.window.history));return!(!r||!r.writable&&!r.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function ZA(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}class sT{}class R1 extends class Cs extends class v6{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function E6(e){Qp||(Qp=e)}(new R1)}onAndCancel(r,n,a){return r.addEventListener(n,a,!1),()=>{r.removeEventListener(n,a,!1)}}dispatchEvent(r,n){r.dispatchEvent(n)}remove(r){r.parentNode&&r.parentNode.removeChild(r)}createElement(r,n){return(n=n||this.getDefaultDocument()).createElement(r)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(r){return r.nodeType===Node.ELEMENT_NODE}isShadowRoot(r){return r instanceof DocumentFragment}getGlobalEventTarget(r,n){return"window"===n?window:"document"===n?r:"body"===n?r.body:null}getBaseHref(r){const n=function sj(){return $p=$p||document.querySelector("base"),$p?$p.getAttribute("href"):null}();return null==n?null:function fT(e){Ua=Ua||document.createElement("a"),Ua.setAttribute("href",e);const r=Ua.pathname;return"/"===r.charAt(0)?r:`/${r}`}(n)}resetBaseElement(){$p=null}getUserAgent(){return window.navigator.userAgent}getCookie(r){return A1(document.cookie,r)}}let Ua,$p=null;const gT=new Et("TRANSITION_ID"),aj=[{provide:PA,useFactory:function Bk(e,r,n){return()=>{n.get(Qv).donePromise.then(()=>{const a=Xo(),u=r.querySelectorAll(`style[ng-transition="${e}"]`);for(let d=0;d<u.length;d++)a.remove(u[d])})}},deps:[gT,Br,gi],multi:!0}];let Uk=(()=>{class e{build(){return new XMLHttpRequest}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})();const nh=new Et("EventManagerPlugins");let D1=(()=>{class e{constructor(n,a){this._zone=a,this._eventNameToPlugin=new Map,n.forEach(u=>u.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,a,u){return this._findPluginFor(a).addEventListener(n,a,u)}addGlobalEventListener(n,a,u){return this._findPluginFor(a).addGlobalEventListener(n,a,u)}getZone(){return this._zone}_findPluginFor(n){const a=this._eventNameToPlugin.get(n);if(a)return a;const u=this._plugins;for(let d=0;d<u.length;d++){const m=u[d];if(m.supports(n))return this._eventNameToPlugin.set(n,m),m}throw new Error(`No event manager plugin found for event ${n}`)}}return e.\u0275fac=function(n){return new(n||e)(Fe(nh),Fe(Gn))},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})();class AT{constructor(r){this._doc=r}addGlobalEventListener(r,n,a){const u=Xo().getGlobalEventTarget(this._doc,r);if(!u)throw new Error(`Unsupported event target ${u} for event ${n}`);return this.addEventListener(u,n,a)}}let rh=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(n){const a=new Set;n.forEach(u=>{this._stylesSet.has(u)||(this._stylesSet.add(u),a.add(u))}),this.onStylesAdded(a)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})(),Sc=(()=>{class e extends rh{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,a,u){n.forEach(d=>{const m=this._doc.createElement("style");m.textContent=d,u.push(a.appendChild(m))})}addHost(n){const a=[];this._addStylesToHost(this._stylesSet,n,a),this._hostNodes.set(n,a)}removeHost(n){const a=this._hostNodes.get(n);a&&a.forEach(Vk),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((a,u)=>{this._addStylesToHost(n,u,a)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(Vk))}}return e.\u0275fac=function(n){return new(n||e)(Fe(Br))},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})();function Vk(e){Xo().remove(e)}const mT={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Rl=/%COMP%/g;function Xi(e,r,n){for(let a=0;a<r.length;a++){let u=r[a];Array.isArray(u)?Xi(e,u,n):(u=u.replace(Rl,e),n.push(u))}return n}function es(e){return r=>{if("__ngUnwrap__"===r)return e;!1===e(r)&&(r.preventDefault(),r.returnValue=!1)}}let En=(()=>{class e{constructor(n,a,u){this.eventManager=n,this.sharedStylesHost=a,this.appId=u,this.rendererByCompId=new Map,this.defaultRenderer=new Xp(n)}createRenderer(n,a){if(!n||!a)return this.defaultRenderer;switch(a.encapsulation){case Ea.Emulated:{let u=this.rendererByCompId.get(a.id);return u||(u=new _T(this.eventManager,this.sharedStylesHost,a,this.appId),this.rendererByCompId.set(a.id,u)),u.applyToHost(n),u}case 1:case Ea.ShadowDom:return new Va(this.eventManager,this.sharedStylesHost,n,a);default:if(!this.rendererByCompId.has(a.id)){const u=Xi(a.id,a.styles,[]);this.sharedStylesHost.addStyles(u),this.rendererByCompId.set(a.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(n){return new(n||e)(Fe(D1),Fe(Sc),Fe(MA))},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})();class Xp{constructor(r){this.eventManager=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(r,n){return n?document.createElementNS(mT[n]||n,r):document.createElement(r)}createComment(r){return document.createComment(r)}createText(r){return document.createTextNode(r)}appendChild(r,n){(ur(r)?r.content:r).appendChild(n)}insertBefore(r,n,a){r&&(ur(r)?r.content:r).insertBefore(n,a)}removeChild(r,n){r&&r.removeChild(n)}selectRootElement(r,n){let a="string"==typeof r?document.querySelector(r):r;if(!a)throw new Error(`The selector "${r}" did not match any elements`);return n||(a.textContent=""),a}parentNode(r){return r.parentNode}nextSibling(r){return r.nextSibling}setAttribute(r,n,a,u){if(u){n=u+":"+n;const d=mT[u];d?r.setAttributeNS(d,n,a):r.setAttribute(n,a)}else r.setAttribute(n,a)}removeAttribute(r,n,a){if(a){const u=mT[a];u?r.removeAttributeNS(u,n):r.removeAttribute(`${a}:${n}`)}else r.removeAttribute(n)}addClass(r,n){r.classList.add(n)}removeClass(r,n){r.classList.remove(n)}setStyle(r,n,a,u){u&(Jo.DashCase|Jo.Important)?r.style.setProperty(n,a,u&Jo.Important?"important":""):r.style[n]=a}removeStyle(r,n,a){a&Jo.DashCase?r.style.removeProperty(n):r.style[n]=""}setProperty(r,n,a){r[n]=a}setValue(r,n){r.nodeValue=n}listen(r,n,a){return"string"==typeof r?this.eventManager.addGlobalEventListener(r,n,es(a)):this.eventManager.addEventListener(r,n,es(a))}}function ur(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class _T extends Xp{constructor(r,n,a,u){super(r),this.component=a;const d=Xi(u+"-"+a.id,a.styles,[]);n.addStyles(d),this.contentAttr=function w1(e){return"_ngcontent-%COMP%".replace(Rl,e)}(u+"-"+a.id),this.hostAttr=function uj(e){return"_nghost-%COMP%".replace(Rl,e)}(u+"-"+a.id)}applyToHost(r){super.setAttribute(r,this.hostAttr,"")}createElement(r,n){const a=super.createElement(r,n);return super.setAttribute(a,this.contentAttr,""),a}}class Va extends Xp{constructor(r,n,a,u){super(r),this.sharedStylesHost=n,this.hostEl=a,this.shadowRoot=a.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const d=Xi(u.id,u.styles,[]);for(let m=0;m<d.length;m++){const E=document.createElement("style");E.textContent=d[m],this.shadowRoot.appendChild(E)}}nodeOrShadowRoot(r){return r===this.hostEl?this.shadowRoot:r}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(r,n){return super.appendChild(this.nodeOrShadowRoot(r),n)}insertBefore(r,n,a){return super.insertBefore(this.nodeOrShadowRoot(r),n,a)}removeChild(r,n){return super.removeChild(this.nodeOrShadowRoot(r),n)}parentNode(r){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(r)))}}let ET=(()=>{class e extends AT{constructor(n){super(n)}supports(n){return!0}addEventListener(n,a,u){return n.addEventListener(a,u,!1),()=>this.removeEventListener(n,a,u)}removeEventListener(n,a,u){return n.removeEventListener(a,u)}}return e.\u0275fac=function(n){return new(n||e)(Fe(Br))},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})();const vT=["alt","control","meta","shift"],ys={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},N1={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let rm=(()=>{class e extends AT{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,a,u){const d=e.parseEventName(a),m=e.eventCallback(d.fullKey,u,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Xo().onAndCancel(n,d.domEventName,m))}static parseEventName(n){const a=n.toLowerCase().split("."),u=a.shift();if(0===a.length||"keydown"!==u&&"keyup"!==u)return null;const d=e._normalizeKey(a.pop());let m="",E=a.indexOf("code");if(E>-1&&(a.splice(E,1),m="code."),vT.forEach(I=>{const w=a.indexOf(I);w>-1&&(a.splice(w,1),m+=I+".")}),m+=d,0!=a.length||0===d.length)return null;const C={};return C.domEventName=u,C.fullKey=m,C}static matchEventFullKeyCode(n,a){let u=ys[n.key]||n.key,d="";return a.indexOf("code.")>-1&&(u=n.code,d="code."),!(null==u||!u)&&(u=u.toLowerCase()," "===u?u="space":"."===u&&(u="dot"),vT.forEach(m=>{m!==u&&(0,N1[m])(n)&&(d+=m+".")}),d+=u,d===a)}static eventCallback(n,a,u){return d=>{e.matchEventFullKeyCode(d,n)&&u.runGuarded(()=>a(d))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return e.\u0275fac=function(n){return new(n||e)(Fe(Br))},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})();const O1=qv(HM,"browser",[{provide:Hv,useValue:"browser"},{provide:gM,useValue:function ST(){R1.makeCurrent()},multi:!0},{provide:Br,useFactory:function Kk(){return function q4(e){du=e}(document),document},deps:[]}]),im=new Et(""),TT=[{provide:Vp,useClass:class Fk{addToWindow(r){Yn.getAngularTestability=(a,u=!0)=>{const d=r.findTestabilityInTree(a,u);if(null==d)throw new Error("Could not find testability for element.");return d},Yn.getAllAngularTestabilities=()=>r.getAllTestabilities(),Yn.getAllAngularRootElements=()=>r.getAllRootElements(),Yn.frameworkStabilizers||(Yn.frameworkStabilizers=[]),Yn.frameworkStabilizers.push(a=>{const u=Yn.getAllAngularTestabilities();let d=u.length,m=!1;const E=function(C){m=m||C,d--,0==d&&a(m)};u.forEach(function(C){C.whenStable(E)})})}findTestabilityInTree(r,n,a){return null==n?null:r.getTestability(n)??(a?Xo().isShadowRoot(n)?this.findTestabilityInTree(r,n.host,!0):this.findTestabilityInTree(r,n.parentElement,!0):null)}},deps:[]},{provide:Sb,useClass:bb,deps:[Gn,Tb,Vp]},{provide:bb,useClass:bb,deps:[Gn,Tb,Vp]}],P1=[{provide:sp,useValue:"root"},{provide:cp,useFactory:function Wk(){return new cp},deps:[]},{provide:nh,useClass:ET,multi:!0,deps:[Br,Gn,Hv]},{provide:nh,useClass:rm,multi:!0,deps:[Br]},{provide:En,useClass:En,deps:[D1,Sc,MA]},{provide:SE,useExisting:En},{provide:rh,useExisting:Sc},{provide:Sc,useClass:Sc,deps:[Br]},{provide:D1,useClass:D1,deps:[nh,Gn]},{provide:sT,useClass:Uk,deps:[]},[]];let M1=(()=>{class e{constructor(n){}static withServerTransition(n){return{ngModule:e,providers:[{provide:MA,useValue:n.appId},{provide:gT,useExisting:MA},aj]}}}return e.\u0275fac=function(n){return new(n||e)(Fe(im,12))},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({providers:[...P1,...TT],imports:[vs,WM]}),e})(),vn=(()=>{class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}}return e.\u0275fac=function(n){return new(n||e)(Fe(Br))},e.\u0275prov=ot({token:e,factory:function(n){let a=null;return a=n?new n:function Re(){return new vn(Fe(Br))}(),a},providedIn:"root"}),e})();function ct(...e){return pi(e,dg(e))}typeof window<"u"&&window;class ji extends Or{constructor(r){super(),this._value=r}get value(){return this.getValue()}_subscribe(r){const n=super._subscribe(r);return!n.closed&&r.next(this._value),n}getValue(){const{hasError:r,thrownError:n,_value:a}=this;if(r)throw n;return this._throwIfClosed(),a}next(r){super.next(this._value=r)}}const B1=Go(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:hj}=Array,{getPrototypeOf:F1,prototype:Xk,keys:pj}=Object;function Zk(e){if(1===e.length){const r=e[0];if(hj(r))return{args:r,keys:null};if(function fj(e){return e&&"object"==typeof e&&F1(e)===Xk}(r)){const n=pj(r);return{args:n.map(a=>r[a]),keys:n}}}return{args:e,keys:null}}const{isArray:gj}=Array;function U1(e){return Ot(r=>function NT(e,r){return gj(r)?e(...r):e(r)}(e,r))}function eL(e,r){return e.reduce((n,a,u)=>(n[a]=r[u],n),{})}function ef(...e){const r=dg(e),n=lg(e),{args:a,keys:u}=Zk(e);if(0===a.length)return pi([],r);const d=new Kn(function Aj(e,r,n=Jc){return a=>{tL(r,()=>{const{length:u}=e,d=new Array(u);let m=u,E=u;for(let C=0;C<u;C++)tL(r,()=>{const I=pi(e[C],r);let w=!1;I.subscribe(tn(a,M=>{d[C]=M,w||(w=!0,E--),E||a.next(n(d.slice()))},()=>{--m||a.complete()}))},a)},a)}}(a,r,u?m=>eL(u,m):Jc));return n?d.pipe(U1(n)):d}function tL(e,r,n){e?$c(n,e,r):r()}function tf(...e){return function nL(){return Fh(1)}()(pi(e,dg(e)))}function rL(e){return new Kn(r=>{Wi(e()).subscribe(r)})}function um(e,r){const n=U(e)?e:()=>e,a=u=>u.error(n());return new Kn(r?u=>r.schedule(a,0,u):a)}function V1(){return Wr((e,r)=>{let n=null;e._refCount++;const a=tn(r,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(n=null);const u=e._connection,d=n;n=null,u&&(!d||u===d)&&u.unsubscribe(),r.unsubscribe()});e.subscribe(a),a.closed||(n=e.connect())})}class iL extends Kn{constructor(r,n){super(),this.source=r,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Er(r)&&(this.lift=r.lift)}_subscribe(r){return this.getSubject().subscribe(r)}getSubject(){const r=this._subject;return(!r||r.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:r}=this;this._subject=this._connection=null,r?.unsubscribe()}connect(){let r=this._connection;if(!r){r=this._connection=new Hr;const n=this.getSubject();r.add(this.source.subscribe(tn(n,void 0,()=>{this._teardown(),n.complete()},a=>{this._teardown(),n.error(a)},()=>this._teardown()))),r.closed&&(this._connection=null,r=Hr.EMPTY)}return r}refCount(){return V1()(this)}}function ta(e,r){return Wr((n,a)=>{let u=null,d=0,m=!1;const E=()=>m&&!u&&a.complete();n.subscribe(tn(a,C=>{u?.unsubscribe();let I=0;const w=d++;Wi(e(C,w)).subscribe(u=tn(a,M=>a.next(r?r(C,M,w,I++):M),()=>{u=null,E()}))},()=>{m=!0,E()}))})}function Ni(e){return e<=0?()=>_a:Wr((r,n)=>{let a=0;r.subscribe(tn(n,u=>{++a<=e&&(n.next(u),e<=a&&n.complete())}))})}function mi(e,r){return Wr((n,a)=>{let u=0;n.subscribe(tn(a,d=>e.call(r,d,u++)&&a.next(d)))})}function Q1(e){return Wr((r,n)=>{let a=!1;r.subscribe(tn(n,u=>{a=!0,n.next(u)},()=>{a||n.next(e),n.complete()}))})}function OT(e=PT){return Wr((r,n)=>{let a=!1;r.subscribe(tn(n,u=>{a=!0,n.next(u)},()=>a?n.complete():n.error(e())))})}function PT(){return new B1}function Dl(e,r){const n=arguments.length>=2;return a=>a.pipe(e?mi((u,d)=>e(u,d,a)):Jc,Ni(1),n?Q1(r):OT(()=>new B1))}function wl(e,r){return U(r)?di(e,r,1):di(e,1)}function _i(e,r,n){const a=U(e)||r||n?{next:e,error:r,complete:n}:e;return a?Wr((u,d)=>{var m;null===(m=a.subscribe)||void 0===m||m.call(a);let E=!0;u.subscribe(tn(d,C=>{var I;null===(I=a.next)||void 0===I||I.call(a,C),d.next(C)},()=>{var C;E=!1,null===(C=a.complete)||void 0===C||C.call(a),d.complete()},C=>{var I;E=!1,null===(I=a.error)||void 0===I||I.call(a,C),d.error(C)},()=>{var C,I;E&&(null===(C=a.unsubscribe)||void 0===C||C.call(a)),null===(I=a.finalize)||void 0===I||I.call(a)}))}):Jc}function Nl(e){return Wr((r,n)=>{let d,a=null,u=!1;a=r.subscribe(tn(n,void 0,void 0,m=>{d=Wi(e(m,Nl(e)(r))),a?(a.unsubscribe(),a=null,d.subscribe(n)):u=!0})),u&&(a.unsubscribe(),a=null,d.subscribe(n))})}function oL(e,r,n,a,u){return(d,m)=>{let E=n,C=r,I=0;d.subscribe(tn(m,w=>{const M=I++;C=E?e(C,w,M):(E=!0,w),a&&m.next(C)},u&&(()=>{E&&m.next(C),m.complete()})))}}function MT(e,r){return Wr(oL(e,r,arguments.length>=2,!0))}function bc(e){return e<=0?()=>_a:Wr((r,n)=>{let a=[];r.subscribe(tn(n,u=>{a.push(u),e<a.length&&a.shift()},()=>{for(const u of a)n.next(u);n.complete()},void 0,()=>{a=null}))})}function kT(e,r){const n=arguments.length>=2;return a=>a.pipe(e?mi((u,d)=>e(u,d,a)):Jc,bc(1),n?Q1(r):OT(()=>new B1))}function sL(e){return Ot(()=>e)}function LT(e){return Wr((r,n)=>{try{r.subscribe(n)}finally{n.add(e)}})}const rn="primary",nf=Symbol("RouteTitle");class _j{constructor(r){this.params=r||{}}has(r){return Object.prototype.hasOwnProperty.call(this.params,r)}get(r){if(this.has(r)){const n=this.params[r];return Array.isArray(n)?n[0]:n}return null}getAll(r){if(this.has(r)){const n=this.params[r];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function rf(e){return new _j(e)}function Ej(e,r,n){const a=n.path.split("/");if(a.length>e.length||"full"===n.pathMatch&&(r.hasChildren()||a.length<e.length))return null;const u={};for(let d=0;d<a.length;d++){const m=a[d],E=e[d];if(m.startsWith(":"))u[m.substring(1)]=E;else if(m!==E.path)return null}return{consumed:e.slice(0,a.length),posParams:u}}function na(e,r){const n=e?Object.keys(e):void 0,a=r?Object.keys(r):void 0;if(!n||!a||n.length!=a.length)return!1;let u;for(let d=0;d<n.length;d++)if(u=n[d],!sf(e[u],r[u]))return!1;return!0}function sf(e,r){if(Array.isArray(e)&&Array.isArray(r)){if(e.length!==r.length)return!1;const n=[...e].sort(),a=[...r].sort();return n.every((u,d)=>a[d]===u)}return e===r}function si(e){return Array.prototype.concat.apply([],e)}function on(e){return e.length>0?e[e.length-1]:null}function ln(e,r){for(const n in e)e.hasOwnProperty(n)&&r(e[n],n)}function fo(e){return lA(e)?e:_u(e)?pi(Promise.resolve(e)):ct(e)}const Cn={exact:function UT(e,r,n){if(!Nu(e.segments,r.segments)||!H1(e.segments,r.segments,n)||e.numberOfChildren!==r.numberOfChildren)return!1;for(const a in r.children)if(!e.children[a]||!UT(e.children[a],r.children[a],n))return!1;return!0},subset:Ei},FT={exact:function vj(e,r){return na(e,r)},subset:function dn(e,r){return Object.keys(r).length<=Object.keys(e).length&&Object.keys(r).every(n=>sf(e[n],r[n]))},ignored:()=>!0};function cL(e,r,n){return Cn[n.paths](e.root,r.root,n.matrixParams)&&FT[n.queryParams](e.queryParams,r.queryParams)&&!("exact"===n.fragment&&e.fragment!==r.fragment)}function Ei(e,r,n){return G1(e,r,r.segments,n)}function G1(e,r,n,a){if(e.segments.length>n.length){const u=e.segments.slice(0,n.length);return!(!Nu(u,n)||r.hasChildren()||!H1(u,n,a))}if(e.segments.length===n.length){if(!Nu(e.segments,n)||!H1(e.segments,n,a))return!1;for(const u in r.children)if(!e.children[u]||!Ei(e.children[u],r.children[u],a))return!1;return!0}{const u=n.slice(0,e.segments.length),d=n.slice(e.segments.length);return!!(Nu(e.segments,u)&&H1(e.segments,u,a)&&e.children[rn])&&G1(e.children[rn],r,d,a)}}function H1(e,r,n){return r.every((a,u)=>FT[n](e[u].parameters,a.parameters))}class ih{constructor(r,n,a){this.root=r,this.queryParams=n,this.fragment=a}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=rf(this.queryParams)),this._queryParamMap}toString(){return Pu.serialize(this)}}class gt{constructor(r,n){this.segments=r,this.children=n,this.parent=null,ln(n,(a,u)=>a.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Mu(this)}}class gn{constructor(r,n){this.path=r,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=rf(this.parameters)),this._parameterMap}toString(){return Qi(this)}}function Nu(e,r){return e.length===r.length&&e.every((n,a)=>n.path===r[a].path)}let Ve=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=ot({token:e,factory:function(){return new Ou},providedIn:"root"}),e})();class Ou{parse(r){const n=new Cj(r);return new ih(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(r){const n=`/${ku(r.root,!0)}`,a=function Me(e){const r=Object.keys(e).map(n=>{const a=e[n];return Array.isArray(a)?a.map(u=>`${Fr(n)}=${Fr(u)}`).join("&"):`${Fr(n)}=${Fr(a)}`}).filter(n=>!!n);return r.length?`?${r.join("&")}`:""}(r.queryParams);return`${n}${a}${"string"==typeof r.fragment?`#${function je(e){return encodeURI(e)}(r.fragment)}`:""}`}}const Pu=new Ou;function Mu(e){return e.segments.map(r=>Qi(r)).join("/")}function ku(e,r){if(!e.hasChildren())return Mu(e);if(r){const n=e.children[rn]?ku(e.children[rn],!1):"",a=[];return ln(e.children,(u,d)=>{d!==rn&&a.push(`${d}:${ku(u,!1)}`)}),a.length>0?`${n}(${a.join("//")})`:n}{const n=function qe(e,r){let n=[];return ln(e.children,(a,u)=>{u===rn&&(n=n.concat(r(a,u)))}),ln(e.children,(a,u)=>{u!==rn&&(n=n.concat(r(a,u)))}),n}(e,(a,u)=>u===rn?[ku(e.children[rn],!1)]:[`${u}:${ku(a,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[rn]?`${Mu(e)}/${n[0]}`:`${Mu(e)}/(${n.join("//")})`}}function ko(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Fr(e){return ko(e).replace(/%3B/gi,";")}function dm(e){return ko(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Bt(e){return decodeURIComponent(e)}function yt(e){return Bt(e.replace(/\+/g,"%20"))}function Qi(e){return`${dm(e.path)}${function $t(e){return Object.keys(e).map(r=>`;${dm(r)}=${dm(e[r])}`).join("")}(e.parameters)}`}const Je=/^[^\/()?;=#]+/;function Oi(e){const r=e.match(Je);return r?r[0]:""}const mt=/^[^=?&#]+/,go=/^[^&#]+/;class Cj{constructor(r){this.url=r,this.remaining=r}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new gt([],{}):new gt([],this.parseChildren())}parseQueryParams(){const r={};if(this.consumeOptional("?"))do{this.parseQueryParam(r)}while(this.consumeOptional("&"));return r}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const r=[];for(this.peekStartsWith("(")||r.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),r.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let a={};return this.peekStartsWith("(")&&(a=this.parseParens(!1)),(r.length>0||Object.keys(n).length>0)&&(a[rn]=new gt(r,n)),a}parseSegment(){const r=Oi(this.remaining);if(""===r&&this.peekStartsWith(";"))throw new Be(4009,!1);return this.capture(r),new gn(Bt(r),this.parseMatrixParams())}parseMatrixParams(){const r={};for(;this.consumeOptional(";");)this.parseParam(r);return r}parseParam(r){const n=Oi(this.remaining);if(!n)return;this.capture(n);let a="";if(this.consumeOptional("=")){const u=Oi(this.remaining);u&&(a=u,this.capture(a))}r[Bt(n)]=Bt(a)}parseQueryParam(r){const n=function lL(e){const r=e.match(mt);return r?r[0]:""}(this.remaining);if(!n)return;this.capture(n);let a="";if(this.consumeOptional("=")){const m=function dL(e){const r=e.match(go);return r?r[0]:""}(this.remaining);m&&(a=m,this.capture(a))}const u=yt(n),d=yt(a);if(r.hasOwnProperty(u)){let m=r[u];Array.isArray(m)||(m=[m],r[u]=m),m.push(d)}else r[u]=d}parseParens(r){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const a=Oi(this.remaining),u=this.remaining[a.length];if("/"!==u&&")"!==u&&";"!==u)throw new Be(4010,!1);let d;a.indexOf(":")>-1?(d=a.slice(0,a.indexOf(":")),this.capture(d),this.capture(":")):r&&(d=rn);const m=this.parseChildren();n[d]=1===Object.keys(m).length?m[rn]:new gt([],m),this.consumeOptional("//")}return n}peekStartsWith(r){return this.remaining.startsWith(r)}consumeOptional(r){return!!this.peekStartsWith(r)&&(this.remaining=this.remaining.substring(r.length),!0)}capture(r){if(!this.consumeOptional(r))throw new Be(4011,!1)}}function oh(e){return e.segments.length>0?new gt([],{[rn]:e}):e}function hm(e){const r={};for(const a of Object.keys(e.children)){const d=hm(e.children[a]);(d.segments.length>0||d.hasChildren())&&(r[a]=d)}return function hL(e){if(1===e.numberOfChildren&&e.children[rn]){const r=e.children[rn];return new gt(e.segments.concat(r.segments),r.children)}return e}(new gt(e.segments,r))}function Lu(e){return e instanceof ih}function ht(e,r,n,a,u){if(0===n.length)return af(r.root,r.root,r.root,a,u);const d=function fL(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new K1(!0,0,e);let r=0,n=!1;const a=e.reduce((u,d,m)=>{if("object"==typeof d&&null!=d){if(d.outlets){const E={};return ln(d.outlets,(C,I)=>{E[I]="string"==typeof C?C.split("/"):C}),[...u,{outlets:E}]}if(d.segmentPath)return[...u,d.segmentPath]}return"string"!=typeof d?[...u,d]:0===m?(d.split("/").forEach((E,C)=>{0==C&&"."===E||(0==C&&""===E?n=!0:".."===E?r++:""!=E&&u.push(E))}),u):[...u,d]},[]);return new K1(n,r,a)}(n);return d.toRoot()?af(r.root,r.root,new gt([],{}),a,u):function m(C){const I=function uf(e,r,n,a){if(e.isAbsolute)return new cf(r.root,!0,0);if(-1===a)return new cf(n,n===r.root,0);return function Vn(e,r,n){let a=e,u=r,d=n;for(;d>u;){if(d-=u,a=a.parent,!a)throw new Be(4005,!1);u=a.segments.length}return new cf(a,!1,u-d)}(n,a+(Un(e.commands[0])?0:1),e.numberOfDoubleDots)}(d,r,e.snapshot?._urlSegment,C),w=I.processChildren?Lo(I.segmentGroup,I.index,d.commands):vi(I.segmentGroup,I.index,d.commands);return af(r.root,I.segmentGroup,w,a,u)}(e.snapshot?._lastPathIndex)}function Un(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function ra(e){return"object"==typeof e&&null!=e&&e.outlets}function af(e,r,n,a,u){let m,d={};a&&ln(a,(C,I)=>{d[I]=Array.isArray(C)?C.map(w=>`${w}`):`${C}`}),m=e===r?n:W1(e,r,n);const E=oh(hm(m));return new ih(E,d,u)}function W1(e,r,n){const a={};return ln(e.children,(u,d)=>{a[d]=u===r?n:W1(u,r,n)}),new gt(e.segments,a)}class K1{constructor(r,n,a){if(this.isAbsolute=r,this.numberOfDoubleDots=n,this.commands=a,r&&a.length>0&&Un(a[0]))throw new Be(4003,!1);const u=a.find(ra);if(u&&u!==on(a))throw new Be(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class cf{constructor(r,n,a){this.segmentGroup=r,this.processChildren=n,this.index=a}}function vi(e,r,n){if(e||(e=new gt([],{})),0===e.segments.length&&e.hasChildren())return Lo(e,r,n);const a=function Zi(e,r,n){let a=0,u=r;const d={match:!1,pathIndex:0,commandIndex:0};for(;u<e.segments.length;){if(a>=n.length)return d;const m=e.segments[u],E=n[a];if(ra(E))break;const C=`${E}`,I=a<n.length-1?n[a+1]:null;if(u>0&&void 0===C)break;if(C&&I&&"object"==typeof I&&void 0===I.outlets){if(!Jn(C,I,m))return d;a+=2}else{if(!Jn(C,{},m))return d;a++}u++}return{match:!0,pathIndex:u,commandIndex:a}}(e,r,n),u=n.slice(a.commandIndex);if(a.match&&a.pathIndex<e.segments.length){const d=new gt(e.segments.slice(0,a.pathIndex),{});return d.children[rn]=new gt(e.segments.slice(a.pathIndex),e.children),Lo(d,0,u)}return a.match&&0===u.length?new gt(e.segments,{}):a.match&&!e.hasChildren()?Tc(e,r,n):a.match?Lo(e,0,u):Tc(e,r,n)}function Lo(e,r,n){if(0===n.length)return new gt(e.segments,{});{const a=function gL(e){return ra(e[0])?e[0].outlets:{[rn]:e}}(n),u={};return ln(a,(d,m)=>{"string"==typeof d&&(d=[d]),null!==d&&(u[m]=vi(e.children[m],r,d))}),ln(e.children,(d,m)=>{void 0===a[m]&&(u[m]=d)}),new gt(e.segments,u)}}function Tc(e,r,n){const a=e.segments.slice(0,r);let u=0;for(;u<n.length;){const d=n[u];if(ra(d)){const C=lr(d.outlets);return new gt(a,C)}if(0===u&&Un(n[0])){a.push(new gn(e.segments[r].path,yn(n[0]))),u++;continue}const m=ra(d)?d.outlets[rn]:`${d}`,E=u<n.length-1?n[u+1]:null;m&&E&&Un(E)?(a.push(new gn(m,yn(E))),u+=2):(a.push(new gn(m,{})),u++)}return new gt(a,{})}function lr(e){const r={};return ln(e,(n,a)=>{"string"==typeof n&&(n=[n]),null!==n&&(r[a]=Tc(new gt([],{}),0,n))}),r}function yn(e){const r={};return ln(e,(n,a)=>r[a]=`${n}`),r}function Jn(e,r,n){return e==n.path&&na(r,n.parameters)}class Qe{constructor(r,n){this.id=r,this.url=n}}class br extends Qe{constructor(r,n,a="imperative",u=null){super(r,n),this.type=0,this.navigationTrigger=a,this.restoredState=u}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class xu extends Qe{constructor(r,n,a){super(r,n),this.urlAfterRedirects=a,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class lf extends Qe{constructor(r,n,a,u){super(r,n),this.reason=a,this.code=u,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Bu extends Qe{constructor(r,n,a,u){super(r,n),this.error=a,this.target=u,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class df extends Qe{constructor(r,n,a,u){super(r,n),this.urlAfterRedirects=a,this.state=u,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class jt extends Qe{constructor(r,n,a,u){super(r,n),this.urlAfterRedirects=a,this.state=u,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class AL extends Qe{constructor(r,n,a,u,d){super(r,n),this.urlAfterRedirects=a,this.state=u,this.shouldActivate=d,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class mL extends Qe{constructor(r,n,a,u){super(r,n),this.urlAfterRedirects=a,this.state=u,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Sj extends Qe{constructor(r,n,a,u){super(r,n),this.urlAfterRedirects=a,this.state=u,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ur{constructor(r){this.route=r,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class VT{constructor(r){this.route=r,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class fm{constructor(r){this.snapshot=r,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class _L{constructor(r){this.snapshot=r,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ut{constructor(r){this.snapshot=r,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Pe{constructor(r){this.snapshot=r,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ao{constructor(r,n,a){this.routerEvent=r,this.position=n,this.anchor=a,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Ci{constructor(r){this._root=r}get root(){return this._root.value}parent(r){const n=this.pathFromRoot(r);return n.length>1?n[n.length-2]:null}children(r){const n=Rc(r,this._root);return n?n.children.map(a=>a.value):[]}firstChild(r){const n=Rc(r,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(r){const n=zr(r,this._root);return n.length<2?[]:n[n.length-2].children.map(u=>u.value).filter(u=>u!==r)}pathFromRoot(r){return zr(r,this._root).map(n=>n.value)}}function Rc(e,r){if(e===r.value)return r;for(const n of r.children){const a=Rc(e,n);if(a)return a}return null}function zr(e,r){if(e===r.value)return[r];for(const n of r.children){const a=zr(e,n);if(a.length)return a.unshift(r),a}return[]}class Tr{constructor(r,n){this.value=r,this.children=n}toString(){return`TreeNode(${this.value})`}}function Pi(e){const r={};return e&&e.children.forEach(n=>r[n.value.outlet]=n),r}class mo extends Ci{constructor(r,n){super(r),this.snapshot=n,QT(this,r)}toString(){return this.snapshot.toString()}}function zn(e,r){const n=function Dc(e,r){const m=new Vr([],{},{},"",{},rn,r,null,e.root,-1,{});return new jT("",new Tr(m,[]))}(e,r),a=new ji([new gn("",{})]),u=new ji({}),d=new ji({}),m=new ji({}),E=new ji(""),C=new cn(a,u,m,E,d,rn,r,n.root);return C.snapshot=n.root,new mo(new Tr(C,[]),n)}class cn{constructor(r,n,a,u,d,m,E,C){this.url=r,this.params=n,this.queryParams=a,this.fragment=u,this.data=d,this.outlet=m,this.component=E,this.title=this.data?.pipe(Ot(I=>I[nf]))??ct(void 0),this._futureSnapshot=C}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Ot(r=>rf(r)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Ot(r=>rf(r)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function gm(e,r="emptyOnly"){const n=e.pathFromRoot;let a=0;if("always"!==r)for(a=n.length-1;a>=1;){const u=n[a],d=n[a-1];if(u.routeConfig&&""===u.routeConfig.path)a--;else{if(d.component)break;a--}}return function Gi(e){return e.reduce((r,n)=>({params:{...r.params,...n.params},data:{...r.data,...n.data},resolve:{...n.data,...r.resolve,...n.routeConfig?.data,...n._resolvedData}}),{params:{},data:{},resolve:{}})}(n.slice(a))}class Vr{constructor(r,n,a,u,d,m,E,C,I,w,M,F){this.url=r,this.params=n,this.queryParams=a,this.fragment=u,this.data=d,this.outlet=m,this.component=E,this.title=this.data?.[nf],this.routeConfig=C,this._urlSegment=I,this._lastPathIndex=w,this._correctedLastPathIndex=F??w,this._resolve=M}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=rf(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=rf(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(a=>a.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class jT extends Ci{constructor(r,n){super(n),this.url=r,QT(this,n)}toString(){return EL(this._root)}}function QT(e,r){r.value._routerState=e,r.children.forEach(n=>QT(e,n))}function EL(e){const r=e.children.length>0?` { ${e.children.map(EL).join(", ")} } `:"";return`${e.value}${r}`}function GT(e){if(e.snapshot){const r=e.snapshot,n=e._futureSnapshot;e.snapshot=n,na(r.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),r.fragment!==n.fragment&&e.fragment.next(n.fragment),na(r.params,n.params)||e.params.next(n.params),function xT(e,r){if(e.length!==r.length)return!1;for(let n=0;n<e.length;++n)if(!na(e[n],r[n]))return!1;return!0}(r.url,n.url)||e.url.next(n.url),na(r.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function Y1(e,r){const n=na(e.params,r.params)&&function uL(e,r){return Nu(e,r)&&e.every((n,a)=>na(n.parameters,r[a].parameters))}(e.url,r.url);return n&&!(!e.parent!=!r.parent)&&(!e.parent||Y1(e.parent,r.parent))}function Am(e,r,n){if(n&&e.shouldReuseRoute(r.value,n.value.snapshot)){const a=n.value;a._futureSnapshot=r.value;const u=function Fu(e,r,n){return r.children.map(a=>{for(const u of n.children)if(e.shouldReuseRoute(a.value,u.value.snapshot))return Am(e,a,u);return Am(e,a)})}(e,r,n);return new Tr(a,u)}{if(e.shouldAttach(r.value)){const d=e.retrieve(r.value);if(null!==d){const m=d.route;return m.value._futureSnapshot=r.value,m.children=r.children.map(E=>Am(e,E)),m}}const a=function Tj(e){return new cn(new ji(e.url),new ji(e.params),new ji(e.queryParams),new ji(e.fragment),new ji(e.data),e.outlet,e.component,e)}(r.value),u=r.children.map(d=>Am(e,d));return new Tr(a,u)}}const HT="ngNavigationCancelingError";function vL(e,r){const{redirectTo:n,navigationBehaviorOptions:a}=Lu(r)?{redirectTo:r,navigationBehaviorOptions:void 0}:r,u=CL(!1,0,r);return u.url=n,u.navigationBehaviorOptions=a,u}function CL(e,r,n){const a=new Error("NavigationCancelingError: "+(e||""));return a[HT]=!0,a.cancellationCode=r,n&&(a.url=n),a}function yL(e){return WT(e)&&Lu(e.url)}function WT(e){return e&&e[HT]}class Rj{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new mm,this.attachRef=null}}let mm=(()=>{class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,a){const u=this.getOrCreateContext(n);u.outlet=a,this.contexts.set(n,u)}onChildOutletDestroyed(n){const a=this.getContext(n);a&&(a.outlet=null,a.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let a=this.getContext(n);return a||(a=new Rj,this.contexts.set(n,a)),a}getContext(n){return this.contexts.get(n)||null}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const q1=!1;let KT=(()=>{class e{constructor(n,a,u,d,m){this.parentContexts=n,this.location=a,this.changeDetector=d,this.environmentInjector=m,this.activated=null,this._activatedRoute=null,this.activateEvents=new Ft,this.deactivateEvents=new Ft,this.attachEvents=new Ft,this.detachEvents=new Ft,this.name=u||rn,n.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const n=this.parentContexts.getContext(this.name);n&&n.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Be(4012,q1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Be(4012,q1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Be(4012,q1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,a){this.activated=n,this._activatedRoute=a,this.location.insert(n.hostView),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,a){if(this.isActivated)throw new Be(4013,q1);this._activatedRoute=n;const u=this.location,m=n._futureSnapshot.component,E=this.parentContexts.getOrCreateContext(this.name).children,C=new IL(n,E,u.injector);if(a&&function Dj(e){return!!e.resolveComponentFactory}(a)){const I=a.resolveComponentFactory(m);this.activated=u.createComponent(I,u.length,C)}else this.activated=u.createComponent(m,{index:u.length,injector:C,environmentInjector:a??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return e.\u0275fac=function(n){return new(n||e)(se(mm),se(As),function Cd(e){return function RN(e,r){if("class"===r)return e.classes;if("style"===r)return e.styles;const n=e.attrs;if(n){const a=n.length;let u=0;for(;u<a;){const d=n[u];if(yN(d))break;if(0===d)u+=2;else if("number"==typeof d)for(u++;u<a&&"string"==typeof n[u];)u++;else{if(d===r)return n[u+1];u+=2}}}return null}(qr(),e)}("name"),se(ms),se(Ks))},e.\u0275dir=We({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),e})();class IL{constructor(r,n,a){this.route=r,this.childContexts=n,this.parent=a}get(r,n){return r===cn?this.route:r===mm?this.childContexts:this.parent.get(r,n)}}let YT=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=So({type:e,selectors:[["ng-component"]],standalone:!0,features:[NP],decls:1,vars:0,template:function(n,a){1&n&&Ir(0,"router-outlet")},dependencies:[KT],encapsulation:2}),e})();function SL(e,r){return e.providers&&!e._injector&&(e._injector=IA(e.providers,r,`Route: ${e.path}`)),e._injector??r}function J1(e){const r=e.children&&e.children.map(J1),n=r?{...e,children:r}:{...e};return!n.component&&!n.loadComponent&&(r||n.loadChildren)&&n.outlet&&n.outlet!==rn&&(n.component=YT),n}function ts(e){return e.outlet||rn}function Em(e,r){const n=e.filter(a=>ts(a)===r);return n.push(...e.filter(a=>ts(a)!==r)),n}function vm(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let r=e.parent;r;r=r.parent){const n=r.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}class z1{constructor(r,n,a,u){this.routeReuseStrategy=r,this.futureState=n,this.currState=a,this.forwardEvent=u}activate(r){const n=this.futureState._root,a=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,a,r),GT(this.futureState.root),this.activateChildRoutes(n,a,r)}deactivateChildRoutes(r,n,a){const u=Pi(n);r.children.forEach(d=>{const m=d.value.outlet;this.deactivateRoutes(d,u[m],a),delete u[m]}),ln(u,(d,m)=>{this.deactivateRouteAndItsChildren(d,a)})}deactivateRoutes(r,n,a){const u=r.value,d=n?n.value:null;if(u===d)if(u.component){const m=a.getContext(u.outlet);m&&this.deactivateChildRoutes(r,n,m.children)}else this.deactivateChildRoutes(r,n,a);else d&&this.deactivateRouteAndItsChildren(n,a)}deactivateRouteAndItsChildren(r,n){r.value.component&&this.routeReuseStrategy.shouldDetach(r.value.snapshot)?this.detachAndStoreRouteSubtree(r,n):this.deactivateRouteAndOutlet(r,n)}detachAndStoreRouteSubtree(r,n){const a=n.getContext(r.value.outlet),u=a&&r.value.component?a.children:n,d=Pi(r);for(const m of Object.keys(d))this.deactivateRouteAndItsChildren(d[m],u);if(a&&a.outlet){const m=a.outlet.detach(),E=a.children.onOutletDeactivated();this.routeReuseStrategy.store(r.value.snapshot,{componentRef:m,route:r,contexts:E})}}deactivateRouteAndOutlet(r,n){const a=n.getContext(r.value.outlet),u=a&&r.value.component?a.children:n,d=Pi(r);for(const m of Object.keys(d))this.deactivateRouteAndItsChildren(d[m],u);a&&a.outlet&&(a.outlet.deactivate(),a.children.onOutletDeactivated(),a.attachRef=null,a.resolver=null,a.route=null)}activateChildRoutes(r,n,a){const u=Pi(n);r.children.forEach(d=>{this.activateRoutes(d,u[d.value.outlet],a),this.forwardEvent(new Pe(d.value.snapshot))}),r.children.length&&this.forwardEvent(new _L(r.value.snapshot))}activateRoutes(r,n,a){const u=r.value,d=n?n.value:null;if(GT(u),u===d)if(u.component){const m=a.getOrCreateContext(u.outlet);this.activateChildRoutes(r,n,m.children)}else this.activateChildRoutes(r,n,a);else if(u.component){const m=a.getOrCreateContext(u.outlet);if(this.routeReuseStrategy.shouldAttach(u.snapshot)){const E=this.routeReuseStrategy.retrieve(u.snapshot);this.routeReuseStrategy.store(u.snapshot,null),m.children.onOutletReAttached(E.contexts),m.attachRef=E.componentRef,m.route=E.route.value,m.outlet&&m.outlet.attach(E.componentRef,E.route.value),GT(E.route.value),this.activateChildRoutes(r,null,m.children)}else{const E=vm(u.snapshot),C=E?.get(zg)??null;m.attachRef=null,m.route=u,m.resolver=C,m.injector=E,m.outlet&&m.outlet.activateWith(u,m.injector),this.activateChildRoutes(r,null,m.children)}}else this.activateChildRoutes(r,null,a)}}class JT{constructor(r){this.path=r,this.route=this.path[this.path.length-1]}}class $1{constructor(r,n){this.component=r,this.route=n}}function DL(e,r,n){const a=e._root;return Cm(a,r?r._root:null,n,[a.value])}function hf(e,r){const n=Symbol(),a=r.get(e,n);return a===n?"function"!=typeof e||function Fs(e){return null!==D_(e)}(e)?r.get(e):e:a}function Cm(e,r,n,a,u={canDeactivateChecks:[],canActivateChecks:[]}){const d=Pi(r);return e.children.forEach(m=>{(function Mj(e,r,n,a,u={canDeactivateChecks:[],canActivateChecks:[]}){const d=e.value,m=r?r.value:null,E=n?n.getContext(e.value.outlet):null;if(m&&d.routeConfig===m.routeConfig){const C=function wL(e,r,n){if("function"==typeof n)return n(e,r);switch(n){case"pathParamsChange":return!Nu(e.url,r.url);case"pathParamsOrQueryParamsChange":return!Nu(e.url,r.url)||!na(e.queryParams,r.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Y1(e,r)||!na(e.queryParams,r.queryParams);default:return!Y1(e,r)}}(m,d,d.routeConfig.runGuardsAndResolvers);C?u.canActivateChecks.push(new JT(a)):(d.data=m.data,d._resolvedData=m._resolvedData),Cm(e,r,d.component?E?E.children:null:n,a,u),C&&E&&E.outlet&&E.outlet.isActivated&&u.canDeactivateChecks.push(new $1(E.outlet.component,m))}else m&&ym(r,E,u),u.canActivateChecks.push(new JT(a)),Cm(e,null,d.component?E?E.children:null:n,a,u)})(m,d[m.value.outlet],n,a.concat([m.value]),u),delete d[m.value.outlet]}),ln(d,(m,E)=>ym(m,n.getContext(E),u)),u}function ym(e,r,n){const a=Pi(e),u=e.value;ln(a,(d,m)=>{ym(d,u.component?r?r.children.getContext(m):null:r,n)}),n.canDeactivateChecks.push(new $1(u.component&&r&&r.outlet&&r.outlet.isActivated?r.outlet.component:null,u))}function pf(e){return"function"==typeof e}function Ga(e){return e instanceof B1||"EmptyError"===e?.name}const Nc=Symbol("INITIAL_VALUE");function sh(){return ta(e=>ef(e.map(r=>r.pipe(Ni(1),function j1(...e){const r=dg(e);return Wr((n,a)=>{(r?tf(e,n,r):tf(e,n)).subscribe(a)})}(Nc)))).pipe(Ot(r=>{for(const n of r)if(!0!==n){if(n===Nc)return Nc;if(!1===n||n instanceof ih)return n}return!0}),mi(r=>r!==Nc),Ni(1)))}function $T(e){return function uU(...e){return E_(e)}(_i(r=>{if(Lu(r))throw vL(0,r)}),Ot(r=>!0===r))}const XT={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Im(e,r,n,a,u){const d=Oc(e,r,n);return d.matched?function Fj(e,r,n,a){const u=r.canMatch;return u&&0!==u.length?ct(u.map(m=>{const E=hf(m,e);return fo(function Qa(e){return e&&pf(e.canMatch)}(E)?E.canMatch(r,n):e.runInContext(()=>E(r,n)))})).pipe(sh(),$T()):ct(!0)}(a=SL(r,a),r,n).pipe(Ot(m=>!0===m?d:{...XT})):ct(d)}function Oc(e,r,n){if(""===r.path)return"full"===r.pathMatch&&(e.hasChildren()||n.length>0)?{...XT}:{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const u=(r.matcher||Ej)(n,e,r);if(!u)return{...XT};const d={};ln(u.posParams,(E,C)=>{d[C]=E.path});const m=u.consumed.length>0?{...d,...u.consumed[u.consumed.length-1].parameters}:d;return{matched:!0,consumedSegments:u.consumed,remainingSegments:n.slice(u.consumed.length),parameters:m,positionalParamSegments:u.posParams??{}}}function Ha(e,r,n,a,u="corrected"){if(n.length>0&&function FL(e,r,n){return n.some(a=>ah(e,r,a)&&ts(a)!==rn)}(e,n,a)){const m=new gt(r,function ZT(e,r,n,a){const u={};u[rn]=a,a._sourceSegment=e,a._segmentIndexShift=r.length;for(const d of n)if(""===d.path&&ts(d)!==rn){const m=new gt([],{});m._sourceSegment=e,m._segmentIndexShift=r.length,u[ts(d)]=m}return u}(e,r,a,new gt(n,e.children)));return m._sourceSegment=e,m._segmentIndexShift=r.length,{segmentGroup:m,slicedSegments:[]}}if(0===n.length&&function UL(e,r,n){return n.some(a=>ah(e,r,a))}(e,n,a)){const m=new gt(e.segments,function BL(e,r,n,a,u,d){const m={};for(const E of a)if(ah(e,n,E)&&!u[ts(E)]){const C=new gt([],{});C._sourceSegment=e,C._segmentIndexShift="legacy"===d?e.segments.length:r.length,m[ts(E)]=C}return{...u,...m}}(e,r,n,a,e.children,u));return m._sourceSegment=e,m._segmentIndexShift=r.length,{segmentGroup:m,slicedSegments:n}}const d=new gt(e.segments,e.children);return d._sourceSegment=e,d._segmentIndexShift=r.length,{segmentGroup:d,slicedSegments:n}}function ah(e,r,n){return(!(e.hasChildren()||r.length>0)||"full"!==n.pathMatch)&&""===n.path}function eR(e,r,n,a){return!!(ts(e)===a||a!==rn&&ah(r,n,e))&&("**"===e.path||Oc(r,e,n).matched)}function Sm(e,r,n){return 0===r.length&&!e.children[n]}const Z1=!1;class Af{constructor(r){this.segmentGroup=r||null}}class VL{constructor(r){this.urlTree=r}}function mf(e){return um(new Af(e))}function tR(e){return um(new VL(e))}class rR{constructor(r,n,a,u,d){this.injector=r,this.configLoader=n,this.urlSerializer=a,this.urlTree=u,this.config=d,this.allowRedirects=!0}apply(){const r=Ha(this.urlTree.root,[],[],this.config).segmentGroup,n=new gt(r.segments,r.children);return this.expandSegmentGroup(this.injector,this.config,n,rn).pipe(Ot(d=>this.createUrlTree(hm(d),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Nl(d=>{if(d instanceof VL)return this.allowRedirects=!1,this.match(d.urlTree);throw d instanceof Af?this.noMatchError(d):d}))}match(r){return this.expandSegmentGroup(this.injector,this.config,r.root,rn).pipe(Ot(u=>this.createUrlTree(hm(u),r.queryParams,r.fragment))).pipe(Nl(u=>{throw u instanceof Af?this.noMatchError(u):u}))}noMatchError(r){return new Be(4002,Z1)}createUrlTree(r,n,a){const u=oh(r);return new ih(u,n,a)}expandSegmentGroup(r,n,a,u){return 0===a.segments.length&&a.hasChildren()?this.expandChildren(r,n,a).pipe(Ot(d=>new gt([],d))):this.expandSegment(r,a,n,a.segments,u,!0)}expandChildren(r,n,a){const u=[];for(const d of Object.keys(a.children))"primary"===d?u.unshift(d):u.push(d);return pi(u).pipe(wl(d=>{const m=a.children[d],E=Em(n,d);return this.expandSegmentGroup(r,E,m,d).pipe(Ot(C=>({segment:C,outlet:d})))}),MT((d,m)=>(d[m.outlet]=m.segment,d),{}),kT())}expandSegment(r,n,a,u,d,m){return pi(a).pipe(wl(E=>this.expandSegmentAgainstRoute(r,n,a,E,u,d,m).pipe(Nl(I=>{if(I instanceof Af)return ct(null);throw I}))),Dl(E=>!!E),Nl((E,C)=>{if(Ga(E))return Sm(n,u,d)?ct(new gt([],{})):mf(n);throw E}))}expandSegmentAgainstRoute(r,n,a,u,d,m,E){return eR(u,n,d,m)?void 0===u.redirectTo?this.matchSegmentAgainstRoute(r,n,u,d,m):E&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(r,n,a,u,d,m):mf(n):mf(n)}expandSegmentAgainstRouteUsingRedirect(r,n,a,u,d,m){return"**"===u.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(r,a,u,m):this.expandRegularSegmentAgainstRouteUsingRedirect(r,n,a,u,d,m)}expandWildCardWithParamsAgainstRouteUsingRedirect(r,n,a,u){const d=this.applyRedirectCommands([],a.redirectTo,{});return a.redirectTo.startsWith("/")?tR(d):this.lineralizeSegments(a,d).pipe(di(m=>{const E=new gt(m,{});return this.expandSegment(r,E,n,m,u,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(r,n,a,u,d,m){const{matched:E,consumedSegments:C,remainingSegments:I,positionalParamSegments:w}=Oc(n,u,d);if(!E)return mf(n);const M=this.applyRedirectCommands(C,u.redirectTo,w);return u.redirectTo.startsWith("/")?tR(M):this.lineralizeSegments(u,M).pipe(di(F=>this.expandSegment(r,n,a,F.concat(I),m,!1)))}matchSegmentAgainstRoute(r,n,a,u,d){return"**"===a.path?(r=SL(a,r),a.loadChildren?(a._loadedRoutes?ct({routes:a._loadedRoutes,injector:a._loadedInjector}):this.configLoader.loadChildren(r,a)).pipe(Ot(E=>(a._loadedRoutes=E.routes,a._loadedInjector=E.injector,new gt(u,{})))):ct(new gt(u,{}))):Im(n,a,u,r).pipe(ta(({matched:m,consumedSegments:E,remainingSegments:C})=>m?this.getChildConfig(r=a._injector??r,a,u).pipe(di(w=>{const M=w.injector??r,F=w.routes,{segmentGroup:H,slicedSegments:$}=Ha(n,E,C,F),oe=new gt(H.segments,H.children);if(0===$.length&&oe.hasChildren())return this.expandChildren(M,F,oe).pipe(Ot(ge=>new gt(E,ge)));if(0===F.length&&0===$.length)return ct(new gt(E,{}));const he=ts(a)===d;return this.expandSegment(M,oe,F,$,he?rn:d,!0).pipe(Ot(Ce=>new gt(E.concat(Ce.segments),Ce.children)))})):mf(n)))}getChildConfig(r,n,a){return n.children?ct({routes:n.children,injector:r}):n.loadChildren?void 0!==n._loadedRoutes?ct({routes:n._loadedRoutes,injector:n._loadedInjector}):function xL(e,r,n,a){const u=r.canLoad;return void 0===u||0===u.length?ct(!0):ct(u.map(m=>{const E=hf(m,e);return fo(function NL(e){return e&&pf(e.canLoad)}(E)?E.canLoad(r,n):e.runInContext(()=>E(r,n)))})).pipe(sh(),$T())}(r,n,a).pipe(di(u=>u?this.configLoader.loadChildren(r,n).pipe(_i(d=>{n._loadedRoutes=d.routes,n._loadedInjector=d.injector})):function Vj(e){return um(CL(Z1,3))}())):ct({routes:[],injector:r})}lineralizeSegments(r,n){let a=[],u=n.root;for(;;){if(a=a.concat(u.segments),0===u.numberOfChildren)return ct(a);if(u.numberOfChildren>1||!u.children[rn])return um(new Be(4e3,Z1));u=u.children[rn]}}applyRedirectCommands(r,n,a){return this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),r,a)}applyRedirectCreateUrlTree(r,n,a,u){const d=this.createSegmentGroup(r,n.root,a,u);return new ih(d,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(r,n){const a={};return ln(r,(u,d)=>{if("string"==typeof u&&u.startsWith(":")){const E=u.substring(1);a[d]=n[E]}else a[d]=u}),a}createSegmentGroup(r,n,a,u){const d=this.createSegments(r,n.segments,a,u);let m={};return ln(n.children,(E,C)=>{m[C]=this.createSegmentGroup(r,E,a,u)}),new gt(d,m)}createSegments(r,n,a,u){return n.map(d=>d.path.startsWith(":")?this.findPosParam(r,d,u):this.findOrReturn(d,a))}findPosParam(r,n,a){const u=a[n.path.substring(1)];if(!u)throw new Be(4001,Z1);return u}findOrReturn(r,n){let a=0;for(const u of n){if(u.path===r.path)return n.splice(a),u;a++}return r}}class jj{}class _f{constructor(r,n,a,u,d,m,E,C){this.injector=r,this.rootComponentType=n,this.config=a,this.urlTree=u,this.url=d,this.paramsInheritanceStrategy=m,this.relativeLinkResolution=E,this.urlSerializer=C}recognize(){const r=Ha(this.urlTree.root,[],[],this.config.filter(n=>void 0===n.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,r,rn).pipe(Ot(n=>{if(null===n)return null;const a=new Vr([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},rn,this.rootComponentType,null,this.urlTree.root,-1,{}),u=new Tr(a,n),d=new jT(this.url,u);return this.inheritParamsAndData(d._root),d}))}inheritParamsAndData(r){const n=r.value,a=gm(n,this.paramsInheritanceStrategy);n.params=Object.freeze(a.params),n.data=Object.freeze(a.data),r.children.forEach(u=>this.inheritParamsAndData(u))}processSegmentGroup(r,n,a,u){return 0===a.segments.length&&a.hasChildren()?this.processChildren(r,n,a):this.processSegment(r,n,a,a.segments,u)}processChildren(r,n,a){return pi(Object.keys(a.children)).pipe(wl(u=>{const d=a.children[u],m=Em(n,u);return this.processSegmentGroup(r,m,d,u)}),MT((u,d)=>u&&d?(u.push(...d),u):null),function mj(e,r=!1){return Wr((n,a)=>{let u=0;n.subscribe(tn(a,d=>{const m=e(d,u++);(m||r)&&a.next(d),!m&&a.complete()}))})}(u=>null!==u),Q1(null),kT(),Ot(u=>{if(null===u)return null;const d=t0(u);return function e0(e){e.sort((r,n)=>r.value.outlet===rn?-1:n.value.outlet===rn?1:r.value.outlet.localeCompare(n.value.outlet))}(d),d}))}processSegment(r,n,a,u,d){return pi(n).pipe(wl(m=>this.processSegmentAgainstRoute(m._injector??r,m,a,u,d)),Dl(m=>!!m),Nl(m=>{if(Ga(m))return Sm(a,u,d)?ct([]):ct(null);throw m}))}processSegmentAgainstRoute(r,n,a,u,d){if(n.redirectTo||!eR(n,a,u,d))return ct(null);let m;if("**"===n.path){const E=u.length>0?on(u).parameters:{},C=n0(a)+u.length;m=ct({snapshot:new Vr(u,E,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,r0(n),ts(n),n.component??n._loadedComponent??null,n,iR(a),C,QL(n),C),consumedSegments:[],remainingSegments:[]})}else m=Im(a,n,u,r).pipe(Ot(({matched:E,consumedSegments:C,remainingSegments:I,parameters:w})=>{if(!E)return null;const M=n0(a)+C.length;return{snapshot:new Vr(C,w,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,r0(n),ts(n),n.component??n._loadedComponent??null,n,iR(a),M,QL(n),M),consumedSegments:C,remainingSegments:I}}));return m.pipe(ta(E=>{if(null===E)return ct(null);const{snapshot:C,consumedSegments:I,remainingSegments:w}=E;r=n._injector??r;const M=n._loadedInjector??r,F=function Pc(e){return e.children?e.children:e.loadChildren?e._loadedRoutes:[]}(n),{segmentGroup:H,slicedSegments:$}=Ha(a,I,w,F.filter(he=>void 0===he.redirectTo),this.relativeLinkResolution);if(0===$.length&&H.hasChildren())return this.processChildren(M,F,H).pipe(Ot(he=>null===he?null:[new Tr(C,he)]));if(0===F.length&&0===$.length)return ct([new Tr(C,[])]);const oe=ts(n)===d;return this.processSegment(M,F,H,$,oe?rn:d).pipe(Ot(he=>null===he?null:[new Tr(C,he)]))}))}}function Gj(e){const r=e.value.routeConfig;return r&&""===r.path&&void 0===r.redirectTo}function t0(e){const r=[],n=new Set;for(const a of e){if(!Gj(a)){r.push(a);continue}const u=r.find(d=>a.value.routeConfig===d.value.routeConfig);void 0!==u?(u.children.push(...a.children),n.add(u)):r.push(a)}for(const a of n){const u=t0(a.children);r.push(new Tr(a.value,u))}return r.filter(a=>!n.has(a))}function iR(e){let r=e;for(;r._sourceSegment;)r=r._sourceSegment;return r}function n0(e){let r=e,n=r._segmentIndexShift??0;for(;r._sourceSegment;)r=r._sourceSegment,n+=r._segmentIndexShift??0;return n-1}function r0(e){return e.data||{}}function QL(e){return e.resolve||{}}function GL(e){return"string"==typeof e.title||null===e.title}function o0(e){return ta(r=>{const n=e(r);return n?pi(n).pipe(Ot(()=>r)):ct(r)})}let Tm=(()=>{class e{buildTitle(n){let a,u=n.root;for(;void 0!==u;)a=this.getResolvedTitleForRoute(u)??a,u=u.children.find(d=>d.outlet===rn);return a}getResolvedTitleForRoute(n){return n.data[nf]}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=ot({token:e,factory:function(){return Zr(s0)},providedIn:"root"}),e})(),s0=(()=>{class e extends Tm{constructor(n){super(),this.title=n}updateTitle(n){const a=this.buildTitle(n);void 0!==a&&this.title.setTitle(a)}}return e.\u0275fac=function(n){return new(n||e)(Fe(vn))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class HL{}class Wa extends class Mc{shouldDetach(r){return!1}store(r,n){}shouldAttach(r){return!1}retrieve(r){return null}shouldReuseRoute(r,n){return r.routeConfig===n.routeConfig}}{}const vf=new Et("",{providedIn:"root",factory:()=>({})}),Rm=new Et("ROUTES");let Dm=(()=>{class e{constructor(n,a){this.injector=n,this.compiler=a,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return ct(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const a=fo(n.loadComponent()).pipe(_i(d=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=d}),LT(()=>{this.componentLoaders.delete(n)})),u=new iL(a,()=>new Or).pipe(V1());return this.componentLoaders.set(n,u),u}loadChildren(n,a){if(this.childrenLoaders.get(a))return this.childrenLoaders.get(a);if(a._loadedRoutes)return ct({routes:a._loadedRoutes,injector:a._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(a);const d=this.loadModuleFactoryOrRoutes(a.loadChildren).pipe(Ot(E=>{this.onLoadEndListener&&this.onLoadEndListener(a);let C,I,w=!1;Array.isArray(E)?I=E:(C=E.create(n).injector,I=si(C.get(Rm,[],bt.Self|bt.Optional)));return{routes:I.map(J1),injector:C}}),LT(()=>{this.childrenLoaders.delete(a)})),m=new iL(d,()=>new Or).pipe(V1());return this.childrenLoaders.set(a,m),m}loadModuleFactoryOrRoutes(n){return fo(n()).pipe(di(a=>a instanceof Bp||Array.isArray(a)?ct(a):pi(this.compiler.compileModuleAsync(a))))}}return e.\u0275fac=function(n){return new(n||e)(Fe(gi),Fe(_b))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class Uu{}class WL{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,n){return r}}function uR(e){throw e}function KL(e,r,n){return r.parse("/")}const ch={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},YL={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function qL(){const e=Zr(Ve),r=Zr(mm),n=Zr(o1),a=Zr(gi),u=Zr(_b),d=Zr(Rm,{optional:!0})??[],m=Zr(vf,{optional:!0})??{},E=Zr(s0),C=Zr(Tm,{optional:!0}),I=Zr(Uu,{optional:!0}),w=Zr(HL,{optional:!0}),M=new Mi(null,e,r,n,a,u,si(d));return I&&(M.urlHandlingStrategy=I),w&&(M.routeReuseStrategy=w),M.titleStrategy=C??E,function lR(e,r){e.errorHandler&&(r.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(r.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(r.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(r.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(r.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(r.urlUpdateStrategy=e.urlUpdateStrategy),e.canceledNavigationResolution&&(r.canceledNavigationResolution=e.canceledNavigationResolution)}(m,M),M}let Mi=(()=>{class e{constructor(n,a,u,d,m,E,C){this.rootComponentType=n,this.urlSerializer=a,this.rootContexts=u,this.location=d,this.config=C,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Or,this.errorHandler=uR,this.malformedUriErrorHandler=KL,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>ct(void 0),this.urlHandlingStrategy=new WL,this.routeReuseStrategy=new Wa,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=m.get(Dm),this.configLoader.onLoadEndListener=F=>this.triggerEvent(new VT(F)),this.configLoader.onLoadStartListener=F=>this.triggerEvent(new Ur(F)),this.ngModule=m.get(El),this.console=m.get(ZV);const M=m.get(Gn);this.isNgZoneEnabled=M instanceof Gn&&Gn.isInAngularZone(),this.resetConfig(C),this.currentUrlTree=function BT(){return new ih(new gt([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=zn(this.currentUrlTree,this.rootComponentType),this.transitions=new ji({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(n){const a=this.events;return n.pipe(mi(u=>0!==u.id),Ot(u=>({...u,extractedUrl:this.urlHandlingStrategy.extract(u.rawUrl)})),ta(u=>{let d=!1,m=!1;return ct(u).pipe(_i(E=>{this.currentNavigation={id:E.id,initialUrl:E.rawUrl,extractedUrl:E.extractedUrl,trigger:E.source,extras:E.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),ta(E=>{const C=this.browserUrlTree.toString(),I=!this.navigated||E.extractedUrl.toString()!==C||C!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||I)&&this.urlHandlingStrategy.shouldProcessUrl(E.rawUrl))return Pl(E.source)&&(this.browserUrlTree=E.extractedUrl),ct(E).pipe(ta(M=>{const F=this.transitions.getValue();return a.next(new br(M.id,this.serializeUrl(M.extractedUrl),M.source,M.restoredState)),F!==this.transitions.getValue()?_a:Promise.resolve(M)}),function jL(e,r,n,a){return ta(u=>function nR(e,r,n,a,u){return new rR(e,r,n,a,u).apply()}(e,r,n,u.extractedUrl,a).pipe(Ot(d=>({...u,urlAfterRedirects:d}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),_i(M=>{this.currentNavigation={...this.currentNavigation,finalUrl:M.urlAfterRedirects},u.urlAfterRedirects=M.urlAfterRedirects}),function oR(e,r,n,a,u,d){return di(m=>function ns(e,r,n,a,u,d,m="emptyOnly",E="legacy"){return new _f(e,r,n,a,u,m,E,d).recognize().pipe(ta(C=>null===C?function Qj(e){return new Kn(r=>r.error(e))}(new jj):ct(C)))}(e,r,n,m.urlAfterRedirects,a.serialize(m.urlAfterRedirects),a,u,d).pipe(Ot(E=>({...m,targetSnapshot:E}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),_i(M=>{if(u.targetSnapshot=M.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!M.extras.skipLocationChange){const H=this.urlHandlingStrategy.merge(M.urlAfterRedirects,M.rawUrl);this.setBrowserUrl(H,M)}this.browserUrlTree=M.urlAfterRedirects}const F=new df(M.id,this.serializeUrl(M.extractedUrl),this.serializeUrl(M.urlAfterRedirects),M.targetSnapshot);a.next(F)}));if(I&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:F,extractedUrl:H,source:$,restoredState:oe,extras:he}=E,Ae=new br(F,this.serializeUrl(H),$,oe);a.next(Ae);const Ce=zn(H,this.rootComponentType).snapshot;return ct(u={...E,targetSnapshot:Ce,urlAfterRedirects:H,extras:{...he,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=E.rawUrl,E.resolve(null),_a}),_i(E=>{const C=new jt(E.id,this.serializeUrl(E.extractedUrl),this.serializeUrl(E.urlAfterRedirects),E.targetSnapshot);this.triggerEvent(C)}),Ot(E=>u={...E,guards:DL(E.targetSnapshot,E.currentSnapshot,this.rootContexts)}),function Lj(e,r){return di(n=>{const{targetSnapshot:a,currentSnapshot:u,guards:{canActivateChecks:d,canDeactivateChecks:m}}=n;return 0===m.length&&0===d.length?ct({...n,guardsResult:!0}):function X1(e,r,n,a){return pi(e).pipe(di(u=>function LL(e,r,n,a,u){const d=r&&r.routeConfig?r.routeConfig.canDeactivate:null;return d&&0!==d.length?ct(d.map(E=>{const C=vm(r)??u,I=hf(E,C);return fo(function OL(e){return e&&pf(e.canDeactivate)}(I)?I.canDeactivate(e,r,n,a):C.runInContext(()=>I(e,r,n,a))).pipe(Dl())})).pipe(sh()):ct(!0)}(u.component,u.route,n,r,a)),Dl(u=>!0!==u,!0))}(m,a,u,e).pipe(di(E=>E&&function ff(e){return"boolean"==typeof e}(E)?function xj(e,r,n,a){return pi(r).pipe(wl(u=>tf(function PL(e,r){return null!==e&&r&&r(new fm(e)),ct(!0)}(u.route.parent,a),function Bj(e,r){return null!==e&&r&&r(new ut(e)),ct(!0)}(u.route,a),function kL(e,r,n){const a=r[r.length-1],d=r.slice(0,r.length-1).reverse().map(m=>function Pj(e){const r=e.routeConfig?e.routeConfig.canActivateChild:null;return r&&0!==r.length?{node:e,guards:r}:null}(m)).filter(m=>null!==m).map(m=>rL(()=>ct(m.guards.map(C=>{const I=vm(m.node)??n,w=hf(C,I);return fo(function kj(e){return e&&pf(e.canActivateChild)}(w)?w.canActivateChild(a,e):I.runInContext(()=>w(a,e))).pipe(Dl())})).pipe(sh())));return ct(d).pipe(sh())}(e,u.path,n),function ML(e,r,n){const a=r.routeConfig?r.routeConfig.canActivate:null;if(!a||0===a.length)return ct(!0);const u=a.map(d=>rL(()=>{const m=vm(r)??n,E=hf(d,m);return fo(function zT(e){return e&&pf(e.canActivate)}(E)?E.canActivate(r,e):m.runInContext(()=>E(r,e))).pipe(Dl())}));return ct(u).pipe(sh())}(e,u.route,n))),Dl(u=>!0!==u,!0))}(a,d,e,r):ct(E)),Ot(E=>({...n,guardsResult:E})))})}(this.ngModule.injector,E=>this.triggerEvent(E)),_i(E=>{if(u.guardsResult=E.guardsResult,Lu(E.guardsResult))throw vL(0,E.guardsResult);const C=new AL(E.id,this.serializeUrl(E.extractedUrl),this.serializeUrl(E.urlAfterRedirects),E.targetSnapshot,!!E.guardsResult);this.triggerEvent(C)}),mi(E=>!!E.guardsResult||(this.restoreHistory(E),this.cancelNavigationTransition(E,"",3),!1)),o0(E=>{if(E.guards.canActivateChecks.length)return ct(E).pipe(_i(C=>{const I=new mL(C.id,this.serializeUrl(C.extractedUrl),this.serializeUrl(C.urlAfterRedirects),C.targetSnapshot);this.triggerEvent(I)}),ta(C=>{let I=!1;return ct(C).pipe(function sR(e,r){return di(n=>{const{targetSnapshot:a,guards:{canActivateChecks:u}}=n;if(!u.length)return ct(n);let d=0;return pi(u).pipe(wl(m=>function Hj(e,r,n,a){const u=e.routeConfig,d=e._resolve;return void 0!==u?.title&&!GL(u)&&(d[nf]=u.title),function Wj(e,r,n,a){const u=function aR(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}(e);if(0===u.length)return ct({});const d={};return pi(u).pipe(di(m=>function Ef(e,r,n,a){const u=vm(r)??a,d=hf(e,u);return fo(d.resolve?d.resolve(r,n):u.runInContext(()=>d(r,n)))}(e[m],r,n,a).pipe(Dl(),_i(E=>{d[m]=E}))),bc(1),sL(d),Nl(m=>Ga(m)?_a:um(m)))}(d,e,r,a).pipe(Ot(m=>(e._resolvedData=m,e.data=gm(e,n).resolve,u&&GL(u)&&(e.data[nf]=u.title),null)))}(m.route,a,e,r)),_i(()=>d++),bc(1),di(m=>d===u.length?ct(n):_a))})}(this.paramsInheritanceStrategy,this.ngModule.injector),_i({next:()=>I=!0,complete:()=>{I||(this.restoreHistory(C),this.cancelNavigationTransition(C,"",2))}}))}),_i(C=>{const I=new Sj(C.id,this.serializeUrl(C.extractedUrl),this.serializeUrl(C.urlAfterRedirects),C.targetSnapshot);this.triggerEvent(I)}))}),o0(E=>{const C=I=>{const w=[];I.routeConfig?.loadComponent&&!I.routeConfig._loadedComponent&&w.push(this.configLoader.loadComponent(I.routeConfig).pipe(_i(M=>{I.component=M}),Ot(()=>{})));for(const M of I.children)w.push(...C(M));return w};return ef(C(E.targetSnapshot.root)).pipe(Q1(),Ni(1))}),o0(()=>this.afterPreactivation()),Ot(E=>{const C=function bj(e,r,n){const a=Am(e,r._root,n?n._root:void 0);return new mo(a,r)}(this.routeReuseStrategy,E.targetSnapshot,E.currentRouterState);return u={...E,targetRouterState:C}}),_i(E=>{this.currentUrlTree=E.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(E.urlAfterRedirects,E.rawUrl),this.routerState=E.targetRouterState,"deferred"===this.urlUpdateStrategy&&(E.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,E),this.browserUrlTree=E.urlAfterRedirects)}),((e,r,n)=>Ot(a=>(new z1(r,a.targetRouterState,a.currentRouterState,n).activate(e),a)))(this.rootContexts,this.routeReuseStrategy,E=>this.triggerEvent(E)),_i({next(){d=!0},complete(){d=!0}}),LT(()=>{d||m||this.cancelNavigationTransition(u,"",1),this.currentNavigation?.id===u.id&&(this.currentNavigation=null)}),Nl(E=>{if(m=!0,WT(E)){yL(E)||(this.navigated=!0,this.restoreHistory(u,!0));const C=new lf(u.id,this.serializeUrl(u.extractedUrl),E.message,E.cancellationCode);if(a.next(C),yL(E)){const I=this.urlHandlingStrategy.merge(E.url,this.rawUrlTree),w={skipLocationChange:u.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Pl(u.source)};this.scheduleNavigation(I,"imperative",null,w,{resolve:u.resolve,reject:u.reject,promise:u.promise})}else u.resolve(!1)}else{this.restoreHistory(u,!0);const C=new Bu(u.id,this.serializeUrl(u.extractedUrl),E,u.targetSnapshot??void 0);a.next(C);try{u.resolve(this.errorHandler(E))}catch(I){u.reject(I)}}return _a}))}))}resetRootComponentType(n){this.rootComponentType=n,this.routerState.root.component=this.rootComponentType}setTransition(n){this.transitions.next({...this.transitions.value,...n})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const a="popstate"===n.type?"popstate":"hashchange";"popstate"===a&&setTimeout(()=>{const u={replaceUrl:!0},d=n.state?.navigationId?n.state:null;if(d){const E={...d};delete E.navigationId,delete E.\u0275routerPageId,0!==Object.keys(E).length&&(u.state=E)}const m=this.parseUrl(n.url);this.scheduleNavigation(m,a,d,u)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(n){this.events.next(n)}resetConfig(n){this.config=n.map(J1),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,a={}){const{relativeTo:u,queryParams:d,fragment:m,queryParamsHandling:E,preserveFragment:C}=a,I=u||this.routerState.root,w=C?this.currentUrlTree.fragment:m;let M=null;switch(E){case"merge":M={...this.currentUrlTree.queryParams,...d};break;case"preserve":M=this.currentUrlTree.queryParams;break;default:M=d||null}return null!==M&&(M=this.removeEmptyProps(M)),ht(I,this.currentUrlTree,n,M,w??null)}navigateByUrl(n,a={skipLocationChange:!1}){const u=Lu(n)?n:this.parseUrl(n),d=this.urlHandlingStrategy.merge(u,this.rawUrlTree);return this.scheduleNavigation(d,"imperative",null,a)}navigate(n,a={skipLocationChange:!1}){return function qj(e){for(let r=0;r<e.length;r++){if(null==e[r])throw new Be(4008,false)}}(n),this.navigateByUrl(this.createUrlTree(n,a),a)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let a;try{a=this.urlSerializer.parse(n)}catch(u){a=this.malformedUriErrorHandler(u,this.urlSerializer,n)}return a}isActive(n,a){let u;if(u=!0===a?{...ch}:!1===a?{...YL}:a,Lu(n))return cL(this.currentUrlTree,n,u);const d=this.parseUrl(n);return cL(this.currentUrlTree,d,u)}removeEmptyProps(n){return Object.keys(n).reduce((a,u)=>{const d=n[u];return null!=d&&(a[u]=d),a},{})}processNavigations(){this.navigations.subscribe(n=>{this.navigated=!0,this.lastSuccessfulId=n.id,this.currentPageId=n.targetPageId,this.events.next(new xu(n.id,this.serializeUrl(n.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),n.resolve(!0)},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}scheduleNavigation(n,a,u,d,m){if(this.disposed)return Promise.resolve(!1);let E,C,I;m?(E=m.resolve,C=m.reject,I=m.promise):I=new Promise((F,H)=>{E=F,C=H});const w=++this.navigationId;let M;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(u=this.location.getState()),M=u&&u.\u0275routerPageId?u.\u0275routerPageId:d.replaceUrl||d.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):M=0,this.setTransition({id:w,targetPageId:M,source:a,restoredState:u,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:n,extras:d,resolve:E,reject:C,promise:I,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),I.catch(F=>Promise.reject(F))}setBrowserUrl(n,a){const u=this.urlSerializer.serialize(n),d={...a.extras.state,...this.generateNgRouterState(a.id,a.targetPageId)};this.location.isCurrentPathEqualTo(u)||a.extras.replaceUrl?this.location.replaceState(u,"",d):this.location.go(u,"",d)}restoreHistory(n,a=!1){if("computed"===this.canceledNavigationResolution){const u=this.currentPageId-n.targetPageId;"popstate"!==n.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===u?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===u&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(u)}else"replace"===this.canceledNavigationResolution&&(a&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(n,a,u){const d=new lf(n.id,this.serializeUrl(n.extractedUrl),a,u);this.triggerEvent(d),n.resolve(!1)}generateNgRouterState(n,a){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:a}:{navigationId:n}}}return e.\u0275fac=function(n){kI()},e.\u0275prov=ot({token:e,factory:function(){return qL()},providedIn:"root"}),e})();function Pl(e){return"imperative"!==e}class JL{}let $j=(()=>{class e{constructor(n,a,u,d,m){this.router=n,this.injector=u,this.preloadingStrategy=d,this.loader=m}setUpPreloading(){this.subscription=this.router.events.pipe(mi(n=>n instanceof xu),wl(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,a){const u=[];for(const d of a){d.providers&&!d._injector&&(d._injector=IA(d.providers,n,`Route: ${d.path}`));const m=d._injector??n,E=d._loadedInjector??m;d.loadChildren&&!d._loadedRoutes&&void 0===d.canLoad||d.loadComponent&&!d._loadedComponent?u.push(this.preloadConfig(m,d)):(d.children||d._loadedRoutes)&&u.push(this.processRoutes(E,d.children??d._loadedRoutes))}return pi(u).pipe(Fh())}preloadConfig(n,a){return this.preloadingStrategy.preload(a,()=>{let u;u=a.loadChildren&&void 0===a.canLoad?this.loader.loadChildren(n,a):ct(null);const d=u.pipe(di(m=>null===m?ct(void 0):(a._loadedRoutes=m.routes,a._loadedInjector=m.injector,this.processRoutes(m.injector??n,m.routes))));return a.loadComponent&&!a._loadedComponent?pi([d,this.loader.loadComponent(a)]).pipe(Fh()):d})}}return e.\u0275fac=function(n){return new(n||e)(Fe(Mi),Fe(_b),Fe(Ks),Fe(JL),Fe(Dm))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const a0=new Et("");let zL=(()=>{class e{constructor(n,a,u={}){this.router=n,this.viewportScroller=a,this.options=u,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},u.scrollPositionRestoration=u.scrollPositionRestoration||"disabled",u.anchorScrolling=u.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(n=>{n instanceof br?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof xu&&(this.lastId=n.id,this.scheduleScrollEvent(n,this.router.parseUrl(n.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(n=>{n instanceof Ao&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,a){this.router.triggerEvent(new Ao(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,a))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return e.\u0275fac=function(n){kI()},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})();function Cf(e,r){return{\u0275kind:e,\u0275providers:r}}function pR(e){return[{provide:Rm,multi:!0,useValue:e}]}function XL(){const e=Zr(gi);return r=>{const n=e.get($d);if(r!==n.components[0])return;const a=e.get(Mi),u=e.get(ZL);1===e.get(fR)&&a.initialNavigation(),e.get(tx,null,bt.Optional)?.setUpPreloading(),e.get(a0,null,bt.Optional)?.init(),a.resetRootComponentType(n.componentTypes[0]),u.closed||(u.next(),u.unsubscribe())}}const ZL=new Et("",{factory:()=>new Or}),fR=new Et("",{providedIn:"root",factory:()=>1});const tx=new Et("");function eQ(e){return Cf(0,[{provide:tx,useExisting:$j},{provide:JL,useExisting:e}])}const nx=new Et("ROUTER_FORROOT_GUARD"),nQ=[o1,{provide:Ve,useClass:Ou},{provide:Mi,useFactory:qL},mm,{provide:cn,useFactory:function $L(e){return e.routerState.root},deps:[Mi]},Dm];function rQ(){return new bM("Router",Mi)}let rx=(()=>{class e{constructor(n){}static forRoot(n,a){return{ngModule:e,providers:[nQ,[],pR(n),{provide:nx,useFactory:ox,deps:[[Mi,new Mg,new kg]]},{provide:vf,useValue:a||{}},a?.useHash?{provide:Tu,useClass:i1}:{provide:Tu,useClass:JM},{provide:a0,useFactory:()=>{const e=Zr(Mi),r=Zr(bk),n=Zr(vf);return n.scrollOffset&&r.setOffset(n.scrollOffset),new zL(e,r,n)}},a?.preloadingStrategy?eQ(a.preloadingStrategy).\u0275providers:[],{provide:bM,multi:!0,useFactory:rQ},a?.initialNavigation?sx(a):[],[{provide:gR,useFactory:XL},{provide:AM,multi:!0,useExisting:gR}]]}}static forChild(n){return{ngModule:e,providers:[pR(n)]}}}return e.\u0275fac=function(n){return new(n||e)(Fe(nx,8))},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[YT]}),e})();function ox(e){return"guarded"}function sx(e){return["disabled"===e.initialNavigation?Cf(3,[{provide:PA,multi:!0,useFactory:()=>{const r=Zr(Mi);return()=>{r.setUpLocationChangeListener()}}},{provide:fR,useValue:2}]).\u0275providers:[],"enabledBlocking"===e.initialNavigation?Cf(2,[{provide:fR,useValue:0},{provide:PA,multi:!0,deps:[gi],useFactory:r=>{const n=r.get(KM,Promise.resolve());let a=!1;return()=>n.then(()=>new Promise(d=>{const m=r.get(Mi),E=r.get(ZL);(function u(d){r.get(Mi).events.pipe(mi(E=>E instanceof xu||E instanceof lf||E instanceof Bu),Ot(E=>E instanceof xu||E instanceof lf&&(0===E.code||1===E.code)&&null),mi(E=>null!==E),Ni(1)).subscribe(()=>{d()})})(()=>{d(!0),a=!0}),m.afterPreactivation=()=>(d(!0),a||E.closed?ct(void 0):E),m.initialNavigation()}))}}]).\u0275providers:[]]}const gR=new Et("");function kl(e,r,n,a,u,d,m){try{var E=e[d](m),C=E.value}catch(I){return void n(I)}E.done?r(C):Promise.resolve(C).then(a,u)}function kc(e){return function(){var r=this,n=arguments;return new Promise(function(a,u){var d=e.apply(r,n);function m(C){kl(d,a,u,m,E,"next",C)}function E(C){kl(d,a,u,m,E,"throw",C)}m(void 0)})}}let AR=(()=>{class e{constructor(){this.characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",this.numbers="1234567890"}_generateRandomCharacters(n,a){let u="";const d=n.length;for(let m=0;m<a;m++)u+=n.charAt(Math.floor(Math.random()*d));return u}getRandomId(n=30){return this._generateRandomCharacters(this.characters,n)}getRandomNumericId(n=30){return+this._generateRandomCharacters(this.numbers,n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function ax(...e){const r=lg(e),{args:n,keys:a}=Zk(e),u=new Kn(d=>{const{length:m}=n;if(!m)return void d.complete();const E=new Array(m);let C=m,I=m;for(let w=0;w<m;w++){let M=!1;Wi(n[w]).subscribe(tn(d,F=>{M||(M=!0,I--),E[w]=F},()=>C--,void 0,()=>{(!C||!M)&&(I||d.next(a?eL(a,E):E),d.complete())}))}});return r?u.pipe(U1(r)):u}let uh=(()=>{class e{constructor(n,a){this._renderer=n,this._elementRef=a,this.onChange=u=>{},this.onTouched=()=>{}}setProperty(n,a){this._renderer.setProperty(this._elementRef.nativeElement,n,a)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return e.\u0275fac=function(n){return new(n||e)(se(gs),se(Qn))},e.\u0275dir=We({type:e}),e})(),lh=(()=>{class e extends uh{}return e.\u0275fac=function(){let r;return function(a){return(r||(r=function co(e){return Xc(()=>{const r=e.prototype.constructor,n=r[Zc]||Dy(r),a=Object.prototype;let u=Object.getPrototypeOf(e.prototype).constructor;for(;u&&u!==a;){const d=u[Zc]||Dy(u);if(d&&d!==n)return d;u=Object.getPrototypeOf(u)}return d=>new d})}(e)))(a||e)}}(),e.\u0275dir=We({type:e,features:[Pn]}),e})();const Lc=new Et("NgValueAccessor"),ux={provide:Lc,useExisting:mn(()=>yf),multi:!0},sQ=new Et("CompositionEventMode");let yf=(()=>{class e extends uh{constructor(n,a,u){super(n,a),this._compositionMode=u,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function wm(){const e=Xo()?Xo().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return e.\u0275fac=function(n){return new(n||e)(se(gs),se(Qn),se(sQ,8))},e.\u0275dir=We({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,a){1&n&&kt("input",function(d){return a._handleInput(d.target.value)})("blur",function(){return a.onTouched()})("compositionstart",function(){return a._compositionStart()})("compositionend",function(d){return a._compositionEnd(d.target.value)})},features:[fr([ux]),Pn]}),e})();const ki=new Et("NgValidators"),xl=new Et("NgAsyncValidators");function f0(e){return null!=e}function ER(e){return _u(e)?pi(e):e}function Ax(e){let r={};return e.forEach(n=>{r=null!=n?{...r,...n}:r}),0===Object.keys(r).length?null:r}function mx(e,r){return r.map(n=>n(e))}function _x(e){return e.map(r=>function g0(e){return!e.validate}(r)?r:n=>r.validate(n))}function A0(e){return null!=e?function vR(e){if(!e)return null;const r=e.filter(f0);return 0==r.length?null:function(n){return Ax(mx(n,r))}}(_x(e)):null}function CR(e){return null!=e?function If(e){if(!e)return null;const r=e.filter(f0);return 0==r.length?null:function(n){return ax(mx(n,r).map(ER)).pipe(Ot(Ax))}}(_x(e)):null}function m0(e,r){return null===e?[r]:Array.isArray(e)?[...e,r]:[e,r]}function E0(e){return e?Array.isArray(e)?e:[e]:[]}function dh(e,r){return Array.isArray(e)?e.includes(r):e===r}function yR(e,r){const n=E0(r);return E0(e).forEach(u=>{dh(n,u)||n.push(u)}),n}function IR(e,r){return E0(r).filter(n=>!dh(e,n))}class SR{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(r){this._rawValidators=r||[],this._composedValidatorFn=A0(this._rawValidators)}_setAsyncValidators(r){this._rawAsyncValidators=r||[],this._composedAsyncValidatorFn=CR(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(r){this._onDestroyCallbacks.push(r)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(r=>r()),this._onDestroyCallbacks=[]}reset(r){this.control&&this.control.reset(r)}hasError(r,n){return!!this.control&&this.control.hasError(r,n)}getError(r,n){return this.control?this.control.getError(r,n):null}}class _o extends SR{get formDirective(){return null}get path(){return null}}class Bl extends SR{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let bR=(()=>{class e extends class Ex{constructor(r){this._cd=r}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}{constructor(n){super(n)}}return e.\u0275fac=function(n){return new(n||e)(se(Bl,2))},e.\u0275dir=We({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,a){2&n&&pr("ng-untouched",a.isUntouched)("ng-touched",a.isTouched)("ng-pristine",a.isPristine)("ng-dirty",a.isDirty)("ng-valid",a.isValid)("ng-invalid",a.isInvalid)("ng-pending",a.isPending)},features:[Pn]}),e})();const Sf="VALID",y0="INVALID",bf="PENDING",Tf="DISABLED";function OR(e){return Array.isArray(e)?A0(e):e||null}function I0(e){return Array.isArray(e)?CR(e):e||null}function S0(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function Vu(e,r){(function xR(e,r){const n=function Nm(e){return e._rawValidators}(e);null!==r.validator?e.setValidators(m0(n,r.validator)):"function"==typeof n&&e.setValidators([n]);const a=function _0(e){return e._rawAsyncValidators}(e);null!==r.asyncValidator?e.setAsyncValidators(m0(a,r.asyncValidator)):"function"==typeof a&&e.setAsyncValidators([a]);const u=()=>e.updateValueAndValidity();T0(r._rawValidators,u),T0(r._rawAsyncValidators,u)})(e,r),r.valueAccessor.writeValue(e.value),e.disabled&&r.valueAccessor.setDisabledState?.(!0),function Tx(e,r){r.valueAccessor.registerOnChange(n=>{e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&Rx(e,r)})}(e,r),function Om(e,r){const n=(a,u)=>{r.valueAccessor.writeValue(a),u&&r.viewToModelUpdate(a)};e.registerOnChange(n),r._registerOnDestroy(()=>{e._unregisterOnChange(n)})}(e,r),function Rr(e,r){r.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&Rx(e,r),"submit"!==e.updateOn&&e.markAsTouched()})}(e,r),function bx(e,r){if(r.valueAccessor.setDisabledState){const n=a=>{r.valueAccessor.setDisabledState(a)};e.registerOnDisabledChange(n),r._registerOnDestroy(()=>{e._unregisterOnDisabledChange(n)})}}(e,r)}function T0(e,r){e.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(r)})}function Rx(e,r){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),r.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function UR(e,r){const n=e.indexOf(r);n>-1&&e.splice(n,1)}function Mx(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}const Bx={provide:Bl,useExisting:mn(()=>jR)},Fx=(()=>Promise.resolve())();let jR=(()=>{class e extends Bl{constructor(n,a,u,d,m){super(),this._changeDetectorRef=m,this.control=new class extends class kR{constructor(r,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=r,this._rawAsyncValidators=n,this._composedValidatorFn=OR(this._rawValidators),this._composedAsyncValidatorFn=I0(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(r){this._rawValidators=this._composedValidatorFn=r}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(r){this._rawAsyncValidators=this._composedAsyncValidatorFn=r}get parent(){return this._parent}get valid(){return this.status===Sf}get invalid(){return this.status===y0}get pending(){return this.status==bf}get disabled(){return this.status===Tf}get enabled(){return this.status!==Tf}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(r){this._rawValidators=r,this._composedValidatorFn=OR(r)}setAsyncValidators(r){this._rawAsyncValidators=r,this._composedAsyncValidatorFn=I0(r)}addValidators(r){this.setValidators(yR(r,this._rawValidators))}addAsyncValidators(r){this.setAsyncValidators(yR(r,this._rawAsyncValidators))}removeValidators(r){this.setValidators(IR(r,this._rawValidators))}removeAsyncValidators(r){this.setAsyncValidators(IR(r,this._rawAsyncValidators))}hasValidator(r){return dh(this._rawValidators,r)}hasAsyncValidator(r){return dh(this._rawAsyncValidators,r)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(r={}){this.touched=!0,this._parent&&!r.onlySelf&&this._parent.markAsTouched(r)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(r=>r.markAllAsTouched())}markAsUntouched(r={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!r.onlySelf&&this._parent._updateTouched(r)}markAsDirty(r={}){this.pristine=!1,this._parent&&!r.onlySelf&&this._parent.markAsDirty(r)}markAsPristine(r={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!r.onlySelf&&this._parent._updatePristine(r)}markAsPending(r={}){this.status=bf,!1!==r.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!r.onlySelf&&this._parent.markAsPending(r)}disable(r={}){const n=this._parentMarkedDirty(r.onlySelf);this.status=Tf,this.errors=null,this._forEachChild(a=>{a.disable({...r,onlySelf:!0})}),this._updateValue(),!1!==r.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...r,skipPristineCheck:n}),this._onDisabledChange.forEach(a=>a(!0))}enable(r={}){const n=this._parentMarkedDirty(r.onlySelf);this.status=Sf,this._forEachChild(a=>{a.enable({...r,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:r.emitEvent}),this._updateAncestors({...r,skipPristineCheck:n}),this._onDisabledChange.forEach(a=>a(!1))}_updateAncestors(r){this._parent&&!r.onlySelf&&(this._parent.updateValueAndValidity(r),r.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(r){this._parent=r}getRawValue(){return this.value}updateValueAndValidity(r={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Sf||this.status===bf)&&this._runAsyncValidator(r.emitEvent)),!1!==r.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!r.onlySelf&&this._parent.updateValueAndValidity(r)}_updateTreeValidity(r={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(r)),this.updateValueAndValidity({onlySelf:!0,emitEvent:r.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Tf:Sf}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(r){if(this.asyncValidator){this.status=bf,this._hasOwnPendingAsyncValidator=!0;const n=ER(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(a=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(a,{emitEvent:r})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(r,n={}){this.errors=r,this._updateControlsErrors(!1!==n.emitEvent)}get(r){let n=r;return null==n||(Array.isArray(n)||(n=n.split(".")),0===n.length)?null:n.reduce((a,u)=>a&&a._find(u),this)}getError(r,n){const a=n?this.get(n):this;return a&&a.errors?a.errors[r]:null}hasError(r,n){return!!this.getError(r,n)}get root(){let r=this;for(;r._parent;)r=r._parent;return r}_updateControlsErrors(r){this.status=this._calculateStatus(),r&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(r)}_initObservables(){this.valueChanges=new Ft,this.statusChanges=new Ft}_calculateStatus(){return this._allControlsDisabled()?Tf:this.errors?y0:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(bf)?bf:this._anyControlsHaveStatus(y0)?y0:Sf}_anyControlsHaveStatus(r){return this._anyControls(n=>n.status===r)}_anyControlsDirty(){return this._anyControls(r=>r.dirty)}_anyControlsTouched(){return this._anyControls(r=>r.touched)}_updatePristine(r={}){this.pristine=!this._anyControlsDirty(),this._parent&&!r.onlySelf&&this._parent._updatePristine(r)}_updateTouched(r={}){this.touched=this._anyControlsTouched(),this._parent&&!r.onlySelf&&this._parent._updateTouched(r)}_registerOnCollectionChange(r){this._onCollectionChange=r}_setUpdateStrategy(r){S0(r)&&null!=r.updateOn&&(this._updateOn=r.updateOn)}_parentMarkedDirty(r){return!r&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(r){return null}}{constructor(r=null,n,a){super(function NR(e){return(S0(e)?e.validators:e)||null}(n),function PR(e,r){return(S0(r)?r.asyncValidators:e)||null}(a,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(r),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),S0(n)&&(n.nonNullable||n.initialValueIsDefault)&&(this.defaultValue=Mx(r)?r.value:r)}setValue(r,n={}){this.value=this._pendingValue=r,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(a=>a(this.value,!1!==n.emitViewToModelChange)),this.updateValueAndValidity(n)}patchValue(r,n={}){this.setValue(r,n)}reset(r=this.defaultValue,n={}){this._applyFormState(r),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(r){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(r){this._onChange.push(r)}_unregisterOnChange(r){UR(this._onChange,r)}registerOnDisabledChange(r){this._onDisabledChange.push(r)}_unregisterOnDisabledChange(r){UR(this._onDisabledChange,r)}_forEachChild(r){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(r){Mx(r)?(this.value=this._pendingValue=r.value,r.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=r}},this._registered=!1,this.update=new Ft,this._parent=n,this._setValidators(a),this._setAsyncValidators(u),this.valueAccessor=function FR(e,r){if(!r)return null;let n,a,u;return Array.isArray(r),r.forEach(d=>{d.constructor===yf?n=d:function Ox(e){return Object.getPrototypeOf(e.constructor)===lh}(d)?a=d:u=d}),u||a||n||null}(0,d)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const a=n.name.previousValue;this.formDirective.removeControl({name:a,path:this._getPath(a)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),function BR(e,r){if(!e.hasOwnProperty("model"))return!1;const n=e.model;return!!n.isFirstChange()||!Object.is(r,n.currentValue)}(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Vu(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){Fx.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){const a=n.isDisabled.currentValue,u=0!==a&&function Cc(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}(a);Fx.then(()=>{u&&!this.control.disabled?this.control.disable():!u&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?function b0(e,r){return[...r.path,e]}(n,this._parent):[n]}}return e.\u0275fac=function(n){return new(n||e)(se(_o,9),se(ki,10),se(xl,10),se(Lc,10),se(ms,8))},e.\u0275dir=We({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[fr([Bx]),Pn,Fi]}),e})(),jx=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({}),e})(),QQ=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[jx]}),e})(),zR=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[QQ]}),e})();function $R(e,r){if(1&e){const n=Ri();Ep(0),Ge(1,"button",4),kt("click",function(){return rr(n),an(nt().joinMeetingInput=!0)}),ti(2,"Join Meeting"),He(),Ge(3,"button",4),kt("click",function(){return rr(n),an(nt().createMeetingInput=!0)}),ti(4,"Create Meeting"),He(),Qd()}}function Dr(e,r){if(1&e){const n=Ri();Ep(0),Ge(1,"div",5)(2,"input",6),kt("ngModelChange",function(u){return rr(n),an(nt().meeting_id=u)}),He(),Ir(3,"span",7),Ge(4,"span",8),ti(5,"Meeting ID"),He()(),Ge(6,"div",5)(7,"input",9),kt("ngModelChange",function(u){return rr(n),an(nt().newHostName=u)}),He(),Ir(8,"span",7),Ge(9,"span",8),ti(10,"Your Name"),He()(),Ge(11,"button",4),kt("click",function(){return rr(n),an(nt().joinMeetingInput=!1)}),ti(12,"Back"),He(),Ge(13,"button",4),kt("click",function(){return rr(n),an(nt().joinExistingMeeting())}),ti(14,"Join Meeting"),He(),Qd()}if(2&e){const n=nt();$e(2),Ue("ngModel",n.meeting_id),$e(5),Ue("ngModel",n.newHostName)}}function Zx(e,r){if(1&e){const n=Ri();Ep(0),Ge(1,"div",5)(2,"input",9),kt("ngModelChange",function(u){return rr(n),an(nt().newHostName=u)}),He(),Ir(3,"span",7),Ge(4,"span",8),ti(5,"Your Name"),He()(),Ge(6,"button",4),kt("click",function(){return rr(n),an(nt().createMeetingInput=!1)}),ti(7,"Back"),He(),Ge(8,"button",4),kt("click",function(){return rr(n),an(nt().startNewMeeting())}),ti(9,"Create Meeting"),He(),Qd()}if(2&e){const n=nt();$e(2),Ue("ngModel",n.newHostName)}}let eB=(()=>{class e{constructor(n,a){this.router=n,this.utility=a,this.joinMeetingInput=!1,this.createMeetingInput=!1,this.newHostName="",this.meeting_id=""}ngOnInit(){}startNewMeeting(){var n=this;return kc(function*(){if(n.newHostName){const a=n.utility.getRandomId(20),u=n.newHostName;n.createMeetingInput=!1,n.router.navigate(["/video",a,u])}else console.log("host name not available")})()}joinExistingMeeting(){if(this.newHostName&&this.meeting_id){const n=this.meeting_id,a=this.newHostName;this.joinMeetingInput=!1,this.router.navigate(["/video",n,a])}else console.log("Host Name or Meeting Id not available")}}return e.\u0275fac=function(n){return new(n||e)(se(Mi),se(AR))},e.\u0275cmp=So({type:e,selectors:[["app-home"]],decls:7,vars:3,consts:[[1,"initial-screen"],[1,"text-center"],[1,"mb-2"],[4,"ngIf"],["type","button",1,"button-class","button-margin",3,"click"],[1,"wrap-input100","validate-input"],["type","text","name","meeting_id",1,"input100",3,"ngModel","ngModelChange"],[1,"focus-input100"],[1,"label-input100"],["type","text","name","name",1,"input100",3,"ngModel","ngModelChange"]],template:function(n,a){1&n&&(Ge(0,"div",0)(1,"div",1)(2,"h1",2),ti(3,"WellCome To Agora Meeting Platform"),He(),ke(4,$R,5,0,"ng-container",3),ke(5,Dr,15,2,"ng-container",3),ke(6,Zx,10,1,"ng-container",3),He()()),2&n&&($e(4),Ue("ngIf",!a.joinMeetingInput&&!a.createMeetingInput),$e(1),Ue("ngIf",a.joinMeetingInput),$e(1),Ue("ngIf",a.createMeetingInput))},dependencies:[Sl,yf,bR,jR],styles:[".button-margin[_ngcontent-%COMP%]{margin:10px}.initial-screen[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;align-items:center;justify-content:center}.mb-2[_ngcontent-%COMP%]{margin-bottom:2rem}"]}),e})();var bs=ig(890),_t=ig.n(bs);class k0{}class L0{}class Eo{constructor(r){this.normalizedNames=new Map,this.lazyUpdate=null,r?this.lazyInit="string"==typeof r?()=>{this.headers=new Map,r.split("\n").forEach(n=>{const a=n.indexOf(":");if(a>0){const u=n.slice(0,a),d=u.toLowerCase(),m=n.slice(a+1).trim();this.maybeSetNormalizedName(u,d),this.headers.has(d)?this.headers.get(d).push(m):this.headers.set(d,[m])}})}:()=>{this.headers=new Map,Object.keys(r).forEach(n=>{let a=r[n];const u=n.toLowerCase();"string"==typeof a&&(a=[a]),a.length>0&&(this.headers.set(u,a),this.maybeSetNormalizedName(n,u))})}:this.headers=new Map}has(r){return this.init(),this.headers.has(r.toLowerCase())}get(r){this.init();const n=this.headers.get(r.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(r){return this.init(),this.headers.get(r.toLowerCase())||null}append(r,n){return this.clone({name:r,value:n,op:"a"})}set(r,n){return this.clone({name:r,value:n,op:"s"})}delete(r,n){return this.clone({name:r,value:n,op:"d"})}maybeSetNormalizedName(r,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,r)}init(){this.lazyInit&&(this.lazyInit instanceof Eo?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(r=>this.applyUpdate(r)),this.lazyUpdate=null))}copyFrom(r){r.init(),Array.from(r.headers.keys()).forEach(n=>{this.headers.set(n,r.headers.get(n)),this.normalizedNames.set(n,r.normalizedNames.get(n))})}clone(r){const n=new Eo;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof Eo?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([r]),n}applyUpdate(r){const n=r.name.toLowerCase();switch(r.op){case"a":case"s":let a=r.value;if("string"==typeof a&&(a=[a]),0===a.length)return;this.maybeSetNormalizedName(r.name,n);const u=("a"===r.op?this.headers.get(n):void 0)||[];u.push(...a),this.headers.set(n,u);break;case"d":const d=r.value;if(d){let m=this.headers.get(n);if(!m)return;m=m.filter(E=>-1===d.indexOf(E)),0===m.length?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,m)}else this.headers.delete(n),this.normalizedNames.delete(n)}}forEach(r){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>r(this.normalizedNames.get(n),this.headers.get(n)))}}class tB{encodeKey(r){return x0(r)}encodeValue(r){return x0(r)}decodeKey(r){return decodeURIComponent(r)}decodeValue(r){return decodeURIComponent(r)}}const rB=/%(\d[a-f0-9])/gi,iB={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function x0(e){return encodeURIComponent(e).replace(rB,(r,n)=>iB[n]??r)}function B0(e){return`${e}`}class Fc{constructor(r={}){if(this.updates=null,this.cloneFrom=null,this.encoder=r.encoder||new tB,r.fromString){if(r.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function nB(e,r){const n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(u=>{const d=u.indexOf("="),[m,E]=-1==d?[r.decodeKey(u),""]:[r.decodeKey(u.slice(0,d)),r.decodeValue(u.slice(d+1))],C=n.get(m)||[];C.push(E),n.set(m,C)}),n}(r.fromString,this.encoder)}else r.fromObject?(this.map=new Map,Object.keys(r.fromObject).forEach(n=>{const a=r.fromObject[n],u=Array.isArray(a)?a.map(B0):[B0(a)];this.map.set(n,u)})):this.map=null}has(r){return this.init(),this.map.has(r)}get(r){this.init();const n=this.map.get(r);return n?n[0]:null}getAll(r){return this.init(),this.map.get(r)||null}keys(){return this.init(),Array.from(this.map.keys())}append(r,n){return this.clone({param:r,value:n,op:"a"})}appendAll(r){const n=[];return Object.keys(r).forEach(a=>{const u=r[a];Array.isArray(u)?u.forEach(d=>{n.push({param:a,value:d,op:"a"})}):n.push({param:a,value:u,op:"a"})}),this.clone(n)}set(r,n){return this.clone({param:r,value:n,op:"s"})}delete(r,n){return this.clone({param:r,value:n,op:"d"})}toString(){return this.init(),this.keys().map(r=>{const n=this.encoder.encodeKey(r);return this.map.get(r).map(a=>n+"="+this.encoder.encodeValue(a)).join("&")}).filter(r=>""!==r).join("&")}clone(r){const n=new Fc({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(r),n}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(r=>this.map.set(r,this.cloneFrom.map.get(r))),this.updates.forEach(r=>{switch(r.op){case"a":case"s":const n=("a"===r.op?this.map.get(r.param):void 0)||[];n.push(B0(r.value)),this.map.set(r.param,n);break;case"d":if(void 0===r.value){this.map.delete(r.param);break}{let a=this.map.get(r.param)||[];const u=a.indexOf(B0(r.value));-1!==u&&a.splice(u,1),a.length>0?this.map.set(r.param,a):this.map.delete(r.param)}}}),this.cloneFrom=this.updates=null)}}class ZR{constructor(){this.map=new Map}set(r,n){return this.map.set(r,n),this}get(r){return this.map.has(r)||this.map.set(r,r.defaultValue()),this.map.get(r)}delete(r){return this.map.delete(r),this}has(r){return this.map.has(r)}keys(){return this.map.keys()}}function eD(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function U0(e){return typeof Blob<"u"&&e instanceof Blob}function tD(e){return typeof FormData<"u"&&e instanceof FormData}class vo{constructor(r,n,a,u){let d;if(this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=r.toUpperCase(),function F0(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||u?(this.body=void 0!==a?a:null,d=u):d=a,d&&(this.reportProgress=!!d.reportProgress,this.withCredentials=!!d.withCredentials,d.responseType&&(this.responseType=d.responseType),d.headers&&(this.headers=d.headers),d.context&&(this.context=d.context),d.params&&(this.params=d.params)),this.headers||(this.headers=new Eo),this.context||(this.context=new ZR),this.params){const m=this.params.toString();if(0===m.length)this.urlWithParams=n;else{const E=n.indexOf("?");this.urlWithParams=n+(-1===E?"?":E<n.length-1?"&":"")+m}}else this.params=new Fc,this.urlWithParams=n}serializeBody(){return null===this.body?null:eD(this.body)||U0(this.body)||tD(this.body)||function oB(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Fc?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||tD(this.body)?null:U0(this.body)?this.body.type||null:eD(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Fc?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(r={}){const n=r.method||this.method,a=r.url||this.url,u=r.responseType||this.responseType,d=void 0!==r.body?r.body:this.body,m=void 0!==r.withCredentials?r.withCredentials:this.withCredentials,E=void 0!==r.reportProgress?r.reportProgress:this.reportProgress;let C=r.headers||this.headers,I=r.params||this.params;const w=r.context??this.context;return void 0!==r.setHeaders&&(C=Object.keys(r.setHeaders).reduce((M,F)=>M.set(F,r.setHeaders[F]),C)),r.setParams&&(I=Object.keys(r.setParams).reduce((M,F)=>M.set(F,r.setParams[F]),I)),new vo(n,a,d,{params:I,headers:C,context:w,reportProgress:E,responseType:u,withCredentials:m})}}var $r=(()=>(($r=$r||{})[$r.Sent=0]="Sent",$r[$r.UploadProgress=1]="UploadProgress",$r[$r.ResponseHeader=2]="ResponseHeader",$r[$r.DownloadProgress=3]="DownloadProgress",$r[$r.Response=4]="Response",$r[$r.User=5]="User",$r))();class nD{constructor(r,n=200,a="OK"){this.headers=r.headers||new Eo,this.status=void 0!==r.status?r.status:n,this.statusText=r.statusText||a,this.url=r.url||null,this.ok=this.status>=200&&this.status<300}}class km extends nD{constructor(r={}){super(r),this.type=$r.ResponseHeader}clone(r={}){return new km({headers:r.headers||this.headers,status:void 0!==r.status?r.status:this.status,statusText:r.statusText||this.statusText,url:r.url||this.url||void 0})}}class fh extends nD{constructor(r={}){super(r),this.type=$r.Response,this.body=void 0!==r.body?r.body:null}clone(r={}){return new fh({body:void 0!==r.body?r.body:this.body,headers:r.headers||this.headers,status:void 0!==r.status?r.status:this.status,statusText:r.statusText||this.statusText,url:r.url||this.url||void 0})}}class gh extends nD{constructor(r){super(r,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${r.url||"(unknown url)"}`:`Http failure response for ${r.url||"(unknown url)"}: ${r.status} ${r.statusText}`,this.error=r.error||null}}function to(e,r){return{body:r,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let rD=(()=>{class e{constructor(n){this.handler=n}request(n,a,u={}){let d;if(n instanceof vo)d=n;else{let C,I;C=u.headers instanceof Eo?u.headers:new Eo(u.headers),u.params&&(I=u.params instanceof Fc?u.params:new Fc({fromObject:u.params})),d=new vo(n,a,void 0!==u.body?u.body:null,{headers:C,context:u.context,params:I,reportProgress:u.reportProgress,responseType:u.responseType||"json",withCredentials:u.withCredentials})}const m=ct(d).pipe(wl(C=>this.handler.handle(C)));if(n instanceof vo||"events"===u.observe)return m;const E=m.pipe(mi(C=>C instanceof fh));switch(u.observe||"body"){case"body":switch(d.responseType){case"arraybuffer":return E.pipe(Ot(C=>{if(null!==C.body&&!(C.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return C.body}));case"blob":return E.pipe(Ot(C=>{if(null!==C.body&&!(C.body instanceof Blob))throw new Error("Response is not a Blob.");return C.body}));case"text":return E.pipe(Ot(C=>{if(null!==C.body&&"string"!=typeof C.body)throw new Error("Response is not a string.");return C.body}));default:return E.pipe(Ot(C=>C.body))}case"response":return E;default:throw new Error(`Unreachable: unhandled observe type ${u.observe}}`)}}delete(n,a={}){return this.request("DELETE",n,a)}get(n,a={}){return this.request("GET",n,a)}head(n,a={}){return this.request("HEAD",n,a)}jsonp(n,a){return this.request("JSONP",n,{params:(new Fc).append(a,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,a={}){return this.request("OPTIONS",n,a)}patch(n,a,u={}){return this.request("PATCH",n,to(u,a))}post(n,a,u={}){return this.request("POST",n,to(u,a))}put(n,a,u={}){return this.request("PUT",n,to(u,a))}}return e.\u0275fac=function(n){return new(n||e)(Fe(k0))},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})();class sB{constructor(r,n){this.next=r,this.interceptor=n}handle(r){return this.interceptor.intercept(r,this.next)}}const aB=new Et("HTTP_INTERCEPTORS");let Fo=(()=>{class e{intercept(n,a){return a.handle(n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})();const cB=/^\)\]\}',?\n/;let iD=(()=>{class e{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Kn(a=>{const u=this.xhrFactory.build();if(u.open(n.method,n.urlWithParams),n.withCredentials&&(u.withCredentials=!0),n.headers.forEach((H,$)=>u.setRequestHeader(H,$.join(","))),n.headers.has("Accept")||u.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const H=n.detectContentTypeHeader();null!==H&&u.setRequestHeader("Content-Type",H)}if(n.responseType){const H=n.responseType.toLowerCase();u.responseType="json"!==H?H:"text"}const d=n.serializeBody();let m=null;const E=()=>{if(null!==m)return m;const H=u.statusText||"OK",$=new Eo(u.getAllResponseHeaders()),oe=function uB(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(u)||n.url;return m=new km({headers:$,status:u.status,statusText:H,url:oe}),m},C=()=>{let{headers:H,status:$,statusText:oe,url:he}=E(),Ae=null;204!==$&&(Ae=typeof u.response>"u"?u.responseText:u.response),0===$&&($=Ae?200:0);let Ce=$>=200&&$<300;if("json"===n.responseType&&"string"==typeof Ae){const ge=Ae;Ae=Ae.replace(cB,"");try{Ae=""!==Ae?JSON.parse(Ae):null}catch(De){Ae=ge,Ce&&(Ce=!1,Ae={error:De,text:Ae})}}Ce?(a.next(new fh({body:Ae,headers:H,status:$,statusText:oe,url:he||void 0})),a.complete()):a.error(new gh({error:Ae,headers:H,status:$,statusText:oe,url:he||void 0}))},I=H=>{const{url:$}=E(),oe=new gh({error:H,status:u.status||0,statusText:u.statusText||"Unknown Error",url:$||void 0});a.error(oe)};let w=!1;const M=H=>{w||(a.next(E()),w=!0);let $={type:$r.DownloadProgress,loaded:H.loaded};H.lengthComputable&&($.total=H.total),"text"===n.responseType&&!!u.responseText&&($.partialText=u.responseText),a.next($)},F=H=>{let $={type:$r.UploadProgress,loaded:H.loaded};H.lengthComputable&&($.total=H.total),a.next($)};return u.addEventListener("load",C),u.addEventListener("error",I),u.addEventListener("timeout",I),u.addEventListener("abort",I),n.reportProgress&&(u.addEventListener("progress",M),null!==d&&u.upload&&u.upload.addEventListener("progress",F)),u.send(d),a.next({type:$r.Sent}),()=>{u.removeEventListener("error",I),u.removeEventListener("abort",I),u.removeEventListener("load",C),u.removeEventListener("timeout",I),n.reportProgress&&(u.removeEventListener("progress",M),null!==d&&u.upload&&u.upload.removeEventListener("progress",F)),u.readyState!==u.DONE&&u.abort()}})}}return e.\u0275fac=function(n){return new(n||e)(Fe(sT))},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})();const V0=new Et("XSRF_COOKIE_NAME"),j0=new Et("XSRF_HEADER_NAME");class jr{}let lB=(()=>{class e{constructor(n,a,u){this.doc=n,this.platform=a,this.cookieName=u,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=A1(n,this.cookieName),this.lastCookieString=n),this.lastToken}}return e.\u0275fac=function(n){return new(n||e)(Fe(Br),Fe(Hv),Fe(V0))},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})(),Q0=(()=>{class e{constructor(n,a){this.tokenService=n,this.headerName=a}intercept(n,a){const u=n.url.toLowerCase();if("GET"===n.method||"HEAD"===n.method||u.startsWith("http://")||u.startsWith("https://"))return a.handle(n);const d=this.tokenService.getToken();return null!==d&&!n.headers.has(this.headerName)&&(n=n.clone({headers:n.headers.set(this.headerName,d)})),a.handle(n)}}return e.\u0275fac=function(n){return new(n||e)(Fe(jr),Fe(j0))},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})(),dB=(()=>{class e{constructor(n,a){this.backend=n,this.injector=a,this.chain=null}handle(n){if(null===this.chain){const a=this.injector.get(aB,[]);this.chain=a.reduceRight((u,d)=>new sB(u,d),this.backend)}return this.chain.handle(n)}}return e.\u0275fac=function(n){return new(n||e)(Fe(L0),Fe(gi))},e.\u0275prov=ot({token:e,factory:e.\u0275fac}),e})(),hB=(()=>{class e{static disable(){return{ngModule:e,providers:[{provide:Q0,useClass:Fo}]}}static withOptions(n={}){return{ngModule:e,providers:[n.cookieName?{provide:V0,useValue:n.cookieName}:[],n.headerName?{provide:j0,useValue:n.headerName}:[]]}}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({providers:[Q0,{provide:aB,useExisting:Q0,multi:!0},{provide:jr,useClass:lB},{provide:V0,useValue:"XSRF-TOKEN"},{provide:j0,useValue:"X-XSRF-TOKEN"}]}),e})(),Ah=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({providers:[rD,{provide:k0,useClass:dB},iD,{provide:L0,useExisting:iD}],imports:[hB.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),e})(),pB=(()=>{class e{constructor(n){this.http=n}Post(n,a){return new Promise((u,d)=>{this.http.post(n,a).toPromise().then(m=>{u(m)},m=>{d(m)})})}Get(n,a={}){return new Promise((u,d)=>{this.http.get(n,a).toPromise().then(m=>{u(m)},m=>{d(m)})})}}return e.\u0275fac=function(n){return new(n||e)(Fe(rD))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),fB=(()=>{class e{constructor(n){this.api=n}generateToken(n,a,u=0){return this.api.Get(`https://agora-video-call-backend.onrender.com/rtcToken?channelName=${n}&uid=${a}`,{}).then(d=>d)}}return e.\u0275fac=function(n){return new(n||e)(Fe(pB))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const gB=["addListener","removeListener"],AB=["addEventListener","removeEventListener"],mB=["on","off"];function jn(e,r,n,a){if(U(n)&&(a=n,n=void 0),a)return jn(e,r,n).pipe(U1(a));const[u,d]=function s7(e){return U(e.addEventListener)&&U(e.removeEventListener)}(e)?AB.map(m=>E=>e[m](r,E,n)):function i7(e){return U(e.addListener)&&U(e.removeListener)}(e)?gB.map(oD(e,r)):function o7(e){return U(e.on)&&U(e.off)}(e)?mB.map(oD(e,r)):[];if(!u&&KC(e))return di(m=>jn(m,r,n))(Wi(e));if(!u)throw new TypeError("Invalid event target");return new Kn(m=>{const E=(...C)=>m.next(1<C.length?C:C[0]);return u(E),()=>d(E)})}function oD(e,r){return n=>a=>e[n](r,a)}class a7 extends Hr{constructor(r,n){super()}schedule(r,n=0){return this}}const G0={setInterval(e,r,...n){const{delegate:a}=G0;return a?.setInterval?a.setInterval(e,r,...n):setInterval(e,r,...n)},clearInterval(e){const{delegate:r}=G0;return(r?.clearInterval||clearInterval)(e)},delegate:void 0},_B={now:()=>(_B.delegate||Date).now(),delegate:void 0};class Ts{constructor(r,n=Ts.now){this.schedulerActionCtor=r,this.now=n}schedule(r,n=0,a){return new this.schedulerActionCtor(this,r).schedule(a,n)}}Ts.now=_B.now;const Lm=new class EB extends Ts{constructor(r,n=Ts.now){super(r,n),this.actions=[],this._active=!1}flush(r){const{actions:n}=this;if(this._active)return void n.push(r);let a;this._active=!0;do{if(a=r.execute(r.state,r.delay))break}while(r=n.shift());if(this._active=!1,a){for(;r=n.shift();)r.unsubscribe();throw a}}}(class sD extends a7{constructor(r,n){super(r,n),this.scheduler=r,this.work=n,this.pending=!1}schedule(r,n=0){var a;if(this.closed)return this;this.state=r;const u=this.id,d=this.scheduler;return null!=u&&(this.id=this.recycleAsyncId(d,u,n)),this.pending=!0,this.delay=n,this.id=null!==(a=this.id)&&void 0!==a?a:this.requestAsyncId(d,this.id,n),this}requestAsyncId(r,n,a=0){return G0.setInterval(r.flush.bind(r,this),a)}recycleAsyncId(r,n,a=0){if(null!=a&&this.delay===a&&!1===this.pending)return n;null!=n&&G0.clearInterval(n)}execute(r,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const a=this._execute(r,n);if(a)return a;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(r,n){let u,a=!1;try{this.work(r)}catch(d){a=!0,u=d||new Error("Scheduled action threw falsy error")}if(a)return this.unsubscribe(),u}unsubscribe(){if(!this.closed){const{id:r,scheduler:n}=this,{actions:a}=n;this.work=this.state=this.scheduler=null,this.pending=!1,rt(a,this),null!=r&&(this.id=this.recycleAsyncId(n,r,null)),this.delay=null,super.unsubscribe()}}}),vB=Lm;function H0(e=0,r,n=vB){let a=-1;return null!=r&&(Uw(r)?n=r:a=r),new Kn(u=>{let d=function CB(e){return e instanceof Date&&!isNaN(e)}(e)?+e-n.now():e;d<0&&(d=0);let m=0;return n.schedule(function(){u.closed||(u.next(m++),0<=a?this.schedule(void 0,a):u.complete())},d)})}const{isArray:yB}=Array;function aD(e){return 1===e.length&&yB(e[0])?e[0]:e}function IB(...e){return 1===(e=aD(e)).length?Wi(e[0]):new Kn(function SB(e){return r=>{let n=[];for(let a=0;n&&!r.closed&&a<e.length;a++)n.push(Wi(e[a]).subscribe(tn(r,u=>{if(n){for(let d=0;d<n.length;d++)d!==a&&n[d].unsubscribe();n=null}r.next(u)})))}}(e))}function mh(...e){const r=lg(e),n=aD(e);return n.length?new Kn(a=>{let u=n.map(()=>[]),d=n.map(()=>!1);a.add(()=>{u=d=null});for(let m=0;!a.closed&&m<n.length;m++)Wi(n[m]).subscribe(tn(a,E=>{if(u[m].push(E),u.every(C=>C.length)){const C=u.map(I=>I.shift());a.next(r?r(...C):C),u.some((I,w)=>!I.length&&d[w])&&a.complete()}},()=>{d[m]=!0,!u[m].length&&a.complete()}));return()=>{u=d=null}}):_a}function Ln(e){return Wr((r,n)=>{Wi(e).subscribe(tn(n,()=>n.complete(),id)),!n.closed&&r.subscribe(n)})}function Uo(...e){const r=lg(e);return Wr((n,a)=>{const u=e.length,d=new Array(u);let m=e.map(()=>!1),E=!1;for(let C=0;C<u;C++)Wi(e[C]).subscribe(tn(a,I=>{d[C]=I,!E&&!m[C]&&(m[C]=!0,(E=m.every(Jc))&&(m=null))},id));n.subscribe(tn(a,C=>{if(E){const I=[C,...d];a.next(r?r(...I):I)}}))})}function Fl(e,r){return r?n=>tf(r.pipe(Ni(1),function TB(){return Wr((e,r)=>{e.subscribe(tn(r,id))})}()),n.pipe(Fl(e))):di((n,a)=>e(n,a).pipe(Ni(1),sL(n)))}function _h(e,r=Lm){const n=H0(e,r);return Fl(()=>n)}new Kn(id);var K0={left:"right",right:"left",bottom:"top",top:"bottom"};function Eh(e){return e.replace(/left|right|bottom|top/g,function(r){return K0[r]})}function Ya(e){return e.split("-")[0]}var Qu={start:"end",end:"start"};function uD(e){return e.replace(/start|end/g,function(r){return Qu[r]})}var rs="top",sa="bottom",Rs="right",Ds="left",xm="auto",Bm=[rs,sa,Rs,Ds],ws="start",Of="end",Ch="viewport",Ar="popper",xn=Bm.reduce(function(e,r){return e.concat([r+"-"+ws,r+"-"+Of])},[]),Y0=[].concat(Bm,[xm]).reduce(function(e,r){return e.concat([r,r+"-"+ws,r+"-"+Of])},[]),Ns=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function en(e){if(null==e)return window;if("[object Window]"!==e.toString()){var r=e.ownerDocument;return r&&r.defaultView||window}return e}function Ul(e){return e instanceof en(e).Element||e instanceof Element}function Co(e){return e instanceof en(e).HTMLElement||e instanceof HTMLElement}function Fm(e){return!(typeof ShadowRoot>"u")&&(e instanceof en(e).ShadowRoot||e instanceof ShadowRoot)}function qa(e){return((Ul(e)?e.ownerDocument:e.document)||window.document).documentElement}var Vl=Math.max,Um=Math.min,Vc=Math.round;function J0(){var e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map(function(r){return r.brand+"/"+r.version}).join(" "):navigator.userAgent}function NB(){return!/^((?!chrome|android).)*safari/i.test(J0())}function Mf(e,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var a=e.getBoundingClientRect(),u=1,d=1;r&&Co(e)&&(u=e.offsetWidth>0&&Vc(a.width)/e.offsetWidth||1,d=e.offsetHeight>0&&Vc(a.height)/e.offsetHeight||1);var E=(Ul(e)?en(e):window).visualViewport,C=!NB()&&n,I=(a.left+(C&&E?E.offsetLeft:0))/u,w=(a.top+(C&&E?E.offsetTop:0))/d,M=a.width/u,F=a.height/d;return{width:M,height:F,top:w,right:I+M,bottom:w+F,left:I,x:I,y:w}}function z0(e){var r=en(e);return{scrollLeft:r.pageXOffset,scrollTop:r.pageYOffset}}function $0(e){return Mf(qa(e)).left+z0(e).scrollLeft}function Gu(e){return en(e).getComputedStyle(e)}function aa(e){return e?(e.nodeName||"").toLowerCase():null}function X0(e){return"html"===aa(e)?e:e.assignedSlot||e.parentNode||(Fm(e)?e.host:null)||qa(e)}function dD(e){var r=Gu(e);return/auto|scroll|overlay|hidden/.test(r.overflow+r.overflowY+r.overflowX)}function OB(e){return["html","body","#document"].indexOf(aa(e))>=0?e.ownerDocument.body:Co(e)&&dD(e)?e:OB(X0(e))}function Vm(e,r){var n;void 0===r&&(r=[]);var a=OB(e),u=a===(null==(n=e.ownerDocument)?void 0:n.body),d=en(a),m=u?[d].concat(d.visualViewport||[],dD(a)?a:[]):a,E=r.concat(m);return u?E:E.concat(Vm(X0(m)))}function kf(e){return["table","td","th"].indexOf(aa(e))>=0}function hD(e){return Co(e)&&"fixed"!==Gu(e).position?e.offsetParent:null}function jm(e){for(var r=en(e),n=hD(e);n&&kf(n)&&"static"===Gu(n).position;)n=hD(n);return n&&("html"===aa(n)||"body"===aa(n)&&"static"===Gu(n).position)?r:n||function h7(e){var r=/firefox/i.test(J0());if(/Trident/i.test(J0())&&Co(e)&&"fixed"===Gu(e).position)return null;var u=X0(e);for(Fm(u)&&(u=u.host);Co(u)&&["html","body"].indexOf(aa(u))<0;){var d=Gu(u);if("none"!==d.transform||"none"!==d.perspective||"paint"===d.contain||-1!==["transform","perspective"].indexOf(d.willChange)||r&&"filter"===d.willChange||r&&d.filter&&"none"!==d.filter)return u;u=u.parentNode}return null}(e)||r}function PB(e,r){var n=r.getRootNode&&r.getRootNode();if(e.contains(r))return!0;if(n&&Fm(n)){var a=r;do{if(a&&e.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function pD(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function MB(e,r,n){return r===Ch?pD(function l7(e,r){var n=en(e),a=qa(e),u=n.visualViewport,d=a.clientWidth,m=a.clientHeight,E=0,C=0;if(u){d=u.width,m=u.height;var I=NB();(I||!I&&"fixed"===r)&&(E=u.offsetLeft,C=u.offsetTop)}return{width:d,height:m,x:E+$0(e),y:C}}(e,n)):Ul(r)?function p7(e,r){var n=Mf(e,!1,"fixed"===r);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(r,n):pD(function d7(e){var r,n=qa(e),a=z0(e),u=null==(r=e.ownerDocument)?void 0:r.body,d=Vl(n.scrollWidth,n.clientWidth,u?u.scrollWidth:0,u?u.clientWidth:0),m=Vl(n.scrollHeight,n.clientHeight,u?u.scrollHeight:0,u?u.clientHeight:0),E=-a.scrollLeft+$0(e),C=-a.scrollTop;return"rtl"===Gu(u||n).direction&&(E+=Vl(n.clientWidth,u?u.clientWidth:0)-d),{width:d,height:m,x:E,y:C}}(qa(e)))}function Lf(e){return e.split("-")[1]}function fD(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function kB(e){var C,r=e.reference,n=e.element,a=e.placement,u=a?Ya(a):null,d=a?Lf(a):null,m=r.x+r.width/2-n.width/2,E=r.y+r.height/2-n.height/2;switch(u){case rs:C={x:m,y:r.y-n.height};break;case sa:C={x:m,y:r.y+r.height};break;case Rs:C={x:r.x+r.width,y:E};break;case Ds:C={x:r.x-n.width,y:E};break;default:C={x:r.x,y:r.y}}var I=u?fD(u):null;if(null!=I){var w="y"===I?"height":"width";switch(d){case ws:C[I]=C[I]-(r[w]/2-n[w]/2);break;case Of:C[I]=C[I]+(r[w]/2-n[w]/2)}}return C}function LB(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function xB(e,r){return r.reduce(function(n,a){return n[a]=e,n},{})}function Z0(e,r){void 0===r&&(r={});var a=r.placement,u=void 0===a?e.placement:a,d=r.strategy,m=void 0===d?e.strategy:d,E=r.boundary,C=void 0===E?"clippingParents":E,I=r.rootBoundary,w=void 0===I?Ch:I,M=r.elementContext,F=void 0===M?Ar:M,H=r.altBoundary,$=void 0!==H&&H,oe=r.padding,he=void 0===oe?0:oe,Ae=LB("number"!=typeof he?he:xB(he,Bm)),ge=e.rects.popper,De=e.elements[$?F===Ar?"reference":Ar:F],Ze=function g7(e,r,n,a){var u="clippingParents"===r?function f7(e){var r=Vm(X0(e)),a=["absolute","fixed"].indexOf(Gu(e).position)>=0&&Co(e)?jm(e):e;return Ul(a)?r.filter(function(u){return Ul(u)&&PB(u,a)&&"body"!==aa(u)}):[]}(e):[].concat(r),d=[].concat(u,[n]),E=d.reduce(function(C,I){var w=MB(e,I,a);return C.top=Vl(w.top,C.top),C.right=Um(w.right,C.right),C.bottom=Um(w.bottom,C.bottom),C.left=Vl(w.left,C.left),C},MB(e,d[0],a));return E.width=E.right-E.left,E.height=E.bottom-E.top,E.x=E.left,E.y=E.top,E}(Ul(De)?De:De.contextElement||qa(e.elements.popper),C,w,m),lt=Mf(e.elements.reference),pn=kB({reference:lt,element:ge,strategy:"absolute",placement:u}),Tn=pD(Object.assign({},ge,pn)),Nr=F===Ar?Tn:lt,st={top:Ze.top-Nr.top+Ae.top,bottom:Nr.bottom-Ze.bottom+Ae.bottom,left:Ze.left-Nr.left+Ae.left,right:Nr.right-Ze.right+Ae.right},hr=e.modifiersData.offset;if(F===Ar&&hr){var yo=hr[u];Object.keys(st).forEach(function(xi){var Gr=[Rs,sa].indexOf(xi)>=0?1:-1,fa=[rs,sa].indexOf(xi)>=0?"y":"x";st[xi]+=yo[fa]*Gr})}return st}const BB={name:"flip",enabled:!0,phase:"main",fn:function A7(e){var r=e.state,n=e.options,a=e.name;if(!r.modifiersData[a]._skip){for(var u=n.mainAxis,d=void 0===u||u,m=n.altAxis,E=void 0===m||m,C=n.fallbackPlacements,I=n.padding,w=n.boundary,M=n.rootBoundary,F=n.altBoundary,H=n.flipVariations,$=void 0===H||H,oe=n.allowedAutoPlacements,he=r.options.placement,Ae=Ya(he),ge=C||(Ae!==he&&$?function AD(e){if(Ya(e)===xm)return[];var r=Eh(e);return[uD(e),r,uD(r)]}(he):[Eh(he)]),De=[he].concat(ge).reduce(function(Lh,ed){return Lh.concat(Ya(ed)===xm?function Ih(e,r){void 0===r&&(r={});var u=r.boundary,d=r.rootBoundary,m=r.padding,E=r.flipVariations,C=r.allowedAutoPlacements,I=void 0===C?Y0:C,w=Lf(r.placement),M=w?E?xn:xn.filter(function($){return Lf($)===w}):Bm,F=M.filter(function($){return I.indexOf($)>=0});0===F.length&&(F=M);var H=F.reduce(function($,oe){return $[oe]=Z0(e,{placement:oe,boundary:u,rootBoundary:d,padding:m})[Ya(oe)],$},{});return Object.keys(H).sort(function($,oe){return H[$]-H[oe]})}(r,{placement:ed,boundary:w,rootBoundary:M,padding:I,flipVariations:$,allowedAutoPlacements:oe}):ed)},[]),Ze=r.rects.reference,lt=r.rects.popper,pn=new Map,Tn=!0,Nr=De[0],st=0;st<De.length;st++){var hr=De[st],yo=Ya(hr),xi=Lf(hr)===ws,Gr=[rs,sa].indexOf(yo)>=0,fa=Gr?"width":"height",Hi=Z0(r,{placement:hr,boundary:w,rootBoundary:M,altBoundary:F,padding:I}),ga=Gr?xi?Rs:Ds:xi?sa:rs;Ze[fa]>lt[fa]&&(ga=Eh(ga));var d_=Eh(ga),Hc=[];if(d&&Hc.push(Hi[yo]<=0),E&&Hc.push(Hi[ga]<=0,Hi[d_]<=0),Hc.every(function(Lh){return Lh})){Nr=hr,Tn=!1;break}pn.set(hr,Hc)}if(Tn)for(var eg=function(ed){var tg=De.find(function(f_){var Wc=pn.get(f_);if(Wc)return Wc.slice(0,ed).every(function(g_){return g_})});if(tg)return Nr=tg,"break"},Zl=$?3:1;Zl>0&&"break"!==eg(Zl);Zl--);r.placement!==Nr&&(r.modifiersData[a]._skip=!0,r.placement=Nr,r.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function xf(e,r,n){return Vl(e,Um(r,n))}function jl(e){var r=Mf(e),n=e.offsetWidth,a=e.offsetHeight;return Math.abs(r.width-n)<=1&&(n=r.width),Math.abs(r.height-a)<=1&&(a=r.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:a}}const UB={name:"preventOverflow",enabled:!0,phase:"main",fn:function mD(e){var r=e.state,n=e.options,a=e.name,u=n.mainAxis,d=void 0===u||u,m=n.altAxis,E=void 0!==m&&m,F=n.tether,H=void 0===F||F,$=n.tetherOffset,oe=void 0===$?0:$,he=Z0(r,{boundary:n.boundary,rootBoundary:n.rootBoundary,padding:n.padding,altBoundary:n.altBoundary}),Ae=Ya(r.placement),Ce=Lf(r.placement),ge=!Ce,De=fD(Ae),Ze=function FB(e){return"x"===e?"y":"x"}(De),lt=r.modifiersData.popperOffsets,pn=r.rects.reference,Tn=r.rects.popper,Nr="function"==typeof oe?oe(Object.assign({},r.rects,{placement:r.placement})):oe,st="number"==typeof Nr?{mainAxis:Nr,altAxis:Nr}:Object.assign({mainAxis:0,altAxis:0},Nr),hr=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,yo={x:0,y:0};if(lt){if(d){var xi,Gr="y"===De?rs:Ds,fa="y"===De?sa:Rs,Hi="y"===De?"height":"width",ga=lt[De],d_=ga+he[Gr],Hc=ga-he[fa],h_=H?-Tn[Hi]/2:0,eg=Ce===ws?pn[Hi]:Tn[Hi],Zl=Ce===ws?-Tn[Hi]:-pn[Hi],p_=r.elements.arrow,Lh=H&&p_?jl(p_):{width:0,height:0},ed=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},tg=ed[Gr],f_=ed[fa],Wc=xf(0,pn[Hi],Lh[Hi]),g_=ge?pn[Hi]/2-h_-Wc-tg-st.mainAxis:eg-Wc-tg-st.mainAxis,Iw=ge?-pn[Hi]/2+h_+Wc+f_+st.mainAxis:Zl+Wc+f_+st.mainAxis,Sw=r.elements.arrow&&jm(r.elements.arrow),Qt=null!=(xi=hr?.[De])?xi:0,MC=ga+Iw-Qt,zF=xf(H?Um(d_,ga+g_-Qt-(Sw?"y"===De?Sw.clientTop||0:Sw.clientLeft||0:0)):d_,ga,H?Vl(Hc,MC):Hc);lt[De]=zF,yo[De]=zF-ga}if(E){var Vo,td=lt[Ze],ng="y"===Ze?"height":"width",kC=td+he["x"===De?rs:Ds],ks=td-he["x"===De?sa:Rs],LC=-1!==[rs,Ds].indexOf(Ae),Lt=null!=(Vo=hr?.[Ze])?Vo:0,bw=LC?kC:td-pn[ng]-Tn[ng]-Lt+st.altAxis,zu=LC?td+pn[ng]+Tn[ng]-Lt-st.altAxis:ks,xC=H&&LC?function m7(e,r,n){var a=xf(e,r,n);return a>n?n:a}(bw,td,zu):xf(H?bw:kC,td,H?zu:ks);lt[Ze]=xC,yo[Ze]=xC-td}r.modifiersData[a]=yo}},requiresIfExists:["offset"]},E7={name:"arrow",enabled:!0,phase:"main",fn:function Ql(e){var r,n=e.state,a=e.name,u=e.options,d=n.elements.arrow,m=n.modifiersData.popperOffsets,E=Ya(n.placement),C=fD(E),w=[Ds,Rs].indexOf(E)>=0?"height":"width";if(d&&m){var M=function(r,n){return LB("number"!=typeof(r="function"==typeof r?r(Object.assign({},n.rects,{placement:n.placement})):r)?r:xB(r,Bm))}(u.padding,n),F=jl(d),H="y"===C?rs:Ds,$="y"===C?sa:Rs,oe=n.rects.reference[w]+n.rects.reference[C]-m[C]-n.rects.popper[w],he=m[C]-n.rects.reference[C],Ae=jm(d),Ce=Ae?"y"===C?Ae.clientHeight||0:Ae.clientWidth||0:0,lt=Ce/2-F[w]/2+(oe/2-he/2),pn=xf(M[H],lt,Ce-F[w]-M[$]);n.modifiersData[a]=((r={})[C]=pn,r.centerOffset=pn-lt,r)}},effect:function _7(e){var r=e.state,a=e.options.element,u=void 0===a?"[data-popper-arrow]":a;null!=u&&("string"==typeof u&&!(u=r.elements.popper.querySelector(u))||!PB(r.elements.popper,u)||(r.elements.arrow=u))},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function y7(e,r,n){void 0===n&&(n=!1);var a=Co(r),u=Co(r)&&function C7(e){var r=e.getBoundingClientRect(),n=Vc(r.width)/e.offsetWidth||1,a=Vc(r.height)/e.offsetHeight||1;return 1!==n||1!==a}(r),d=qa(r),m=Mf(e,u,n),E={scrollLeft:0,scrollTop:0},C={x:0,y:0};return(a||!a&&!n)&&(("body"!==aa(r)||dD(d))&&(E=function jB(e){return e!==en(e)&&Co(e)?function v7(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}(e):z0(e)}(r)),Co(r)?((C=Mf(r,!0)).x+=r.clientLeft,C.y+=r.clientTop):d&&(C.x=$0(d))),{x:m.left+E.scrollLeft-C.x,y:m.top+E.scrollTop-C.y,width:m.width,height:m.height}}function I7(e){var r=new Map,n=new Set,a=[];function u(d){n.add(d.name),[].concat(d.requires||[],d.requiresIfExists||[]).forEach(function(E){if(!n.has(E)){var C=r.get(E);C&&u(C)}}),a.push(d)}return e.forEach(function(d){r.set(d.name,d)}),e.forEach(function(d){n.has(d.name)||u(d)}),a}function eC(e){var r;return function(){return r||(r=new Promise(function(n){Promise.resolve().then(function(){r=void 0,n(e())})})),r}}var CD={placement:"bottom",modifiers:[],strategy:"absolute"};function yD(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return!r.some(function(a){return!(a&&"function"==typeof a.getBoundingClientRect)})}function S7(e){void 0===e&&(e={});var n=e.defaultModifiers,a=void 0===n?[]:n,u=e.defaultOptions,d=void 0===u?CD:u;return function(E,C,I){void 0===I&&(I=d);var w={placement:"bottom",orderedModifiers:[],options:Object.assign({},CD,d),modifiersData:{},elements:{reference:E,popper:C},attributes:{},styles:{}},M=[],F=!1,H={state:w,setOptions:function(Ae){var Ce="function"==typeof Ae?Ae(w.options):Ae;oe(),w.options=Object.assign({},d,w.options,Ce),w.scrollParents={reference:Ul(E)?Vm(E):E.contextElement?Vm(E.contextElement):[],popper:Vm(C)};var ge=function _D(e){var r=I7(e);return Ns.reduce(function(n,a){return n.concat(r.filter(function(u){return u.phase===a}))},[])}(function ED(e){var r=e.reduce(function(n,a){var u=n[a.name];return n[a.name]=u?Object.assign({},u,a,{options:Object.assign({},u.options,a.options),data:Object.assign({},u.data,a.data)}):a,n},{});return Object.keys(r).map(function(n){return r[n]})}([].concat(a,w.options.modifiers)));return w.orderedModifiers=ge.filter(function(hr){return hr.enabled}),function $(){w.orderedModifiers.forEach(function(he){var Ce=he.options,De=he.effect;if("function"==typeof De){var Ze=De({state:w,name:he.name,instance:H,options:void 0===Ce?{}:Ce});M.push(Ze||function(){})}})}(),H.update()},forceUpdate:function(){if(!F){var Ae=w.elements,Ce=Ae.reference,ge=Ae.popper;if(yD(Ce,ge)){w.rects={reference:y7(Ce,jm(ge),"fixed"===w.options.strategy),popper:jl(ge)},w.reset=!1,w.placement=w.options.placement,w.orderedModifiers.forEach(function(hr){return w.modifiersData[hr.name]=Object.assign({},hr.data)});for(var Ze=0;Ze<w.orderedModifiers.length;Ze++)if(!0!==w.reset){var lt=w.orderedModifiers[Ze],pn=lt.fn,Tn=lt.options;"function"==typeof pn&&(w=pn({state:w,options:void 0===Tn?{}:Tn,name:lt.name,instance:H})||w)}else w.reset=!1,Ze=-1}}},update:eC(function(){return new Promise(function(he){H.forceUpdate(),he(w)})}),destroy:function(){oe(),F=!0}};if(!yD(E,C))return H;function oe(){M.forEach(function(he){return he()}),M=[]}return H.setOptions(I).then(function(he){!F&&I.onFirstUpdate&&I.onFirstUpdate(he)}),H}}var tC={passive:!0},T7={top:"auto",right:"auto",bottom:"auto",left:"auto"};function GB(e){var r,n=e.popper,a=e.popperRect,u=e.placement,d=e.variation,m=e.offsets,E=e.position,C=e.gpuAcceleration,I=e.adaptive,w=e.roundOffsets,M=e.isFixed,F=m.x,H=void 0===F?0:F,$=m.y,oe=void 0===$?0:$,he="function"==typeof w?w({x:H,y:oe}):{x:H,y:oe};H=he.x,oe=he.y;var Ae=m.hasOwnProperty("x"),Ce=m.hasOwnProperty("y"),ge=Ds,De=rs,Ze=window;if(I){var lt=jm(n),pn="clientHeight",Tn="clientWidth";lt===en(n)&&"static"!==Gu(lt=qa(n)).position&&"absolute"===E&&(pn="scrollHeight",Tn="scrollWidth"),(u===rs||(u===Ds||u===Rs)&&d===Of)&&(De=sa,oe-=(M&&lt===Ze&&Ze.visualViewport?Ze.visualViewport.height:lt[pn])-a.height,oe*=C?1:-1),u!==Ds&&(u!==rs&&u!==sa||d!==Of)||(ge=Rs,H-=(M&&lt===Ze&&Ze.visualViewport?Ze.visualViewport.width:lt[Tn])-a.width,H*=C?1:-1)}var xi,hr=Object.assign({position:E},I&&T7),yo=!0===w?function R7(e){var n=e.y,u=window.devicePixelRatio||1;return{x:Vc(e.x*u)/u||0,y:Vc(n*u)/u||0}}({x:H,y:oe}):{x:H,y:oe};return H=yo.x,oe=yo.y,Object.assign({},hr,C?((xi={})[De]=Ce?"0":"",xi[ge]=Ae?"0":"",xi.transform=(Ze.devicePixelRatio||1)<=1?"translate("+H+"px, "+oe+"px)":"translate3d("+H+"px, "+oe+"px, 0)",xi):((r={})[De]=Ce?oe+"px":"",r[ge]=Ae?H+"px":"",r.transform="",r))}var Bf=S7({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function ID(e){var r=e.state,n=e.instance,a=e.options,u=a.scroll,d=void 0===u||u,m=a.resize,E=void 0===m||m,C=en(r.elements.popper),I=[].concat(r.scrollParents.reference,r.scrollParents.popper);return d&&I.forEach(function(w){w.addEventListener("scroll",n.update,tC)}),E&&C.addEventListener("resize",n.update,tC),function(){d&&I.forEach(function(w){w.removeEventListener("scroll",n.update,tC)}),E&&C.removeEventListener("resize",n.update,tC)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function SD(e){var r=e.state;r.modifiersData[e.name]=kB({reference:r.rects.reference,element:r.rects.popper,strategy:"absolute",placement:r.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function HB(e){var r=e.state,n=e.options,a=n.gpuAcceleration,u=void 0===a||a,d=n.adaptive,m=void 0===d||d,E=n.roundOffsets,C=void 0===E||E,w={placement:Ya(r.placement),variation:Lf(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:u,isFixed:"fixed"===r.options.strategy};null!=r.modifiersData.popperOffsets&&(r.styles.popper=Object.assign({},r.styles.popper,GB(Object.assign({},w,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:m,roundOffsets:C})))),null!=r.modifiersData.arrow&&(r.styles.arrow=Object.assign({},r.styles.arrow,GB(Object.assign({},w,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:C})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})},data:{}},{name:"applyStyles",enabled:!0,phase:"write",fn:function D7(e){var r=e.state;Object.keys(r.elements).forEach(function(n){var a=r.styles[n]||{},u=r.attributes[n]||{},d=r.elements[n];!Co(d)||!aa(d)||(Object.assign(d.style,a),Object.keys(u).forEach(function(m){var E=u[m];!1===E?d.removeAttribute(m):d.setAttribute(m,!0===E?"":E)}))})},effect:function WB(e){var r=e.state,n={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(r.elements.popper.style,n.popper),r.styles=n,r.elements.arrow&&Object.assign(r.elements.arrow.style,n.arrow),function(){Object.keys(r.elements).forEach(function(a){var u=r.elements[a],d=r.attributes[a]||{},E=Object.keys(r.styles.hasOwnProperty(a)?r.styles[a]:n[a]).reduce(function(C,I){return C[I]="",C},{});!Co(u)||!aa(u)||(Object.assign(u.style,E),Object.keys(d).forEach(function(C){u.removeAttribute(C)}))})}},requires:["computeStyles"]}]});const nC={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function O7(e){var r=e.state,a=e.name,u=e.options.offset,d=void 0===u?[0,0]:u,m=Y0.reduce(function(w,M){return w[M]=function N7(e,r,n){var a=Ya(e),u=[Ds,rs].indexOf(a)>=0?-1:1,d="function"==typeof n?n(Object.assign({},r,{placement:e})):n,m=d[0],E=d[1];return m=m||0,E=(E||0)*u,[Ds,Rs].indexOf(a)>=0?{x:E,y:m}:{x:m,y:E}}(M,r.rects,d),w},{}),E=m[r.placement],I=E.y;null!=r.modifiersData.popperOffsets&&(r.modifiersData.popperOffsets.x+=E.x,r.modifiersData.popperOffsets.y+=I),r.modifiersData[a]=m}},iC=["*"],z7=["dialog"];function c9(e,r){1&e&&ti(0),2&e&&ml(nt(2).title)}function u9(e,r){}function Ym(e,r){if(1&e&&(Ge(0,"h3",3),ke(1,c9,1,1,"ng-template",null,4,xr),ke(3,u9,0,0,"ng-template",5),He()),2&e){const n=qn(2),a=nt();$e(3),Ue("ngTemplateOutlet",a.isTitleTemplate()?a.title:n)("ngTemplateOutletContext",a.context)}}function lC(e){return"string"==typeof e}function Gl(e){return null!=e}function Hl(e){return(e||document.body).getBoundingClientRect()}const bh={animation:!0,transitionTimerDelayMs:5},Qc=()=>{},{transitionTimerDelayMs:p3}=bh,Xa=new Map,Qr=(e,r,n,a)=>{let u=a.context||{};const d=Xa.get(r);if(d)switch(a.runningTransition){case"continue":return _a;case"stop":e.run(()=>d.transition$.complete()),u=Object.assign(d.context,u),Xa.delete(r)}const m=n(r,a.animation,u)||Qc;if(!a.animation||"none"===window.getComputedStyle(r).transitionProperty)return e.run(()=>m()),ct(void 0).pipe(function UD(e){return r=>new Kn(n=>r.subscribe({next:m=>e.run(()=>n.next(m)),error:m=>e.run(()=>n.error(m)),complete:()=>e.run(()=>n.complete())}))}(e));const E=new Or,C=new Or,I=E.pipe(function c7(...e){return r=>tf(r,ct(...e))}(!0));Xa.set(r,{transition$:E,complete:()=>{C.next(),C.complete()},context:u});const w=function VD(e){const{transitionDelay:r,transitionDuration:n}=window.getComputedStyle(e);return 1e3*(parseFloat(r)+parseFloat(n))}(r);return e.runOutsideAngular(()=>{const M=jn(r,"transitionend").pipe(Ln(I),mi(({target:H})=>H===r));IB(H0(w+p3).pipe(Ln(I)),M,C).pipe(Ln(I)).subscribe(()=>{Xa.delete(r),e.run(()=>{m(),E.next(),E.complete()})})}),E.asObservable()};let no=(()=>{class e{constructor(){this.animation=bh.animation}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Gc=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[vs]}),e})(),v3=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[vs]}),e})(),HD=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[vs]}),e})(),WD=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({}),e})();var ai=(()=>{return(e=ai||(ai={}))[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.ArrowLeft=37]="ArrowLeft",e[e.ArrowUp=38]="ArrowUp",e[e.ArrowRight=39]="ArrowRight",e[e.ArrowDown=40]="ArrowDown",ai;var e})();const Wf=(e,r)=>!!r&&r.some(n=>n.contains(e)),B3=(e,r)=>!r||null!=function FD(e,r){return!r||typeof e.closest>"u"?null:e.closest(r)}(e,r),YD=typeof navigator<"u"&&!!navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));function e_(e,r,n,a,u,d,m,E){n&&e.runOutsideAngular((e=>YD?()=>setTimeout(()=>e(),100):e)(()=>{const I=jn(r,"keydown").pipe(Ln(u),mi(F=>F.which===ai.Escape),_i(F=>F.preventDefault())),w=jn(r,"mousedown").pipe(Ot(F=>{const H=F.target;return 2!==F.button&&!Wf(H,m)&&("inside"===n?Wf(H,d)&&B3(H,E):"outside"===n?!Wf(H,d):B3(H,E)||!Wf(H,d))}),Ln(u)),M=jn(r,"mouseup").pipe(Uo(w),mi(([F,H])=>H),_h(0),Ln(u));IB([I.pipe(Ot(F=>0)),M.pipe(Ot(F=>1))]).subscribe(F=>e.run(()=>a(F)))}))}const qD=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function pC(e){const r=Array.from(e.querySelectorAll(qD)).filter(n=>-1!==n.tabIndex);return[r[0],r[r.length-1]]}const JD=/\s+/,x9=/  +/gi,zD=/^start/,U3=/^end/,V3=/-(top|left)$/,j3=/-(bottom|right)$/,Q3=/^left/,t_=/^right/,F9=/^start/,G3=/^end/;function H3({placement:e,baseClass:r}){let n=Array.isArray(e)?e:e.split(JD),u=n.findIndex(C=>"auto"===C);u>=0&&["top","bottom","start","end","top-start","top-end","bottom-start","bottom-end","start-top","start-bottom","end-top","end-bottom"].forEach(function(C){null==n.find(I=>-1!==I.search("^"+C))&&n.splice(u++,1,C)});const d=n.map(C=>function B9(e){return e.replace(zD,"left").replace(U3,"right").replace(V3,"-start").replace(j3,"-end")}(C));return{placement:d.shift(),modifiers:[{name:"bootstrapClasses",enabled:!!r,phase:"write",fn({state:C}){const I=new RegExp(r+"(-[a-z]+)*","gi"),w=C.elements.popper,M=C.placement;let F=w.className;F=F.replace(I,""),F+=` ${function ro(e,r){let[n,a]=r.split("-");const u=n.replace(Q3,"start").replace(t_,"end");let d=[u];if(a){let m=a;("left"===n||"right"===n)&&(m=m.replace(F9,"top").replace(G3,"bottom")),d.push(`${u}-${m}`)}return e&&(d=d.map(m=>`${e}-${m}`)),d.join(" ")}(r,M)}`,F=F.trim().replace(x9," "),w.className=F}},BB,UB,E7,{enabled:!0,name:"flip",options:{fallbackPlacements:d}},{enabled:!0,name:"preventOverflow",phase:"main",fn:function(){}}]}}function $D(e){return e}function fC(){let e=null;return{createPopper(r){if(!e){let a=(r.updatePopperOptions||$D)(H3(r));e=Bf(r.hostElement,r.targetElement,a)}},update(){e&&e.update()},setOptions(r){if(e){let a=(r.updatePopperOptions||$D)(H3(r));e.setOptions(a)}},destroy(){e&&(e.destroy(),e=null)}}}function W3(e){return r=>(r.modifiers.push(nC,{name:"offset",options:{offset:()=>e}}),r)}new Date(1882,10,12),new Date(2174,10,25);let AC=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[vs,zR]}),e})(),tF=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({}),e})();class Dh{constructor(r,n,a){this.nodes=r,this.viewRef=n,this.componentRef=a}}class nF{constructor(r,n,a,u,d,m){this._componentType=r,this._injector=n,this._viewContainerRef=a,this._renderer=u,this._ngZone=d,this._applicationRef=m,this._windowRef=null,this._contentRef=null}open(r,n,a=!1){this._windowRef||(this._contentRef=this._getContentRef(r,n),this._windowRef=this._viewContainerRef.createComponent(this._componentType,{injector:this._injector,projectableNodes:this._contentRef.nodes}));const{nativeElement:u}=this._windowRef.location,d=this._ngZone.onStable.pipe(Ni(1),di(()=>Qr(this._ngZone,u,({classList:m})=>m.add("show"),{animation:a,runningTransition:"continue"})));return{windowRef:this._windowRef,transition$:d}}close(r=!1){return this._windowRef?Qr(this._ngZone,this._windowRef.location.nativeElement,({classList:n})=>n.remove("show"),{animation:r,runningTransition:"stop"}).pipe(_i(()=>{this._windowRef&&(this._viewContainerRef.remove(this._viewContainerRef.indexOf(this._windowRef.hostView)),this._windowRef=null),this._contentRef?.viewRef&&(this._applicationRef.detachView(this._contentRef.viewRef),this._contentRef.viewRef.destroy(),this._contentRef=null)})):ct(void 0)}_getContentRef(r,n){if(r){if(r instanceof gr){const a=r.createEmbeddedView(n);return this._applicationRef.attachView(a),new Dh([a.rootNodes],a)}return new Dh([[this._renderer.createText(`${r}`)]])}return new Dh([])}}let rF=(()=>{class e{constructor(n,a){this._el=n,this._zone=a}ngOnInit(){this._zone.onStable.asObservable().pipe(Ni(1)).subscribe(()=>{Qr(this._zone,this._el.nativeElement,(n,a)=>{a&&Hl(n),n.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return Qr(this._zone,this._el.nativeElement,({classList:n})=>n.remove("show"),{animation:this.animation,runningTransition:"stop"})}}return e.\u0275fac=function(n){return new(n||e)(se(Qn),se(Gn))},e.\u0275cmp=So({type:e,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1055"],hostVars:6,hostBindings:function(n,a){2&n&&(Js("modal-backdrop"+(a.backdropClass?" "+a.backdropClass:"")),pr("show",!a.animation)("fade",a.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},decls:0,vars:0,template:function(n,a){},encapsulation:2}),e})();class iF{close(r){}dismiss(r){}}class uG{constructor(r,n,a,u){this._windowCmptRef=r,this._contentRef=n,this._backdropCmptRef=a,this._beforeDismiss=u,this._closed=new Or,this._dismissed=new Or,this._hidden=new Or,r.instance.dismissEvent.subscribe(d=>{this.dismiss(d)}),this.result=new Promise((d,m)=>{this._resolve=d,this._reject=m}),this.result.then(null,()=>{})}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(Ln(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(Ln(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}close(r){this._windowCmptRef&&(this._closed.next(r),this._resolve(r),this._removeModalElements())}_dismiss(r){this._dismissed.next(r),this._reject(r),this._removeModalElements()}dismiss(r){if(this._windowCmptRef)if(this._beforeDismiss){const n=this._beforeDismiss();!function LD(e){return e&&e.then}(n)?!1!==n&&this._dismiss(r):n.then(a=>{!1!==a&&this._dismiss(r)},()=>{})}else this._dismiss(r)}_removeModalElements(){const r=this._windowCmptRef.instance.hide(),n=this._backdropCmptRef?this._backdropCmptRef.instance.hide():ct(void 0);r.subscribe(()=>{const{nativeElement:a}=this._windowCmptRef.location;a.parentNode.removeChild(a),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),n.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:a}=this._backdropCmptRef.location;a.parentNode.removeChild(a),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),mh(r,n).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var s_=(()=>{return(e=s_||(s_={}))[e.BACKDROP_CLICK=0]="BACKDROP_CLICK",e[e.ESC=1]="ESC",s_;var e})();let oF=(()=>{class e{constructor(n,a,u){this._document=n,this._elRef=a,this._zone=u,this._closed$=new Or,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new Ft,this.shown=new Or,this.hidden=new Or}get fullscreenClass(){return!0===this.fullscreen?" modal-fullscreen":lC(this.fullscreen)?` modal-fullscreen-${this.fullscreen}-down`:""}dismiss(n){this.dismissEvent.emit(n)}ngOnInit(){this._elWithFocus=this._document.activeElement,this._zone.onStable.asObservable().pipe(Ni(1)).subscribe(()=>{this._show()})}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:n}=this._elRef,a={animation:this.animation,runningTransition:"stop"},m=mh(Qr(this._zone,n,()=>n.classList.remove("show"),a),Qr(this._zone,this._dialogEl.nativeElement,()=>{},a));return m.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),m}_show(){const n={animation:this.animation,runningTransition:"continue"};mh(Qr(this._zone,this._elRef.nativeElement,(d,m)=>{m&&Hl(d),d.classList.add("show")},n),Qr(this._zone,this._dialogEl.nativeElement,()=>{},n)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:n}=this._elRef;this._zone.runOutsideAngular(()=>{jn(n,"keydown").pipe(Ln(this._closed$),mi(u=>u.which===ai.Escape)).subscribe(u=>{this.keyboard?requestAnimationFrame(()=>{u.defaultPrevented||this._zone.run(()=>this.dismiss(s_.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let a=!1;jn(this._dialogEl.nativeElement,"mousedown").pipe(Ln(this._closed$),_i(()=>a=!1),ta(()=>jn(n,"mouseup").pipe(Ln(this._closed$),Ni(1))),mi(({target:u})=>n===u)).subscribe(()=>{a=!0}),jn(n,"click").pipe(Ln(this._closed$)).subscribe(({target:u})=>{n===u&&("static"===this.backdrop?this._bumpBackdrop():!0===this.backdrop&&!a&&this._zone.run(()=>this.dismiss(s_.BACKDROP_CLICK))),a=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:n}=this._elRef;if(!n.contains(document.activeElement)){const a=n.querySelector("[ngbAutofocus]"),u=pC(n)[0];(a||u||n).focus()}}_restoreFocus(){const n=this._document.body,a=this._elWithFocus;let u;u=a&&a.focus&&n.contains(a)?a:n,this._zone.runOutsideAngular(()=>{setTimeout(()=>u.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&Qr(this._zone,this._elRef.nativeElement,({classList:n})=>(n.add("modal-static"),()=>n.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}}return e.\u0275fac=function(n){return new(n||e)(se(Br),se(Qn),se(Gn))},e.\u0275cmp=So({type:e,selectors:[["ngb-modal-window"]],viewQuery:function(n,a){if(1&n&&ab(z7,7),2&n){let u;kr(u=function Lr(){return function qP(e,r){return e[19].queries[r].queryList}(ve(),ru())}())&&(a._dialogEl=u.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(n,a){2&n&&(Mn("aria-modal",!0)("aria-labelledby",a.ariaLabelledBy)("aria-describedby",a.ariaDescribedBy),Js("modal d-block"+(a.windowClass?" "+a.windowClass:"")),pr("fade",a.animation))},inputs:{animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",backdrop:"backdrop",centered:"centered",fullscreen:"fullscreen",keyboard:"keyboard",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},ngContentSelectors:iC,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(n,a){1&n&&(yp(),Ge(0,"div",0,1)(2,"div",2),Ip(3),He()()),2&n&&Js("modal-dialog"+(a.size?" modal-"+a.size:"")+(a.centered?" modal-dialog-centered":"")+a.fullscreenClass+(a.scrollable?" modal-dialog-scrollable":"")+(a.modalDialogClass?" "+a.modalDialogClass:""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}\n"],encapsulation:2}),e})(),sF=(()=>{class e{constructor(n){this._document=n}hide(){const n=Math.abs(window.innerWidth-this._document.documentElement.clientWidth),a=this._document.body,u=a.style,{overflow:d,paddingRight:m}=u;if(n>0){const E=parseFloat(window.getComputedStyle(a).paddingRight);u.paddingRight=`${E+n}px`}return u.overflow="hidden",()=>{n>0&&(u.paddingRight=m),u.overflow=d}}}return e.\u0275fac=function(n){return new(n||e)(Fe(Br))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),aF=(()=>{class e{constructor(n,a,u,d,m,E){this._applicationRef=n,this._injector=a,this._document=u,this._scrollBar=d,this._rendererFactory=m,this._ngZone=E,this._activeWindowCmptHasChanged=new Or,this._ariaHiddenValues=new Map,this._scrollBarRestoreFn=null,this._backdropAttributes=["animation","backdropClass"],this._modalRefs=[],this._windowAttributes=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","fullscreen","keyboard","scrollable","size","windowClass","modalDialogClass"],this._windowCmpts=[],this._activeInstances=new Ft,this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const C=this._windowCmpts[this._windowCmpts.length-1];((e,r,n,a=!1)=>{this._ngZone.runOutsideAngular(()=>{const u=jn(r,"focusin").pipe(Ln(n),Ot(d=>d.target));jn(r,"keydown").pipe(Ln(n),mi(d=>d.which===ai.Tab),Uo(u)).subscribe(([d,m])=>{const[E,C]=pC(r);(m===E||m===r)&&d.shiftKey&&(C.focus(),d.preventDefault()),m===C&&!d.shiftKey&&(E.focus(),d.preventDefault())}),a&&jn(r,"click").pipe(Ln(n),Uo(u),Ot(d=>d[1])).subscribe(d=>d.focus())})})(0,C.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(C.location.nativeElement)}})}_restoreScrollBar(){const n=this._scrollBarRestoreFn;n&&(this._scrollBarRestoreFn=null,n())}_hideScrollBar(){this._scrollBarRestoreFn||(this._scrollBarRestoreFn=this._scrollBar.hide())}open(n,a,u){const d=u.container instanceof HTMLElement?u.container:Gl(u.container)?this._document.querySelector(u.container):this._document.body,m=this._rendererFactory.createRenderer(null,null);if(!d)throw new Error(`The specified modal container "${u.container||"body"}" was not found in the DOM.`);this._hideScrollBar();const E=new iF,C=this._getContentRef(u.injector||n,a,E,u);let I=!1!==u.backdrop?this._attachBackdrop(d):void 0,w=this._attachWindowComponent(d,C.nodes),M=new uG(w,C,I,u.beforeDismiss);return this._registerModalRef(M),this._registerWindowCmpt(w),M.hidden.pipe(Ni(1)).subscribe(()=>Promise.resolve(!0).then(()=>{this._modalRefs.length||(m.removeClass(this._document.body,"modal-open"),this._restoreScrollBar(),this._revertAriaHidden())})),E.close=F=>{M.close(F)},E.dismiss=F=>{M.dismiss(F)},this._applyWindowOptions(w.instance,u),1===this._modalRefs.length&&m.addClass(this._document.body,"modal-open"),I&&I.instance&&(this._applyBackdropOptions(I.instance,u),I.changeDetectorRef.detectChanges()),w.changeDetectorRef.detectChanges(),M}get activeInstances(){return this._activeInstances}dismissAll(n){this._modalRefs.forEach(a=>a.dismiss(n))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(n){let a=Gb(rF,{environmentInjector:this._applicationRef.injector,elementInjector:this._injector});return this._applicationRef.attachView(a.hostView),n.appendChild(a.location.nativeElement),a}_attachWindowComponent(n,a){let u=Gb(oF,{environmentInjector:this._applicationRef.injector,elementInjector:this._injector,projectableNodes:a});return this._applicationRef.attachView(u.hostView),n.appendChild(u.location.nativeElement),u}_applyWindowOptions(n,a){this._windowAttributes.forEach(u=>{Gl(a[u])&&(n[u]=a[u])})}_applyBackdropOptions(n,a){this._backdropAttributes.forEach(u=>{Gl(a[u])&&(n[u]=a[u])})}_getContentRef(n,a,u,d){return a?a instanceof gr?this._createFromTemplateRef(a,u):lC(a)?this._createFromString(a):this._createFromComponent(n,a,u,d):new Dh([])}_createFromTemplateRef(n,a){const d=n.createEmbeddedView({$implicit:a,close(m){a.close(m)},dismiss(m){a.dismiss(m)}});return this._applicationRef.attachView(d),new Dh([d.rootNodes],d)}_createFromString(n){const a=this._document.createTextNode(`${n}`);return new Dh([[a]])}_createFromComponent(n,a,u,d){const m=gi.create({providers:[{provide:iF,useValue:u}],parent:n}),E=Gb(a,{environmentInjector:this._applicationRef.injector,elementInjector:m}),C=E.location.nativeElement;return d.scrollable&&C.classList.add("component-host-scrollable"),this._applicationRef.attachView(E.hostView),new Dh([[C]],E.hostView,E)}_setAriaHidden(n){const a=n.parentElement;a&&n!==this._document.body&&(Array.from(a.children).forEach(u=>{u!==n&&"SCRIPT"!==u.nodeName&&(this._ariaHiddenValues.set(u,u.getAttribute("aria-hidden")),u.setAttribute("aria-hidden","true"))}),this._setAriaHidden(a))}_revertAriaHidden(){this._ariaHiddenValues.forEach((n,a)=>{n?a.setAttribute("aria-hidden",n):a.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(n){const a=()=>{const u=this._modalRefs.indexOf(n);u>-1&&(this._modalRefs.splice(u,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(n),this._activeInstances.emit(this._modalRefs),n.result.then(a,a)}_registerWindowCmpt(n){this._windowCmpts.push(n),this._activeWindowCmptHasChanged.next(),n.onDestroy(()=>{const a=this._windowCmpts.indexOf(n);a>-1&&(this._windowCmpts.splice(a,1),this._activeWindowCmptHasChanged.next())})}}return e.\u0275fac=function(n){return new(n||e)(Fe($d),Fe(gi),Fe(Br),Fe(sF),Fe(SE),Fe(Gn))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),cF=(()=>{class e{constructor(n){this._ngbConfig=n,this.backdrop=!0,this.fullscreen=!1,this.keyboard=!0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(n){this._animation=n}}return e.\u0275fac=function(n){return new(n||e)(Fe(no))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),lG=(()=>{class e{constructor(n,a,u){this._injector=n,this._modalStack=a,this._config=u}open(n,a={}){const u={...this._config,animation:this._config.animation,...a};return this._modalStack.open(this._injector,n,u)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(n){this._modalStack.dismissAll(n)}hasOpenModals(){return this._modalStack.hasOpenModals()}}return e.\u0275fac=function(n){return new(n||e)(Fe(gi),Fe(aF),Fe(cF))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),uF=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({providers:[lG]}),e})(),dF=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[vs]}),e})(),ui=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[vs]}),e})();class fG{constructor(r,n){this.open=r,this.close=n,n||(this.close=r)}isManual(){return"manual"===this.open||"manual"===this.close}}const gG={hover:["mouseenter","mouseleave"],focus:["focusin","focusout"]},IC=e=>e>0?_h(e):r=>r;function AF(e,r,n,a,u,d,m=0,E=0){const C=function AG(e,r=gG){const n=(e||"").trim();if(0===n.length)return[];const a=n.split(/\s+/).map(d=>d.split(":")).map(d=>{let m=r[d[0]]||d;return new fG(m[0],m[1])}),u=a.filter(d=>d.isManual());if(u.length>1)throw"Triggers parse error: only one manual trigger is allowed";if(1===u.length&&a.length>1)throw"Triggers parse error: manual trigger can't be mixed with other triggers";return a}(n);if(1===C.length&&C[0].isManual())return()=>{};const I=function mG(e,r,n,a){return new Kn(u=>{const d=[],m=()=>u.next(!0),E=()=>u.next(!1),C=()=>u.next(!a());return n.forEach(I=>{I.open===I.close?d.push(e.listen(r,I.open,C)):d.push(e.listen(r,I.open,m),e.listen(r,I.close,E))}),()=>{d.forEach(I=>I())}})}(e,r,C,a).pipe(function aw(e,r,n){return a=>{let u=null;const d=a.pipe(Ot(C=>({open:C})),mi(C=>{const I=n();return I===C.open||u&&u.open!==I?(u&&u.open!==C.open&&(u=null),!1):(u=C,!0)}),Kw());return Ww(d.pipe(mi(C=>C.open),IC(e)),d.pipe(mi(C=>!C.open),IC(r))).pipe(mi(C=>C===u&&(u=null,C.open!==n())),Ot(C=>C.open))}}(m,E,a)).subscribe(w=>w?u():d());return()=>I.unsubscribe()}let SC=(()=>{class e{constructor(n){this._ngbConfig=n,this.autoClose=!0,this.placement="auto",this.triggers="click",this.disablePopover=!1,this.openDelay=0,this.closeDelay=0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(n){this._animation=n}}return e.\u0275fac=function(n){return new(n||e)(Fe(no))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),cw=0,mF=(()=>{class e{isTitleTemplate(){return this.title instanceof gr}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=So({type:e,selectors:[["ngb-popover-window"]],hostAttrs:["role","tooltip"],hostVars:5,hostBindings:function(n,a){2&n&&(_l("id",a.id),Js("popover"+(a.popoverClass?" "+a.popoverClass:"")),pr("fade",a.animation))},inputs:{animation:"animation",title:"title",id:"id",popoverClass:"popoverClass",context:"context"},ngContentSelectors:iC,decls:4,vars:1,consts:[["data-popper-arrow","",1,"popover-arrow"],["class","popover-header",4,"ngIf"],[1,"popover-body"],[1,"popover-header"],["simpleTitle",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,a){1&n&&(yp(),Ir(0,"div",0),ke(1,Ym,4,2,"h3",1),Ge(2,"div",2),Ip(3),He()),2&n&&($e(1),Ue("ngIf",a.title))},dependencies:[Sl,Du],encapsulation:2,changeDetection:0}),e})(),uw=(()=>{class e{constructor(n,a,u,d,m,E,C,I,w){this._elementRef=n,this._renderer=a,this._ngZone=E,this._document=C,this._changeDetector=I,this.shown=new Ft,this.hidden=new Ft,this._ngbPopoverWindowId="ngb-popover-"+cw++,this._windowRef=null,this._positioning=fC(),this.animation=m.animation,this.autoClose=m.autoClose,this.placement=m.placement,this.triggers=m.triggers,this.container=m.container,this.disablePopover=m.disablePopover,this.popoverClass=m.popoverClass,this.openDelay=m.openDelay,this.closeDelay=m.closeDelay,this._popupService=new nF(mF,u,d,a,this._ngZone,w)}_isDisabled(){return!(!this.disablePopover&&(this.ngbPopover||this.popoverTitle))}open(n){if(!this._windowRef&&!this._isDisabled()){const{windowRef:a,transition$:u}=this._popupService.open(this.ngbPopover,n,this.animation);this._windowRef=a,this._windowRef.setInput("animation",this.animation),this._windowRef.setInput("title",this.popoverTitle),this._windowRef.setInput("context",n),this._windowRef.setInput("popoverClass",this.popoverClass),this._windowRef.setInput("id",this._ngbPopoverWindowId),this._renderer.setAttribute(this._elementRef.nativeElement,"aria-describedby",this._ngbPopoverWindowId),"body"===this.container&&this._document.querySelector(this.container).appendChild(this._windowRef.location.nativeElement),this._windowRef.changeDetectorRef.detectChanges(),this._windowRef.changeDetectorRef.markForCheck(),this._ngZone.runOutsideAngular(()=>{this._positioning.createPopper({hostElement:this._elementRef.nativeElement,targetElement:this._windowRef.location.nativeElement,placement:this.placement,appendToBody:"body"===this.container,baseClass:"bs-popover",updatePopperOptions:W3([0,8])}),Promise.resolve().then(()=>{this._positioning.update(),this._zoneSubscription=this._ngZone.onStable.subscribe(()=>this._positioning.update())})}),e_(this._ngZone,this._document,this.autoClose,()=>this.close(),this.hidden,[this._windowRef.location.nativeElement]),u.subscribe(()=>this.shown.emit())}}close(n=this.animation){this._windowRef&&(this._renderer.removeAttribute(this._elementRef.nativeElement,"aria-describedby"),this._popupService.close(n).subscribe(()=>{this._windowRef=null,this._positioning.destroy(),this._zoneSubscription?.unsubscribe(),this.hidden.emit(),this._changeDetector.markForCheck()}))}toggle(){this._windowRef?this.close():this.open()}isOpen(){return null!=this._windowRef}ngOnInit(){this._unregisterListenersFn=AF(this._renderer,this._elementRef.nativeElement,this.triggers,this.isOpen.bind(this),this.open.bind(this),this.close.bind(this),+this.openDelay,+this.closeDelay)}ngOnChanges({ngbPopover:n,popoverTitle:a,disablePopover:u,popoverClass:d}){d&&this.isOpen()&&(this._windowRef.instance.popoverClass=d.currentValue),(n||a||u)&&this._isDisabled()&&this.close()}ngOnDestroy(){this.close(!1),this._unregisterListenersFn?.()}}return e.\u0275fac=function(n){return new(n||e)(se(Qn),se(gs),se(gi),se(As),se(SC),se(Gn),se(Br),se(ms),se($d))},e.\u0275dir=We({type:e,selectors:[["","ngbPopover",""]],inputs:{animation:"animation",autoClose:"autoClose",ngbPopover:"ngbPopover",popoverTitle:"popoverTitle",placement:"placement",triggers:"triggers",container:"container",disablePopover:"disablePopover",popoverClass:"popoverClass",openDelay:"openDelay",closeDelay:"closeDelay"},outputs:{shown:"shown",hidden:"hidden"},exportAs:["ngbPopover"],features:[Fi]}),e})(),Xf=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[vs]}),e})(),lw=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[vs]}),e})(),dw=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[vs]}),e})(),CF=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[vs]}),e})(),yF=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[vs]}),e})(),IF=(()=>{class e{constructor(n){this._ngbConfig=n,this.autoClose=!0,this.placement="auto",this.triggers="hover focus",this.disableTooltip=!1,this.openDelay=0,this.closeDelay=0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(n){this._animation=n}}return e.\u0275fac=function(n){return new(n||e)(Fe(no))},e.\u0275prov=ot({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),tc=0,$l=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=So({type:e,selectors:[["ngb-tooltip-window"]],hostAttrs:["role","tooltip"],hostVars:5,hostBindings:function(n,a){2&n&&(_l("id",a.id),Js("tooltip"+(a.tooltipClass?" "+a.tooltipClass:"")),pr("fade",a.animation))},inputs:{animation:"animation",id:"id",tooltipClass:"tooltipClass"},ngContentSelectors:iC,decls:3,vars:0,consts:[["data-popper-arrow","",1,"tooltip-arrow"],[1,"tooltip-inner"]],template:function(n,a){1&n&&(yp(),Ir(0,"div",0),Ge(1,"div",1),Ip(2),He())},encapsulation:2,changeDetection:0}),e})(),Oh=(()=>{class e{constructor(n,a,u,d,m,E,C,I,w){this._elementRef=n,this._renderer=a,this._ngZone=E,this._document=C,this._changeDetector=I,this.shown=new Ft,this.hidden=new Ft,this._ngbTooltipWindowId="ngb-tooltip-"+tc++,this._windowRef=null,this._positioning=fC(),this.animation=m.animation,this.autoClose=m.autoClose,this.placement=m.placement,this.triggers=m.triggers,this.container=m.container,this.disableTooltip=m.disableTooltip,this.tooltipClass=m.tooltipClass,this.openDelay=m.openDelay,this.closeDelay=m.closeDelay,this._popupService=new nF($l,u,d,a,this._ngZone,w)}set ngbTooltip(n){this._ngbTooltip=n,!n&&this._windowRef&&this.close()}get ngbTooltip(){return this._ngbTooltip}open(n){if(!this._windowRef&&this._ngbTooltip&&!this.disableTooltip){const{windowRef:a,transition$:u}=this._popupService.open(this._ngbTooltip,n,this.animation);this._windowRef=a,this._windowRef.setInput("animation",this.animation),this._windowRef.setInput("tooltipClass",this.tooltipClass),this._windowRef.setInput("id",this._ngbTooltipWindowId),this._renderer.setAttribute(this._elementRef.nativeElement,"aria-describedby",this._ngbTooltipWindowId),"body"===this.container&&this._document.querySelector(this.container).appendChild(this._windowRef.location.nativeElement),this._windowRef.changeDetectorRef.detectChanges(),this._windowRef.changeDetectorRef.markForCheck(),this._ngZone.runOutsideAngular(()=>{this._positioning.createPopper({hostElement:this._elementRef.nativeElement,targetElement:this._windowRef.location.nativeElement,placement:this.placement,appendToBody:"body"===this.container,baseClass:"bs-tooltip"}),Promise.resolve().then(()=>{this._positioning.update(),this._zoneSubscription=this._ngZone.onStable.subscribe(()=>this._positioning.update())})}),e_(this._ngZone,this._document,this.autoClose,()=>this.close(),this.hidden,[this._windowRef.location.nativeElement]),u.subscribe(()=>this.shown.emit())}}close(n=this.animation){null!=this._windowRef&&(this._renderer.removeAttribute(this._elementRef.nativeElement,"aria-describedby"),this._popupService.close(n).subscribe(()=>{this._windowRef=null,this._positioning.destroy(),this._zoneSubscription?.unsubscribe(),this.hidden.emit(),this._changeDetector.markForCheck()}))}toggle(){this._windowRef?this.close():this.open()}isOpen(){return null!=this._windowRef}ngOnInit(){this._unregisterListenersFn=AF(this._renderer,this._elementRef.nativeElement,this.triggers,this.isOpen.bind(this),this.open.bind(this),this.close.bind(this),+this.openDelay,+this.closeDelay)}ngOnChanges({tooltipClass:n}){n&&this.isOpen()&&(this._windowRef.instance.tooltipClass=n.currentValue)}ngOnDestroy(){this.close(!1),this._unregisterListenersFn?.()}}return e.\u0275fac=function(n){return new(n||e)(se(Qn),se(gs),se(gi),se(As),se(IF),se(Gn),se(Br),se(ms),se($d))},e.\u0275dir=We({type:e,selectors:[["","ngbTooltip",""]],inputs:{animation:"animation",autoClose:"autoClose",placement:"placement",triggers:"triggers",container:"container",disableTooltip:"disableTooltip",tooltipClass:"tooltipClass",openDelay:"openDelay",closeDelay:"closeDelay",ngbTooltip:"ngbTooltip"},outputs:{shown:"shown",hidden:"hidden"},exportAs:["ngbTooltip"],features:[Fi]}),e})(),bC=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({}),e})();new Et("live announcer delay",{providedIn:"root",factory:function bF(){return 100}});let DC=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[vs]}),e})(),gw=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({}),e})();const OF=[Gc,v3,HD,WD,AC,tF,uF,dF,gw,ui,Xf,lw,dw,CF,yF,bC,DC];let Aw=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[OF,Gc,v3,HD,WD,AC,tF,uF,dF,gw,ui,Xf,lw,dw,CF,yF,bC,DC]}),e})();function DG(e,r){}function wG(e,r){1&e&&ke(0,DG,0,0,"ng-template",10),2&e&&(nt(),Ue("ngTemplateOutlet",qn(30)))}function PF(e,r){}function MF(e,r){1&e&&ke(0,PF,0,0,"ng-template",10),2&e&&(nt(),Ue("ngTemplateOutlet",qn(28)))}function NG(e,r){}const kF=function(e){return{name:e}};function u_(e,r){if(1&e&&ke(0,NG,0,0,"ng-template",30),2&e){const n=nt();Ue("ngTemplateOutlet",qn(26))("ngTemplateOutletContext",wo(2,kF,n.name))}}function ha(e,r){}const It=function(e){return{name:e,class:"small"}};function OG(e,r){if(1&e&&ke(0,ha,0,0,"ng-template",30),2&e){const n=nt().$implicit;nt(),Ue("ngTemplateOutlet",qn(26))("ngTemplateOutletContext",wo(2,It,n.uid))}}function l_(e,r){}function LF(e,r){1&e&&ke(0,l_,0,0,"ng-template",10),2&e&&(nt(2),Ue("ngTemplateOutlet",qn(30)))}function PG(e,r){}function MG(e,r){1&e&&ke(0,PG,0,0,"ng-template",10),2&e&&(nt(2),Ue("ngTemplateOutlet",qn(28)))}function kG(e,r){}function wC(e,r){}const xF=function(e){return{contain:e}},BF=function(e){return{"bg-red":e}};function LG(e,r){if(1&e){const n=Ri();Ge(0,"div",31),ke(1,OG,1,4,null,5),Ge(2,"span",32),ti(3),He(),Ge(4,"div",4),ke(5,LF,1,1,null,5),ke(6,MG,1,1,null,5),He(),Ge(7,"div",33)(8,"button",34),kt("click",function(){const d=rr(n).$implicit;return an(nt().pinToFullScreen(d))}),ke(9,kG,0,0,"ng-template",10),He(),Ge(10,"button",35),kt("click",function(){const d=rr(n).$implicit;return an(nt().unPinToFullScreen(d))}),ke(11,wC,0,0,"ng-template",10),He()()()}if(2&e){const n=r.$implicit,a=nt(),u=qn(38),d=qn(40);bp("id","remote_user_",n.uid,""),Ue("ngClass",wo(9,xF,!a.isVideoCovered)),$e(1),Ue("ngIf",!n.hasVideo),$e(2),ml(n.uid),$e(1),Ue("ngClass",wo(11,BF,!n.hasAudio)),$e(1),Ue("ngIf",n.hasAudio),$e(1),Ue("ngIf",!n.hasAudio),$e(3),Ue("ngTemplateOutlet",u),$e(2),Ue("ngTemplateOutlet",d)}}function xG(e,r){}function BG(e,r){}function FG(e,r){}function qu(e,r){if(1&e){const n=Ri();Ge(0,"button",36),kt("click",function(){return rr(n),an(nt().shareScreen())}),ke(1,FG,0,0,"ng-template",10),He()}if(2&e){nt();const n=qn(42);$e(1),Ue("ngTemplateOutlet",n)}}function Mh(e,r){}function FF(e,r){if(1&e){const n=Ri();Ge(0,"button",37),kt("click",function(){return rr(n),an(nt().stopSharing())}),ke(1,Mh,0,0,"ng-template",10),He()}if(2&e){nt();const n=qn(44);$e(1),Ue("ngTemplateOutlet",n)}}function NC(e,r){}function UG(e,r){1&e&&ke(0,NC,0,0,"ng-template",10),2&e&&(nt(),Ue("ngTemplateOutlet",qn(30)))}function VG(e,r){}function jG(e,r){1&e&&ke(0,VG,0,0,"ng-template",10),2&e&&(nt(),Ue("ngTemplateOutlet",qn(28)))}function QG(e,r){}function GG(e,r){1&e&&ke(0,QG,0,0,"ng-template",10),2&e&&(nt(),Ue("ngTemplateOutlet",qn(32)))}function HG(e,r){}function sr(e,r){1&e&&ke(0,HG,0,0,"ng-template",10),2&e&&(nt(),Ue("ngTemplateOutlet",qn(34)))}function UF(e,r){}function VF(e,r){if(1&e&&(Ge(0,"span",40),ti(1),He()),2&e){const n=nt(),u=n.name;Ue("ngClass",n.class),$e(1),ml(u[0])}}function mw(e,r){1&e&&Ir(0,"img",41)}function kh(e,r){if(1&e&&(ke(0,VF,2,2,"span",38),ke(1,mw,1,0,"img",39)),2&e){const n=r.name;Ue("ngIf",n.length>0),$e(1),Ue("ngIf",n.length<=0)}}function jF(e,r){1&e&&(hs(),Ge(0,"svg",42),Ir(1,"path",43)(2,"path",44)(3,"path",45),He())}function QF(e,r){1&e&&(hs(),Ge(0,"svg",42),Ir(1,"path",46)(2,"path",47),He())}function Ms(e,r){1&e&&(hs(),Ge(0,"svg",42),Ir(1,"path",48)(2,"path",49),He())}function Zf(e,r){1&e&&(hs(),Ge(0,"svg",42),Ir(1,"path",50),He())}function _w(e,r){1&e&&(hs(),Ge(0,"svg",42),Ir(1,"path",51),He())}function Ew(e,r){1&e&&(hs(),Ge(0,"svg",52),Ir(1,"path",53),He())}function GF(e,r){1&e&&(hs(),Ge(0,"svg",52),Ir(1,"path",54),He())}function OC(e,r){1&e&&(hs(),Ge(0,"svg",42),Ir(1,"path",55),He())}function HF(e,r){1&e&&(hs(),Ge(0,"svg",42),Ir(1,"path",56)(2,"rect",57),He())}function WF(e,r){1&e&&(hs(),Ge(0,"svg",42),Ir(1,"path",58)(2,"path",59),He())}function vw(e,r){1&e&&(hs(),Ge(0,"svg",42),Ir(1,"path",60),He())}function PC(e,r){if(1&e){const n=Ri();Ge(0,"div",61)(1,"h4",62),ti(2,"Meeting Id"),He(),Ir(3,"div",63),Ge(4,"p",64),kt("click",function(){rr(n);const u=nt();return an(u.copyText(u.meeting_id))}),ti(5),He()()}if(2&e){const n=nt();$e(5),ml(n.meeting_id)}}const Cw=function(e){return{"bg-green color-white":e}},Ju=function(e){return{"bg-red color-white":e}},pa=[{path:"",component:eB},{path:"video/:meeting_id/:uid",component:(()=>{class e{constructor(n,a,u,d){this.utility=n,this.agoraService=a,this.activeRoute=u,this.router=d,this.agoraClientConfig={mode:"rtc",codec:"vp8"},this.client=null,this.name="",this.meeting_id="",this.remoteUsers=[],this.isMuted=!1,this.isSharingEnabled=!1,this.isCameraEnabled=!0,this.isCameraDetected=!0,this.isMicDetected=!0,this.isVideoCovered=!0}ngOnInit(){var n=this;return kc(function*(){n.activeRoute.params.subscribe(function(){var a=kc(function*(u){n.client=_t().createClient(n.agoraClientConfig),n.meeting_id=u?.meeting_id,n.name=u?.uid;const{key:d}=yield n.agoraService.generateToken(n.meeting_id,n.name,0);n.client&&n.connectMe(n.meeting_id,d,n.name),n.handleCallEvents()});return function(u){return a.apply(this,arguments)}}())})()}handleErrorCallback(n){console.log("error",n)}connectMe(n,a,u){var d=this;this.client&&this.client.join("f4de51077da445b893bfdf00d0e3f286",n,a,u).then(function(){var m=kc(function*(E){const C=document.getElementById("my_name");C&&(C.textContent=`${E}`),ax({isCameraEnabled:d.checkCameraAvailability(),hasMic:d.hasMicrophone()}).subscribe(function(){var I=kc(function*({isCameraEnabled:w,hasMic:M}){const F=[];w?(d.localVideoTrack=yield _t().createCameraVideoTrack(),F.push(d.localVideoTrack),d.isCameraDetected=!0,d.isCameraEnabled=!1,d.toggleCamera()):(d.isCameraDetected=!1,d.isCameraEnabled=!0,d.toggleCamera()),M?(d.localAudioTrack=yield _t().createMicrophoneAudioTrack(),F.push(d.localAudioTrack),d.isMicDetected=!0,d.isMuted=!0,d.toggleMic()):(d.isMicDetected=!1,d.isMuted=!1,d.toggleMic()),d.client&&(d.client.publish(F).then(H=>{console.log("published",H),d.localVideoTrack&&d.localVideoTrack.play("me")}),console.log("publish success!"))});return function(w){return I.apply(this,arguments)}}())});return function(E){return m.apply(this,arguments)}}(),this.handleErrorCallback)}handleCallEvents(){var n=this;this.client.on("user-published",function(){var a=kc(function*(u,d){if(yield n.client.subscribe(u,d),console.log("subscribe success",u.uid.toString(),n.client.uid.toString()),u.uid.toString()!=n.client.uid.toString()){if("video"==d){const m={videoTrack:u.videoTrack,audioTrack:u.audioTrack,uid:u.uid.toString()};m.videoTrack.play(`remote_user_${m.uid}`)}if("audio"==d){const m={videoTrack:{},audioTrack:u.audioTrack,uid:u.uid.toString()};m.audioTrack.play(`remote_user_${m.uid}`)}}n.client.on("user-unpublished",m=>{console.log(m.uid+"has left the channel")})});return function(u,d){return a.apply(this,arguments)}}())}toggleMic(){this.isMuted?(this.isMuted=!1,this.localAudioTrack&&this.localAudioTrack.setMuted(!1)):(this.isMuted=!0,this.localAudioTrack&&this.localAudioTrack.setMuted(!0))}toggleCamera(){this.isCameraEnabled?(this.isCameraEnabled=!1,this.localVideoTrack&&this.localVideoTrack.setEnabled(!1)):(this.isCameraEnabled=!0,this.localVideoTrack&&this.localVideoTrack.setEnabled(!0))}leaveMeeting(){this.client.leave(),this.localVideoTrack&&this.localVideoTrack.close(),this.localAudioTrack&&this.localAudioTrack.close(),this.isSharingEnabled&&this.stopSharing(),this.router.navigate(["/"])}pinToFullScreen(n){console.log("user: "+n.uid);const a=document.getElementById("full-screen"),u=a?.firstChild,d=document.getElementById(`remote_user_${n.uid}`),m=document.getElementById("other");u&&(m?.prepend(u),d&&a?.appendChild(d))}unPinToFullScreen(n){console.log("user: "+n.uid);const a=document.getElementById("full-screen"),u=a?.firstChild,d=document.getElementById("me"),m=document.getElementById("other");u&&(m?.prepend(u),d&&a?.appendChild(d))}shareScreen(){var n=this;return kc(function*(){0==n.isSharingEnabled&&(n.screenTrack=yield _t().createScreenVideoTrack({},"auto"),n.localVideoTrack&&(n.localVideoTrack.stop(),yield n.client.unpublish(n.localVideoTrack)),yield n.client.publish(n.screenTrack),n.screenTrack.play("me"),n.isSharingEnabled=!0,n.screenTrack.on("track-ended",()=>{n.stopSharing()}))})()}stopSharing(){var n=this;return kc(function*(){1==n.isSharingEnabled&&(n.screenTrack.stop(),yield n.client.unpublish(n.screenTrack),n.localVideoTrack&&(yield n.client.publish(n.localVideoTrack),1==n.isCameraEnabled&&n.localVideoTrack.play("me")),n.isSharingEnabled=!1,n.screenTrack.off("track-ended",()=>{n.stopSharing()}))})()}copyText(n){if(!document.queryCommandSupported||!document.queryCommandSupported("copy"))return prompt("Copy to clipboard: Ctrl+C, Enter",n);var a=document.createElement("textarea");a.textContent=n,a.style.position="fixed",document.body.appendChild(a),a.select();try{return document.execCommand("copy")}catch{return prompt("Copy to clipboard: Ctrl+C, Enter",n)}finally{document.body.removeChild(a)}}checkCameraAvailability(){return kc(function*(){try{return(yield navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks().length>0?(console.log("Camera is available."),!0):(console.log("No camera found."),!1)}catch(n){return"NotFoundError"===n.name||"NotAllowedError"===n.name?console.log("Camera not found or access denied."):console.error("Error accessing camera:",n),!1}})()}hasMicrophone(){return navigator.mediaDevices.enumerateDevices().then(n=>n.some(a=>"audioinput"===a.kind))}}return e.\u0275fac=function(n){return new(n||e)(se(AR),se(fB),se(cn),se(Mi))},e.\u0275cmp=So({type:e,selectors:[["app-video-meeting"]],decls:51,vars:34,consts:[[1,"main-container"],[1,"video-container"],["id","full-screen",1,"full-screen"],["id","me",1,"remote-user",3,"ngClass"],[1,"remote-state-button",3,"ngClass"],[4,"ngIf"],["id","other",1,"other"],["class","remote-user",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"buttom-control-panel"],["type","button","placement","top","ngbTooltip","Share Meeting Link",1,"action-button",3,"ngbPopover","autoClose"],[3,"ngTemplateOutlet"],["type","button","placement","top","ngbTooltip","Video Crop",1,"action-button",3,"ngClass","click"],["type","button","placement","top","ngbTooltip","Share Screen","class","action-button",3,"click",4,"ngIf"],["type","button","placement","top","ngbTooltip","Stop Screen Sharing","class","action-button bg-red color-white",3,"click",4,"ngIf"],["type","button","placement","top",1,"action-button",3,"ngbTooltip","ngClass","disabled","click"],["type","button","placement","top",1,"action-button",3,"ngbTooltip","disabled","ngClass","click"],["type","button","placement","top","ngbTooltip","Leave Meeting",1,"action-button","call-cut-button",3,"click"],["placeholder",""],["mute",""],["unmute",""],["cameraDisabled",""],["cameraEnabled",""],["callCut",""],["pin",""],["unpin",""],["shareScr",""],["shareScrSharing",""],["videoCrop",""],["shareLink",""],["shareMeetingLink",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"remote-user",3,"id","ngClass"],[1,"remote-name"],[1,"hover-action-button-container"],["type","button",1,"remote-center-button","pin",3,"click"],["type","button",1,"remote-center-button","unpin",3,"click"],["type","button","placement","top","ngbTooltip","Share Screen",1,"action-button",3,"click"],["type","button","placement","top","ngbTooltip","Stop Screen Sharing",1,"action-button","bg-red","color-white",3,"click"],["class","placeholder-text",3,"ngClass",4,"ngIf"],["src","https://www.gstatic.com/meet/user_edu_get_a_link_light_90698cd7b4ca04d3005c962a3756c42d.svg","class","placeholder-image",4,"ngIf"],[1,"placeholder-text",3,"ngClass"],["src","https://www.gstatic.com/meet/user_edu_get_a_link_light_90698cd7b4ca04d3005c962a3756c42d.svg",1,"placeholder-image"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 512 512",1,"ionicon"],["fill","none","stroke","currentColor","stroke-linecap","round","stroke-miterlimit","10","stroke-width","32","d","M432 400L96 64"],["fill","currentColor","d","M400 240v-31.55c0-8.61-6.62-16-15.23-16.43A16 16 0 00368 208v32a111.68 111.68 0 01-2.68 24.38 2 2 0 00.53 1.84l22.59 22.59a2 2 0 003.29-.72A143.27 143.27 0 00400 240zM256 352a112.36 112.36 0 01-112-112v-31.55c0-8.61-6.62-16-15.23-16.43A16 16 0 00112 208v32c0 74 56.1 135.12 128 143.11V432h-47.55c-8.61 0-16 6.62-16.43 15.23A16 16 0 00192 464h127.55c8.61 0 16-6.62 16.43-15.23A16 16 0 00320 432h-48v-48.89a143.08 143.08 0 0052-16.22 4 4 0 00.91-6.35l-18.4-18.39a3 3 0 00-3.41-.58A111 111 0 01256 352zM257.14 48a79.66 79.66 0 00-68.47 36.57 4 4 0 00.54 5L332.59 233a2 2 0 003.41-1.42V128.91C336 85 301 48.6 257.14 48z"],["fill","currentColor","d","M179.41 215a2 2 0 00-3.41 1.42V239a80.89 80.89 0 0023.45 56.9 78.55 78.55 0 0077.8 21.19 2 2 0 00.86-3.35z"],["fill","none","stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","32","d","M192 448h128M384 208v32c0 70.4-57.6 128-128 128h0c-70.4 0-128-57.6-128-128v-32M256 368v80"],["fill","currentColor","d","M256 320a78.83 78.83 0 01-56.55-24.1A80.89 80.89 0 01176 239V128a79.69 79.69 0 0180-80c44.86 0 80 35.14 80 80v111c0 44.66-35.89 81-80 81z"],["fill","currentColor","d","M336 179.52A67.52 67.52 0 00268.48 112h-79.2a4 4 0 00-2.82 6.83l142.71 142.71a4 4 0 006.83-2.82zM16 180v152a68 68 0 0068 68h184a67.66 67.66 0 0042.84-15.24 4 4 0 00.33-6L54.41 122a4 4 0 00-4.87-.62A68 68 0 0016 180zM464 384.39a32 32 0 01-13-2.77 15.77 15.77 0 01-2.71-1.54l-82.71-58.22A32 32 0 01352 295.7v-79.4a32 32 0 0113.58-26.16l82.71-58.22a15.77 15.77 0 012.71-1.54 32 32 0 0145 29.24v192.76a32 32 0 01-32 32z"],["fill","none","stroke","currentColor","stroke-linecap","round","stroke-miterlimit","10","stroke-width","32","d","M416 416L80 80"],["fill","currentColor","d","M464 384.39a32 32 0 01-13-2.77 15.77 15.77 0 01-2.71-1.54l-82.71-58.22A32 32 0 01352 295.7v-79.4a32 32 0 0113.58-26.16l82.71-58.22a15.77 15.77 0 012.71-1.54 32 32 0 0145 29.24v192.76a32 32 0 01-32 32zM268 400H84a68.07 68.07 0 01-68-68V180a68.07 68.07 0 0168-68h184.48A67.6 67.6 0 01336 179.52V332a68.07 68.07 0 01-68 68z"],["fill","currentColor","d","M391 480c-19.52 0-46.94-7.06-88-30-49.93-28-88.55-53.85-138.21-103.38C116.91 298.77 93.61 267.79 61 208.45c-36.84-67-30.56-102.12-23.54-117.13C45.82 73.38 58.16 62.65 74.11 52a176.3 176.3 0 0128.64-15.2c1-.43 1.93-.84 2.76-1.21 4.95-2.23 12.45-5.6 21.95-2 6.34 2.38 12 7.25 20.86 16 18.17 17.92 43 57.83 52.16 77.43 6.15 13.21 10.22 21.93 10.23 31.71 0 11.45-5.76 20.28-12.75 29.81-1.31 1.79-2.61 3.5-3.87 5.16-7.61 10-9.28 12.89-8.18 18.05 2.23 10.37 18.86 41.24 46.19 68.51s57.31 42.85 67.72 45.07c5.38 1.15 8.33-.59 18.65-8.47 1.48-1.13 3-2.3 4.59-3.47 10.66-7.93 19.08-13.54 30.26-13.54h.06c9.73 0 18.06 4.22 31.86 11.18 18 9.08 59.11 33.59 77.14 51.78 8.77 8.84 13.66 14.48 16.05 20.81 3.6 9.53.21 17-2 22-.37.83-.78 1.74-1.21 2.75a176.49 176.49 0 01-15.29 28.58c-10.63 15.9-21.4 28.21-39.38 36.58A67.42 67.42 0 01391 480z"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 448 512"],["fill","currentColor","d","M32 32C14.3 32 0 46.3 0 64v96c0 17.7 14.3 32 32 32s32-14.3 32-32V96h64c17.7 0 32-14.3 32-32s-14.3-32-32-32H32zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7 14.3 32 32 32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H64V352zM320 32c-17.7 0-32 14.3-32 32s14.3 32 32 32h64v64c0 17.7 14.3 32 32 32s32-14.3 32-32V64c0-17.7-14.3-32-32-32H320zM448 352c0-17.7-14.3-32-32-32s-32 14.3-32 32v64H320c-17.7 0-32 14.3-32 32s14.3 32 32 32h96c17.7 0 32-14.3 32-32V352z"],["fill","currentColor","d","M160 64c0-17.7-14.3-32-32-32s-32 14.3-32 32v64H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96c17.7 0 32-14.3 32-32V64zM32 320c-17.7 0-32 14.3-32 32s14.3 32 32 32H96v64c0 17.7 14.3 32 32 32s32-14.3 32-32V352c0-17.7-14.3-32-32-32H32zM352 64c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7 14.3 32 32 32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V64zM320 320c-17.7 0-32 14.3-32 32v96c0 17.7 14.3 32 32 32s32-14.3 32-32V384h64c17.7 0 32-14.3 32-32s-14.3-32-32-32H320z"],["fill","currentColor","d","M376 352H272V198.63l52.69 52.68a16 16 0 0022.62-22.62l-80-80a16 16 0 00-22.62 0l-80 80a16 16 0 0022.62 22.62L240 198.63V352H136a56.06 56.06 0 01-56-56V88a56.06 56.06 0 0156-56h240a56.06 56.06 0 0156 56v208a56.06 56.06 0 01-56 56zM272 464a16 16 0 01-32 0V352h32z"],["fill","currentColor","d","M64 164v244a56 56 0 0056 56h272a56 56 0 0056-56V164a4 4 0 00-4-4H68a4 4 0 00-4 4zm267 151.63l-63.69 63.68a16 16 0 01-22.62 0L181 315.63c-6.09-6.09-6.65-16-.85-22.38a16 16 0 0123.16-.56L240 329.37V224.45c0-8.61 6.62-16 15.23-16.43A16 16 0 01272 224v105.37l36.69-36.68a16 16 0 0123.16.56c5.8 6.37 5.24 16.29-.85 22.38z"],["x","32","y","48","width","448","height","80","rx","32","ry","32","fill","currentColor"],["fill","currentColor","d","M458 346H192a26 26 0 01-26-26V54a22 22 0 00-44 0v68H54a22 22 0 000 44h68v154a70.08 70.08 0 0070 70h154v68a22 22 0 0044 0v-68h68a22 22 0 000-44z"],["fill","currentColor","d","M214 166h106a26 26 0 0126 26v106a22 22 0 0044 0V192a70.08 70.08 0 00-70-70H214a22 22 0 000 44z"],["fill","currentColor","d","M384 336a63.78 63.78 0 00-46.12 19.7l-148-83.27a63.85 63.85 0 000-32.86l148-83.27a63.8 63.8 0 10-15.73-27.87l-148 83.27a64 64 0 100 88.6l148 83.27A64 64 0 10384 336z"],[1,"share-link"],[1,"share-heating"],[1,"share-devider"],["placement","top","ngbTooltip","Click to Copy Id",1,"share-id",3,"click"]],template:function(n,a){if(1&n&&(Ge(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),ke(5,wG,1,1,null,5),ke(6,MF,1,1,null,5),He(),ke(7,u_,1,4,null,5),He()(),Ge(8,"div",6),ke(9,LG,12,13,"div",7),He()(),Ge(10,"div",8)(11,"button",9),ke(12,xG,0,0,"ng-template",10),He(),Ge(13,"button",11),kt("click",function(){return a.isVideoCovered=!a.isVideoCovered}),ke(14,BG,0,0,"ng-template",10),He(),ke(15,qu,2,1,"button",12),ke(16,FF,2,1,"button",13),Ge(17,"button",14),kt("click",function(){return a.isMicDetected&&a.toggleMic()}),ke(18,UG,1,1,null,5),ke(19,jG,1,1,null,5),He(),Ge(20,"button",15),kt("click",function(){return a.isCameraDetected&&a.toggleCamera()}),ke(21,GG,1,1,null,5),ke(22,sr,1,1,null,5),He(),Ge(23,"button",16),kt("click",function(){return a.leaveMeeting()}),ke(24,UF,0,0,"ng-template",10),He()()(),ke(25,kh,2,2,"ng-template",null,17,xr),ke(27,jF,4,0,"ng-template",null,18,xr),ke(29,QF,3,0,"ng-template",null,19,xr),ke(31,Ms,3,0,"ng-template",null,20,xr),ke(33,Zf,2,0,"ng-template",null,21,xr),ke(35,_w,2,0,"ng-template",null,22,xr),ke(37,Ew,2,0,"ng-template",null,23,xr),ke(39,GF,2,0,"ng-template",null,24,xr),ke(41,OC,2,0,"ng-template",null,25,xr),ke(43,HF,3,0,"ng-template",null,26,xr),ke(45,WF,3,0,"ng-template",null,27,xr),ke(47,vw,2,0,"ng-template",null,28,xr),ke(49,PC,6,1,"ng-template",null,29,xr)),2&n){const u=qn(36),d=qn(46),m=qn(48),E=qn(50);$e(3),Ue("ngClass",wo(24,xF,!a.isVideoCovered)),$e(1),Ue("ngClass",wo(26,BF,a.isMuted)),$e(1),Ue("ngIf",!a.isMuted),$e(1),Ue("ngIf",a.isMuted),$e(1),Ue("ngIf",!a.isCameraEnabled),$e(2),Ue("ngForOf",a.client.remoteUsers),$e(2),Ue("ngbPopover",E)("autoClose","outside"),$e(1),Ue("ngTemplateOutlet",m),$e(1),Ue("ngClass",wo(28,Cw,!a.isVideoCovered)),$e(1),Ue("ngTemplateOutlet",d),$e(1),Ue("ngIf",!a.isSharingEnabled),$e(1),Ue("ngIf",a.isSharingEnabled),$e(1),Sp("ngbTooltip",a.isMicDetected?a.isMuted?"Unmute":"Mute":"Microphone Not Available"),Ue("ngClass",wo(30,Ju,a.isMuted))("disabled",!a.isMicDetected),$e(1),Ue("ngIf",!a.isMuted),$e(1),Ue("ngIf",a.isMuted),$e(1),Sp("ngbTooltip",a.isCameraDetected?a.isCameraEnabled?"Camera Off":"Camera On":"Camera Not Available"),Ue("disabled",!a.isCameraDetected)("ngClass",wo(32,Ju,!a.isCameraEnabled)),$e(1),Ue("ngIf",!a.isCameraEnabled),$e(1),Ue("ngIf",a.isCameraEnabled),$e(2),Ue("ngTemplateOutlet",u)}},dependencies:[m1,zp,Sl,Du,uw,Oh],styles:[".main-container[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#202124}.video-container[_ngcontent-%COMP%]{display:flex;height:calc(100% - 140px);width:calc(100% - 40px);padding:20px}.full-screen[_ngcontent-%COMP%]{display:flex;width:100%;height:100%}.full-screen[_ngcontent-%COMP%]   .remote-user[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;margin-right:10px;border-radius:15px;overflow:hidden}.full-screen[_ngcontent-%COMP%]   .remote-user[_ngcontent-%COMP%]   .pin[_ngcontent-%COMP%]{display:none}.full-screen[_ngcontent-%COMP%]   .remote-user[_ngcontent-%COMP%]   .unpin[_ngcontent-%COMP%]{display:block}.placeholder-image[_ngcontent-%COMP%]{width:auto;height:auto;opacity:.5;position:absolute;top:50%;left:50%;z-index:2;transform:translate(-50%,-50%);max-width:50%;max-height:50%;filter:grayscale(1)}.placeholder-text[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;z-index:2;transform:translate(-50%,-50%);background:#202020;font-size:100px;border-radius:50%;line-height:1;height:200px;width:200px;display:flex;align-items:center;justify-content:center}.placeholder-text.small[_ngcontent-%COMP%]{height:100px;width:100px;font-size:70px}.my-name[_ngcontent-%COMP%]{position:absolute;bottom:20px;left:20px;z-index:1;color:#fff;background:#0cbd68;padding:10px;border-radius:10px;font-weight:900;font-size:14px}.other[_ngcontent-%COMP%]{flex-shrink:0;overflow-y:auto;overflow-x:hidden}.buttom-control-panel[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100px}.action-button[_ngcontent-%COMP%]{border-radius:50%;width:40px;height:40px;border:0px;padding:10px;margin:0 10px;display:flex;cursor:pointer}.call-cut-button[_ngcontent-%COMP%]{background-color:red;color:#fff}.remote-state-button[_ngcontent-%COMP%]{width:30px;height:30px;padding:7px;left:10px;position:absolute;bottom:10px;background-color:#0cbd68;border-radius:50%;z-index:1;display:flex;align-items:center;justify-content:center}.remote-state-button.camera-state[_ngcontent-%COMP%]{left:59px}.remote-name[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;z-index:1;font-size:10px;color:green;background:#0cbd68;padding:5px;border-radius:5px;color:#fff}.bg-red[_ngcontent-%COMP%]{background:red}.bg-green[_ngcontent-%COMP%]{background:#0cbd68}.remote-center-button[_ngcontent-%COMP%]{border:0px solid;background:rgba(0,0,0,.5);color:#fff;border-radius:10px;height:40px;width:40px;padding:10px;cursor:pointer}.share-link[_ngcontent-%COMP%]{min-width:240px;overflow:hidden}.share-heading[_ngcontent-%COMP%]{font-size:30px}.share-devider[_ngcontent-%COMP%]{width:100%;height:1px;background-color:#202020;margin-bottom:20px}.share-id[_ngcontent-%COMP%]{margin-bottom:20px;font-size:18px;background:rgba(12,189,104,.368627451);padding:10px;text-align:center;letter-spacing:1px;border-radius:15px;cursor:pointer}"]}),e})()}];let KF=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e}),e.\u0275inj=Nn({imports:[rx.forRoot(pa,{useHash:!0}),rx]}),e})(),yw=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=So({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(n,a){1&n&&Ir(0,"router-outlet")},dependencies:[KT]}),e})(),YF=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Sn({type:e,bootstrap:[yw]}),e.\u0275inj=Nn({imports:[M1,KF,Ah,zR,Aw,bC]}),e})();(function Ob(){Jv=!1})(),O1().bootstrapModule(YF).catch(e=>console.error(e))},890:function($u,m_,ig){var U=ig(156).default;$u.exports=function(){"use strict";var Go=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},xs=function(t){return t&&t.Math==Math&&t},rt=xs("object"==typeof globalThis&&globalThis)||xs("object"==typeof window&&window)||xs("object"==typeof self&&self)||xs("object"==typeof Go&&Go)||function(){return this}()||Function("return this")(),Hr={},An=function(t){try{return!!t()}catch{return!0}},_r=!An(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),Aa=!An(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}),qc=Function.prototype.call,io=Aa?qc.bind(qc):function(){return qc.apply(qc,arguments)},id={},Dw={}.propertyIsEnumerable,ww=Object.getOwnPropertyDescriptor,oU=ww&&!Dw.call({1:2},1);id.f=oU?function(t){var i=ww(this,t);return!!i&&i.enumerable}:Dw;var rc,ic,ma=function(t,i){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:i}},Nw=Aa,__=Function.prototype,og=__.call,aU=Nw&&__.bind.bind(og,og),Dn=Nw?function(t){return t&&aU(t)}:function(t){return t&&function(){return og.apply(t,arguments)}},sg=Dn,cU=sg({}.toString),UC=sg("".slice),od=function(t){return UC(cU(t),8,-1)},Jc=An,uU=od,E_=rt.Object,Kn=Dn("".split),jC=Jc(function(){return!E_("z").propertyIsEnumerable(0)})?function(t){return"String"==uU(t)?Kn(t,""):E_(t)}:E_,lU=rt.TypeError,v_=function(t){if(null==t)throw lU("Can't call method on "+t);return t},dU=jC,Or=v_,xh=function(t){return dU(Or(t))},Er=function(t){return"function"==typeof t},Wr=Er,tn=function(t){return"object"==typeof t?null!==t:Wr(t)},QC=rt,Ot=Er,GC=function(t){return Ot(t)?t:void 0},Bs=function(t,i){return arguments.length<2?GC(QC[t]):QC[t]&&QC[t][i]},zc=Dn({}.isPrototypeOf),Bh=Bs("navigator","userAgent")||"",Ow=Bh,pU=rt.process,Pw=rt.Deno,fU=pU&&pU.versions||Pw&&Pw.version,HC=fU&&fU.v8;HC&&(ic=(rc=HC.split("."))[0]>0&&rc[0]<4?1:+(rc[0]+rc[1])),!ic&&Ow&&(!(rc=Ow.match(/Edge\/(\d+)/))||rc[1]>=74)&&(rc=Ow.match(/Chrome\/(\d+)/))&&(ic=+rc[1]);var Mw=ic,WC=Mw,AU=!!Object.getOwnPropertySymbols&&!An(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&WC&&WC<41}),mU=AU&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,nH=Bs,sd=Er,_U=zc,EU=rt.Object,kw=mU?function(t){return"symbol"==typeof t}:function(t){var i=nH("Symbol");return sd(i)&&_U(i.prototype,EU(t))},vU=rt.String,C_=function(t){try{return vU(t)}catch{return"Object"}},iH=Er,oH=C_,sH=rt.TypeError,ag=function(t){if(iH(t))return t;throw sH(oH(t)+" is not a function")},KC=ag,cg=function(t,i){var o=t[i];return null==o?void 0:KC(o)},y_=io,I_=Er,S_=tn,CU=rt.TypeError,ug={exports:{}},YC=rt,Lw=Object.defineProperty,b_=function(t,i){try{Lw(YC,t,{value:i,configurable:!0,writable:!0})}catch{YC[t]=i}return i},xw="__core-js_shared__",qC=rt[xw]||b_(xw,{}),Bw=qC;(ug.exports=function(t,i){return Bw[t]||(Bw[t]=void 0!==i?i:{})})("versions",[]).push({version:"3.20.3",mode:"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"});var yU=v_,Fw=rt.Object,ad=function(t){return Fw(yU(t))},IU=ad,$c=Dn({}.hasOwnProperty),Ki=Object.hasOwn||function(t,i){return $c(IU(t),i)},di=Dn,Fh=0,_a=Math.random(),aH=di(1..toString),JC=function(t){return"Symbol("+(void 0===t?"":t)+")_"+aH(++Fh+_a,36)},Uw=rt,lg=Ki,dg=JC,Vw=AU,$C=mU,Uh=(0,ug.exports)("wks"),cd=Uw.Symbol,jw=cd&&cd.for,SU=$C?cd:cd&&cd.withoutSetter||dg,hi=function(t){if(!lg(Uh,t)||!Vw&&"string"!=typeof Uh[t]){var i="Symbol."+t;Uh[t]=Vw&&lg(cd,t)?cd[t]:$C&&jw?jw(i):SU(i)}return Uh[t]},Qw=io,Gw=tn,Hw=kw,pi=cg,XC=rt.TypeError,Zn=hi("toPrimitive"),ZC=function(t,i){if(!Gw(t)||Hw(t))return t;var o,s=pi(t,Zn);if(s){if(void 0===i&&(i="default"),o=Qw(s,t,i),!Gw(o)||Hw(o))return o;throw XC("Can't convert object to primitive value")}return void 0===i&&(i="number"),function(t,i){var o,s;if("string"===i&&I_(o=t.toString)&&!S_(s=y_(o,t))||I_(o=t.valueOf)&&!S_(s=y_(o,t))||"string"!==i&&I_(o=t.toString)&&!S_(s=y_(o,t)))return s;throw CU("Can't convert object to primitive value")}(t,i)},er=kw,Vh=function(t){var i=ZC(t,"string");return er(i)?i:i+""},Yw=tn,mn=rt.document,Pt=Yw(mn)&&Yw(mn.createElement),jh=function(t){return Pt?mn.createElement(t):{}},cH=jh,Be=!_r&&!An(function(){return 7!=Object.defineProperty(cH("div"),"a",{get:function(){return 7}}).a}),Ut=io,wn=id,bU=ma,uH=xh,TU=Vh,R_=Ki,os=Be,RU=Object.getOwnPropertyDescriptor;Hr.f=_r?RU:function(t,i){if(t=uH(t),i=TU(i),os)try{return RU(t,i)}catch{}if(R_(t,i))return bU(!Ut(wn.f,t,i),t[i])};var Yi={},DU=_r&&An(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),lH=tn,dH=rt.String,hH=rt.TypeError,Io=function(t){if(lH(t))return t;throw hH(dH(t)+" is not an object")},pH=Be,ey=Io,Wo=Vh,Bn=rt.TypeError,qw=Object.defineProperty,fH=Object.getOwnPropertyDescriptor;Yi.f=_r?DU?function(t,i,o){if(ey(t),i=Wo(i),ey(o),"function"==typeof t&&"prototype"===i&&"value"in o&&"writable"in o&&!o.writable){var s=fH(t,i);s&&s.writable&&(t[i]=o.value,o={configurable:"configurable"in o?o.configurable:s.configurable,enumerable:"enumerable"in o?o.enumerable:s.enumerable,writable:!1})}return qw(t,i,o)}:qw:function(t,i,o){if(ey(t),i=Wo(i),ey(o),pH)try{return qw(t,i,o)}catch{}if("get"in o||"set"in o)throw Bn("Accessors not supported");return"value"in o&&(t[i]=o.value),t};var Nn=Yi,D_=ma,Fs=_r?function(t,i,o){return Nn.f(t,i,D_(1,o))}:function(t,i,o){return t[i]=o,t},Us={exports:{}},OU=Er,ty=qC,Jw=Dn(Function.toString);OU(ty.inspectSource)||(ty.inspectSource=function(t){return Jw(t)});var ud,ld,hg,w_=ty.inspectSource,ny=w_,zw=rt.WeakMap,Vs=Er(zw)&&/native code/.test(ny(zw)),mH=JC,Xc=(0,ug.exports)("keys"),ss=function(t){return Xc[t]||(Xc[t]=mH(t))},Xw={},Yn=Dn,EH=tn,vH=Fs,Xu=Ki,N_=ss,ry=Xw,O_="Object already initialized",P_=rt.TypeError;if(Vs||qC.state){var va=qC.state||(qC.state=new(0,rt.WeakMap)),PU=Yn(va.get),So=Yn(va.has),MU=Yn(va.set);ud=function(t,i){if(So(va,t))throw new P_(O_);return i.facade=t,MU(va,t,i),i},ld=function(t){return PU(va,t)||{}},hg=function(t){return So(va,t)}}else{var dd=N_("state");ry[dd]=!0,ud=function(t,i){if(Xu(t,dd))throw new P_(O_);return i.facade=t,vH(t,dd,i),i},ld=function(t){return Xu(t,dd)?t[dd]:{}},hg=function(t){return Xu(t,dd)}}var as={set:ud,get:ld,has:hg,enforce:function(t){return hg(t)?ld(t):ud(t,{})},getterFor:function(t){return function(i){var o;if(!EH(i)||(o=ld(i)).type!==t)throw P_("Incompatible receiver, "+t+" required");return o}}},Sn=_r,iy=Function.prototype,We=Sn&&Object.getOwnPropertyDescriptor,oo=Ki(iy,"name"),On={EXISTS:oo,PROPER:oo&&"something"===function(){}.name,CONFIGURABLE:oo&&(!Sn||Sn&&We(iy,"name").configurable)},bo=rt,so=Er,Qh=Ki,Ko=Fs,js=b_,ze=w_,Ht=On.CONFIGURABLE,vr=as.get,cs=as.enforce,hd=String(String).split("String");(Us.exports=function(t,i,o,s){var c,l=!!s&&!!s.unsafe,p=!!s&&!!s.enumerable,h=!!s&&!!s.noTargetGet,g=s&&void 0!==s.name?s.name:i;so(o)&&("Symbol("===String(g).slice(0,7)&&(g="["+String(g).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!Qh(o,"name")||Ht&&o.name!==g)&&Ko(o,"name",g),(c=cs(o)).source||(c.source=hd.join("string"==typeof g?g:""))),t!==bo?(l?!h&&t[i]&&(p=!0):delete t[i],p?t[i]=o:Ko(t,i,o)):p?t[i]=o:js(i,o)})(Function.prototype,"toString",function(){return so(this)&&vr(this).source||ze(this)});var Kr={},pd=Math.ceil,Yr=Math.floor,Qs=function(t){var i=+t;return i!=i||0===i?0:(i>0?Yr:pd)(i)},pg=Qs,qt=Math.max,M_=Math.min,eu=function(t,i){var o=pg(t);return o<0?qt(o+i,0):M_(o,i)},oy=Qs,fd=Math.min,Xr=function(t){return t>0?fd(oy(t),9007199254740991):0},fg=Xr,us=function(t){return fg(t.length)},Ca=xh,Gh=eu,Zw=us,tr=function(t){return function(i,o,s){var c,l=Ca(i),p=Zw(l),h=Gh(s,p);if(t&&o!=o){for(;p>h;)if((c=l[h++])!=c)return!0}else for(;p>h;h++)if((t||h in l)&&l[h]===o)return t||h||0;return!t&&-1}},LU={includes:tr(!0),indexOf:tr(!1)},sy=Ki,k_=xh,ay=LU.indexOf,gg=Xw,Ag=Dn([].push),Zu=function(t,i){var o,s=k_(t),c=0,l=[];for(o in s)!sy(gg,o)&&sy(s,o)&&Ag(l,o);for(;i.length>c;)sy(s,o=i[c++])&&(~ay(l,o)||Ag(l,o));return l},Bi=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],xU=Zu,Yo=Bi.concat("length","prototype");Kr.f=Object.getOwnPropertyNames||function(t){return xU(t,Yo)};var Gs={};Gs.f=Object.getOwnPropertySymbols;var cy=Bs,L_=Kr,x_=Gs,ya=Io,BU=Dn([].concat),CH=cy("Reflect","ownKeys")||function(t){var i=L_.f(ya(t)),o=x_.f;return o?BU(i,o(t)):i},eN=Ki,FU=CH,yH=Hr,IH=Yi,tN=function(t,i,o){for(var s=FU(i),c=IH.f,l=yH.f,p=0;p<s.length;p++){var h=s[p];eN(t,h)||o&&eN(o,h)||c(t,h,l(i,h))}},SH=An,bH=Er,TH=/#|\.prototype\./,B_=function(t,i){var o=DH[RH(t)];return o==NH||o!=wH&&(bH(i)?SH(i):!!i)},RH=B_.normalize=function(t){return String(t).replace(TH,".").toLowerCase()},DH=B_.data={},wH=B_.NATIVE="N",NH=B_.POLYFILL="P",nN=B_,rN=rt,OH=Hr.f,iN=Fs,uy=Us.exports,PH=b_,MH=tN,kH=nN,Ii=function(t,i){var o,s,c,l,p,h=t.target,g=t.global,f=t.stat;if(o=g?rN:f?rN[h]||PH(h,{}):(rN[h]||{}).prototype)for(s in i){if(l=i[s],c=t.noTargetGet?(p=OH(o,s))&&p.value:o[s],!kH(g?s:h+(f?".":"#")+s,t.forced)&&void 0!==c){if(typeof l==typeof c)continue;MH(l,c)}(t.sham||c&&c.sham)&&iN(l,"sham",!0),uy(o,s,l,t)}},Fi=Function.prototype,ly=Fi.apply,oN=Fi.call,F_="object"==typeof Reflect&&Reflect.apply||(Aa?oN.bind(ly):function(){return oN.apply(ly,arguments)}),sN=Ii,VU=F_,gd=Dn,jU=An,Hs=rt.Array,Hh=Bs("JSON","stringify"),U_=gd(/./.exec),V_=gd("".charAt),QU=gd("".charCodeAt),LH=gd("".replace),fi=gd(1..toString),GU=/[\uD800-\uDFFF]/g,HU=/^[\uD800-\uDBFF]$/,mg=/^[\uDC00-\uDFFF]$/,ls=function(t,i,o){var s=V_(o,i-1),c=V_(o,i+1);return U_(HU,t)&&!U_(mg,c)||U_(mg,t)&&!U_(HU,s)?"\\u"+fi(QU(t,0),16):t},WU=jU(function(){return'"\\udf06\\ud834"'!==Hh("\udf06\ud834")||'"\\udead"'!==Hh("\udead")});Hh&&sN({target:"JSON",stat:!0,forced:WU},{stringify:function(t,i,o){for(var s=0,c=arguments.length,l=Hs(c);s<c;s++)l[s]=arguments[s];var p=VU(Hh,null,l);return"string"==typeof p?LH(p,GU,ls):p}});var Cr=function(t){try{return!!t()}catch{return!0}},tu=!Cr(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}),qo=tu,cN=Function.prototype,dy=cN.call,el=qo&&cN.bind.bind(dy,dy),nr=qo?function(t){return t&&el(t)}:function(t){return t&&function(){return dy.apply(t,arguments)}},To=nr({}.isPrototypeOf),Mt=function(t){return t&&t.Math==Math&&t},Dt=Mt("object"==typeof globalThis&&globalThis)||Mt("object"==typeof window&&window)||Mt("object"==typeof self&&self)||Mt("object"==typeof Go&&Go)||function(){return this}()||Function("return this")(),uN=Function.prototype,lN=uN.apply,dN=uN.call,Q_="object"==typeof Reflect&&Reflect.apply||(tu?dN.bind(lN):function(){return dN.apply(lN,arguments)}),Si=function(t){return"function"==typeof t},_g={},ve=!Cr(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),rr=Function.prototype.call,an=tu?rr.bind(rr):function(){return rr.apply(rr,arguments)},qr={},hy={}.propertyIsEnumerable,Wh=Object.getOwnPropertyDescriptor,sc=Wh&&!hy.call({1:2},1);qr.f=sc?function(t){var i=Wh(this,t);return!!i&&i.enumerable}:hy;var ac,Kh,Ad=function(t,i){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:i}},hN=nr,BH=hN({}.toString),pN=hN("".slice),bi=function(t){return pN(BH(t),8,-1)},fN=Cr,Yh=bi,Ia=Dt.Object,KU=nr("".split),Eg=fN(function(){return!Ia("z").propertyIsEnumerable(0)})?function(t){return"String"==Yh(t)?KU(t,""):Ia(t)}:Ia,YU=Dt.TypeError,G_=function(t){if(null==t)throw YU("Can't call method on "+t);return t},py=Eg,fy=G_,ru=function(t){return py(fy(t))},gy=Si,ds=function(t){return"object"==typeof t?null!==t:gy(t)},cc={},vg=cc,H_=Dt,gN=Si,Ay=function(t){return gN(t)?t:void 0},Ws=function(t,i){return arguments.length<2?Ay(vg[t])||Ay(H_[t]):vg[t]&&vg[t][i]||H_[t]&&H_[t][i]},iu=Ws("navigator","userAgent")||"",my=iu,ao=Dt.process,ou=Dt.Deno,yr=ao&&ao.versions||ou&&ou.version,hs=yr&&yr.v8;hs&&(Kh=(ac=hs.split("."))[0]>0&&ac[0]<4?1:+(ac[0]+ac[1])),!Kh&&my&&(!(ac=my.match(/Edge\/(\d+)/))||ac[1]>=74)&&(ac=my.match(/Chrome\/(\d+)/))&&(Kh=+ac[1]);var qh=Kh,mN=qh,_y=!!Object.getOwnPropertySymbols&&!Cr(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&mN&&mN<41}),_N=_y&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,W_=Ws,K_=Si,Y_=To,EN=Dt.Object,vy=_N?function(t){return"symbol"==typeof t}:function(t){var i=W_("Symbol");return K_(i)&&Y_(i.prototype,EN(t))},tl=Dt.String,nl=function(t){try{return tl(t)}catch{return"Object"}},JU=Si,zU=nl,Cg=Dt.TypeError,Sa=function(t){if(JU(t))return t;throw Cg(zU(t)+" is not a function")},$U=Sa,Cy=function(t,i){var o=t[i];return null==o?void 0:$U(o)},vN=an,CN=Si,Jh=ds,yN=Dt.TypeError,yg={exports:{}},Ig=Dt,IN=Object.defineProperty,md="__core-js_shared__",yy=Dt[md]||function(t,i){try{IN(Ig,t,{value:i,configurable:!0,writable:!0})}catch{Ig[t]=i}return i}(md,{}),_d=yy;(yg.exports=function(t,i){return _d[t]||(_d[t]=void 0!==i?i:{})})("versions",[]).push({version:"3.20.3",mode:"pure",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"});var Iy=G_,q_=Dt.Object,su=function(t){return q_(Iy(t))},bN=su,TN=nr({}.hasOwnProperty),qi=Object.hasOwn||function(t,i){return TN(bN(t),i)},uc=nr,XU=0,Sg=Math.random(),Sy=uc(1..toString),bg=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Sy(++XU+Sg,36)},J_=Dt,RN=qi,DN=bg,by=_y,Ty=_N,zh=(0,yg.exports)("wks"),Ed=J_.Symbol,Tg=Ed&&Ed.for,Rg=Ty?Ed:Ed&&Ed.withoutSetter||DN,Jr=function(t){if(!RN(zh,t)||!by&&"string"!=typeof zh[t]){var i="Symbol."+t;zh[t]=by&&RN(Ed,t)?Ed[t]:Ty&&Tg?Tg(i):Rg(i)}return zh[t]},wN=an,Ry=ds,vd=vy,ZU=Cy,e4=Dt.TypeError,NN=Jr("toPrimitive"),Cd=function(t,i){if(!Ry(t)||vd(t))return t;var o,s=ZU(t,NN);if(s){if(void 0===i&&(i="default"),o=wN(s,t,i),!Ry(o)||vd(o))return o;throw e4("Can't convert object to primitive value")}return void 0===i&&(i="number"),function(t,i){var o,s;if("string"===i&&CN(o=t.toString)&&!Jh(s=vN(o,t))||CN(o=t.valueOf)&&!Jh(s=vN(o,t))||"string"!==i&&CN(o=t.toString)&&!Jh(s=vN(o,t)))return s;throw yN("Can't convert object to primitive value")}(t,i)},$h=vy,au=function(t){var i=Cd(t,"string");return $h(i)?i:i+""},yd=ds,$_=Dt.document,wy=yd($_)&&yd($_.createElement),rl=function(t){return wy?$_.createElement(t):{}},FH=rl,ON=!ve&&!Cr(function(){return 7!=Object.defineProperty(FH("div"),"a",{get:function(){return 7}}).a}),UH=an,VH=qr,jH=Ad,QH=ru,GH=au,HH=qi,WH=ON,Xh=Object.getOwnPropertyDescriptor;_g.f=ve?Xh:function(t,i){if(t=QH(t),i=GH(i),WH)try{return Xh(t,i)}catch{}if(HH(t,i))return jH(!UH(VH.f,t,i),t[i])};var KH=Cr,YH=Si,Ti=/#|\.prototype\./,Id=function(t,i){var o=qH[Dg(t)];return o==ps||o!=t4&&(YH(i)?KH(i):!!i)},Dg=Id.normalize=function(t){return String(t).replace(Ti,".").toLowerCase()},qH=Id.data={},t4=Id.NATIVE="N",ps=Id.POLYFILL="P",lc=Id,PN=Sa,X_=tu,wg=nr(nr.bind),cu=function(t,i){return PN(t),void 0===i?t:X_?wg(t,i):function(){return t.apply(i,arguments)}},ba={},MN=ve&&Cr(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),JH=ds,kN=Dt.String,fs=Dt.TypeError,Ro=function(t){if(JH(t))return t;throw fs(kN(t)+" is not an object")},zH=ON,Z_=Ro,xN=au,r4=Dt.TypeError,Ny=Object.defineProperty,i4=Object.getOwnPropertyDescriptor;ba.f=ve?MN?function(t,i,o){if(Z_(t),i=xN(i),Z_(o),"function"==typeof t&&"prototype"===i&&"value"in o&&"writable"in o&&!o.writable){var s=i4(t,i);s&&s.writable&&(t[i]=o.value,o={configurable:"configurable"in o?o.configurable:s.configurable,enumerable:"enumerable"in o?o.enumerable:s.enumerable,writable:!1})}return Ny(t,i,o)}:Ny:function(t,i,o){if(Z_(t),i=xN(i),Z_(o),zH)try{return Ny(t,i,o)}catch{}if("get"in o||"set"in o)throw r4("Accessors not supported");return"value"in o&&(t[i]=o.value),t};var $H=ba,Ng=Ad,uu=ve?function(t,i,o){return $H.f(t,i,Ng(1,o))}:function(t,i,o){return t[i]=o,t},Sd=Dt,s4=Q_,a4=nr,c4=Si,BN=_g.f,Og=lc,Ta=cc,u4=cu,Fe=uu,Py=qi,Zr=function(t){var i=function(o,s,c){if(this instanceof i){switch(arguments.length){case 0:return new t;case 1:return new t(o);case 2:return new t(o,s)}return new t(o,s,c)}return s4(t,this,arguments)};return i.prototype=t.prototype,i},ei=function(t,i){var o,s,c,l,p,h,g,f,A=t.target,_=t.global,v=t.stat,y=t.proto,S=_?Sd:v?Sd[A]:(Sd[A]||{}).prototype,R=_?Ta:Ta[A]||Fe(Ta,A,{})[A],D=R.prototype;for(c in i)o=!Og(_?c:A+(v?".":"#")+c,t.forced)&&S&&Py(S,c),p=R[c],o&&(h=t.noTargetGet?(f=BN(S,c))&&f.value:S[c]),l=o&&h?h:i[c],o&&typeof p==typeof l||(g=t.bind&&o?u4(l,Sd):t.wrap&&o?Zr(l):y&&c4(l)?a4(l):l,(t.sham||l&&l.sham||p&&p.sham)&&Fe(g,"sham",!0),Fe(R,c,g),y&&(Py(Ta,s=A+"Prototype")||Fe(Ta,s,{}),Fe(Ta[s],c,l),t.real&&D&&!D[c]&&Fe(D,c,l)))},Pg=Math.ceil,l4=Math.floor,My=function(t){var i=+t;return i!=i||0===i?0:(i>0?l4:Pg)(i)},d4=My,ky=Math.min,dc=function(t){return function(t){return t>0?ky(d4(t),9007199254740991):0}(t.length)},kg=Sa,h4=su,FN=Eg,Lg=dc,tE=Dt.TypeError,Ly=function(t){return function(i,o,s,c){kg(o);var l=h4(i),p=FN(l),h=Lg(l),g=t?h-1:0,f=t?-1:1;if(s<2)for(;;){if(g in p){c=p[g],g+=f;break}if(g+=f,t?g<0:h<=g)throw tE("Reduce of empty array with no initial value")}for(;t?g>=0:h>g;g+=f)g in p&&(c=o(c,p[g],g,l));return c}},p4={left:Ly(!1),right:Ly(!0)},f4=Cr,il=function(t,i){var o=[][t];return!!o&&f4(function(){o.call(null,i||function(){throw 1},1)})},ol="process"==bi(Dt.process),g4=p4.left,A4=qh,UN=ol;ei({target:"Array",proto:!0,forced:!il("reduce")||!UN&&A4>79&&A4<83},{reduce:function(t){var i=arguments.length;return g4(this,t,i,i>1?arguments[1]:void 0)}});var m4=cc,bd=function(t){return m4[t+"Prototype"]},_4=bd("Array").reduce,E4=To,v4=_4,ep=Array.prototype,xy=function(t){var i=t.reduce;return t===ep||E4(ep,t)&&i===ep.reduce?v4:i},hc=xy,By={};By[hi("toStringTag")]="z";var XH=rt,VN="[object z]"===String(By),ZH=Er,nE=od,C4=hi("toStringTag"),Fy=XH.Object,eW="Arguments"==nE(function(){return arguments}()),rE=VN?nE:function(t){var i,o,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(o=function(c,l){try{return c[l]}catch{}}(i=Fy(t),C4))?o:eW?nE(i):"Object"==(s=nE(i))&&ZH(i.callee)?"Arguments":s},Uy=rE,tW=rt.String,xg=function(t){if("Symbol"===Uy(t))throw TypeError("Cannot convert a Symbol value to a string");return tW(t)},nW=Io,y4=function(){var t=nW(this),i="";return t.global&&(i+="g"),t.ignoreCase&&(i+="i"),t.multiline&&(i+="m"),t.dotAll&&(i+="s"),t.unicode&&(i+="u"),t.sticky&&(i+="y"),i},jN=An,Vy=rt.RegExp,iE=jN(function(){var t=Vy("a","y");return t.lastIndex=2,null!=t.exec("abcd")}),jy=iE||jN(function(){return!Vy("a","y").sticky}),Qy={BROKEN_CARET:iE||jN(function(){var t=Vy("^r","gy");return t.lastIndex=2,null!=t.exec("str")}),MISSED_STICKY:jy,UNSUPPORTED_Y:iE},oE={},QN=Zu,Jo=Bi,GN=Yi,Gy=Io,T4=xh,R4=Object.keys||function(t){return QN(t,Jo)};oE.f=_r&&!DU?Object.defineProperties:function(t,i){Gy(t);for(var o,s=T4(i),c=R4(i),l=c.length,p=0;l>p;)GN.f(t,o=c[p++],s[o]);return t};var sE,Hy=Bs("document","documentElement"),D4=Io,w4=oE,uo=Bi,Wy=Xw,HN=Hy,Ky=jh,Ji=ss("IE_PROTO"),Td=function(){},Yy=function(t){return"<script>"+t+"<\/script>"},WN=function(t){t.write(Yy("")),t.close();var i=t.parentWindow.Object;return t=null,i},aE=function(){try{sE=new ActiveXObject("htmlfile")}catch{}var t,i;aE=typeof document<"u"?document.domain&&sE?WN(sE):((i=Ky("iframe")).style.display="none",HN.appendChild(i),i.src=String("javascript:"),(t=i.contentWindow.document).open(),t.write(Yy("document.F=Object")),t.close(),t.F):WN(sE);for(var o=uo.length;o--;)delete aE.prototype[uo[o]];return aE()};Wy[Ji]=!0;var t,i,Rd=Object.create||function(t,i){var o;return null!==t?(Td.prototype=D4(t),o=new Td,Td.prototype=null,o[Ji]=t):o=aE(),void 0===i?o:w4.f(o,i)},KN=rt.RegExp,qy=An(function(){var t=KN(".","s");return!(t.dotAll&&t.exec("\n")&&"s"===t.flags)}),O4=rt.RegExp,qN=An(function(){var t=O4("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}),sl=io,tp=Dn,P4=xg,JN=y4,M4=Qy,k4=Rd,L4=as.get,Jy=qy,zy=qN,zN=(0,ug.exports)("native-string-replace",String.prototype.replace),$y=RegExp.prototype.exec,al=$y,Xy=tp("".charAt),$N=tp("".indexOf),x4=tp("".replace),Fg=tp("".slice),Zy=(i=/b*/g,sl($y,t=/a/,"a"),sl($y,i,"a"),0!==t.lastIndex||0!==i.lastIndex),XN=M4.BROKEN_CARET,eI=void 0!==/()??/.exec("")[1];(Zy||eI||XN||Jy||zy)&&(al=function(t){var i,o,s,c,l,p,h,g=this,f=L4(g),A=P4(t),_=f.raw;if(_)return _.lastIndex=g.lastIndex,i=sl(al,_,A),g.lastIndex=_.lastIndex,i;var v=f.groups,y=XN&&g.sticky,S=sl(JN,g),R=g.source,D=0,O=A;if(y&&(S=x4(S,"y",""),-1===$N(S,"g")&&(S+="g"),O=Fg(A,g.lastIndex),g.lastIndex>0&&(!g.multiline||g.multiline&&"\n"!==Xy(A,g.lastIndex-1))&&(R="(?: "+R+")",O=" "+O,D++),o=new RegExp("^(?:"+R+")",S)),eI&&(o=new RegExp("^"+R+"$(?!\\s)",S)),Zy&&(s=g.lastIndex),c=sl($y,y?o:g,O),y?c?(c.input=Fg(c.input,D),c[0]=Fg(c[0],D),c.index=g.lastIndex,g.lastIndex+=c[0].length):g.lastIndex=0:Zy&&c&&(g.lastIndex=g.global?c.index+c[0].length:s),eI&&c&&c.length>1&&sl(zN,c[0],o,function(){for(l=1;l<arguments.length-2;l++)void 0===arguments[l]&&(c[l]=void 0)}),c&&v)for(c.groups=p=k4(null),l=0;l<v.length;l++)p[(h=v[l])[0]]=c[h[1]];return c});var cE=al;Ii({target:"RegExp",proto:!0,forced:/./.exec!==cE},{exec:cE});var B4=Rd,F4=Yi,uE=hi("unscopables"),Ug=Array.prototype;null==Ug[uE]&&F4.f(Ug,uE,{configurable:!0,value:B4(null)});var cl,lE,ZN,Vg={},e2=!An(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),t2=rt,Dd=Ki,n2=Er,r2=ad,U4=e2,V4=ss("IE_PROTO"),np=t2.Object,j4=np.prototype,jg=U4?np.getPrototypeOf:function(t){var i=r2(t);if(Dd(i,V4))return i[V4];var o=i.constructor;return n2(o)&&i instanceof o?o.prototype:i instanceof np?j4:null},o2=An,s2=Er,dE=jg,a2=Us.exports,rp=hi("iterator"),Qg=!1;[].keys&&("next"in(ZN=[].keys())?(lE=dE(dE(ZN)))!==Object.prototype&&(cl=lE):Qg=!0),(null==cl||o2(function(){var t={};return cl[rp].call(t)!==t}))&&(cl={}),s2(cl[rp])||a2(cl,rp,function(){return this});var hE={IteratorPrototype:cl,BUGGY_SAFARI_ITERATORS:Qg},tI=Yi.f,nI=Ki,pE=hi("toStringTag"),lu=function(t,i,o){t&&!o&&(t=t.prototype),t&&!nI(t,pE)&&tI(t,pE,{configurable:!0,value:i})},Q4=hE.IteratorPrototype,c2=Rd,G4=ma,H4=lu,u2=Vg,rI=function(){return this},iI=Er,wd=rt.String,W4=rt.TypeError,K4=Dn,rW=Io,du=Object.setPrototypeOf||("__proto__"in{}?function(){var t,i=!1,o={};try{(t=K4(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(o,[]),i=o instanceof Array}catch{}return function(s,c){return rW(s),function(t){if("object"==typeof t||iI(t))return t;throw W4("Can't set "+wd(t)+" as a prototype")}(c),i?t(s,c):s.__proto__=c,s}}():void 0),q4=Ii,l2=io,oI=Er,sI=jg,aI=du,h2=lu,J4=Fs,cI=Us.exports,z4=Vg,$4=On.PROPER,X4=On.CONFIGURABLE,hu=hE.IteratorPrototype,ul=hE.BUGGY_SAFARI_ITERATORS,Wg=hi("iterator"),fE="values",e8="entries",iW=function(){return this},oW=xh,gE=function(t){Ug[uE][t]=!0},p2=Vg,t8=Yi.f,uI=_r,pc="Array Iterator",Kg=as.set,g2=as.getterFor(pc),A2=function(t,i,o,s,c,l,p){!function(t,i,o,s){var c=i+" Iterator";t.prototype=c2(Q4,{next:G4(+!s,o)}),H4(t,c,!1),u2[c]=rI}(o,i,s);var h,g,f,A=function(O){if(O===c&&R)return R;if(!ul&&O in y)return y[O];switch(O){case"keys":case fE:case e8:return function(){return new o(this,O)}}return function(){return new o(this)}},_=i+" Iterator",v=!1,y=t.prototype,S=y[Wg]||y["@@iterator"]||c&&y[c],R=!ul&&S||A(c),D="Array"==i&&y.entries||S;if(D&&(h=sI(D.call(new t)))!==Object.prototype&&h.next&&(sI(h)!==hu&&(aI?aI(h,hu):oI(h[Wg])||cI(h,Wg,iW)),h2(h,_,!0)),$4&&c==fE&&S&&S.name!==fE&&(X4?J4(y,"name",fE):(v=!0,R=function(){return l2(S,this)})),c)if(g={values:A(fE),keys:l?R:A("keys"),entries:A(e8)},p)for(f in g)(ul||v||!(f in y))&&cI(y,f,g[f]);else q4({target:i,proto:!0,forced:ul||v},g);return y[Wg]!==R&&cI(y,Wg,R,{name:c}),z4[i]=R,g}(Array,"Array",function(t,i){Kg(this,{type:pc,target:oW(t),index:0,kind:i})},function(){var t=g2(this),i=t.target,o=t.kind,s=t.index++;return!i||s>=i.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==o?{value:s,done:!1}:"values"==o?{value:i[s],done:!1}:{value:[s,i[s]],done:!1}},"values"),lI=p2.Arguments=p2.Array;if(gE("keys"),gE("values"),gE("entries"),uI&&"values"!==lI.name)try{t8(lI,"name",{value:"values"})}catch{}var m2=jh("span").classList,r8=m2&&m2.constructor&&m2.constructor.prototype,AE=rt,mE={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},aW=r8===Object.prototype?void 0:r8,_E=A2,EE=Fs,_2=hi,dI=_2("iterator"),E2=_2("toStringTag"),hI=_E.values,pI=function(t,i){if(t){if(t[dI]!==hI)try{EE(t,dI,hI)}catch{t[dI]=hI}if(t[E2]||EE(t,E2,i),mE[i])for(var o in _E)if(t[o]!==_E[o])try{EE(t,o,_E[o])}catch{t[o]=_E[o]}}};for(var ip in mE)pI(AE[ip]&&AE[ip].prototype,ip);pI(aW,"DOMTokenList");var i8=Er,fI=tn,v2=du,Pr=function(t,i,o){var s,c;return v2&&i8(s=i.constructor)&&s!==o&&fI(c=s.prototype)&&c!==o.prototype&&v2(t,c),t},o8=xg,vE=function(t,i){return void 0===t?arguments.length<2?"":i:o8(t)},gI=tn,C2=Fs,s8=Dn("".replace),a8=String(Error("zxcasd").stack),y2=/\n\s*at [^:]*:[^\n]*/,c8=y2.test(a8),AI=function(t,i){if(c8&&"string"==typeof t)for(;i--;)t=s8(t,y2,"");return t},cW=ma,uW=!An(function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",cW(1,7)),7!==t.stack)}),op=Bs,mI=Ki,CE=Fs,I2=zc,_I=du,S2=tN,b2=Pr,T2=vE,EI=function(t,i){gI(i)&&"cause"in i&&C2(t,"cause",i.cause)},lW=AI,u8=uW,yE=Ii,Ra=F_,vI=function(t,i,o,s){var c=s?2:1,l=t.split("."),p=l[l.length-1],h=op.apply(null,l);if(h){var g=h.prototype;if(mI(g,"cause")&&delete g.cause,!o)return h;var f=op("Error"),A=i(function(_,v){var y=T2(s?v:_,void 0),S=s?new h(_):new h;return void 0!==y&&CE(S,"message",y),u8&&CE(S,"stack",lW(S.stack,2)),this&&I2(g,this)&&b2(S,this,A),arguments.length>c&&EI(S,arguments[c]),S});A.prototype=g,"Error"!==p&&(_I?_I(A,f):S2(A,f,{name:!0})),S2(A,h);try{g.name!==p&&CE(g,"name",p),g.constructor=A}catch{}return A}},R2=rt.WebAssembly,sp=7!==Error("e",{cause:7}).cause,fc=function(t,i){var o={};o[t]=vI(t,i,sp),yE({global:!0,forced:sp},o)},CI=function(t,i){if(R2&&R2[t]){var o={};o[t]=vI("WebAssembly."+t,i,sp),yE({target:"WebAssembly",stat:!0,forced:sp},o)}};fc("Error",function(t){return function(i){return Ra(t,this,arguments)}}),fc("EvalError",function(t){return function(i){return Ra(t,this,arguments)}}),fc("RangeError",function(t){return function(i){return Ra(t,this,arguments)}}),fc("ReferenceError",function(t){return function(i){return Ra(t,this,arguments)}}),fc("SyntaxError",function(t){return function(i){return Ra(t,this,arguments)}}),fc("TypeError",function(t){return function(i){return Ra(t,this,arguments)}}),fc("URIError",function(t){return function(i){return Ra(t,this,arguments)}}),CI("CompileError",function(t){return function(i){return Ra(t,this,arguments)}}),CI("LinkError",function(t){return function(i){return Ra(t,this,arguments)}}),CI("RuntimeError",function(t){return function(i){return Ra(t,this,arguments)}});let IE=!0,Yg=!0;function Ks(t,i,o){const s=t.match(i);return s&&s.length>=o&&parseInt(s[o],10)}function Od(t,i,o){if(!t.RTCPeerConnection)return;const s=t.RTCPeerConnection.prototype,c=s.addEventListener;s.addEventListener=function(p,h){if(p!==i)return c.apply(this,arguments);const g=f=>{const A=o(f);A&&(h.handleEvent?h.handleEvent(A):h(A))};return this._eventMap=this._eventMap||{},this._eventMap[i]||(this._eventMap[i]=new Map),this._eventMap[i].set(h,g),c.apply(this,[p,g])};const l=s.removeEventListener;s.removeEventListener=function(p,h){if(p!==i||!this._eventMap||!this._eventMap[i])return l.apply(this,arguments);if(!this._eventMap[i].has(h))return l.apply(this,arguments);const g=this._eventMap[i].get(h);return this._eventMap[i].delete(h),0===this._eventMap[i].size&&delete this._eventMap[i],0===Object.keys(this._eventMap).length&&delete this._eventMap,l.apply(this,[p,g])},Object.defineProperty(s,"on"+i,{get(){return this["_on"+i]},set(p){this["_on"+i]&&(this.removeEventListener(i,this["_on"+i]),delete this["_on"+i]),p&&this.addEventListener(i,this["_on"+i]=p)},enumerable:!0,configurable:!0})}function yI(t){return"boolean"!=typeof t?new Error("Argument type: "+typeof t+". Please use a boolean."):(IE=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function l8(t){return"boolean"!=typeof t?new Error("Argument type: "+typeof t+". Please use a boolean."):(Yg=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function II(){if("object"==typeof window){if(IE)return;typeof console<"u"&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function qg(t,i){Yg&&console.warn(t+" is deprecated, please use "+i+" instead.")}function ap(t){const i={browser:null,version:null};if(void 0===t||!t.navigator)return i.browser="Not a browser.",i;const{navigator:o}=t;if(o.mozGetUserMedia)i.browser="firefox",i.version=Ks(o.userAgent,/Firefox\/(\d+)\./,1);else if(o.webkitGetUserMedia||!1===t.isSecureContext&&t.webkitRTCPeerConnection&&!t.RTCIceGatherer)i.browser="chrome",i.version=Ks(o.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(o.mediaDevices&&o.userAgent.match(/Edge\/(\d+).(\d+)$/))i.browser="edge",i.version=Ks(o.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!t.RTCPeerConnection||!o.userAgent.match(/AppleWebKit\/(\d+)\./))return i.browser="Not a supported browser.",i;i.browser="safari",i.version=Ks(o.userAgent,/AppleWebKit\/(\d+)\./,1),i.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype}return i}function D2(t){return"[object Object]"===Object.prototype.toString.call(t)}function w2(t){var i;return D2(t)?hc(i=Object.keys(t)).call(i,function(o,s){const c=D2(t[s]),l=c?w2(t[s]):t[s],p=c&&!Object.keys(l).length;return void 0===l||p?o:Object.assign(o,{[s]:l})},{}):t}function N2(t,i,o){const s=o?"outbound-rtp":"inbound-rtp",c=new Map;if(null===i)return c;const l=[];return t.forEach(p=>{"track"===p.type&&p.trackIdentifier===i.id&&l.push(p)}),l.forEach(p=>{t.forEach(h=>{h.type===s&&h.trackId===p.id&&function g(f,A,_){A&&!_.has(A.id)&&(_.set(A.id,A),Object.keys(A).forEach(v=>{v.endsWith("Id")?g(f,f.get(A[v]),_):v.endsWith("Ids")&&A[v].forEach(y=>{g(f,f.get(y),_)})}))}(t,h,c)})}),c}var SI=bg,O2=(0,yg.exports)("keys"),Jg=function(t){return O2[t]||(O2[t]=SI(t))},h8=!Cr(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),P2=Dt,dW=qi,p8=Si,zg=su,f8=h8,Pd=Jg("IE_PROTO"),Qn=P2.Object,g8=Qn.prototype,M2=f8?Qn.getPrototypeOf:function(t){var i=zg(t);if(dW(i,Pd))return i[Pd];var o=i.constructor;return p8(o)&&i instanceof o?o.prototype:i instanceof Qn?g8:null},gs=Si,A8=Dt.String,m8=Dt.TypeError,$g=nr,_8=Ro,TI=Object.setPrototypeOf||("__proto__"in{}?function(){var t,i=!1,o={};try{(t=$g(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(o,[]),i=o instanceof Array}catch{}return function(s,c){return _8(s),function(t){if("object"==typeof t||gs(t))return t;throw m8("Can't set "+A8(t)+" as a prototype")}(c),i?t(s,c):s.__proto__=c,s}}():void 0),bE={},RI=My,cp=Math.max,E8=Math.min,DI=function(t,i){var o=RI(t);return o<0?cp(o+i,0):E8(o,i)},v8=ru,C8=DI,y8=dc,k2=function(t){return function(i,o,s){var c,l=v8(i),p=y8(l),h=C8(s,p);if(t&&o!=o){for(;p>h;)if((c=l[h++])!=c)return!0}else for(;p>h;h++)if((t||h in l)&&l[h]===o)return t||h||0;return!t&&-1}},I8={includes:k2(!0),indexOf:k2(!1)},pu={},Da=qi,S8=ru,b8=I8.indexOf,hW=pu,T8=nr([].push),wI=function(t,i){var o,s=S8(t),c=0,l=[];for(o in s)!Da(hW,o)&&Da(s,o)&&T8(l,o);for(;i.length>c;)Da(s,o=i[c++])&&(~b8(l,o)||T8(l,o));return l},L2=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],x2=wI,pW=L2.concat("length","prototype");bE.f=Object.getOwnPropertyNames||function(t){return x2(t,pW)};var Xg={};Xg.f=Object.getOwnPropertySymbols;var R8=Ws,B2=bE,D8=Xg,w8=Ro,wa=nr([].concat),N8=R8("Reflect","ownKeys")||function(t){var i=B2.f(w8(t)),o=D8.f;return o?wa(i,o(t)):i},NI=qi,O8=N8,P8=_g,M8=ba,TE={},F2=wI,k8=L2,RE=Object.keys||function(t){return F2(t,k8)},$e=ba,U2=Ro,V2=ru,x8=RE;TE.f=ve&&!MN?Object.defineProperties:function(t,i){U2(t);for(var o,s=V2(i),c=x8(i),l=c.length,p=0;l>p;)$e.f(t,o=c[p++],s[o]);return t};var DE,OI=Ws("document","documentElement"),B8=Ro,j2=TE,Q2=L2,F8=pu,fW=OI,G2=rl,PI=Jg("IE_PROTO"),gi=function(){},H2=function(t){return"<script>"+t+"<\/script>"},wE=function(t){t.write(H2("")),t.close();var i=t.parentWindow.Object;return t=null,i},up=function(){try{DE=new ActiveXObject("htmlfile")}catch{}var t,i;up=typeof document<"u"?document.domain&&DE?wE(DE):((i=G2("iframe")).style.display="none",fW.appendChild(i),i.src=String("javascript:"),(t=i.contentWindow.document).open(),t.write(H2("document.F=Object")),t.close(),t.F):wE(DE);for(var o=Q2.length;o--;)delete up.prototype[Q2[o]];return up()};F8[PI]=!0;var Zg=Object.create||function(t,i){var o;return null!==t?(gi.prototype=B8(t),o=new gi,gi.prototype=null,o[PI]=t):o=up(),void 0===i?o:j2.f(o,i)},gW=nr("".replace),AW=String(Error("zxcasd").stack),U8=/\n\s*at [^:]*:[^\n]*/,V8=U8.test(AW),W2=ds,mW=uu,lp={},dp=lp,j8=Jr("iterator"),K2=Array.prototype,eA=function(t){return void 0!==t&&(dp.Array===t||K2[j8]===t)},Y2={};Y2[Jr("toStringTag")]="z";var NE="[object z]"===String(Y2),Q8=Dt,G8=NE,H8=Si,OE=bi,W8=Jr("toStringTag"),q2=Q8.Object,K8="Arguments"==OE(function(){return arguments}()),gc=G8?OE:function(t){var i,o,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(o=function(c,l){try{return c[l]}catch{}}(i=q2(t),W8))?o:K8?OE(i):"Object"==(s=OE(i))&&H8(i.callee)?"Arguments":s},J2=gc,PE=Cy,_W=lp,MI=Jr("iterator"),ME=function(t){if(null!=t)return PE(t,MI)||PE(t,"@@iterator")||_W[J2(t)]},EW=an,se=Sa,kI=Ro,z2=nl,kE=ME,Na=Dt.TypeError,LE=function(t,i){var o=arguments.length<2?kE(t):i;if(se(o))return kI(EW(o,t));throw Na(z2(t)+" is not iterable")},Y8=an,xE=Ro,fu=Cy,BE=function(t,i,o){var s,c;xE(t);try{if(!(s=fu(t,"return"))){if("throw"===i)throw o;return o}s=Y8(s,t)}catch(l){c=!0,s=l}if("throw"===i)throw o;if(c)throw s;return xE(s),o},$2=cu,LI=an,vW=Ro,X2=nl,CW=eA,FE=dc,tA=To,xI=LE,BI=ME,UE=BE,yW=Dt.TypeError,VE=function(t,i){this.stopped=t,this.result=i},Z2=VE.prototype,jE=function(t,i,o){var s,c,l,p,h,g,f,_=!(!o||!o.AS_ENTRIES),v=!(!o||!o.IS_ITERATOR),y=!(!o||!o.INTERRUPTED),S=$2(i,o&&o.that),R=function(O){return s&&UE(s,"normal",O),new VE(!0,O)},D=function(O){return _?(vW(O),y?S(O[0],O[1],R):S(O[0],O[1])):y?S(O,R):S(O)};if(v)s=t;else{if(!(c=BI(t)))throw yW(X2(t)+" is not iterable");if(CW(c)){for(l=0,p=FE(t);p>l;l++)if((h=D(t[l]))&&tA(Z2,h))return h;return new VE(!1)}s=xI(t,c)}for(g=s.next;!(f=LI(g,s)).done;){try{h=D(f.value)}catch(O){UE(s,"throw",O)}if("object"==typeof h&&h&&tA(Z2,h))return h}return new VE(!1)},q8=gc,eO=Dt.String,Md=function(t){if("Symbol"===q8(t))throw TypeError("Cannot convert a Symbol value to a string");return eO(t)},J8=Md,IW=Ad,tO=!Cr(function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",IW(1,7)),7!==t.stack)}),nO=ei,z8=Dt,FI=To,SW=M2,UI=TI,$8=Zg,VI=uu,rO=Ad,TW=function(t,i){if(V8&&"string"==typeof t)for(;i--;)t=gW(t,U8,"");return t},RW=function(t,i){W2(i)&&"cause"in i&&mW(t,"cause",i.cause)},DW=jE,wW=function(t,i){return void 0===t?arguments.length<2?"":i:J8(t)},ll=tO,jI=Jr("toStringTag"),QE=z8.Error,iO=[].push,kd=function(t,i){var o,s=arguments.length>2?arguments[2]:void 0,c=FI(GE,this);UI?o=UI(new QE,c?SW(this):GE):(o=c?this:$8(GE),VI(o,jI,"Error")),void 0!==i&&VI(o,"message",wW(i)),ll&&VI(o,"stack",TW(o.stack,1)),RW(o,s);var l=[];return DW(t,iO,{that:l}),VI(o,"errors",l),o};UI?UI(kd,QE):function(t,i,o){for(var s=O8(i),c=M8.f,l=P8.f,p=0;p<s.length;p++){var h=s[p];NI(t,h)||o&&NI(o,h)||c(t,h,l(i,h))}}(kd,QE,{name:!0});var GE=kd.prototype=$8(QE.prototype,{constructor:rO(1,kd),message:rO(1,""),name:rO(1,"AggregateError")});nO({global:!0},{AggregateError:kd});var QI=Si,GI=yy,dl=nr(Function.toString);QI(GI.inspectSource)||(GI.inspectSource=function(t){return dl(t)});var nA,rA,HE,WE=GI.inspectSource,Z8=WE,iA=Dt.WeakMap,hp=Si(iA)&&/native code/.test(Z8(iA)),hl=nr,HI=ds,YE=uu,qE=qi,WI=Jg,KI=pu,YI="Object already initialized",oA=Dt.TypeError;if(hp||yy.state){var pp=yy.state||(yy.state=new(0,Dt.WeakMap)),t5=hl(pp.get),qI=hl(pp.has),n5=hl(pp.set);nA=function(t,i){if(qI(pp,t))throw new oA(YI);return i.facade=t,n5(pp,t,i),i},rA=function(t){return t5(pp,t)||{}},HE=function(t){return qI(pp,t)}}else{var Ld=WI("state");KI[Ld]=!0,nA=function(t,i){if(qE(t,Ld))throw new oA(YI);return i.facade=t,YE(t,Ld,i),i},rA=function(t){return qE(t,Ld)?t[Ld]:{}},HE=function(t){return qE(t,Ld)}}var pl,oO,zo,xd={set:nA,get:rA,has:HE,enforce:function(t){return HE(t)?rA(t):nA(t,{})},getterFor:function(t){return function(i){var o;if(!HI(i)||(o=rA(i)).type!==t)throw oA("Incompatible receiver, "+t+" required");return o}}},JI=ve,sO=Function.prototype,zI=JI&&Object.getOwnPropertyDescriptor,zE=qi(sO,"name"),aO={EXISTS:zE,PROPER:zE&&"something"===function(){}.name,CONFIGURABLE:zE&&(!JI||JI&&zI(sO,"name").configurable)},r5=uu,fp=function(t,i,o,s){s&&s.enumerable?t[i]=o:r5(t,i,o)},cO=Cr,i5=Si,uO=Zg,lO=M2,o5=fp,$E=Jr("iterator"),$I=!1;[].keys&&("next"in(zo=[].keys())?(oO=lO(lO(zo)))!==Object.prototype&&(pl=oO):$I=!0);var s5=null==pl||cO(function(){var t={};return pl[$E].call(t)!==t});i5((pl=s5?{}:uO(pl))[$E])||o5(pl,$E,function(){return this});var Oa={IteratorPrototype:pl,BUGGY_SAFARI_ITERATORS:$I},XI=gc,c5=NE,OW=ba.f,dO=uu,u5=qi,l5=NE?{}.toString:function(){return"[object "+XI(this)+"]"},hO=Jr("toStringTag"),gu=function(t,i,o,s){if(t){var c=o?t:t.prototype;u5(c,hO)||OW(c,hO,{configurable:!0,value:i}),s&&!c5&&dO(c,"toString",l5)}},d5=Oa.IteratorPrototype,h5=Zg,XE=Ad,ZI=gu,ZE=lp,PW=function(){return this},ev=function(t,i,o,s){var c=i+" Iterator";return t.prototype=h5(d5,{next:XE(+!s,o)}),ZI(t,c,!1,!0),ZE[c]=PW,t},MW=ei,pO=an,fO=ev,gO=M2,AO=gu,tv=fp,Ac=lp,nv=aO.PROPER,Bd=Oa.BUGGY_SAFARI_ITERATORS,Fd=Jr("iterator"),gp="values",eS="entries",p5=function(){return this},_O=function(t,i,o,s,c,l,p){fO(o,i,s);var h,g,f,A=function(O){if(O===c&&R)return R;if(!Bd&&O in y)return y[O];switch(O){case"keys":case gp:case eS:return function(){return new o(this,O)}}return function(){return new o(this)}},_=i+" Iterator",v=!1,y=t.prototype,S=y[Fd]||y["@@iterator"]||c&&y[c],R=!Bd&&S||A(c),D="Array"==i&&y.entries||S;if(D&&(h=gO(D.call(new t)))!==Object.prototype&&h.next&&(AO(h,_,!0,!0),Ac[_]=p5),nv&&c==gp&&S&&S.name!==gp&&(v=!0,R=function(){return pO(S,this)}),c)if(g={values:A(gp),keys:l?R:A("keys"),entries:A(eS)},p)for(f in g)(Bd||v||!(f in y))&&tv(y,f,g[f]);else MW({target:i,proto:!0,forced:Bd||v},g);return p&&y[Fd]!==R&&tv(y,Fd,R,{name:c}),Ac[i]=R,g},sA=ru,EO=lp,g5=_O,A5="Array Iterator",m5=xd.set,_5=xd.getterFor(A5);g5(Array,"Array",function(t,i){m5(this,{type:A5,target:sA(t),index:0,kind:i})},function(){var t=_5(this),i=t.target,o=t.kind,s=t.index++;return!i||s>=i.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==o?{value:s,done:!1}:"values"==o?{value:i[s],done:!1}:{value:[s,i[s]],done:!1}},"values"),EO.Arguments=EO.Array;var vO=Dt.Promise,CO=fp,Pn=function(t,i,o){for(var s in i)o&&o.unsafe&&t[s]?t[s]=i[s]:CO(t,s,i[s],o);return t},E5=Ws,tS=ba,v5=ve,yO=Jr("species"),C5=To,y5=Dt.TypeError,nS=function(t,i){if(C5(i,t))return t;throw y5("Incorrect invocation")},IO=Jr("iterator"),aA=!1;try{var Ud=0,I5={next:function(){return{done:!!Ud++}},return:function(){aA=!0}};I5[IO]=function(){return this},Array.from(I5,function(){throw 2})}catch{}var cA=nr,S5=Cr,SO=Si,rS=gc,b5=WE,Pa=function(){},uA=[],zi=Ws("Reflect","construct"),Au=/^\s*(?:class|function)\b/,rv=cA(Au.exec),Ys=!Au.exec(Pa),Mn=function(t){if(!SO(t))return!1;try{return zi(Pa,uA,t),!0}catch{return!1}},Vd=function(t){if(!SO(t))return!1;switch(rS(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Ys||!!rv(Au,b5(t))}catch{return!0}};Vd.sham=!0;var mc,Ma,jd,fl,mu=!zi||S5(function(){var t;return Mn(Mn.call)||!Mn(Object)||!Mn(function(){t=!0})||t})?Vd:Mn,Ap=mu,mp=nl,_p=Dt.TypeError,iS=Ro,TO=Jr("species"),oS=function(t,i){var o,s=iS(t).constructor;return void 0===s||null==(o=iS(s)[TO])?i:function(t){if(Ap(t))return t;throw _p(mp(t)+" is not a constructor")}(o)},iv=nr([].slice),sS=/(?:ipad|iphone|ipod).*applewebkit/i.test(iu),$o=Dt,RO=Q_,DO=cu,wO=Si,T5=qi,ke=Cr,NO=OI,qn=iv,Ue=rl,aS=sS,R5=ol,Ge=$o.setImmediate,He=$o.clearImmediate,Ir=$o.process,cS=$o.Dispatch,Ep=$o.Function,Qd=$o.MessageChannel,OO=$o.String,Ri=0,_u={};try{mc=$o.location}catch{}var lA=function(t){if(T5(_u,t)){var i=_u[t];delete _u[t],i()}},kt=function(t){return function(){lA(t)}},uS=function(t){lA(t.data)},MO=function(t){$o.postMessage(OO(t),mc.protocol+"//"+mc.host)};Ge&&He||(Ge=function(t){var i=qn(arguments,1);return _u[++Ri]=function(){RO(wO(t)?t:Ep(t),void 0,i)},Ma(Ri),Ri},He=function(t){delete _u[t]},R5?Ma=function(t){Ir.nextTick(kt(t))}:cS&&cS.now?Ma=function(t){cS.now(kt(t))}:Qd&&!aS?(fl=(jd=new Qd).port2,jd.port1.onmessage=uS,Ma=DO(fl.postMessage,fl)):$o.addEventListener&&wO($o.postMessage)&&!$o.importScripts&&mc&&"file:"!==mc.protocol&&!ke(MO)?(Ma=MO,$o.addEventListener("message",uS,!1)):Ma="onreadystatechange"in Ue("script")?function(t){NO.appendChild(Ue("script")).onreadystatechange=function(){NO.removeChild(this),lA(t)}}:function(t){setTimeout(kt(t),0)});var vp,gl,Cp,nt,lS,yp,Ip,Sp,bp={set:Ge,clear:He},kO=Dt,LO=/ipad|iphone|ipod/i.test(iu)&&void 0!==kO.Pebble,xO=/web0s(?!.*chrome)/i.test(iu),Al=Dt,dS=cu,ov=bp.set,FO=sS,kW=LO,D5=xO,hS=ol,pS=Al.MutationObserver||Al.WebKitMutationObserver,UO=Al.document,Ai=Al.process,dA=Al.Promise,VO=(0,_g.f)(Al,"queueMicrotask"),jO=VO&&VO.value;jO||(vp=function(){var t,i;for(hS&&(t=Ai.domain)&&t.exit();gl;){i=gl.fn,gl=gl.next;try{i()}catch(o){throw gl?nt():Cp=void 0,o}}Cp=void 0,t&&t.enter()},FO||hS||D5||!pS||!UO?!kW&&dA&&dA.resolve?((Ip=dA.resolve(void 0)).constructor=dA,Sp=dS(Ip.then,Ip),nt=function(){Sp(vp)}):hS?nt=function(){Ai.nextTick(vp)}:(ov=dS(ov,Al),nt=function(){ov(vp)}):(lS=!0,yp=UO.createTextNode(""),new pS(vp).observe(yp,{characterData:!0}),nt=function(){yp.data=lS=!lS}));var QO=jO||function(t){var i={fn:t,next:void 0};Cp&&(Cp.next=i),gl||(gl=i,nt()),Cp=i},Tp={},fS=Sa,GO=function(t){var i,o;this.promise=new t(function(s,c){if(void 0!==i||void 0!==o)throw TypeError("Bad Promise constructor");i=s,o=c}),this.resolve=fS(i),this.reject=fS(o)};Tp.f=function(t){return new GO(t)};var Rp=Ro,w5=ds,N5=Tp,gS=function(t,i){if(Rp(t),w5(i)&&i.constructor===t)return i;var o=N5.f(t);return(0,o.resolve)(i),o.promise},O5=Dt,hA=function(t){try{return{error:!1,value:t()}}catch(i){return{error:!0,value:i}}},P5=function(){this.head=null,this.tail=null};P5.prototype={add:function(t){var i={item:t,next:null};this.head?this.tail.next=i:this.head=i,this.tail=i},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var pA,pr,qs,M5="object"==typeof window,Js=ei,Ui=Dt,ka=Ws,Vi=an,sv=vO,HO=Pn,k5=gu,AS=Sa,av=Si,mS=ds,fA=nS,x5=WE,_S=jE,WO=oS,ES=bp.set,Dp=QO,F5=gS,ti=Tp,ml=hA,gA=P5,cv=xd,YO=lc,qO=M5,AA=ol,vS=qh,JO=Jr("species"),La="Promise",CS=cv.getterFor(La),U5=cv.set,V5=cv.getterFor(La),_c=sv,uv=sv&&sv.prototype,zO=Ui.TypeError,yS=Ui.document,IS=Ui.process,wp=ti.f,Q5=wp,G5=!!(yS&&yS.createEvent&&Ui.dispatchEvent),$O=av(Ui.PromiseRejectionEvent),XO="unhandledrejection",lv=YO(La,function(){var t=x5(_c),i=t!==String(_c);if(!i&&66===vS||!uv.finally)return!0;if(vS>=51&&/native code/.test(t))return!1;var o=new _c(function(c){c(1)}),s=function(c){c(function(){},function(){})};return(o.constructor={})[JO]=s,!(o.then(function(){})instanceof s)||!i&&qO&&!$O}),H5=lv||!function(t,i){if(!i&&!aA)return!1;var o=!1;try{var s={};s[IO]=function(){return{next:function(){return{done:o=!0}}}},t(s)}catch{}return o}(function(t){_c.all(t).catch(function(){})}),ZO=function(t){var i;return!(!mS(t)||!av(i=t.then))&&i},eP=function(t,i){var o,s,c,l=i.value,p=1==i.state,h=p?t.ok:t.fail,g=t.resolve,f=t.reject,A=t.domain;try{h?(p||(2===i.rejection&&rP(i),i.rejection=1),!0===h?o=l:(A&&A.enter(),o=h(l),A&&(A.exit(),c=!0)),o===t.promise?f(zO("Promise-chain cycle")):(s=ZO(o))?Vi(s,o,g,f):g(o)):f(l)}catch(_){A&&!c&&A.exit(),f(_)}},tP=function(t,i){t.notified||(t.notified=!0,Dp(function(){for(var o,s=t.reactions;o=s.get();)eP(o,t);t.notified=!1,i&&!t.rejection&&nP(t)}))},SS=function(t,i,o){var s,c;G5?((s=yS.createEvent("Event")).promise=i,s.reason=o,s.initEvent(t,!1,!0),Ui.dispatchEvent(s)):s={promise:i,reason:o},!$O&&(c=Ui["on"+t])?c(s):t===XO&&function(t,i){var o=O5.console;o&&o.error&&(1==arguments.length?o.error(t):o.error(t,i))}("Unhandled promise rejection",o)},nP=function(t){Vi(ES,Ui,function(){var i,o=t.facade,s=t.value;if(bS(t)&&(i=ml(function(){AA?IS.emit("unhandledRejection",s,o):SS(XO,o,s)}),t.rejection=AA||bS(t)?2:1,i.error))throw i.value})},bS=function(t){return 1!==t.rejection&&!t.parent},rP=function(t){Vi(ES,Ui,function(){var i=t.facade;AA?IS.emit("rejectionHandled",i):SS("rejectionhandled",i,t.value)})},Gd=function(t,i,o){return function(s){t(i,s,o)}},Hd=function(t,i,o){t.done||(t.done=!0,o&&(t=o),t.value=i,t.state=2,tP(t,!0))},dv=function(t,i,o){if(!t.done){t.done=!0,o&&(t=o);try{if(t.facade===i)throw zO("Promise can't be resolved itself");var s=ZO(i);s?Dp(function(){var c={done:!1};try{Vi(s,i,Gd(dv,c,t),Gd(Hd,c,t))}catch(l){Hd(c,l,t)}}):(t.value=i,t.state=1,tP(t,!1))}catch(c){Hd({done:!1},c,t)}}};lv&&(uv=(_c=function(t){fA(this,uv),AS(t),Vi(pA,this);var i=CS(this);try{t(Gd(dv,i),Gd(Hd,i))}catch(o){Hd(i,o)}}).prototype,(pA=function(t){U5(this,{type:La,done:!1,notified:!1,parent:!1,reactions:new gA,rejection:!1,state:0,value:void 0})}).prototype=HO(uv,{then:function(t,i){var o=V5(this),s=wp(WO(this,_c));return o.parent=!0,s.ok=!av(t)||t,s.fail=av(i)&&i,s.domain=AA?IS.domain:void 0,0==o.state?o.reactions.add(s):Dp(function(){eP(s,o)}),s.promise},catch:function(t){return this.then(void 0,t)}}),pr=function(){var t=new pA,i=CS(t);this.promise=t,this.resolve=Gd(dv,i),this.reject=Gd(Hd,i)},ti.f=wp=function(t){return t===_c||t===qs?new pr(t):Q5(t)}),Js({global:!0,wrap:!0,forced:lv},{Promise:_c}),k5(_c,La,!1,!0),function(t){var i=E5(t);v5&&i&&!i[yO]&&(0,tS.f)(i,yO,{configurable:!0,get:function(){return this}})}(La),qs=ka(La),Js({target:La,stat:!0,forced:lv},{reject:function(t){var i=wp(this);return Vi(i.reject,void 0,t),i.promise}}),Js({target:La,stat:!0,forced:!0},{resolve:function(t){return F5(this===qs?_c:this,t)}}),Js({target:La,stat:!0,forced:H5},{all:function(t){var i=this,o=wp(i),s=o.resolve,c=o.reject,l=ml(function(){var p=AS(i.resolve),h=[],g=0,f=1;_S(t,function(A){var _=g++,v=!1;f++,Vi(p,i,A).then(function(y){v||(v=!0,h[_]=y,--f||s(h))},c)}),--f||s(h)});return l.error&&c(l.value),o.promise},race:function(t){var i=this,o=wp(i),s=o.reject,c=ml(function(){var l=AS(i.resolve);_S(t,function(p){Vi(l,i,p).then(o.resolve,s)})});return c.error&&s(c.value),o.promise}});var iP=an,oP=Sa,_l=Tp,sP=hA,Wd=jE;ei({target:"Promise",stat:!0},{allSettled:function(t){var i=this,o=_l.f(i),s=o.resolve,c=o.reject,l=sP(function(){var p=oP(i.resolve),h=[],g=0,f=1;Wd(t,function(A){var _=g++,v=!1;f++,iP(p,i,A).then(function(y){v||(v=!0,h[_]={status:"fulfilled",value:y},--f||s(h))},function(y){v||(v=!0,h[_]={status:"rejected",reason:y},--f||s(h))})}),--f||s(h)});return l.error&&c(l.value),o.promise}});var W5=Sa,K5=Ws,Np=an,LW=Tp,Do=hA,xW=jE,TS="No one promise resolved";ei({target:"Promise",stat:!0},{any:function(t){var i=this,o=K5("AggregateError"),s=LW.f(i),c=s.resolve,l=s.reject,p=Do(function(){var h=W5(i.resolve),g=[],f=0,A=1,_=!1;xW(t,function(v){var y=f++,S=!1;A++,Np(h,i,v).then(function(R){S||_||(_=!0,c(R))},function(R){S||_||(S=!0,g[y]=R,--A||l(new o(g,TS)))})}),--A||l(new o(g,TS))});return p.error&&l(p.value),s.promise}});var RS=vO,BW=Ws,Xe=Si,Y5=oS,aP=gS;ei({target:"Promise",proto:!0,real:!0,forced:!!RS&&Cr(function(){RS.prototype.finally.call({then:function(){}},function(){})})},{finally:function(t){var i=Y5(this,BW("Promise")),o=Xe(t);return this.then(o?function(s){return aP(i,t()).then(function(){return s})}:t,o?function(s){return aP(i,t()).then(function(){throw s})}:t)}});var DS=nr,Op=My,q5=Md,hv=G_,pv=DS("".charAt),Mr=DS("".charCodeAt),FW=DS("".slice),wS=function(t){return function(i,o){var s,c,l=q5(hv(i)),p=Op(o),h=l.length;return p<0||p>=h?t?"":void 0:(s=Mr(l,p))<55296||s>56319||p+1===h||(c=Mr(l,p+1))<56320||c>57343?t?pv(l,p):s:t?FW(l,p,p+2):c-56320+(s-55296<<10)+65536}},NS={codeAt:wS(!1),charAt:wS(!0)},J5=NS.charAt,cP=Md,uP=_O,PS="String Iterator",z5=xd.set,$5=xd.getterFor(PS);uP(String,"String",function(t){z5(this,{type:PS,string:cP(t),index:0})},function(){var t,i=$5(this),o=i.string,s=i.index;return s>=o.length?{value:void 0,done:!0}:(t=J5(o,s),i.index+=t.length,{value:t,done:!1})});var X5=cc.Promise,Z5=Dt,eV=gc,tV=uu,_A=lp,MS=Jr("toStringTag");for(var fv in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var kS=Z5[fv],LS=kS&&kS.prototype;LS&&eV(LS)!==MS&&tV(LS,MS,fv),_A[fv]=_A.Array}var Pp=X5,Ie=Pp,gv="process"==od(rt.process),nV=gv,rV=zc,lP=rt.TypeError,Mp=function(t,i){if(rV(i,t))return t;throw lP("Incorrect invocation")},dP=_r,hP=Io,oV=Rd,pP=vE,xS=Error.prototype.toString,UW=An(function(){if(dP){var t=oV(Object.defineProperty({},"name",{get:function(){return this===t}}));if("true"!==xS.call(t))return!0}return"2: 1"!==xS.call({message:1,name:2})||"Error"!==xS.call({})})?function(){var t=hP(this),i=pP(t.name,"Error"),o=pP(t.message);return i?o?i+": "+o:i:o}:xS,sV={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}},VW=Ii,Kd=Bs,BS=An,aV=Rd,Av=ma,Eu=Yi.f,cV=oE.f,uV=Us.exports,mv=Ki,lV=Mp,dV=Io,FS=UW,gP=vE,kp=sV,EA=AI,AP=as,_v=_r,Lp="DOMException",Ev=Kd("Error"),Ec=Kd(Lp)||function(){try{(new(Kd("MessageChannel")||function(t){try{if(nV)return Function('return require("'+t+'")')()}catch{}}("worker_threads").MessageChannel)).port1.postMessage(new WeakMap)}catch(t){if("DATA_CLONE_ERR"==t.name&&25==t.code)return t.constructor}}(),vv=Ev.prototype,pV=AP.set,_P=AP.getterFor(Lp),EP="stack"in Ev(Lp),vP=function(t){return mv(kp,t)&&kp[t].m?kp[t].c:0},US=function(){lV(this,VS);var t=arguments.length,i=gP(t<1?void 0:arguments[0]),o=gP(t<2?void 0:arguments[1],"Error"),s=vP(o);if(pV(this,{type:Lp,name:o,message:i,code:s}),_v||(this.name=o,this.message=i,this.code=s),EP){var c=Ev(i);c.name=Lp,Eu(this,"stack",Av(1,EA(c.stack,1)))}},VS=US.prototype=aV(vv),Cv=function(t){return{enumerable:!0,configurable:!0,get:t}},jS=function(t){return Cv(function(){return _P(this)[t]})};_v&&cV(VS,{name:jS("name"),message:jS("message"),code:jS("code")}),Eu(VS,"constructor",Av(1,US));var xp=BS(function(){return!(new Ec instanceof Ev)}),fV=xp||BS(function(){return vv.toString!==FS||"2: 1"!==String(new Ec(1,2))}),gV=xp||BS(function(){return 25!==new Ec(1,"DataCloneError").code});VW({global:!0,forced:xp},{DOMException:xp?US:Ec});var vA=Kd(Lp),yv=vA.prototype;for(var CP in fV&&Ec===vA&&uV(yv,"toString",FS),gV&&_v&&Ec===vA&&Eu(yv,"code",Cv(function(){return vP(dV(this).name)})),kp)if(mv(kp,CP)){var yP=kp[CP],Iv=yP.s,IP=Av(6,yP.c);mv(vA,Iv)||Eu(vA,Iv,IP),mv(yv,Iv)||Eu(yv,Iv,IP)}var SP=Ii,Sv=Bs,vc=ma,QS=Yi.f,bv=Ki,bP=Mp,AV=Pr,TP=vE,CA=sV,GS=AI,yA="DOMException",Tv=Sv("Error"),Rv=Sv(yA),HS=function(){bP(this,WS);var t=arguments.length,i=TP(t<1?void 0:arguments[0]),o=TP(t<2?void 0:arguments[1],"Error"),s=new Rv(i,o),c=Tv(i);return c.name=yA,QS(s,"stack",vc(1,GS(c.stack,1))),AV(s,this,HS),s},WS=HS.prototype=Rv.prototype,mV="stack"in Tv(yA),fr="stack"in new Rv(1,2),El=mV&&!fr;SP({global:!0,forced:El},{DOMException:El?HS:Rv});var Bp=Sv(yA),RP=Bp.prototype;if(RP.constructor!==Bp)for(var _V in QS(RP,"constructor",vc(1,Bp)),CA)if(bv(CA,_V)){var KS=CA[_V],Dv=KS.s;bv(Bp,Dv)||QS(Bp,Dv,vc(6,KS.c))}var DP="DOMException";lu(Bs(DP),DP);var IA=Dn,wP=Us.exports,NP=cE,wv=An,YS=hi,OP=Fs,PP=YS("species"),Nv=RegExp.prototype,qS=Dn,EV=Qs,vV=xg,CV=v_,MP=qS("".charAt),yV=qS("".charCodeAt),kP=qS("".slice),LP=function(t){return function(i,o){var s,c,l=vV(CV(i)),p=EV(o),h=l.length;return p<0||p>=h?t?"":void 0:(s=yV(l,p))<55296||s>56319||p+1===h||(c=yV(l,p+1))<56320||c>57343?t?MP(l,p):s:t?kP(l,p,p+2):c-56320+(s-55296<<10)+65536}},IV=(LP(!1),LP(!0)),xP=Dn,jW=ad,SV=Math.floor,JS=xP("".charAt),bV=xP("".replace),wo=xP("".slice),SA=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,zS=/\$([$&'`]|\d{1,2})/g,BP=io,TV=Io,RV=Er,DV=od,wV=cE,NV=rt.TypeError,bA=F_,$S=io,TA=Dn,UP=An,VP=Io,OV=Er,PV=Qs,QW=Xr,Fp=xg,MV=v_,kV=function(t,i,o){return i+(o?IV(t,i).length:1)},LV=cg,xV=function(t,i,o,s,c,l){var p=o+t.length,h=s.length,g=zS;return void 0!==c&&(c=jW(c),g=SA),bV(l,g,function(f,A){var _;switch(JS(A,0)){case"$":return"$";case"&":return t;case"`":return wo(i,0,o);case"'":return wo(i,p);case"<":_=c[wo(A,1,-1)];break;default:var v=+A;if(0===v)return f;if(v>h){var y=SV(v/10);return 0===y?f:y<=h?void 0===s[y-1]?JS(A,1):s[y-1]+JS(A,1):f}_=s[v-1]}return void 0===_?"":_})},RA=function(t,i){var o=t.exec;if(RV(o)){var s=BP(o,t,i);return null!==s&&TV(s),s}if("RegExp"===DV(t))return BP(wV,t,i);throw NV("RegExp#exec called on incompatible receiver")},XS=hi("replace"),ZS=Math.max,Ft=Math.min,BV=TA([].concat),DA=TA([].push),gr=TA("".indexOf),jP=TA("".slice),FV="$0"==="a".replace(/./,"$0"),QP=!!/./[XS]&&""===/./[XS]("a","$0");!function(t,i,o,s){var c=YS(t),l=!wv(function(){var f={};return f[c]=function(){return 7},7!=""[t](f)}),p=l&&!wv(function(){var f=!1,A=/a/;return"split"===t&&((A={}).constructor={},A.constructor[PP]=function(){return A},A.flags="",A[c]=/./[c]),A.exec=function(){return f=!0,null},A[c](""),!f});if(!l||!p||o){var h=IA(/./[c]),g=i(c,""[t],function(f,A,_,v,y){var S=IA(f),R=A.exec;return R===NP||R===Nv.exec?l&&!y?{done:!0,value:h(A,_,v)}:{done:!0,value:S(_,A,v)}:{done:!1}});wP(String.prototype,t,g[0]),wP(Nv,c,g[1])}s&&OP(Nv[c],"sham",!0)}("replace",function(t,i,o){var s=QP?"$":"$0";return[function(c,l){var p=MV(this),h=null==c?void 0:LV(c,XS);return h?$S(h,c,p,l):$S(i,Fp(p),c,l)},function(c,l){var p=VP(this),h=Fp(c);if("string"==typeof l&&-1===gr(l,s)&&-1===gr(l,"$<")){var g=o(i,p,h,l);if(g.done)return g.value}var f=OV(l);f||(l=Fp(l));var A=p.global;if(A){var _=p.unicode;p.lastIndex=0}for(var v=[];;){var y=RA(p,h);if(null===y||(DA(v,y),!A))break;""===Fp(y[0])&&(p.lastIndex=kV(h,QW(p.lastIndex),_))}for(var S,R="",D=0,O=0;O<v.length;O++){for(var P=Fp((y=v[O])[0]),B=ZS(Ft(PV(y.index),h.length),0),G=[],Y=1;Y<y.length;Y++)DA(G,void 0===(S=y[Y])?S:String(S));var ae=y.groups;if(f){var te=BV([P],G,B,h);void 0!==ae&&DA(te,ae);var Z=Fp(bA(l,void 0,te))}else Z=xV(P,h,B,G,ae,l);B>=D&&(R+=jP(h,D,B)+Z,D=B+P.length)}return R+jP(h,D)}]},!!UP(function(){var t=/./;return t.exec=function(){var i=[];return i.groups={a:"7"},i},"7"!=="".replace(t,"$<a>")})||!FV||QP);var Ov=tn,As=od,UV=hi("match"),VV=Bs,GP=Yi,HP=_r,Pv=hi("species"),wA=function(t){var i=VV(t);HP&&i&&!i[Pv]&&(0,GP.f)(i,Pv,{configurable:!0,get:function(){return this}})},jV=_r,eb=rt,NA=Dn,tb=nN,nb=Pr,WP=Fs,rb=Yi.f,ib=Kr.f,KP=zc,YP=xg,GV=y4,ob=Qy,sb=Us.exports,kr=An,ab=Ki,ni=as.enforce,Lr=wA,qP=qy,cb=qN,JP=hi("match"),vu=eb.RegExp,Yd=vu.prototype,xr=eb.SyntaxError,No=NA(GV),Up=NA(Yd.exec),Mv=NA("".charAt),zP=NA("".replace),HV=NA("".indexOf),GW=NA("".slice),$P=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,vl=/a/g,qd=/a/g,WV=new vu(vl)!==vl,kv=ob.MISSED_STICKY,KV=ob.UNSUPPORTED_Y;if(tb("RegExp",jV&&(!WV||kv||qP||cb||kr(function(){return qd[JP]=!1,vu(vl)!=vl||vu(qd)==qd||"/a/i"!=vu(vl,"i")})))){for(var Cl=function(t,i){var o,s,c,l,p,h,g=KP(Yd,this),f=function(t){var i;return Ov(t)&&(void 0!==(i=t[UV])?!!i:"RegExp"==As(t))}(t),A=void 0===i,_=[],v=t;if(!g&&f&&A&&t.constructor===Cl)return t;if((f||KP(Yd,t))&&(t=t.source,A&&(i="flags"in v?v.flags:No(v))),t=void 0===t?"":YP(t),i=void 0===i?"":YP(i),v=t,qP&&"dotAll"in vl&&(s=!!i&&HV(i,"s")>-1)&&(i=zP(i,/s/g,"")),o=i,kv&&"sticky"in vl&&(c=!!i&&HV(i,"y")>-1)&&KV&&(i=zP(i,/y/g,"")),cb&&(t=(l=function(y){for(var S,R=y.length,D=0,O="",P=[],B={},G=!1,Y=!1,ae=0,te="";D<=R;D++){if("\\"===(S=Mv(y,D)))S+=Mv(y,++D);else if("]"===S)G=!1;else if(!G)switch(!0){case"["===S:G=!0;break;case"("===S:Up($P,GW(y,D+1))&&(D+=2,Y=!0),O+=S,ae++;continue;case">"===S&&Y:if(""===te||ab(B,te))throw new xr("Invalid capture group name");B[te]=!0,P[P.length]=[te,ae],Y=!1,te="";continue}Y?te+=S:O+=S}return[O,P]}(t))[0],_=l[1]),p=nb(vu(t,i),g?this:Yd,Cl),(s||c||_.length)&&(h=ni(p),s&&(h.dotAll=!0,h.raw=Cl(function(y){for(var S,R=y.length,D=0,O="",P=!1;D<=R;D++)"\\"!==(S=Mv(y,D))?P||"."!==S?("["===S?P=!0:"]"===S&&(P=!1),O+=S):O+="[\\s\\S]":O+=S+Mv(y,++D);return O}(t),o)),c&&(h.sticky=!0),_.length&&(h.groups=_)),t!==v)try{WP(p,"source",""===v?"(?:)":v)}catch{}return p},YV=function(t){t in Cl||rb(Cl,t,{configurable:!0,get:function(){return vu[t]},set:function(i){vu[t]=i}})},ZP=ib(vu),Lv=0;ZP.length>Lv;)YV(ZP[Lv++]);Yd.constructor=Cl,Cl.prototype=Yd,sb(eb,"RegExp",Cl)}Lr("RegExp");var ub=od,nM=as.get,rM=RegExp.prototype,iM=rt.TypeError;_r&&qy&&(0,Yi.f)(rM,"dotAll",{configurable:!0,get:function(){if(this!==rM){if("RegExp"===ub(this))return!!nM(this).dotAll;throw iM("Incompatible receiver, RegExp required")}}});const Jd=II;function oM(t,i){const o=t&&t.navigator;if(!o.mediaDevices)return;const s=function(p){if("object"!=typeof p||p.mandatory||p.optional)return p;const h={};return Object.keys(p).forEach(g=>{if("require"===g||"advanced"===g||"mediaSource"===g)return;const f="object"==typeof p[g]?p[g]:{ideal:p[g]};void 0!==f.exact&&"number"==typeof f.exact&&(f.min=f.max=f.exact);const A=function(_,v){return _?_+v.charAt(0).toUpperCase()+v.slice(1):"deviceId"===v?"sourceId":v};if(void 0!==f.ideal){h.optional=h.optional||[];let _={};"number"==typeof f.ideal?(_[A("min",g)]=f.ideal,h.optional.push(_),_={},_[A("max",g)]=f.ideal,h.optional.push(_)):(_[A("",g)]=f.ideal,h.optional.push(_))}void 0!==f.exact&&"number"!=typeof f.exact?(h.mandatory=h.mandatory||{},h.mandatory[A("",g)]=f.exact):["min","max"].forEach(_=>{void 0!==f[_]&&(h.mandatory=h.mandatory||{},h.mandatory[A(_,g)]=f[_])})}),p.advanced&&(h.optional=(h.optional||[]).concat(p.advanced)),h},c=function(p,h){if(i.version>=61)return h(p);if((p=JSON.parse(JSON.stringify(p)))&&"object"==typeof p.audio){const g=function(f,A,_){A in f&&!(_ in f)&&(f[_]=f[A],delete f[A])};g((p=JSON.parse(JSON.stringify(p))).audio,"autoGainControl","googAutoGainControl"),g(p.audio,"noiseSuppression","googNoiseSuppression"),p.audio=s(p.audio)}if(p&&"object"==typeof p.video){let g=p.video.facingMode;g=g&&("object"==typeof g?g:{ideal:g});const f=i.version<66;if(g&&("user"===g.exact||"environment"===g.exact||"user"===g.ideal||"environment"===g.ideal)&&(!o.mediaDevices.getSupportedConstraints||!o.mediaDevices.getSupportedConstraints().facingMode||f)){let A;if(delete p.video.facingMode,"environment"===g.exact||"environment"===g.ideal?A=["back","rear"]:"user"!==g.exact&&"user"!==g.ideal||(A=["front"]),A)return o.mediaDevices.enumerateDevices().then(_=>{let v=(_=_.filter(y=>"videoinput"===y.kind)).find(y=>A.some(S=>y.label.toLowerCase().includes(S)));return!v&&_.length&&A.includes("back")&&(v=_[_.length-1]),v&&(p.video.deviceId=g.exact?{exact:v.deviceId}:{ideal:v.deviceId}),p.video=s(p.video),Jd("chrome: "+JSON.stringify(p)),h(p)})}p.video=s(p.video)}return Jd("chrome: "+JSON.stringify(p)),h(p)},l=function(p){return i.version>=64?p:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[p.name]||p.name,message:p.message,constraint:p.constraint||p.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(o.getUserMedia=function(p,h,g){c(p,f=>{o.webkitGetUserMedia(f,h,A=>{g&&g(l(A))})})}.bind(o),o.mediaDevices.getUserMedia){const p=o.mediaDevices.getUserMedia.bind(o.mediaDevices);o.mediaDevices.getUserMedia=function(h){return c(h,g=>p(g).then(f=>{if(g.audio&&!f.getAudioTracks().length||g.video&&!f.getVideoTracks().length)throw f.getTracks().forEach(A=>{A.stop()}),new DOMException("","NotFoundError");return f},f=>Ie.reject(l(f))))}}}function lb(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function Bv(t){if("object"==typeof t&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(o){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=o)},enumerable:!0,configurable:!0});const i=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=o=>{o.stream.addEventListener("addtrack",s=>{let c;c=t.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(p=>p.track&&p.track.id===s.track.id):{track:s.track};const l=new Event("track");l.track=s.track,l.receiver=c,l.transceiver={receiver:c},l.streams=[o.stream],this.dispatchEvent(l)}),o.stream.getTracks().forEach(s=>{let c;c=t.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(p=>p.track&&p.track.id===s.id):{track:s};const l=new Event("track");l.track=s,l.receiver=c,l.transceiver={receiver:c},l.streams=[o.stream],this.dispatchEvent(l)})},this.addEventListener("addstream",this._ontrackpoly)),i.apply(this,arguments)}}else Od(t,"track",i=>(i.transceiver||Object.defineProperty(i,"transceiver",{value:{receiver:i.receiver}}),i))}function qV(t){if("object"==typeof t&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const i=function(c,l){return{track:l,get dtmf(){return void 0===this._dtmf&&(this._dtmf="audio"===l.kind?c.createDTMFSender(l):null),this._dtmf},_pc:c}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const c=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(p,h){let g=c.apply(this,arguments);return g||(g=i(this,p),this._senders.push(g)),g};const l=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(p){l.apply(this,arguments);const h=this._senders.indexOf(p);-1!==h&&this._senders.splice(h,1)}}const o=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(c){this._senders=this._senders||[],o.apply(this,[c]),c.getTracks().forEach(l=>{this._senders.push(i(this,l))})};const s=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(c){this._senders=this._senders||[],s.apply(this,[c]),c.getTracks().forEach(l=>{const p=this._senders.find(h=>h.track===l);p&&this._senders.splice(this._senders.indexOf(p),1)})}}else if("object"==typeof t&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const i=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const o=i.apply(this,[]);return o.forEach(s=>s._pc=this),o},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null),this._dtmf}})}}function sM(t){if(!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[o,s,c]=arguments;if(arguments.length>0&&"function"==typeof o)return i.apply(this,arguments);if(0===i.length&&(0===arguments.length||"function"!=typeof o))return i.apply(this,[]);const l=function(h){const g={};return h.result().forEach(f=>{const A={id:f.id,timestamp:f.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[f.type]||f.type};f.names().forEach(_=>{A[_]=f.stat(_)}),g[A.id]=A}),g},p=function(h){return new Map(Object.keys(h).map(g=>[g,h[g]]))};return arguments.length>=2?i.apply(this,[function(g){s(p(l(g)))},o]):new Ie((h,g)=>{i.apply(this,[function(f){h(p(l(f)))},g])}).then(s,c)}}function JV(t){if(!("object"==typeof t&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const o=t.RTCPeerConnection.prototype.getSenders;o&&(t.RTCPeerConnection.prototype.getSenders=function(){const c=o.apply(this,[]);return c.forEach(l=>l._pc=this),c});const s=t.RTCPeerConnection.prototype.addTrack;s&&(t.RTCPeerConnection.prototype.addTrack=function(){const c=s.apply(this,arguments);return c._pc=this,c}),t.RTCRtpSender.prototype.getStats=function(){const c=this;return this._pc.getStats().then(l=>N2(l,c.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const o=t.RTCPeerConnection.prototype.getReceivers;o&&(t.RTCPeerConnection.prototype.getReceivers=function(){const s=o.apply(this,[]);return s.forEach(c=>c._pc=this),s}),Od(t,"track",s=>(s.receiver._pc=s.srcElement,s)),t.RTCRtpReceiver.prototype.getStats=function(){const s=this;return this._pc.getStats().then(c=>N2(c,s.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype)||!("getStats"in t.RTCRtpReceiver.prototype))return;const i=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const o=arguments[0];let s,c,l;return this.getSenders().forEach(p=>{p.track===o&&(s?l=!0:s=p)}),this.getReceivers().forEach(p=>(p.track===o&&(c?l=!0:c=p),p.track===o)),l||s&&c?Ie.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):s?s.getStats():c?c.getStats():Ie.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}function aM(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(l=>this._shimmedLocalStreams[l][0])};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(l,p){if(!p)return i.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const h=i.apply(this,arguments);return this._shimmedLocalStreams[p.id]?-1===this._shimmedLocalStreams[p.id].indexOf(h)&&this._shimmedLocalStreams[p.id].push(h):this._shimmedLocalStreams[p.id]=[p,h],h};const o=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(l){this._shimmedLocalStreams=this._shimmedLocalStreams||{},l.getTracks().forEach(g=>{if(this.getSenders().find(f=>f.track===g))throw new DOMException("Track already exists.","InvalidAccessError")});const p=this.getSenders();o.apply(this,arguments);const h=this.getSenders().filter(g=>-1===p.indexOf(g));this._shimmedLocalStreams[l.id]=[l].concat(h)};const s=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(l){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[l.id],s.apply(this,arguments)};const c=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(l){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},l&&Object.keys(this._shimmedLocalStreams).forEach(p=>{const h=this._shimmedLocalStreams[p].indexOf(l);-1!==h&&this._shimmedLocalStreams[p].splice(h,1),1===this._shimmedLocalStreams[p].length&&delete this._shimmedLocalStreams[p]}),c.apply(this,arguments)}}function cM(t,i){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&i.version>=65)return aM(t);const o=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const f=o.apply(this);return this._reverseStreams=this._reverseStreams||{},f.map(A=>this._reverseStreams[A.id])};const s=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(f){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},f.getTracks().forEach(A=>{if(this.getSenders().find(_=>_.track===A))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[f.id]){const A=new t.MediaStream(f.getTracks());this._streams[f.id]=A,this._reverseStreams[A.id]=f,f=A}s.apply(this,[f])};const c=t.RTCPeerConnection.prototype.removeStream;function l(f,A){let _=A.sdp;return Object.keys(f._reverseStreams||[]).forEach(v=>{const y=f._reverseStreams[v];_=_.replace(new RegExp(f._streams[y.id].id,"g"),y.id)}),new RTCSessionDescription({type:A.type,sdp:_})}function p(f,A){let _=A.sdp;return Object.keys(f._reverseStreams||[]).forEach(v=>{const y=f._reverseStreams[v],S=f._streams[y.id];_=_.replace(new RegExp(y.id,"g"),S.id)}),new RTCSessionDescription({type:A.type,sdp:_})}t.RTCPeerConnection.prototype.removeStream=function(f){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.apply(this,[this._streams[f.id]||f]),delete this._reverseStreams[this._streams[f.id]?this._streams[f.id].id:f.id],delete this._streams[f.id]},t.RTCPeerConnection.prototype.addTrack=function(f,A){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const _=[].slice.call(arguments,1);if(1!==_.length||!_[0].getTracks().find(S=>S===f))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(S=>S.track===f))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const y=this._streams[A.id];if(y)y.addTrack(f),Ie.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const S=new t.MediaStream([f]);this._streams[A.id]=S,this._reverseStreams[S.id]=A,this.addStream(S)}return this.getSenders().find(S=>S.track===f)},["createOffer","createAnswer"].forEach(function(f){const A=t.RTCPeerConnection.prototype[f],_={[f](){const v=arguments;return arguments.length&&"function"==typeof arguments[0]?A.apply(this,[y=>{const S=l(this,y);v[0].apply(null,[S])},y=>{v[1]&&v[1].apply(null,y)},arguments[2]]):A.apply(this,arguments).then(y=>l(this,y))}};t.RTCPeerConnection.prototype[f]=_[f]});const h=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=p(this,arguments[0]),h.apply(this,arguments)):h.apply(this,arguments)};const g=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const f=g.get.apply(this);return""===f.type?f:l(this,f)}}),t.RTCPeerConnection.prototype.removeTrack=function(f){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!f._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(f._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let A;this._streams=this._streams||{},Object.keys(this._streams).forEach(_=>{this._streams[_].getTracks().find(v=>f.track===v)&&(A=this._streams[_])}),A&&(1===A.getTracks().length?this.removeStream(this._reverseStreams[A.id]):A.removeTrack(f.track),this.dispatchEvent(new Event("negotiationneeded")))}}function db(t,i){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&i.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(o){const s=t.RTCPeerConnection.prototype[o],c={[o](){return arguments[0]=new("addIceCandidate"===o?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};t.RTCPeerConnection.prototype[o]=c[o]})}function hb(t,i){Od(t,"negotiationneeded",o=>{const s=o.target;if(!(i.version<72||s.getConfiguration&&"plan-b"===s.getConfiguration().sdpSemantics)||"stable"===s.signalingState)return o})}var pb=Object.freeze({__proto__:null,shimMediaStream:lb,shimOnTrack:Bv,shimGetSendersWithDtmf:qV,shimGetStats:sM,shimSenderReceiverGetStats:JV,shimAddTrackRemoveTrackWithNative:aM,shimAddTrackRemoveTrack:cM,shimPeerConnection:db,fixNegotiationNeeded:hb,shimGetUserMedia:oM,shimGetDisplayMedia:function(t,i){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&("function"==typeof i?t.navigator.mediaDevices.getDisplayMedia=function(o){return i(o).then(s=>{const c=o.video&&o.video.width,l=o.video&&o.video.height;return o.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s,maxFrameRate:o.video&&o.video.frameRate||3}},c&&(o.video.mandatory.maxWidth=c),l&&(o.video.mandatory.maxHeight=l),t.navigator.mediaDevices.getUserMedia(o)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}}),uM={exports:{}};!function(t){var i={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};i.localCName=i.generateIdentifier(),i.splitLines=function(o){return o.trim().split("\n").map(function(s){return s.trim()})},i.splitSections=function(o){return o.split("\nm=").map(function(s,c){return(c>0?"m="+s:s).trim()+"\r\n"})},i.getDescription=function(o){var s=i.splitSections(o);return s&&s[0]},i.getMediaSections=function(o){var s=i.splitSections(o);return s.shift(),s},i.matchPrefix=function(o,s){return i.splitLines(o).filter(function(c){return 0===c.indexOf(s)})},i.parseCandidate=function(o){for(var s,c={foundation:(s=0===o.indexOf("a=candidate:")?o.substring(12).split(" "):o.substring(10).split(" "))[0],component:parseInt(s[1],10),protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]},l=8;l<s.length;l+=2)switch(s[l]){case"raddr":c.relatedAddress=s[l+1];break;case"rport":c.relatedPort=parseInt(s[l+1],10);break;case"tcptype":c.tcpType=s[l+1];break;case"ufrag":c.ufrag=s[l+1],c.usernameFragment=s[l+1];break;default:c[s[l]]=s[l+1]}return c},i.writeCandidate=function(o){var s=[];s.push(o.foundation),s.push(o.component),s.push(o.protocol.toUpperCase()),s.push(o.priority),s.push(o.address||o.ip),s.push(o.port);var c=o.type;return s.push("typ"),s.push(c),"host"!==c&&o.relatedAddress&&o.relatedPort&&(s.push("raddr"),s.push(o.relatedAddress),s.push("rport"),s.push(o.relatedPort)),o.tcpType&&"tcp"===o.protocol.toLowerCase()&&(s.push("tcptype"),s.push(o.tcpType)),(o.usernameFragment||o.ufrag)&&(s.push("ufrag"),s.push(o.usernameFragment||o.ufrag)),"candidate:"+s.join(" ")},i.parseIceOptions=function(o){return o.substr(14).split(" ")},i.parseRtpMap=function(o){var s=o.substr(9).split(" "),c={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),c.name=s[0],c.clockRate=parseInt(s[1],10),c.channels=3===s.length?parseInt(s[2],10):1,c.numChannels=c.channels,c},i.writeRtpMap=function(o){var s=o.payloadType;void 0!==o.preferredPayloadType&&(s=o.preferredPayloadType);var c=o.channels||o.numChannels||1;return"a=rtpmap:"+s+" "+o.name+"/"+o.clockRate+(1!==c?"/"+c:"")+"\r\n"},i.parseExtmap=function(o){var s=o.substr(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1]}},i.writeExtmap=function(o){return"a=extmap:"+(o.id||o.preferredId)+(o.direction&&"sendrecv"!==o.direction?"/"+o.direction:"")+" "+o.uri+"\r\n"},i.parseFmtp=function(o){for(var s,c={},l=o.substr(o.indexOf(" ")+1).split(";"),p=0;p<l.length;p++)c[(s=l[p].trim().split("="))[0].trim()]=s[1];return c},i.writeFmtp=function(o){var s="",c=o.payloadType;if(void 0!==o.preferredPayloadType&&(c=o.preferredPayloadType),o.parameters&&Object.keys(o.parameters).length){var l=[];Object.keys(o.parameters).forEach(function(p){l.push(o.parameters[p]?p+"="+o.parameters[p]:p)}),s+="a=fmtp:"+c+" "+l.join(";")+"\r\n"}return s},i.parseRtcpFb=function(o){var s=o.substr(o.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},i.writeRtcpFb=function(o){var s="",c=o.payloadType;return void 0!==o.preferredPayloadType&&(c=o.preferredPayloadType),o.rtcpFeedback&&o.rtcpFeedback.length&&o.rtcpFeedback.forEach(function(l){s+="a=rtcp-fb:"+c+" "+l.type+(l.parameter&&l.parameter.length?" "+l.parameter:"")+"\r\n"}),s},i.parseSsrcMedia=function(o){var s=o.indexOf(" "),c={ssrc:parseInt(o.substr(7,s-7),10)},l=o.indexOf(":",s);return l>-1?(c.attribute=o.substr(s+1,l-s-1),c.value=o.substr(l+1)):c.attribute=o.substr(s+1),c},i.parseSsrcGroup=function(o){var s=o.substr(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(function(c){return parseInt(c,10)})}},i.getMid=function(o){var s=i.matchPrefix(o,"a=mid:")[0];if(s)return s.substr(6)},i.parseFingerprint=function(o){var s=o.substr(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1]}},i.getDtlsParameters=function(o,s){return{role:"auto",fingerprints:i.matchPrefix(o+s,"a=fingerprint:").map(i.parseFingerprint)}},i.writeDtlsParameters=function(o,s){var c="a=setup:"+s+"\r\n";return o.fingerprints.forEach(function(l){c+="a=fingerprint:"+l.algorithm+" "+l.value+"\r\n"}),c},i.getIceParameters=function(o,s){var c=i.splitLines(o);return{usernameFragment:(c=c.concat(i.splitLines(s))).filter(function(l){return 0===l.indexOf("a=ice-ufrag:")})[0].substr(12),password:c.filter(function(l){return 0===l.indexOf("a=ice-pwd:")})[0].substr(10)}},i.writeIceParameters=function(o){return"a=ice-ufrag:"+o.usernameFragment+"\r\na=ice-pwd:"+o.password+"\r\n"},i.parseRtpParameters=function(o){for(var s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=i.splitLines(o)[0].split(" "),l=3;l<c.length;l++){var p=c[l],h=i.matchPrefix(o,"a=rtpmap:"+p+" ")[0];if(h){var g=i.parseRtpMap(h),f=i.matchPrefix(o,"a=fmtp:"+p+" ");switch(g.parameters=f.length?i.parseFmtp(f[0]):{},g.rtcpFeedback=i.matchPrefix(o,"a=rtcp-fb:"+p+" ").map(i.parseRtcpFb),s.codecs.push(g),g.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(g.name.toUpperCase())}}}return i.matchPrefix(o,"a=extmap:").forEach(function(A){s.headerExtensions.push(i.parseExtmap(A))}),s},i.writeRtpDescription=function(o,s){var c="";c+="m="+o+" ",c+=s.codecs.length>0?"9":"0",c+=" UDP/TLS/RTP/SAVPF ",c+=s.codecs.map(function(p){return void 0!==p.preferredPayloadType?p.preferredPayloadType:p.payloadType}).join(" ")+"\r\n",c+="c=IN IP4 0.0.0.0\r\n",c+="a=rtcp:9 IN IP4 0.0.0.0\r\n",s.codecs.forEach(function(p){c+=i.writeRtpMap(p),c+=i.writeFmtp(p),c+=i.writeRtcpFb(p)});var l=0;return s.codecs.forEach(function(p){p.maxptime>l&&(l=p.maxptime)}),l>0&&(c+="a=maxptime:"+l+"\r\n"),c+="a=rtcp-mux\r\n",s.headerExtensions&&s.headerExtensions.forEach(function(p){c+=i.writeExtmap(p)}),c},i.parseRtpEncodingParameters=function(o){var s,c=[],l=i.parseRtpParameters(o),p=-1!==l.fecMechanisms.indexOf("RED"),h=-1!==l.fecMechanisms.indexOf("ULPFEC"),g=i.matchPrefix(o,"a=ssrc:").map(function(v){return i.parseSsrcMedia(v)}).filter(function(v){return"cname"===v.attribute}),f=g.length>0&&g[0].ssrc,A=i.matchPrefix(o,"a=ssrc-group:FID").map(function(v){return v.substr(17).split(" ").map(function(y){return parseInt(y,10)})});A.length>0&&A[0].length>1&&A[0][0]===f&&(s=A[0][1]),l.codecs.forEach(function(v){if("RTX"===v.name.toUpperCase()&&v.parameters.apt){var y={ssrc:f,codecPayloadType:parseInt(v.parameters.apt,10)};f&&s&&(y.rtx={ssrc:s}),c.push(y),p&&((y=JSON.parse(JSON.stringify(y))).fec={ssrc:f,mechanism:h?"red+ulpfec":"red"},c.push(y))}}),0===c.length&&f&&c.push({ssrc:f});var _=i.matchPrefix(o,"b=");return _.length&&(_=0===_[0].indexOf("b=TIAS:")?parseInt(_[0].substr(7),10):0===_[0].indexOf("b=AS:")?1e3*parseInt(_[0].substr(5),10)*.95-16e3:void 0,c.forEach(function(v){v.maxBitrate=_})),c},i.parseRtcpParameters=function(o){var s={},c=i.matchPrefix(o,"a=ssrc:").map(function(h){return i.parseSsrcMedia(h)}).filter(function(h){return"cname"===h.attribute})[0];c&&(s.cname=c.value,s.ssrc=c.ssrc);var l=i.matchPrefix(o,"a=rtcp-rsize");s.reducedSize=l.length>0,s.compound=0===l.length;var p=i.matchPrefix(o,"a=rtcp-mux");return s.mux=p.length>0,s},i.parseMsid=function(o){var s,c=i.matchPrefix(o,"a=msid:");if(1===c.length)return{stream:(s=c[0].substr(7).split(" "))[0],track:s[1]};var l=i.matchPrefix(o,"a=ssrc:").map(function(p){return i.parseSsrcMedia(p)}).filter(function(p){return"msid"===p.attribute});return l.length>0?{stream:(s=l[0].value.split(" "))[0],track:s[1]}:void 0},i.generateSessionId=function(){return Math.random().toString().substr(2,21)},i.writeSessionBoilerplate=function(o,s,c){var l=void 0!==s?s:2;return"v=0\r\no="+(c||"thisisadapterortc")+" "+(o||i.generateSessionId())+" "+l+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},i.writeMediaSection=function(o,s,c,l){var p=i.writeRtpDescription(o.kind,s);if(p+=i.writeIceParameters(o.iceGatherer.getLocalParameters()),p+=i.writeDtlsParameters(o.dtlsTransport.getLocalParameters(),"offer"===c?"actpass":"active"),p+="a=mid:"+o.mid+"\r\n",p+=o.direction?"a="+o.direction+"\r\n":o.rtpSender&&o.rtpReceiver?"a=sendrecv\r\n":o.rtpSender?"a=sendonly\r\n":o.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",o.rtpSender){var h="msid:"+l.id+" "+o.rtpSender.track.id+"\r\n";p+="a="+h,p+="a=ssrc:"+o.sendEncodingParameters[0].ssrc+" "+h,o.sendEncodingParameters[0].rtx&&(p+="a=ssrc:"+o.sendEncodingParameters[0].rtx.ssrc+" "+h,p+="a=ssrc-group:FID "+o.sendEncodingParameters[0].ssrc+" "+o.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return p+="a=ssrc:"+o.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",o.rtpSender&&o.sendEncodingParameters[0].rtx&&(p+="a=ssrc:"+o.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),p},i.getDirection=function(o,s){for(var c=i.splitLines(o),l=0;l<c.length;l++)switch(c[l]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return c[l].substr(2)}return s?i.getDirection(s):"sendrecv"},i.getKind=function(o){return i.splitLines(o)[0].split(" ")[0].substr(2)},i.isRejected=function(o){return"0"===o.split(" ",2)[1]},i.parseMLine=function(o){var s=i.splitLines(o)[0].substr(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},i.parseOLine=function(o){var s=i.matchPrefix(o,"o=")[0].substr(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},i.isValidSDP=function(o){if("string"!=typeof o||0===o.length)return!1;for(var s=i.splitLines(o),c=0;c<s.length;c++)if(s[c].length<2||"="!==s[c].charAt(1))return!1;return!0},t.exports=i}(uM);var Tt=uM.exports;function fb(t,i,o,s,c){var l=Tt.writeRtpDescription(t.kind,i);if(l+=Tt.writeIceParameters(t.iceGatherer.getLocalParameters()),l+=Tt.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),"offer"===o?"actpass":c||"active"),l+="a=mid:"+t.mid+"\r\n",l+=t.rtpSender&&t.rtpReceiver?"a=sendrecv\r\n":t.rtpSender?"a=sendonly\r\n":t.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",t.rtpSender){var p=t.rtpSender._initialTrackId||t.rtpSender.track.id;t.rtpSender._initialTrackId=p;var h="msid:"+(s?s.id:"-")+" "+p+"\r\n";l+="a="+h,l+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" "+h,t.sendEncodingParameters[0].rtx&&(l+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+h,l+="a=ssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return l+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+Tt.localCName+"\r\n",t.rtpSender&&t.sendEncodingParameters[0].rtx&&(l+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+Tt.localCName+"\r\n"),l}function Fv(t,i){var o={codecs:[],headerExtensions:[],fecMechanisms:[]},s=function(l,p){l=parseInt(l,10);for(var h=0;h<p.length;h++)if(p[h].payloadType===l||p[h].preferredPayloadType===l)return p[h]},c=function(l,p,h,g){var f=s(l.parameters.apt,h),A=s(p.parameters.apt,g);return f&&A&&f.name.toLowerCase()===A.name.toLowerCase()};return t.codecs.forEach(function(l){for(var p=0;p<i.codecs.length;p++){var h=i.codecs[p];if(l.name.toLowerCase()===h.name.toLowerCase()&&l.clockRate===h.clockRate){if("rtx"===l.name.toLowerCase()&&l.parameters&&h.parameters.apt&&!c(l,h,t.codecs,i.codecs))continue;(h=JSON.parse(JSON.stringify(h))).numChannels=Math.min(l.numChannels,h.numChannels),o.codecs.push(h),h.rtcpFeedback=h.rtcpFeedback.filter(function(g){for(var f=0;f<l.rtcpFeedback.length;f++)if(l.rtcpFeedback[f].type===g.type&&l.rtcpFeedback[f].parameter===g.parameter)return!0;return!1});break}}}),t.headerExtensions.forEach(function(l){for(var p=0;p<i.headerExtensions.length;p++){var h=i.headerExtensions[p];if(l.uri===h.uri){o.headerExtensions.push(h);break}}}),o}function lM(t,i,o){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[i][t].indexOf(o)}function Uv(t,i){var o=t.getRemoteCandidates().find(function(s){return i.foundation===s.foundation&&i.ip===s.ip&&i.port===s.port&&i.priority===s.priority&&i.protocol===s.protocol&&i.type===s.type});return o||t.addRemoteCandidate(i),!o}function lo(t,i){var o=new Error(i);return o.name=t,o.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[t],o}function gb(t){const i=t&&t.navigator,o=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(s){return o(s).catch(c=>{return Ie.reject({name:{PermissionDeniedError:"NotAllowedError"}[(l=c).name]||l.name,message:l.message,constraint:l.constraint,toString(){return this.name}});var l})}}function Ab(t){"getDisplayMedia"in t.navigator&&t.navigator.mediaDevices&&(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||(t.navigator.mediaDevices.getDisplayMedia=t.navigator.getDisplayMedia.bind(t.navigator)))}function Vv(t,i){if(t.RTCIceGatherer&&(t.RTCIceCandidate||(t.RTCIceCandidate=function(s){return s}),t.RTCSessionDescription||(t.RTCSessionDescription=function(s){return s}),i.version<15025)){const s=Object.getOwnPropertyDescriptor(t.MediaStreamTrack.prototype,"enabled");Object.defineProperty(t.MediaStreamTrack.prototype,"enabled",{set(c){s.set.call(this,c);const l=new Event("enabled");l.enabled=c,this.dispatchEvent(l)}})}t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)&&Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new t.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),t.RTCDtmfSender&&!t.RTCDTMFSender&&(t.RTCDTMFSender=t.RTCDtmfSender);const o=function(t,i){function o(p,h){h.addTrack(p),h.dispatchEvent(new t.MediaStreamTrackEvent("addtrack",{track:p}))}function s(p,h,g,f){var A=new Event("track");A.track=h,A.receiver=g,A.transceiver={receiver:g},A.streams=f,t.setTimeout(function(){p._dispatchEvent("track",A)})}var c=function(p){var A,_,v,h=this,g=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(A){h[A]=g[A].bind(g)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",p=JSON.parse(JSON.stringify(p||{})),this.usingBundle="max-bundle"===p.bundlePolicy,"negotiate"===p.rtcpMuxPolicy)throw lo("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(p.rtcpMuxPolicy||(p.rtcpMuxPolicy="require"),p.iceTransportPolicy){case"all":case"relay":break;default:p.iceTransportPolicy="all"}switch(p.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:p.bundlePolicy="balanced"}if(p.iceServers=(A=p.iceServers||[],_=i,v=!1,(A=JSON.parse(JSON.stringify(A))).filter(function(y){if(y&&(y.urls||y.url)){var S=y.urls||y.url;y.url&&!y.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var R="string"==typeof S;return R&&(S=[S]),S=S.filter(function(D){return 0!==D.indexOf("turn:")||-1===D.indexOf("transport=udp")||-1!==D.indexOf("turn:[")||v?0===D.indexOf("stun:")&&_>=14393&&-1===D.indexOf("?transport=udp"):(v=!0,!0)}),delete y.url,y.urls=R?S[0]:S,!!S.length}})),this._iceGatherers=[],p.iceCandidatePoolSize)for(var f=p.iceCandidatePoolSize;f>0;f--)this._iceGatherers.push(new t.RTCIceGatherer({iceServers:p.iceServers,gatherPolicy:p.iceTransportPolicy}));else p.iceCandidatePoolSize=0;this._config=p,this.transceivers=[],this._sdpSessionId=Tt.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(c.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(c.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),c.prototype.onicecandidate=null,c.prototype.onaddstream=null,c.prototype.ontrack=null,c.prototype.onremovestream=null,c.prototype.onsignalingstatechange=null,c.prototype.oniceconnectionstatechange=null,c.prototype.onconnectionstatechange=null,c.prototype.onicegatheringstatechange=null,c.prototype.onnegotiationneeded=null,c.prototype.ondatachannel=null,c.prototype._dispatchEvent=function(p,h){this._isClosed||(this.dispatchEvent(h),"function"==typeof this["on"+p]&&this["on"+p](h))},c.prototype._emitGatheringStateChange=function(){var p=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",p)},c.prototype.getConfiguration=function(){return this._config},c.prototype.getLocalStreams=function(){return this.localStreams},c.prototype.getRemoteStreams=function(){return this.remoteStreams},c.prototype._createTransceiver=function(p,h){var f={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:p,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&this.transceivers.length>0)f.iceTransport=this.transceivers[0].iceTransport,f.dtlsTransport=this.transceivers[0].dtlsTransport;else{var A=this._createIceAndDtlsTransports();f.iceTransport=A.iceTransport,f.dtlsTransport=A.dtlsTransport}return h||this.transceivers.push(f),f},c.prototype.addTrack=function(p,h){if(this._isClosed)throw lo("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var g;if(this.transceivers.find(function(A){return A.track===p}))throw lo("InvalidAccessError","Track already exists.");for(var f=0;f<this.transceivers.length;f++)this.transceivers[f].track||this.transceivers[f].kind!==p.kind||(g=this.transceivers[f]);return g||(g=this._createTransceiver(p.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(h)&&this.localStreams.push(h),g.track=p,g.stream=h,g.rtpSender=new t.RTCRtpSender(p,g.dtlsTransport),g.rtpSender},c.prototype.addStream=function(p){var h=this;if(i>=15025)p.getTracks().forEach(function(f){h.addTrack(f,p)});else{var g=p.clone();p.getTracks().forEach(function(f,A){var _=g.getTracks()[A];f.addEventListener("enabled",function(v){_.enabled=v.enabled})}),g.getTracks().forEach(function(f){h.addTrack(f,g)})}},c.prototype.removeTrack=function(p){if(this._isClosed)throw lo("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(p instanceof t.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var h=this.transceivers.find(function(f){return f.rtpSender===p});if(!h)throw lo("InvalidAccessError","Sender was not created by this connection.");var g=h.stream;h.rtpSender.stop(),h.rtpSender=null,h.track=null,h.stream=null,-1===this.transceivers.map(function(f){return f.stream}).indexOf(g)&&this.localStreams.indexOf(g)>-1&&this.localStreams.splice(this.localStreams.indexOf(g),1),this._maybeFireNegotiationNeeded()},c.prototype.removeStream=function(p){var h=this;p.getTracks().forEach(function(g){var f=h.getSenders().find(function(A){return A.track===g});f&&h.removeTrack(f)})},c.prototype.getSenders=function(){return this.transceivers.filter(function(p){return!!p.rtpSender}).map(function(p){return p.rtpSender})},c.prototype.getReceivers=function(){return this.transceivers.filter(function(p){return!!p.rtpReceiver}).map(function(p){return p.rtpReceiver})},c.prototype._createIceGatherer=function(p,h){var g=this;if(h&&p>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var f=new t.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(f,"state",{value:"new",writable:!0}),this.transceivers[p].bufferedCandidateEvents=[],this.transceivers[p].bufferCandidates=function(A){var _=!A.candidate||0===Object.keys(A.candidate).length;f.state=_?"completed":"gathering",null!==g.transceivers[p].bufferedCandidateEvents&&g.transceivers[p].bufferedCandidateEvents.push(A)},f.addEventListener("localcandidate",this.transceivers[p].bufferCandidates),f},c.prototype._gather=function(p,h){var g=this,f=this.transceivers[h].iceGatherer;if(!f.onlocalcandidate){var A=this.transceivers[h].bufferedCandidateEvents;this.transceivers[h].bufferedCandidateEvents=null,f.removeEventListener("localcandidate",this.transceivers[h].bufferCandidates),f.onlocalcandidate=function(_){if(!(g.usingBundle&&h>0)){var v=new Event("icecandidate");v.candidate={sdpMid:p,sdpMLineIndex:h};var y=_.candidate,S=!y||0===Object.keys(y).length;if(S)"new"!==f.state&&"gathering"!==f.state||(f.state="completed");else{"new"===f.state&&(f.state="gathering"),y.component=1,y.ufrag=f.getLocalParameters().usernameFragment;var R=Tt.writeCandidate(y);v.candidate=Object.assign(v.candidate,Tt.parseCandidate(R)),v.candidate.candidate=R,v.candidate.toJSON=function(){return{candidate:v.candidate.candidate,sdpMid:v.candidate.sdpMid,sdpMLineIndex:v.candidate.sdpMLineIndex,usernameFragment:v.candidate.usernameFragment}}}var D=Tt.getMediaSections(g._localDescription.sdp);D[v.candidate.sdpMLineIndex]+=S?"a=end-of-candidates\r\n":"a="+v.candidate.candidate+"\r\n",g._localDescription.sdp=Tt.getDescription(g._localDescription.sdp)+D.join("");var O=g.transceivers.every(function(P){return P.iceGatherer&&"completed"===P.iceGatherer.state});"gathering"!==g.iceGatheringState&&(g.iceGatheringState="gathering",g._emitGatheringStateChange()),S||g._dispatchEvent("icecandidate",v),O&&(g._dispatchEvent("icecandidate",new Event("icecandidate")),g.iceGatheringState="complete",g._emitGatheringStateChange())}},t.setTimeout(function(){A.forEach(function(_){f.onlocalcandidate(_)})},0)}},c.prototype._createIceAndDtlsTransports=function(){var p=this,h=new t.RTCIceTransport(null);h.onicestatechange=function(){p._updateIceConnectionState(),p._updateConnectionState()};var g=new t.RTCDtlsTransport(h);return g.ondtlsstatechange=function(){p._updateConnectionState()},g.onerror=function(){Object.defineProperty(g,"state",{value:"failed",writable:!0}),p._updateConnectionState()},{iceTransport:h,dtlsTransport:g}},c.prototype._disposeIceAndDtlsTransports=function(p){var h=this.transceivers[p].iceGatherer;h&&(delete h.onlocalcandidate,delete this.transceivers[p].iceGatherer);var g=this.transceivers[p].iceTransport;g&&(delete g.onicestatechange,delete this.transceivers[p].iceTransport);var f=this.transceivers[p].dtlsTransport;f&&(delete f.ondtlsstatechange,delete f.onerror,delete this.transceivers[p].dtlsTransport)},c.prototype._transceive=function(p,h,g){var f=Fv(p.localCapabilities,p.remoteCapabilities);h&&p.rtpSender&&(f.encodings=p.sendEncodingParameters,f.rtcp={cname:Tt.localCName,compound:p.rtcpParameters.compound},p.recvEncodingParameters.length&&(f.rtcp.ssrc=p.recvEncodingParameters[0].ssrc),p.rtpSender.send(f)),g&&p.rtpReceiver&&f.codecs.length>0&&("video"===p.kind&&p.recvEncodingParameters&&i<15019&&p.recvEncodingParameters.forEach(function(A){delete A.rtx}),f.encodings=p.recvEncodingParameters.length?p.recvEncodingParameters:[{}],f.rtcp={compound:p.rtcpParameters.compound},p.rtcpParameters.cname&&(f.rtcp.cname=p.rtcpParameters.cname),p.sendEncodingParameters.length&&(f.rtcp.ssrc=p.sendEncodingParameters[0].ssrc),p.rtpReceiver.receive(f))},c.prototype.setLocalDescription=function(p){var h,g,f=this;if(-1===["offer","answer"].indexOf(p.type))return Promise.reject(lo("TypeError",'Unsupported type "'+p.type+'"'));if(!lM("setLocalDescription",p.type,f.signalingState)||f._isClosed)return Promise.reject(lo("InvalidStateError","Can not set local "+p.type+" in state "+f.signalingState));if("offer"===p.type)h=Tt.splitSections(p.sdp),g=h.shift(),h.forEach(function(_,v){var y=Tt.parseRtpParameters(_);f.transceivers[v].localCapabilities=y}),f.transceivers.forEach(function(_,v){f._gather(_.mid,v)});else if("answer"===p.type){h=Tt.splitSections(f._remoteDescription.sdp),g=h.shift();var A=Tt.matchPrefix(g,"a=ice-lite").length>0;h.forEach(function(_,v){var y=f.transceivers[v],S=y.iceGatherer,R=y.iceTransport,D=y.dtlsTransport,O=y.localCapabilities,P=y.remoteCapabilities;if(!(Tt.isRejected(_)&&0===Tt.matchPrefix(_,"a=bundle-only").length||y.rejected)){var B=Tt.getIceParameters(_,g),G=Tt.getDtlsParameters(_,g);A&&(G.role="server"),f.usingBundle&&0!==v||(f._gather(y.mid,v),"new"===R.state&&R.start(S,B,A?"controlling":"controlled"),"new"===D.state&&D.start(G));var Y=Fv(O,P);f._transceive(y,Y.codecs.length>0,!1)}})}return f._localDescription={type:p.type,sdp:p.sdp},f._updateSignalingState("offer"===p.type?"have-local-offer":"stable"),Promise.resolve()},c.prototype.setRemoteDescription=function(p){var h=this;if(-1===["offer","answer"].indexOf(p.type))return Promise.reject(lo("TypeError",'Unsupported type "'+p.type+'"'));if(!lM("setRemoteDescription",p.type,h.signalingState)||h._isClosed)return Promise.reject(lo("InvalidStateError","Can not set remote "+p.type+" in state "+h.signalingState));var g={};h.remoteStreams.forEach(function(R){g[R.id]=R});var f=[],A=Tt.splitSections(p.sdp),_=A.shift(),v=Tt.matchPrefix(_,"a=ice-lite").length>0,y=Tt.matchPrefix(_,"a=group:BUNDLE ").length>0;h.usingBundle=y;var S=Tt.matchPrefix(_,"a=ice-options:")[0];return h.canTrickleIceCandidates=!!S&&S.substr(14).split(" ").indexOf("trickle")>=0,A.forEach(function(R,D){var O=Tt.splitLines(R),P=Tt.getKind(R),B=Tt.isRejected(R)&&0===Tt.matchPrefix(R,"a=bundle-only").length,G=O[0].substr(2).split(" ")[2],Y=Tt.getDirection(R,_),ae=Tt.parseMsid(R),te=Tt.getMid(R)||Tt.generateIdentifier();if(B||"application"===P&&("DTLS/SCTP"===G||"UDP/DTLS/SCTP"===G))h.transceivers[D]={mid:te,kind:P,protocol:G,rejected:!0};else{var Z,_e,fe,Se,Oe,Ye,Ee,z,ee;!B&&h.transceivers[D]&&h.transceivers[D].rejected&&(h.transceivers[D]=h._createTransceiver(P,!0));var Q,K,ne=Tt.parseRtpParameters(R);B||(Q=Tt.getIceParameters(R,_),(K=Tt.getDtlsParameters(R,_)).role="client"),Ee=Tt.parseRtpEncodingParameters(R);var me=Tt.parseRtcpParameters(R),Ne=Tt.matchPrefix(R,"a=end-of-candidates",_).length>0,ce=Tt.matchPrefix(R,"a=candidate:").map(function(j){return Tt.parseCandidate(j)}).filter(function(j){return 1===j.component});if(("offer"===p.type||"answer"===p.type)&&!B&&y&&D>0&&h.transceivers[D]&&(h._disposeIceAndDtlsTransports(D),h.transceivers[D].iceGatherer=h.transceivers[0].iceGatherer,h.transceivers[D].iceTransport=h.transceivers[0].iceTransport,h.transceivers[D].dtlsTransport=h.transceivers[0].dtlsTransport,h.transceivers[D].rtpSender&&h.transceivers[D].rtpSender.setTransport(h.transceivers[0].dtlsTransport),h.transceivers[D].rtpReceiver&&h.transceivers[D].rtpReceiver.setTransport(h.transceivers[0].dtlsTransport)),"offer"!==p.type||B)"answer"===p.type&&!B&&(_e=(Z=h.transceivers[D]).iceGatherer,fe=Z.iceTransport,Se=Z.dtlsTransport,Oe=Z.rtpReceiver,Ye=Z.sendEncodingParameters,z=Z.localCapabilities,h.transceivers[D].recvEncodingParameters=Ee,h.transceivers[D].remoteCapabilities=ne,h.transceivers[D].rtcpParameters=me,ce.length&&"new"===fe.state&&(!v&&!Ne||y&&0!==D?ce.forEach(function(j){Uv(Z.iceTransport,j)}):fe.setRemoteCandidates(ce)),y&&0!==D||("new"===fe.state&&fe.start(_e,Q,"controlling"),"new"===Se.state&&Se.start(K)),!Fv(Z.localCapabilities,Z.remoteCapabilities).codecs.filter(function(j){return"rtx"===j.name.toLowerCase()}).length&&Z.sendEncodingParameters[0].rtx&&delete Z.sendEncodingParameters[0].rtx,h._transceive(Z,"sendrecv"===Y||"recvonly"===Y,"sendrecv"===Y||"sendonly"===Y),!Oe||"sendrecv"!==Y&&"sendonly"!==Y?delete Z.rtpReceiver:(ee=Oe.track,ae?(g[ae.stream]||(g[ae.stream]=new t.MediaStream),o(ee,g[ae.stream]),f.push([ee,Oe,g[ae.stream]])):(g.default||(g.default=new t.MediaStream),o(ee,g.default),f.push([ee,Oe,g.default]))));else{(Z=h.transceivers[D]||h._createTransceiver(P)).mid=te,Z.iceGatherer||(Z.iceGatherer=h._createIceGatherer(D,y)),ce.length&&"new"===Z.iceTransport.state&&(!Ne||y&&0!==D?ce.forEach(function(j){Uv(Z.iceTransport,j)}):Z.iceTransport.setRemoteCandidates(ce)),z=t.RTCRtpReceiver.getCapabilities(P),i<15019&&(z.codecs=z.codecs.filter(function(j){return"rtx"!==j.name})),Ye=Z.sendEncodingParameters||[{ssrc:1001*(2*D+2)}];var T,k=!1;"sendrecv"===Y||"sendonly"===Y?(k=!Z.rtpReceiver,Oe=Z.rtpReceiver||new t.RTCRtpReceiver(Z.dtlsTransport,P),k&&(ee=Oe.track,ae&&"-"===ae.stream||(ae?(g[ae.stream]||(g[ae.stream]=new t.MediaStream,Object.defineProperty(g[ae.stream],"id",{get:function(){return ae.stream}})),Object.defineProperty(ee,"id",{get:function(){return ae.track}}),T=g[ae.stream]):(g.default||(g.default=new t.MediaStream),T=g.default)),T&&(o(ee,T),Z.associatedRemoteMediaStreams.push(T)),f.push([ee,Oe,T]))):Z.rtpReceiver&&Z.rtpReceiver.track&&(Z.associatedRemoteMediaStreams.forEach(function(j){var be,dt,re=j.getTracks().find(function(be){return be.id===Z.rtpReceiver.track.id});re&&((dt=j).removeTrack(be=re),dt.dispatchEvent(new t.MediaStreamTrackEvent("removetrack",{track:be})))}),Z.associatedRemoteMediaStreams=[]),Z.localCapabilities=z,Z.remoteCapabilities=ne,Z.rtpReceiver=Oe,Z.rtcpParameters=me,Z.sendEncodingParameters=Ye,Z.recvEncodingParameters=Ee,h._transceive(h.transceivers[D],!1,k)}}}),void 0===h._dtlsRole&&(h._dtlsRole="offer"===p.type?"active":"passive"),h._remoteDescription={type:p.type,sdp:p.sdp},h._updateSignalingState("offer"===p.type?"have-remote-offer":"stable"),Object.keys(g).forEach(function(R){var D=g[R];if(D.getTracks().length){if(-1===h.remoteStreams.indexOf(D)){h.remoteStreams.push(D);var O=new Event("addstream");O.stream=D,t.setTimeout(function(){h._dispatchEvent("addstream",O)})}f.forEach(function(P){D.id===P[2].id&&s(h,P[0],P[1],[D])})}}),f.forEach(function(R){R[2]||s(h,R[0],R[1],[])}),t.setTimeout(function(){h&&h.transceivers&&h.transceivers.forEach(function(R){R.iceTransport&&"new"===R.iceTransport.state&&R.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),R.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},c.prototype.close=function(){this.transceivers.forEach(function(p){p.iceTransport&&p.iceTransport.stop(),p.dtlsTransport&&p.dtlsTransport.stop(),p.rtpSender&&p.rtpSender.stop(),p.rtpReceiver&&p.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},c.prototype._updateSignalingState=function(p){this.signalingState=p;var h=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",h)},c.prototype._maybeFireNegotiationNeeded=function(){var p=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,t.setTimeout(function(){if(p.needNegotiation){p.needNegotiation=!1;var h=new Event("negotiationneeded");p._dispatchEvent("negotiationneeded",h)}},0))},c.prototype._updateIceConnectionState=function(){var p,h={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(f){f.iceTransport&&!f.rejected&&h[f.iceTransport.state]++}),p="new",h.failed>0?p="failed":h.checking>0?p="checking":h.disconnected>0?p="disconnected":h.new>0?p="new":h.connected>0?p="connected":h.completed>0&&(p="completed"),p!==this.iceConnectionState){this.iceConnectionState=p;var g=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",g)}},c.prototype._updateConnectionState=function(){var p,h={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(f){f.iceTransport&&f.dtlsTransport&&!f.rejected&&(h[f.iceTransport.state]++,h[f.dtlsTransport.state]++)}),h.connected+=h.completed,p="new",h.failed>0?p="failed":h.connecting>0?p="connecting":h.disconnected>0?p="disconnected":h.new>0?p="new":h.connected>0&&(p="connected"),p!==this.connectionState){this.connectionState=p;var g=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",g)}},c.prototype.createOffer=function(){var p=this;if(p._isClosed)return Promise.reject(lo("InvalidStateError","Can not call createOffer after close"));var h=p.transceivers.filter(function(v){return"audio"===v.kind}).length,g=p.transceivers.filter(function(v){return"video"===v.kind}).length,f=arguments[0];if(f){if(f.mandatory||f.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==f.offerToReceiveAudio&&(h=!0===f.offerToReceiveAudio?1:!1===f.offerToReceiveAudio?0:f.offerToReceiveAudio),void 0!==f.offerToReceiveVideo&&(g=!0===f.offerToReceiveVideo?1:!1===f.offerToReceiveVideo?0:f.offerToReceiveVideo)}for(p.transceivers.forEach(function(v){"audio"===v.kind?--h<0&&(v.wantReceive=!1):"video"===v.kind&&--g<0&&(v.wantReceive=!1)});h>0||g>0;)h>0&&(p._createTransceiver("audio"),h--),g>0&&(p._createTransceiver("video"),g--);var A=Tt.writeSessionBoilerplate(p._sdpSessionId,p._sdpSessionVersion++);p.transceivers.forEach(function(v,y){var S=v.track,R=v.kind,D=v.mid||Tt.generateIdentifier();v.mid=D,v.iceGatherer||(v.iceGatherer=p._createIceGatherer(y,p.usingBundle));var O=t.RTCRtpSender.getCapabilities(R);i<15019&&(O.codecs=O.codecs.filter(function(B){return"rtx"!==B.name})),O.codecs.forEach(function(B){"H264"===B.name&&void 0===B.parameters["level-asymmetry-allowed"]&&(B.parameters["level-asymmetry-allowed"]="1"),v.remoteCapabilities&&v.remoteCapabilities.codecs&&v.remoteCapabilities.codecs.forEach(function(G){B.name.toLowerCase()===G.name.toLowerCase()&&B.clockRate===G.clockRate&&(B.preferredPayloadType=G.payloadType)})}),O.headerExtensions.forEach(function(B){(v.remoteCapabilities&&v.remoteCapabilities.headerExtensions||[]).forEach(function(G){B.uri===G.uri&&(B.id=G.id)})});var P=v.sendEncodingParameters||[{ssrc:1001*(2*y+1)}];S&&i>=15019&&"video"===R&&!P[0].rtx&&(P[0].rtx={ssrc:P[0].ssrc+1}),v.wantReceive&&(v.rtpReceiver=new t.RTCRtpReceiver(v.dtlsTransport,R)),v.localCapabilities=O,v.sendEncodingParameters=P}),"max-compat"!==p._config.bundlePolicy&&(A+="a=group:BUNDLE "+p.transceivers.map(function(v){return v.mid}).join(" ")+"\r\n"),A+="a=ice-options:trickle\r\n",p.transceivers.forEach(function(v,y){A+=fb(v,v.localCapabilities,"offer",v.stream,p._dtlsRole),A+="a=rtcp-rsize\r\n",!v.iceGatherer||"new"===p.iceGatheringState||0!==y&&p.usingBundle||(v.iceGatherer.getLocalCandidates().forEach(function(S){S.component=1,A+="a="+Tt.writeCandidate(S)+"\r\n"}),"completed"===v.iceGatherer.state&&(A+="a=end-of-candidates\r\n"))});var _=new t.RTCSessionDescription({type:"offer",sdp:A});return Promise.resolve(_)},c.prototype.createAnswer=function(){var p=this;if(p._isClosed)return Promise.reject(lo("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==p.signalingState&&"have-local-pranswer"!==p.signalingState)return Promise.reject(lo("InvalidStateError","Can not call createAnswer in signalingState "+p.signalingState));var h=Tt.writeSessionBoilerplate(p._sdpSessionId,p._sdpSessionVersion++);p.usingBundle&&(h+="a=group:BUNDLE "+p.transceivers.map(function(A){return A.mid}).join(" ")+"\r\n"),h+="a=ice-options:trickle\r\n";var g=Tt.getMediaSections(p._remoteDescription.sdp).length;p.transceivers.forEach(function(A,_){if(!(_+1>g)){if(A.rejected)return"application"===A.kind?h+="DTLS/SCTP"===A.protocol?"m=application 0 DTLS/SCTP 5000\r\n":"m=application 0 "+A.protocol+" webrtc-datachannel\r\n":"audio"===A.kind?h+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===A.kind&&(h+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(h+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+A.mid+"\r\n");var v;A.stream&&("audio"===A.kind?v=A.stream.getAudioTracks()[0]:"video"===A.kind&&(v=A.stream.getVideoTracks()[0]),v&&i>=15019&&"video"===A.kind&&!A.sendEncodingParameters[0].rtx&&(A.sendEncodingParameters[0].rtx={ssrc:A.sendEncodingParameters[0].ssrc+1}));var y=Fv(A.localCapabilities,A.remoteCapabilities);!y.codecs.filter(function(S){return"rtx"===S.name.toLowerCase()}).length&&A.sendEncodingParameters[0].rtx&&delete A.sendEncodingParameters[0].rtx,h+=fb(A,y,"answer",A.stream,p._dtlsRole),A.rtcpParameters&&A.rtcpParameters.reducedSize&&(h+="a=rtcp-rsize\r\n")}});var f=new t.RTCSessionDescription({type:"answer",sdp:h});return Promise.resolve(f)},c.prototype.addIceCandidate=function(p){var h,g=this;return p&&void 0===p.sdpMLineIndex&&!p.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(f,A){if(!g._remoteDescription)return A(lo("InvalidStateError","Can not add ICE candidate without a remote description"));if(p&&""!==p.candidate){var _=p.sdpMLineIndex;if(p.sdpMid)for(var v=0;v<g.transceivers.length;v++)if(g.transceivers[v].mid===p.sdpMid){_=v;break}var y=g.transceivers[_];if(!y)return A(lo("OperationError","Can not add ICE candidate"));if(y.rejected)return f();var S=Object.keys(p.candidate).length>0?Tt.parseCandidate(p.candidate):{};if("tcp"===S.protocol&&(0===S.port||9===S.port)||S.component&&1!==S.component)return f();if((0===_||_>0&&y.iceTransport!==g.transceivers[0].iceTransport)&&!Uv(y.iceTransport,S))return A(lo("OperationError","Can not add ICE candidate"));var R=p.candidate.trim();0===R.indexOf("a=")&&(R=R.substr(2)),(h=Tt.getMediaSections(g._remoteDescription.sdp))[_]+="a="+(S.type?R:"end-of-candidates")+"\r\n",g._remoteDescription.sdp=Tt.getDescription(g._remoteDescription.sdp)+h.join("")}else for(var D=0;D<g.transceivers.length&&(g.transceivers[D].rejected||(g.transceivers[D].iceTransport.addRemoteCandidate({}),(h=Tt.getMediaSections(g._remoteDescription.sdp))[D]+="a=end-of-candidates\r\n",g._remoteDescription.sdp=Tt.getDescription(g._remoteDescription.sdp)+h.join(""),!g.usingBundle));D++);f()})},c.prototype.getStats=function(p){if(p&&p instanceof t.MediaStreamTrack){var h=null;if(this.transceivers.forEach(function(f){f.rtpSender&&f.rtpSender.track===p?h=f.rtpSender:f.rtpReceiver&&f.rtpReceiver.track===p&&(h=f.rtpReceiver)}),!h)throw lo("InvalidAccessError","Invalid selector.");return h.getStats()}var g=[];return this.transceivers.forEach(function(f){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(A){f[A]&&g.push(f[A].getStats())})}),Promise.all(g).then(function(f){var A=new Map;return f.forEach(function(_){_.forEach(function(v){A.set(v.id,v)})}),A})},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(p){var h=t[p];if(h&&h.prototype&&h.prototype.getStats){var g=h.prototype.getStats;h.prototype.getStats=function(){return g.apply(this).then(function(f){var A=new Map;return Object.keys(f).forEach(function(_){var v;f[_].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(v=f[_]).type]||v.type,A.set(_,f[_])}),A})}}});var l=["createOffer","createAnswer"];return l.forEach(function(p){var h=c.prototype[p];c.prototype[p]=function(){var g=arguments;return"function"==typeof g[0]||"function"==typeof g[1]?h.apply(this,[arguments[2]]).then(function(f){"function"==typeof g[0]&&g[0].apply(null,[f])},function(f){"function"==typeof g[1]&&g[1].apply(null,[f])}):h.apply(this,arguments)}}),(l=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(p){var h=c.prototype[p];c.prototype[p]=function(){var g=arguments;return"function"==typeof g[1]||"function"==typeof g[2]?h.apply(this,arguments).then(function(){"function"==typeof g[1]&&g[1].apply(null)},function(f){"function"==typeof g[2]&&g[2].apply(null,[f])}):h.apply(this,arguments)}}),["getStats"].forEach(function(p){var h=c.prototype[p];c.prototype[p]=function(){var g=arguments;return"function"==typeof g[1]?h.apply(this,arguments).then(function(){"function"==typeof g[1]&&g[1].apply(null)}):h.apply(this,arguments)}}),c}(t,i.version);t.RTCPeerConnection=function(s){return s&&s.iceServers&&(s.iceServers=function(c,l){let p=!1;return(c=JSON.parse(JSON.stringify(c))).filter(h=>{if(h&&(h.urls||h.url)){let g=h.urls||h.url;h.url&&!h.urls&&qg("RTCIceServer.url","RTCIceServer.urls");const f="string"==typeof g;return f&&(g=[g]),g=g.filter(A=>{if(0===A.indexOf("stun:"))return!1;const _=A.startsWith("turn")&&!A.startsWith("turn:[")&&A.includes("transport=udp");return _&&!p?(p=!0,!0):_&&!p}),delete h.url,h.urls=f?g[0]:g,!!g.length}})}(s.iceServers),II("ICE servers after filtering:",s.iceServers)),new o(s)},t.RTCPeerConnection.prototype=o.prototype}function hM(t){t.RTCRtpSender&&!("replaceTrack"in t.RTCRtpSender.prototype)&&(t.RTCRtpSender.prototype.replaceTrack=t.RTCRtpSender.prototype.setTrack)}var pM=Object.freeze({__proto__:null,shimPeerConnection:Vv,shimReplaceTrack:hM,shimGetUserMedia:gb,shimGetDisplayMedia:Ab}),zV=rt.Promise,fM=Us.exports,$V=function(t,i,o){for(var s in i)fM(t,s,i[s],o);return t},WW=ag,KW=Aa,YW=Dn(Dn.bind),jv=function(t,i){return WW(t),void 0===i?t:KW?YW(t,i):function(){return t.apply(i,arguments)}},qW=Vg,JW=hi("iterator"),zW=Array.prototype,OA=function(t){return void 0!==t&&(qW.Array===t||zW[JW]===t)},$W=rE,PA=cg,Qv=Vg,MA=hi("iterator"),Gv=function(t){if(null!=t)return PA(t,MA)||PA(t,"@@iterator")||Qv[$W(t)]},XW=io,mb=ag,gM=Io,Hv=C_,AM=Gv,ZW=rt.TypeError,XV=function(t,i){var o=arguments.length<2?AM(t):i;if(mb(o))return gM(XW(o,t));throw ZW(Hv(t)+" is not iterable")},ZV=io,mM=Io,Cu=cg,e6=jv,eK=io,tK=Io,nK=C_,t6=OA,_b=us,_M=zc,rK=XV,n6=Gv,Eb=function(t,i,o){var s,c;mM(t);try{if(!(s=Cu(t,"return"))){if("throw"===i)throw o;return o}s=ZV(s,t)}catch(l){c=!0,s=l}if("throw"===i)throw o;if(c)throw s;return mM(s),o},EM=rt.TypeError,vb=function(t,i){this.stopped=t,this.result=i},zs=vb.prototype,vM=hi("iterator"),Wv=!1;try{var r6=0,Gn={next:function(){return{done:!!r6++}},return:function(){Wv=!0}};Gn[vM]=function(){return this},Array.from(Gn,function(){throw 2})}catch{}var CM=function(t,i){if(!i&&!Wv)return!1;var o=!1;try{var s={};s[vM]=function(){return{next:function(){return{done:o=!0}}}},t(s)}catch{}return o},Cb=Dn,i6=An,yM=Er,yb=rE,IM=w_,Ib=function(){},o6=[],Sb=Bs("Reflect","construct"),Vp=/^\s*(?:class|function)\b/,bb=Cb(Vp.exec),Tb=!Vp.exec(Ib),kA=function(t){if(!yM(t))return!1;try{return Sb(Ib,o6,t),!0}catch{return!1}},Kv=function(t){if(!yM(t))return!1;switch(yb(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Tb||!!bb(Vp,IM(t))}catch{return!0}};Kv.sham=!0;var $s,zd,Yv,xa,SM=!Sb||i6(function(){var t;return kA(kA.call)||!kA(Object)||!kA(function(){t=!0})||t})?Kv:kA,iK=SM,s6=C_,bM=rt.TypeError,TM=function(t){if(iK(t))return t;throw bM(s6(t)+" is not a constructor")},RM=Io,DM=TM,oK=hi("species"),qv=function(t,i){var o,s=RM(t).constructor;return void 0===s||null==(o=RM(s)[oK])?i:DM(o)},a6=Dn([].slice),Rb=/(?:ipad|iphone|ipod).*applewebkit/i.test(Bh),Xs=rt,Db=F_,wM=jv,wb=Er,NM=Ki,OM=An,Nb=Hy,$d=a6,LA=jh,PM=Rb,c6=gv,Jv=Xs.setImmediate,zv=Xs.clearImmediate,sK=Xs.process,Ob=Xs.Dispatch,aK=Xs.Function,u6=Xs.MessageChannel,MM=Xs.String,ms=0,xA={};try{$s=Xs.location}catch{}var kM=function(t){if(NM(xA,t)){var i=xA[t];delete xA[t],i()}},LM=function(t){return function(){kM(t)}},d6=function(t){kM(t.data)},h6=function(t){Xs.postMessage(MM(t),$s.protocol+"//"+$s.host)};Jv&&zv||(Jv=function(t){var i=$d(arguments,1);return xA[++ms]=function(){Db(wb(t)?t:aK(t),void 0,i)},zd(ms),ms},zv=function(t){delete xA[t]},c6?zd=function(t){sK.nextTick(LM(t))}:Ob&&Ob.now?zd=function(t){Ob.now(LM(t))}:u6&&!PM?(xa=(Yv=new u6).port2,Yv.port1.onmessage=d6,zd=wM(xa.postMessage,xa)):Xs.addEventListener&&wb(Xs.postMessage)&&!Xs.importScripts&&$s&&"file:"!==$s.protocol&&!OM(h6)?(zd=h6,Xs.addEventListener("message",d6,!1)):zd="onreadystatechange"in LA("script")?function(t){Nb.appendChild(LA("script")).onreadystatechange=function(){Nb.removeChild(this),kM(t)}}:function(t){setTimeout(LM(t),0)});var $v,Xd,yl,jp,Pb,Xv,yu,Mb,Zv={set:Jv,clear:zv},kb=rt,p6=/ipad|iphone|ipod/i.test(Bh)&&void 0!==kb.Pebble,Lb=/web0s(?!.*chrome)/i.test(Bh),Iu=rt,BA=jv,xM=Zv.set,uK=Rb,lK=p6,BM=Lb,xb=gv,FM=Iu.MutationObserver||Iu.WebKitMutationObserver,UM=Iu.document,VM=Iu.process,FA=Iu.Promise,Bb=(0,Hr.f)(Iu,"queueMicrotask"),Fb=Bb&&Bb.value;Fb||($v=function(){var t,i;for(xb&&(t=VM.domain)&&t.exit();Xd;){i=Xd.fn,Xd=Xd.next;try{i()}catch(o){throw Xd?jp():yl=void 0,o}}yl=void 0,t&&t.enter()},uK||xb||BM||!FM||!UM?!lK&&FA&&FA.resolve?((yu=FA.resolve(void 0)).constructor=FA,Mb=BA(yu.then,yu),jp=function(){Mb($v)}):xb?jp=function(){VM.nextTick($v)}:(xM=BA(xM,Iu),jp=function(){xM($v)}):(Pb=!0,Xv=UM.createTextNode(""),new FM($v).observe(Xv,{characterData:!0}),jp=function(){Xv.data=Pb=!Pb}));var f6=Fb||function(t){var i={fn:t,next:void 0};yl&&(yl.next=i),Xd||(Xd=i,jp()),yl=i},Ub={},Vb=ag,e1=function(t){var i,o;this.promise=new t(function(s,c){if(void 0!==i||void 0!==o)throw TypeError("Bad Promise constructor");i=s,o=c}),this.resolve=Vb(i),this.reject=Vb(o)};Ub.f=function(t){return new e1(t)};var dK=Io,jM=tn,UA=Ub,QM=function(t,i){if(dK(t),jM(i)&&i.constructor===t)return i;var o=UA.f(t);return(0,o.resolve)(i),o.promise},g6=rt,A6=function(){this.head=null,this.tail=null};A6.prototype={add:function(t){var i={item:t,next:null};this.head?this.tail.next=i:this.head=i,this.tail=i},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var GM,HM,WM,Cc,pK="object"==typeof window,jb=Ii,Il=rt,fK=Bs,Su=io,Qb=zV,m6=Us.exports,gK=$V,_6=du,Gb=lu,AK=wA,Qp=ag,Xo=Er,mK=tn,E6=Mp,v6=w_,Br=function(t,i,o){var s,c,l,p,h,g,f,_=!(!o||!o.AS_ENTRIES),v=!(!o||!o.IS_ITERATOR),y=!(!o||!o.INTERRUPTED),S=e6(i,o&&o.that),R=function(O){return s&&Eb(s,"normal",O),new vb(!0,O)},D=function(O){return _?(tK(O),y?S(O[0],O[1],R):S(O[0],O[1])):y?S(O,R):S(O)};if(v)s=t;else{if(!(c=n6(t)))throw EM(nK(t)+" is not iterable");if(t6(c)){for(l=0,p=_b(t);p>l;l++)if((h=D(t[l]))&&_M(zs,h))return h;return new vb(!1)}s=rK(t,c)}for(g=s.next;!(f=eK(g,s)).done;){try{h=D(f.value)}catch(O){Eb(s,"throw",O)}if("object"==typeof h&&h&&_M(zs,h))return h}return new vb(!1)},Hb=CM,C6=qv,KM=Zv.set,t1=f6,YM=QM,n1=Ub,r1=function(t){try{return{error:!1,value:t()}}catch(i){return{error:!0,value:i}}},bu=A6,Tu=as,qM=nN,JM=pK,i1=gv,o1=Mw,I6=hi("species"),yc="Promise",Wb=Tu.getterFor(yc),zM=Tu.set,Zo=Tu.getterFor(yc),cr=Qb&&Qb.prototype,Fn=Qb,Jt=cr,Sr=Il.TypeError,Ct=Il.document,$M=Il.process,Gp=n1.f,S6=Gp,b6=!!(Ct&&Ct.createEvent&&Il.dispatchEvent),XM=Xo(Il.PromiseRejectionEvent),ZM="unhandledrejection",T6=!1,s1=qM(yc,function(){var t=v6(Fn),i=t!==String(Fn);if(!i&&66===o1)return!0;if(o1>=51&&/native code/.test(t))return!1;var o=new Fn(function(c){c(1)}),s=function(c){c(function(){},function(){})};return(o.constructor={})[I6]=s,!(T6=o.then(function(){})instanceof s)||!i&&JM&&!XM}),a1=s1||!Hb(function(t){Fn.all(t).catch(function(){})}),VA=function(t){var i;return!(!mK(t)||!Xo(i=t.then))&&i},jA=function(t,i){var o,s,c,l=i.value,p=1==i.state,h=p?t.ok:t.fail,g=t.resolve,f=t.reject,A=t.domain;try{h?(p||(2===i.rejection&&EK(i),i.rejection=1),!0===h?o=l:(A&&A.enter(),o=h(l),A&&(A.exit(),c=!0)),o===t.promise?f(Sr("Promise-chain cycle")):(s=VA(o))?Su(s,o,g,f):g(o)):f(l)}catch(_){A&&!c&&A.exit(),f(_)}},_s=function(t,i){t.notified||(t.notified=!0,t1(function(){for(var o,s=t.reactions;o=s.get();)jA(o,t);t.notified=!1,i&&!t.rejection&&_K(t)}))},c1=function(t,i,o){var s,c;b6?((s=Ct.createEvent("Event")).promise=i,s.reason=o,s.initEvent(t,!1,!0),Il.dispatchEvent(s)):s={promise:i,reason:o},!XM&&(c=Il["on"+t])?c(s):t===ZM&&function(t,i){var o=g6.console;o&&o.error&&(1==arguments.length?o.error(t):o.error(t,i))}("Unhandled promise rejection",o)},_K=function(t){Su(KM,Il,function(){var i,o=t.facade,s=t.value;if(R6(t)&&(i=r1(function(){i1?$M.emit("unhandledRejection",s,o):c1(ZM,o,s)}),t.rejection=i1||R6(t)?2:1,i.error))throw i.value})},R6=function(t){return 1!==t.rejection&&!t.parent},EK=function(t){Su(KM,Il,function(){var i=t.facade;i1?$M.emit("rejectionHandled",i):c1("rejectionhandled",i,t.value)})},Hp=function(t,i,o){return function(s){t(i,s,o)}},Wp=function(t,i,o){t.done||(t.done=!0,o&&(t=o),t.value=i,t.state=2,_s(t,!0))},u1=function(t,i,o){if(!t.done){t.done=!0,o&&(t=o);try{if(t.facade===i)throw Sr("Promise can't be resolved itself");var s=VA(i);s?t1(function(){var c={done:!1};try{Su(s,i,Hp(u1,c,t),Hp(Wp,c,t))}catch(l){Wp(c,l,t)}}):(t.value=i,t.state=1,_s(t,!1))}catch(c){Wp({done:!1},c,t)}}};if(s1&&(Jt=(Fn=function(t){E6(this,Jt),Qp(t),Su(GM,this);var i=Wb(this);try{t(Hp(u1,i),Hp(Wp,i))}catch(o){Wp(i,o)}}).prototype,(GM=function(t){zM(this,{type:yc,done:!1,notified:!1,parent:!1,reactions:new bu,rejection:!1,state:0,value:void 0})}).prototype=gK(Jt,{then:function(t,i){var o=Zo(this),s=Gp(C6(this,Fn));return o.parent=!0,s.ok=!Xo(t)||t,s.fail=Xo(i)&&i,s.domain=i1?$M.domain:void 0,0==o.state?o.reactions.add(s):t1(function(){jA(s,o)}),s.promise},catch:function(t){return this.then(void 0,t)}}),HM=function(){var t=new GM,i=Wb(t);this.promise=t,this.resolve=Hp(u1,i),this.reject=Hp(Wp,i)},n1.f=Gp=function(t){return t===Fn||t===WM?new HM(t):S6(t)},Xo(Qb)&&cr!==Object.prototype)){Cc=cr.then,T6||(m6(cr,"then",function(t,i){var o=this;return new Fn(function(s,c){Su(Cc,o,s,c)}).then(t,i)},{unsafe:!0}),m6(cr,"catch",Jt.catch,{unsafe:!0}));try{delete cr.constructor}catch{}_6&&_6(cr,Jt)}jb({global:!0,wrap:!0,forced:s1},{Promise:Fn}),Gb(Fn,yc,!1),AK(yc),WM=fK(yc),jb({target:yc,stat:!0,forced:s1},{reject:function(t){var i=Gp(this);return Su(i.reject,void 0,t),i.promise}}),jb({target:yc,stat:!0,forced:s1},{resolve:function(t){return YM(this,t)}}),jb({target:yc,stat:!0,forced:a1},{all:function(t){var i=this,o=Gp(i),s=o.resolve,c=o.reject,l=r1(function(){var p=Qp(i.resolve),h=[],g=0,f=1;Br(t,function(A){var _=g++,v=!1;f++,Su(p,i,A).then(function(y){v||(v=!0,h[_]=y,--f||s(h))},c)}),--f||s(h)});return l.error&&c(l.value),o.promise},race:function(t){var i=this,o=Gp(i),s=o.reject,c=r1(function(){var l=Qp(i.resolve);Br(t,function(p){Su(l,i,p).then(o.resolve,s)})});return c.error&&s(c.value),o.promise}});var QA=zV,Es=Bs,l1=Er,w6=qv,ek=QM,N6=Us.exports;if(Ii({target:"Promise",proto:!0,real:!0,forced:!!QA&&An(function(){QA.prototype.finally.call({then:function(){}},function(){})})},{finally:function(t){var i=w6(this,Es("Promise")),o=l1(t);return this.then(o?function(s){return ek(i,t()).then(function(){return s})}:t,o?function(s){return ek(i,t()).then(function(){throw s})}:t)}}),l1(QA)){var tk=Es("Promise").prototype.finally;QA.prototype.finally!==tk&&N6(QA.prototype,"finally",tk,{unsafe:!0})}function Kp(t,i){const o=t&&t.navigator,s=t&&t.MediaStreamTrack;if(o.getUserMedia=function(c,l,p){qg("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),o.mediaDevices.getUserMedia(c).then(l,p)},!(i.version>55&&"autoGainControl"in o.mediaDevices.getSupportedConstraints())){const c=function(p,h,g){h in p&&!(g in p)&&(p[g]=p[h],delete p[h])},l=o.mediaDevices.getUserMedia.bind(o.mediaDevices);if(o.mediaDevices.getUserMedia=function(p){return"object"==typeof p&&"object"==typeof p.audio&&(p=JSON.parse(JSON.stringify(p)),c(p.audio,"autoGainControl","mozAutoGainControl"),c(p.audio,"noiseSuppression","mozNoiseSuppression")),l(p)},s&&s.prototype.getSettings){const p=s.prototype.getSettings;s.prototype.getSettings=function(){const h=p.apply(this,arguments);return c(h,"mozAutoGainControl","autoGainControl"),c(h,"mozNoiseSuppression","noiseSuppression"),h}}if(s&&s.prototype.applyConstraints){const p=s.prototype.applyConstraints;s.prototype.applyConstraints=function(h){return"audio"===this.kind&&"object"==typeof h&&(h=JSON.parse(JSON.stringify(h)),c(h,"autoGainControl","mozAutoGainControl"),c(h,"noiseSuppression","mozNoiseSuppression")),p.apply(this,[h])}}}}function nk(t){"object"==typeof t&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ri(t,i){if("object"!=typeof t||!t.RTCPeerConnection&&!t.mozRTCPeerConnection)return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),i.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){const l=t.RTCPeerConnection.prototype[c],p={[c](){return arguments[0]=new("addIceCandidate"===c?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),l.apply(this,arguments)}};t.RTCPeerConnection.prototype[c]=p[c]});const o={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[c,l,p]=arguments;return s.apply(this,[c||null]).then(h=>{if(i.version<53&&!l)try{h.forEach(g=>{g.type=o[g.type]||g.type})}catch(g){if("TypeError"!==g.name)throw g;h.forEach((f,A)=>{h.set(A,Object.assign({},f,{type:o[f.type]||f.type}))})}return h}).then(l,p)}}function Rt(t){if("object"!=typeof t||!t.RTCPeerConnection||!t.RTCRtpSender||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const i=t.RTCPeerConnection.prototype.getSenders;i&&(t.RTCPeerConnection.prototype.getSenders=function(){const s=i.apply(this,[]);return s.forEach(c=>c._pc=this),s});const o=t.RTCPeerConnection.prototype.addTrack;o&&(t.RTCPeerConnection.prototype.addTrack=function(){const s=o.apply(this,arguments);return s._pc=this,s}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Ie.resolve(new Map)}}function Wt(t){if("object"!=typeof t||!t.RTCPeerConnection||!t.RTCRtpSender||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const i=t.RTCPeerConnection.prototype.getReceivers;i&&(t.RTCPeerConnection.prototype.getReceivers=function(){const o=i.apply(this,[]);return o.forEach(s=>s._pc=this),o}),Od(t,"track",o=>(o.receiver._pc=o.srcElement,o)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function rk(t){t.RTCPeerConnection&&!("removeStream"in t.RTCPeerConnection.prototype)&&(t.RTCPeerConnection.prototype.removeStream=function(i){qg("removeStream","removeTrack"),this.getSenders().forEach(o=>{o.track&&i.getTracks().includes(o.track)&&this.removeTrack(o)})})}function GA(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function Ic(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype.addTransceiver;i&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const o=arguments[1],s=o&&"sendEncodings"in o;s&&o.sendEncodings.forEach(l=>{if("rid"in l&&!/^[a-z0-9]{0,16}$/i.test(l.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in l&&!(parseFloat(l.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in l&&!(parseFloat(l.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const c=i.apply(this,arguments);if(s){const{sender:l}=c,p=l.getParameters();(!("encodings"in p)||1===p.encodings.length&&0===Object.keys(p.encodings[0]).length)&&(p.encodings=o.sendEncodings,l.sendEncodings=o.sendEncodings,this.setParametersPromises.push(l.setParameters(p).then(()=>{delete l.sendEncodings}).catch(()=>{delete l.sendEncodings})))}return c})}function HA(t){if("object"!=typeof t||!t.RTCRtpSender)return;const i=t.RTCRtpSender.prototype.getParameters;i&&(t.RTCRtpSender.prototype.getParameters=function(){const o=i.apply(this,arguments);return"encodings"in o||(o.encodings=[].concat(this.sendEncodings||[{}])),o})}function Zs(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Ie.all(this.setParametersPromises).then(()=>i.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):i.apply(this,arguments)}}function ik(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Ie.all(this.setParametersPromises).then(()=>i.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):i.apply(this,arguments)}}var ii=Object.freeze({__proto__:null,shimOnTrack:nk,shimPeerConnection:ri,shimSenderGetStats:Rt,shimReceiverGetStats:Wt,shimRemoveStream:rk,shimRTCDataChannel:GA,shimAddTransceiver:Ic,shimGetParameters:HA,shimCreateOffer:Zs,shimCreateAnswer:ik,shimGetUserMedia:Kp,shimGetDisplayMedia:function(t,i){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(o){if(!o||!o.video){const s=new DOMException("getDisplayMedia without video constraints is undefined");return s.name="NotFoundError",s.code=8,Ie.reject(s)}return!0===o.video?o.video={mediaSource:i}:o.video.mediaSource=i,t.navigator.mediaDevices.getUserMedia(o)})}});function ok(t){if("object"==typeof t&&t.RTCPeerConnection){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(o){this._localStreams||(this._localStreams=[]),this._localStreams.includes(o)||this._localStreams.push(o),o.getAudioTracks().forEach(s=>i.call(this,s,o)),o.getVideoTracks().forEach(s=>i.call(this,s,o))},t.RTCPeerConnection.prototype.addTrack=function(o){for(var s=arguments.length,c=new Array(s>1?s-1:0),l=1;l<s;l++)c[l-1]=arguments[l];return c&&c.forEach(p=>{this._localStreams?this._localStreams.includes(p)||this._localStreams.push(p):this._localStreams=[p]}),i.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(i){this._localStreams||(this._localStreams=[]);const o=this._localStreams.indexOf(i);if(-1===o)return;this._localStreams.splice(o,1);const s=i.getTracks();this.getSenders().forEach(c=>{s.includes(c.track)&&this.removeTrack(c)})})}}function ir(t){if("object"==typeof t&&t.RTCPeerConnection&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(o){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=o),this.addEventListener("track",this._onaddstreampoly=s=>{s.streams.forEach(c=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(c))return;this._remoteStreams.push(c);const l=new Event("addstream");l.stream=c,this.dispatchEvent(l)})})}});const i=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const o=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(c=>{if(o._remoteStreams||(o._remoteStreams=[]),o._remoteStreams.indexOf(c)>=0)return;o._remoteStreams.push(c);const l=new Event("addstream");l.stream=c,o.dispatchEvent(l)})}),i.apply(o,arguments)}}}function sk(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype,o=i.createOffer,s=i.createAnswer,c=i.setLocalDescription,l=i.setRemoteDescription,p=i.addIceCandidate;i.createOffer=function(g,f){const _=o.apply(this,[arguments.length>=2?arguments[2]:arguments[0]]);return f?(_.then(g,f),Ie.resolve()):_},i.createAnswer=function(g,f){const _=s.apply(this,[arguments.length>=2?arguments[2]:arguments[0]]);return f?(_.then(g,f),Ie.resolve()):_};let h=function(g,f,A){const _=c.apply(this,[g]);return A?(_.then(f,A),Ie.resolve()):_};i.setLocalDescription=h,h=function(g,f,A){const _=l.apply(this,[g]);return A?(_.then(f,A),Ie.resolve()):_},i.setRemoteDescription=h,h=function(g,f,A){const _=p.apply(this,[g]);return A?(_.then(f,A),Ie.resolve()):_},i.addIceCandidate=h}function WA(t){const i=t&&t.navigator;if(i.mediaDevices&&i.mediaDevices.getUserMedia){const o=i.mediaDevices,s=o.getUserMedia.bind(o);i.mediaDevices.getUserMedia=c=>s(ak(c))}!i.getUserMedia&&i.mediaDevices&&i.mediaDevices.getUserMedia&&(i.getUserMedia=function(o,s,c){i.mediaDevices.getUserMedia(o).then(s,c)}.bind(i))}function ak(t){return t&&void 0!==t.video?Object.assign({},t,{video:w2(t.video)}):t}function KA(t){if(!t.RTCPeerConnection)return;const i=t.RTCPeerConnection;t.RTCPeerConnection=function(o,s){if(o&&o.iceServers){const c=[];for(let l=0;l<o.iceServers.length;l++){let p=o.iceServers[l];!p.hasOwnProperty("urls")&&p.hasOwnProperty("url")?(qg("RTCIceServer.url","RTCIceServer.urls"),p=JSON.parse(JSON.stringify(p)),p.urls=p.url,delete p.url,c.push(p)):c.push(o.iceServers[l])}o.iceServers=c}return new i(o,s)},t.RTCPeerConnection.prototype=i.prototype,"generateCertificate"in i&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:()=>i.generateCertificate})}function ck(t){"object"==typeof t&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Kb(t){const i=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(o){if(o){void 0!==o.offerToReceiveAudio&&(o.offerToReceiveAudio=!!o.offerToReceiveAudio);const s=this.getTransceivers().find(l=>"audio"===l.receiver.track.kind);!1===o.offerToReceiveAudio&&s?"sendrecv"===s.direction?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":"recvonly"===s.direction&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):!0!==o.offerToReceiveAudio||s||this.addTransceiver("audio"),void 0!==o.offerToReceiveVideo&&(o.offerToReceiveVideo=!!o.offerToReceiveVideo);const c=this.getTransceivers().find(l=>"video"===l.receiver.track.kind);!1===o.offerToReceiveVideo&&c?"sendrecv"===c.direction?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":"recvonly"===c.direction&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):!0!==o.offerToReceiveVideo||c||this.addTransceiver("video")}return i.apply(this,arguments)}}function d1(t){"object"!=typeof t||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var YA=Object.freeze({__proto__:null,shimLocalStreamsAPI:ok,shimRemoteStreamsAPI:ir,shimCallbacksAPI:sk,shimGetUserMedia:WA,shimConstraints:ak,shimRTCIceServerUrls:KA,shimTrackEventTransceiver:ck,shimCreateOfferLegacy:Kb,shimAudioContext:d1}),O6=G_,uk=Md,lk=nr("".replace),h1="[\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]",P6=RegExp("^"+h1+h1+"*"),M6=RegExp(h1+h1+"*$"),p1=function(t){return function(i){var o=uk(O6(i));return 1&t&&(o=lk(o,P6,"")),2&t&&(o=lk(o,M6,"")),o}},k6={start:p1(1),end:p1(2),trim:p1(3)},dk=aO.PROPER,f1=Cr,Yp="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",L6=k6.trim;ei({target:"String",proto:!0,forced:function(t){return f1(function(){return!!Yp[t]()||"\u200b\x85\u180e"!=="\u200b\x85\u180e"[t]()||dk&&Yp[t].name!==t})}("trim")},{trim:function(){return L6(this)}});var x6=bd("String").trim,qb=To,hk=x6,Jb=String.prototype,Ba=function(t){var i=t.trim;return"string"==typeof t||t===Jb||qb(Jb,t)&&i===Jb.trim?hk:i},B6=io;Ii({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return B6(URL.prototype.toString,this)}});var pk={exports:{}};!function(t){var i={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};i.localCName=i.generateIdentifier(),i.splitLines=function(o){return Ba(o).call(o).split("\n").map(function(s){return Ba(s).call(s)})},i.splitSections=function(o){return o.split("\nm=").map(function(s,c){var l;return Ba(l=c>0?"m="+s:s).call(l)+"\r\n"})},i.getDescription=function(o){var s=i.splitSections(o);return s&&s[0]},i.getMediaSections=function(o){var s=i.splitSections(o);return s.shift(),s},i.matchPrefix=function(o,s){return i.splitLines(o).filter(function(c){return 0===c.indexOf(s)})},i.parseCandidate=function(o){for(var s,c={foundation:(s=0===o.indexOf("a=candidate:")?o.substring(12).split(" "):o.substring(10).split(" "))[0],component:parseInt(s[1],10),protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]},l=8;l<s.length;l+=2)switch(s[l]){case"raddr":c.relatedAddress=s[l+1];break;case"rport":c.relatedPort=parseInt(s[l+1],10);break;case"tcptype":c.tcpType=s[l+1];break;case"ufrag":c.ufrag=s[l+1],c.usernameFragment=s[l+1];break;default:c[s[l]]=s[l+1]}return c},i.writeCandidate=function(o){var s=[];s.push(o.foundation),s.push(o.component),s.push(o.protocol.toUpperCase()),s.push(o.priority),s.push(o.address||o.ip),s.push(o.port);var c=o.type;return s.push("typ"),s.push(c),"host"!==c&&o.relatedAddress&&o.relatedPort&&(s.push("raddr"),s.push(o.relatedAddress),s.push("rport"),s.push(o.relatedPort)),o.tcpType&&"tcp"===o.protocol.toLowerCase()&&(s.push("tcptype"),s.push(o.tcpType)),(o.usernameFragment||o.ufrag)&&(s.push("ufrag"),s.push(o.usernameFragment||o.ufrag)),"candidate:"+s.join(" ")},i.parseIceOptions=function(o){return o.substr(14).split(" ")},i.parseRtpMap=function(o){var s=o.substr(9).split(" "),c={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),c.name=s[0],c.clockRate=parseInt(s[1],10),c.channels=3===s.length?parseInt(s[2],10):1,c.numChannels=c.channels,c},i.writeRtpMap=function(o){var s=o.payloadType;void 0!==o.preferredPayloadType&&(s=o.preferredPayloadType);var c=o.channels||o.numChannels||1;return"a=rtpmap:"+s+" "+o.name+"/"+o.clockRate+(1!==c?"/"+c:"")+"\r\n"},i.parseExtmap=function(o){var s=o.substr(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1]}},i.writeExtmap=function(o){return"a=extmap:"+(o.id||o.preferredId)+(o.direction&&"sendrecv"!==o.direction?"/"+o.direction:"")+" "+o.uri+"\r\n"},i.parseFmtp=function(o){for(var s,c={},l=o.substr(o.indexOf(" ")+1).split(";"),p=0;p<l.length;p++){var h,g;s=Ba(h=l[p]).call(h).split("="),c[Ba(g=s[0]).call(g)]=s[1]}return c},i.writeFmtp=function(o){var s="",c=o.payloadType;if(void 0!==o.preferredPayloadType&&(c=o.preferredPayloadType),o.parameters&&Object.keys(o.parameters).length){var l=[];Object.keys(o.parameters).forEach(function(p){l.push(o.parameters[p]?p+"="+o.parameters[p]:p)}),s+="a=fmtp:"+c+" "+l.join(";")+"\r\n"}return s},i.parseRtcpFb=function(o){var s=o.substr(o.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},i.writeRtcpFb=function(o){var s="",c=o.payloadType;return void 0!==o.preferredPayloadType&&(c=o.preferredPayloadType),o.rtcpFeedback&&o.rtcpFeedback.length&&o.rtcpFeedback.forEach(function(l){s+="a=rtcp-fb:"+c+" "+l.type+(l.parameter&&l.parameter.length?" "+l.parameter:"")+"\r\n"}),s},i.parseSsrcMedia=function(o){var s=o.indexOf(" "),c={ssrc:parseInt(o.substr(7,s-7),10)},l=o.indexOf(":",s);return l>-1?(c.attribute=o.substr(s+1,l-s-1),c.value=o.substr(l+1)):c.attribute=o.substr(s+1),c},i.parseSsrcGroup=function(o){var s=o.substr(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(function(c){return parseInt(c,10)})}},i.getMid=function(o){var s=i.matchPrefix(o,"a=mid:")[0];if(s)return s.substr(6)},i.parseFingerprint=function(o){var s=o.substr(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1]}},i.getDtlsParameters=function(o,s){return{role:"auto",fingerprints:i.matchPrefix(o+s,"a=fingerprint:").map(i.parseFingerprint)}},i.writeDtlsParameters=function(o,s){var c="a=setup:"+s+"\r\n";return o.fingerprints.forEach(function(l){c+="a=fingerprint:"+l.algorithm+" "+l.value+"\r\n"}),c},i.parseCryptoLine=function(o){var s=o.substr(9).split(" ");return{tag:parseInt(s[0],10),cryptoSuite:s[1],keyParams:s[2],sessionParams:s.slice(3)}},i.writeCryptoLine=function(o){return"a=crypto:"+o.tag+" "+o.cryptoSuite+" "+("object"==typeof o.keyParams?i.writeCryptoKeyParams(o.keyParams):o.keyParams)+(o.sessionParams?" "+o.sessionParams.join(" "):"")+"\r\n"},i.parseCryptoKeyParams=function(o){if(0!==o.indexOf("inline:"))return null;var s=o.substr(7).split("|");return{keyMethod:"inline",keySalt:s[0],lifeTime:s[1],mkiValue:s[2]?s[2].split(":")[0]:void 0,mkiLength:s[2]?s[2].split(":")[1]:void 0}},i.writeCryptoKeyParams=function(o){return o.keyMethod+":"+o.keySalt+(o.lifeTime?"|"+o.lifeTime:"")+(o.mkiValue&&o.mkiLength?"|"+o.mkiValue+":"+o.mkiLength:"")},i.getCryptoParameters=function(o,s){return i.matchPrefix(o+s,"a=crypto:").map(i.parseCryptoLine)},i.getIceParameters=function(o,s){var c=i.matchPrefix(o+s,"a=ice-ufrag:")[0],l=i.matchPrefix(o+s,"a=ice-pwd:")[0];return c&&l?{usernameFragment:c.substr(12),password:l.substr(10)}:null},i.writeIceParameters=function(o){return"a=ice-ufrag:"+o.usernameFragment+"\r\na=ice-pwd:"+o.password+"\r\n"},i.parseRtpParameters=function(o){for(var s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=i.splitLines(o)[0].split(" "),l=3;l<c.length;l++){var p=c[l],h=i.matchPrefix(o,"a=rtpmap:"+p+" ")[0];if(h){var g=i.parseRtpMap(h),f=i.matchPrefix(o,"a=fmtp:"+p+" ");switch(g.parameters=f.length?i.parseFmtp(f[0]):{},g.rtcpFeedback=i.matchPrefix(o,"a=rtcp-fb:"+p+" ").map(i.parseRtcpFb),s.codecs.push(g),g.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(g.name.toUpperCase())}}}return i.matchPrefix(o,"a=extmap:").forEach(function(A){s.headerExtensions.push(i.parseExtmap(A))}),s},i.writeRtpDescription=function(o,s){var c="";c+="m="+o+" ",c+=s.codecs.length>0?"9":"0",c+=" UDP/TLS/RTP/SAVPF ",c+=s.codecs.map(function(p){return void 0!==p.preferredPayloadType?p.preferredPayloadType:p.payloadType}).join(" ")+"\r\n",c+="c=IN IP4 0.0.0.0\r\n",c+="a=rtcp:9 IN IP4 0.0.0.0\r\n",s.codecs.forEach(function(p){c+=i.writeRtpMap(p),c+=i.writeFmtp(p),c+=i.writeRtcpFb(p)});var l=0;return s.codecs.forEach(function(p){p.maxptime>l&&(l=p.maxptime)}),l>0&&(c+="a=maxptime:"+l+"\r\n"),c+="a=rtcp-mux\r\n",s.headerExtensions&&s.headerExtensions.forEach(function(p){c+=i.writeExtmap(p)}),c},i.parseRtpEncodingParameters=function(o){var s,c=[],l=i.parseRtpParameters(o),p=-1!==l.fecMechanisms.indexOf("RED"),h=-1!==l.fecMechanisms.indexOf("ULPFEC"),g=i.matchPrefix(o,"a=ssrc:").map(function(v){return i.parseSsrcMedia(v)}).filter(function(v){return"cname"===v.attribute}),f=g.length>0&&g[0].ssrc,A=i.matchPrefix(o,"a=ssrc-group:FID").map(function(v){return v.substr(17).split(" ").map(function(y){return parseInt(y,10)})});A.length>0&&A[0].length>1&&A[0][0]===f&&(s=A[0][1]),l.codecs.forEach(function(v){if("RTX"===v.name.toUpperCase()&&v.parameters.apt){var y={ssrc:f,codecPayloadType:parseInt(v.parameters.apt,10)};f&&s&&(y.rtx={ssrc:s}),c.push(y),p&&((y=JSON.parse(JSON.stringify(y))).fec={ssrc:f,mechanism:h?"red+ulpfec":"red"},c.push(y))}}),0===c.length&&f&&c.push({ssrc:f});var _=i.matchPrefix(o,"b=");return _.length&&(_=0===_[0].indexOf("b=TIAS:")?parseInt(_[0].substr(7),10):0===_[0].indexOf("b=AS:")?1e3*parseInt(_[0].substr(5),10)*.95-16e3:void 0,c.forEach(function(v){v.maxBitrate=_})),c},i.parseRtcpParameters=function(o){var s={},c=i.matchPrefix(o,"a=ssrc:").map(function(h){return i.parseSsrcMedia(h)}).filter(function(h){return"cname"===h.attribute})[0];c&&(s.cname=c.value,s.ssrc=c.ssrc);var l=i.matchPrefix(o,"a=rtcp-rsize");s.reducedSize=l.length>0,s.compound=0===l.length;var p=i.matchPrefix(o,"a=rtcp-mux");return s.mux=p.length>0,s},i.parseMsid=function(o){var s,c=i.matchPrefix(o,"a=msid:");if(1===c.length)return{stream:(s=c[0].substr(7).split(" "))[0],track:s[1]};var l=i.matchPrefix(o,"a=ssrc:").map(function(p){return i.parseSsrcMedia(p)}).filter(function(p){return"msid"===p.attribute});return l.length>0?{stream:(s=l[0].value.split(" "))[0],track:s[1]}:void 0},i.parseSctpDescription=function(o){var s,c=i.parseMLine(o),l=i.matchPrefix(o,"a=max-message-size:");l.length>0&&(s=parseInt(l[0].substr(19),10)),isNaN(s)&&(s=65536);var p=i.matchPrefix(o,"a=sctp-port:");if(p.length>0)return{port:parseInt(p[0].substr(12),10),protocol:c.fmt,maxMessageSize:s};if(i.matchPrefix(o,"a=sctpmap:").length>0){var h=i.matchPrefix(o,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(h[0],10),protocol:h[1],maxMessageSize:s}}},i.writeSctpDescription=function(o,s){var c=[];return c="DTLS/SCTP"!==o.protocol?["m="+o.kind+" 9 "+o.protocol+" "+s.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+s.port+"\r\n"]:["m="+o.kind+" 9 "+o.protocol+" "+s.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+s.port+" "+s.protocol+" 65535\r\n"],void 0!==s.maxMessageSize&&c.push("a=max-message-size:"+s.maxMessageSize+"\r\n"),c.join("")},i.generateSessionId=function(){return Math.random().toString().substr(2,21)},i.writeSessionBoilerplate=function(o,s,c){var l=void 0!==s?s:2;return"v=0\r\no="+(c||"thisisadapterortc")+" "+(o||i.generateSessionId())+" "+l+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},i.writeMediaSection=function(o,s,c,l){var p=i.writeRtpDescription(o.kind,s);if(p+=i.writeIceParameters(o.iceGatherer.getLocalParameters()),p+=i.writeDtlsParameters(o.dtlsTransport.getLocalParameters(),"offer"===c?"actpass":"active"),p+="a=mid:"+o.mid+"\r\n",p+=o.direction?"a="+o.direction+"\r\n":o.rtpSender&&o.rtpReceiver?"a=sendrecv\r\n":o.rtpSender?"a=sendonly\r\n":o.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",o.rtpSender){var h="msid:"+l.id+" "+o.rtpSender.track.id+"\r\n";p+="a="+h,p+="a=ssrc:"+o.sendEncodingParameters[0].ssrc+" "+h,o.sendEncodingParameters[0].rtx&&(p+="a=ssrc:"+o.sendEncodingParameters[0].rtx.ssrc+" "+h,p+="a=ssrc-group:FID "+o.sendEncodingParameters[0].ssrc+" "+o.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return p+="a=ssrc:"+o.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",o.rtpSender&&o.sendEncodingParameters[0].rtx&&(p+="a=ssrc:"+o.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),p},i.getDirection=function(o,s){for(var c=i.splitLines(o),l=0;l<c.length;l++)switch(c[l]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return c[l].substr(2)}return s?i.getDirection(s):"sendrecv"},i.getKind=function(o){return i.splitLines(o)[0].split(" ")[0].substr(2)},i.isRejected=function(o){return"0"===o.split(" ",2)[1]},i.parseMLine=function(o){var s=i.splitLines(o)[0].substr(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},i.parseOLine=function(o){var s=i.matchPrefix(o,"o=")[0].substr(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},i.isValidSDP=function(o){if("string"!=typeof o||0===o.length)return!1;for(var s=i.splitLines(o),c=0;c<s.length;c++)if(s[c].length<2||"="!==s[c].charAt(1))return!1;return!0},t.exports=i}(pk);var g1=pk.exports;function qp(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const i=t.RTCIceCandidate;t.RTCIceCandidate=function(o){if("object"==typeof o&&o.candidate&&0===o.candidate.indexOf("a=")&&((o=JSON.parse(JSON.stringify(o))).candidate=o.candidate.substr(2)),o.candidate&&o.candidate.length){const s=new i(o),c=g1.parseCandidate(o.candidate),l=Object.assign(s,c);return l.toJSON=function(){return{candidate:l.candidate,sdpMid:l.sdpMid,sdpMLineIndex:l.sdpMLineIndex,usernameFragment:l.usernameFragment}},l}return new i(o)},t.RTCIceCandidate.prototype=i.prototype,Od(t,"icecandidate",o=>(o.candidate&&Object.defineProperty(o,"candidate",{value:new t.RTCIceCandidate(o.candidate),writable:"false"}),o))}function qA(t,i){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const o=function(h){if(!h||!h.sdp)return!1;const g=g1.splitSections(h.sdp);return g.shift(),g.some(f=>{const A=g1.parseMLine(f);return A&&"application"===A.kind&&-1!==A.protocol.indexOf("SCTP")})},s=function(h){const g=h.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===g||g.length<2)return-1;const f=parseInt(g[1],10);return f!=f?-1:f},c=function(h){let g=65536;return"firefox"===i.browser&&(g=i.version<57?-1===h?16384:2147483637:i.version<60?57===i.version?65535:65536:2147483637),g},l=function(h,g){let f=65536;"firefox"===i.browser&&57===i.version&&(f=65535);const A=g1.matchPrefix(h.sdp,"a=max-message-size:");return A.length>0?f=parseInt(A[0].substr(19),10):"firefox"===i.browser&&-1!==g&&(f=2147483637),f},p=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===i.browser&&i.version>=76){const{sdpSemantics:h}=this.getConfiguration();"plan-b"===h&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(o(arguments[0])){const h=s(arguments[0]),g=c(h),f=l(arguments[0],h);let A;A=0===g&&0===f?Number.POSITIVE_INFINITY:0===g||0===f?Math.max(g,f):Math.min(g,f);const _={};Object.defineProperty(_,"maxMessageSize",{get:()=>A}),this._sctp=_}return p.apply(this,arguments)}}function JA(t){if(!t.RTCPeerConnection||!("createDataChannel"in t.RTCPeerConnection.prototype))return;function i(s,c){const l=s.send;s.send=function(){const p=arguments[0];if("open"===s.readyState&&c.sctp&&(p.length||p.size||p.byteLength)>c.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+c.sctp.maxMessageSize+" bytes)");return l.apply(s,arguments)}}const o=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const s=o.apply(this,arguments);return i(s,this),s},Od(t,"datachannel",s=>(i(s.channel,s.target),s))}function zb(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const i=t.RTCPeerConnection.prototype;Object.defineProperty(i,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(i,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(o){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),o&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=o)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(o=>{const s=i[o];i[o]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=c=>{const l=c.target;if(l._lastConnectionState!==l.connectionState){l._lastConnectionState=l.connectionState;const p=new Event("connectionstatechange",c);l.dispatchEvent(p)}return c},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),s.apply(this,arguments)}})}function zA(t,i){if(!t.RTCPeerConnection||"chrome"===i.browser&&i.version>=71||"safari"===i.browser&&i.version>=605)return;const o=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(s){if(s&&s.sdp&&-1!==s.sdp.indexOf("\na=extmap-allow-mixed")){const c=s.sdp.split("\n").filter(l=>"a=extmap-allow-mixed"!==Ba(l).call(l)).join("\n");t.RTCSessionDescription&&s instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:s.type,sdp:c}):s.sdp=c}return o.apply(this,arguments)}}function Jp(t,i){if(!t.RTCPeerConnection||!t.RTCPeerConnection.prototype)return;const o=t.RTCPeerConnection.prototype.addIceCandidate;o&&0!==o.length&&(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===i.browser&&i.version<78||"firefox"===i.browser&&i.version<68||"safari"===i.browser)&&arguments[0]&&""===arguments[0].candidate?Ie.resolve():o.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Ie.resolve())})}var fk=Object.freeze({__proto__:null,shimRTCIceCandidate:qp,shimMaxMessageSize:qA,shimSendThrowTypeError:JA,shimConnectionState:zb,removeExtmapAllowMixed:zA,shimAddIceCandidateNullOrEmpty:Jp});let oi,nn;(function(){let{window:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};const o=II,s=ap(t),c={browserDetails:s,commonShim:fk,extractVersion:Ks,disableLog:yI,disableWarnings:l8};switch(s.browser){case"chrome":if(!pb||!db||!i.shimChrome)return o("Chrome shim is not included in this adapter release."),c;if(null===s.version)return o("Chrome shim can not determine version, not shimming."),c;o("adapter.js shimming chrome."),c.browserShim=pb,Jp(t,s),oM(t,s),lb(t),db(t,s),Bv(t),cM(t,s),qV(t),sM(t),JV(t),hb(t,s),qp(t),zb(t),qA(t,s),JA(t),zA(t,s);break;case"firefox":if(!ii||!ri||!i.shimFirefox)return o("Firefox shim is not included in this adapter release."),c;o("adapter.js shimming firefox."),c.browserShim=ii,Jp(t,s),Kp(t,s),ri(t,s),nk(t),rk(t),Rt(t),Wt(t),GA(t),Ic(t),HA(t),Zs(t),ik(t),qp(t),zb(t),qA(t,s),JA(t);break;case"edge":if(!pM||!Vv||!i.shimEdge)return o("MS edge shim is not included in this adapter release."),c;o("adapter.js shimming edge."),c.browserShim=pM,gb(t),Ab(t),Vv(t,s),hM(t),qA(t,s),JA(t);break;case"safari":if(!YA||!i.shimSafari)return o("Safari shim is not included in this adapter release."),c;o("adapter.js shimming safari."),c.browserShim=YA,Jp(t,s),KA(t),Kb(t),sk(t),ok(t),ir(t),ck(t),WA(t),d1(t),qp(t),qA(t,s),JA(t),zA(t,s);break;default:o("Unsupported browser!")}})({window:typeof window>"u"?void 0:window}),function(t){t.WIN_10="Windows 10",t.WIN_81="Windows 8.1",t.WIN_8="Windows 8",t.WIN_7="Windows 7",t.WIN_VISTA="Windows Vista",t.WIN_SERVER_2003="Windows Server 2003",t.WIN_XP="Windows XP",t.WIN_2000="Windows 2000",t.ANDROID="Android",t.OPEN_BSD="Open BSD",t.SUN_OS="Sun OS",t.LINUX="Linux",t.IOS="iOS",t.MAC_OS="Mac OS",t.QNX="QNX",t.UNIX="UNIX",t.BEOS="BeOS",t.OS_2="OS/2",t.SEARCH_BOT="Search Bot"}(oi||(oi={})),function(t){t.CHROME="Chrome",t.SAFARI="Safari",t.EDGE="Edge",t.FIREFOX="Firefox",t.OPERA="OPR",t.QQ="QQBrowser",t.WECHAT="MicroMessenger"}(nn||(nn={}));var A1={exports:{}};!function(t,i){!function(o,s){var c="function",l="undefined",p="object",h="string",g="model",f="name",A="type",_="vendor",v="version",y="architecture",S="console",R="mobile",D="tablet",O="smarttv",P="wearable",B="embedded",G="Amazon",Y="Apple",te="BlackBerry",_e="Google",Oe="Microsoft",Ye="Motorola",z="Samsung",Q="Sony",K="Xiaomi",ne="Zebra",me="Facebook",Ne=function(vt){for(var Xt={},et=0;et<vt.length;et++)Xt[vt[et].toUpperCase()]=vt[et];return Xt},ce=function(vt,Xt){return typeof vt===h&&-1!==T(Xt).indexOf(T(vt))},T=function(vt){return vt.toLowerCase()},k=function(vt,Xt){if(typeof vt===h)return vt=vt.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof Xt===l?vt:vt.substring(0,350)},j=function(vt,Xt){for(var et,Zt,pt,Gt,li,Xn,mr=0;mr<Xt.length&&!li;){var A_=Xt[mr],X=Xt[mr+1];for(et=Zt=0;et<A_.length&&!li;)if(li=A_[et++].exec(vt))for(pt=0;pt<X.length;pt++)Xn=li[++Zt],typeof(Gt=X[pt])===p&&Gt.length>0?2===Gt.length?this[Gt[0]]=typeof Gt[1]==c?Gt[1].call(this,Xn):Gt[1]:3===Gt.length?this[Gt[0]]=typeof Gt[1]!==c||Gt[1].exec&&Gt[1].test?Xn?Xn.replace(Gt[1],Gt[2]):s:Xn?Gt[1].call(this,Xn,Gt[2]):s:4===Gt.length&&(this[Gt[0]]=Xn?Gt[3].call(this,Xn.replace(Gt[1],Gt[2])):s):this[Gt]=Xn||s;mr+=2}},re=function(vt,Xt){for(var et in Xt)if(typeof Xt[et]===p&&Xt[et].length>0){for(var Zt=0;Zt<Xt[et].length;Zt++)if(ce(Xt[et][Zt],vt))return"?"===et?s:et}else if(ce(Xt[et],vt))return"?"===et?s:et;return vt},be={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},dt={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[v,[f,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[v,[f,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[f,v],[/opios[\/ ]+([\w\.]+)/i],[v,[f,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[v,[f,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[f,v],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[v,[f,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[v,[f,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[v,[f,"WeChat"]],[/konqueror\/([\w\.]+)/i],[v,[f,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[v,[f,"IE"]],[/yabrowser\/([\w\.]+)/i],[v,[f,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[f,/(.+)/,"$1 Secure Browser"],v],[/\bfocus\/([\w\.]+)/i],[v,[f,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[v,[f,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[v,[f,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[v,[f,"Dolphin"]],[/coast\/([\w\.]+)/i],[v,[f,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[v,[f,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[v,[f,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[f,"360 Browser"]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[f,/(.+)/,"$1 Browser"],v],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],v],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[f,v],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[f],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[f,me],v],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[f,v],[/\bgsa\/([\w\.]+) .*safari\//i],[v,[f,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[v,[f,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[f,"Chrome WebView"],v],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[v,[f,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[f,v],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[v,[f,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[v,f],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[f,[v,re,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[f,v],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[f,"Netscape"],v],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[v,[f,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[f,v]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[y,"amd64"]],[/(ia32(?=;))/i],[[y,T]],[/((?:i[346]|x)86)[;\)]/i],[[y,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[y,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[y,"armhf"]],[/windows (ce|mobile); ppc;/i],[[y,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[y,/ower/,"",T]],[/(sun4\w)[;\)]/i],[[y,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[y,T]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[g,[_,z],[A,D]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[g,[_,z],[A,R]],[/\((ip(?:hone|od)[\w ]*);/i],[g,[_,Y],[A,R]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[g,[_,Y],[A,D]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[g,[_,"Huawei"],[A,D]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[g,[_,"Huawei"],[A,R]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[g,/_/g," "],[_,K],[A,R]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[g,/_/g," "],[_,K],[A,D]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[g,[_,"OPPO"],[A,R]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[g,[_,"Vivo"],[A,R]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[g,[_,"Realme"],[A,R]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[g,[_,Ye],[A,R]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[g,[_,Ye],[A,D]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[g,[_,"LG"],[A,D]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[g,[_,"LG"],[A,R]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[g,[_,"Lenovo"],[A,D]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[g,/_/g," "],[_,"Nokia"],[A,R]],[/(pixel c)\b/i],[g,[_,_e],[A,D]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[g,[_,_e],[A,R]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[g,[_,Q],[A,R]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[g,"Xperia Tablet"],[_,Q],[A,D]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[g,[_,"OnePlus"],[A,R]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[g,[_,G],[A,D]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[g,/(.+)/g,"Fire Phone $1"],[_,G],[A,R]],[/(playbook);[-\w\),; ]+(rim)/i],[g,_,[A,D]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[g,[_,te],[A,R]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[g,[_,"ASUS"],[A,D]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[g,[_,"ASUS"],[A,R]],[/(nexus 9)/i],[g,[_,"HTC"],[A,D]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony(?!-bra))[-_ ]?([-\w]*)/i],[_,[g,/_/g," "],[A,R]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[g,[_,"Acer"],[A,D]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[g,[_,"Meizu"],[A,R]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[g,[_,"Sharp"],[A,R]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[_,g,[A,R]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[_,g,[A,D]],[/(surface duo)/i],[g,[_,Oe],[A,D]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[g,[_,"Fairphone"],[A,R]],[/(u304aa)/i],[g,[_,"AT&T"],[A,R]],[/\bsie-(\w*)/i],[g,[_,"Siemens"],[A,R]],[/\b(rct\w+) b/i],[g,[_,"RCA"],[A,D]],[/\b(venue[\d ]{2,7}) b/i],[g,[_,"Dell"],[A,D]],[/\b(q(?:mv|ta)\w+) b/i],[g,[_,"Verizon"],[A,D]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[g,[_,"Barnes & Noble"],[A,D]],[/\b(tm\d{3}\w+) b/i],[g,[_,"NuVision"],[A,D]],[/\b(k88) b/i],[g,[_,"ZTE"],[A,D]],[/\b(nx\d{3}j) b/i],[g,[_,"ZTE"],[A,R]],[/\b(gen\d{3}) b.+49h/i],[g,[_,"Swiss"],[A,R]],[/\b(zur\d{3}) b/i],[g,[_,"Swiss"],[A,D]],[/\b((zeki)?tb.*\b) b/i],[g,[_,"Zeki"],[A,D]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[_,"Dragon Touch"],g,[A,D]],[/\b(ns-?\w{0,9}) b/i],[g,[_,"Insignia"],[A,D]],[/\b((nxa|next)-?\w{0,9}) b/i],[g,[_,"NextBook"],[A,D]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[_,"Voice"],g,[A,R]],[/\b(lvtel\-)?(v1[12]) b/i],[[_,"LvTel"],g,[A,R]],[/\b(ph-1) /i],[g,[_,"Essential"],[A,R]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[g,[_,"Envizen"],[A,D]],[/\b(trio[-\w\. ]+) b/i],[g,[_,"MachSpeed"],[A,D]],[/\btu_(1491) b/i],[g,[_,"Rotor"],[A,D]],[/(shield[\w ]+) b/i],[g,[_,"Nvidia"],[A,D]],[/(sprint) (\w+)/i],[_,g,[A,R]],[/(kin\.[onetw]{3})/i],[[g,/\./g," "],[_,Oe],[A,R]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[g,[_,ne],[A,D]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[g,[_,ne],[A,R]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[_,g,[A,S]],[/droid.+; (shield) bui/i],[g,[_,"Nvidia"],[A,S]],[/(playstation [345portablevi]+)/i],[g,[_,Q],[A,S]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[g,[_,Oe],[A,S]],[/smart-tv.+(samsung)/i],[_,[A,O]],[/hbbtv.+maple;(\d+)/i],[[g,/^/,"SmartTV"],[_,z],[A,O]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[_,"LG"],[A,O]],[/(apple) ?tv/i],[_,[g,"Apple TV"],[A,O]],[/crkey/i],[[g,"Chromecast"],[_,_e],[A,O]],[/droid.+aft(\w)( bui|\))/i],[g,[_,G],[A,O]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[g,[_,"Sharp"],[A,O]],[/(bravia[\w ]+)( bui|\))/i],[g,[_,Q],[A,O]],[/(mitv-\w{5}) bui/i],[g,[_,K],[A,O]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[_,k],[g,k],[A,O]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[A,O]],[/((pebble))app/i],[_,g,[A,P]],[/droid.+; (glass) \d/i],[g,[_,_e],[A,P]],[/droid.+; (wt63?0{2,3})\)/i],[g,[_,ne],[A,P]],[/(quest( 2)?)/i],[g,[_,me],[A,P]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[_,[A,B]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[g,[A,R]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[g,[A,D]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[A,D]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[A,R]],[/(android[-\w\. ]{0,9});.+buil/i],[g,[_,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[v,[f,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[v,[f,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[f,v],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[v,f]],os:[[/microsoft (windows) (vista|xp)/i],[f,v],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[f,[v,re,be]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[f,"Windows"],[v,re,be]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[v,/_/g,"."],[f,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[f,"Mac OS"],[v,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[v,f],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[f,v],[/\(bb(10);/i],[v,[f,te]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[v,[f,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[v,[f,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[v,[f,"webOS"]],[/crkey\/([\d\.]+)/i],[v,[f,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[f,"Chromium OS"],v],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[f,v],[/(sunos) ?([\w\.\d]*)/i],[[f,"Solaris"],v],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[f,v]]},St=function(vt,Xt){if(typeof vt===p&&(Xt=vt,vt=s),!(this instanceof St))return new St(vt,Xt).getResult();var et=vt||(typeof o!==l&&o.navigator&&o.navigator.userAgent?o.navigator.userAgent:""),Zt=Xt?function(pt,Gt){var li={};for(var Xn in pt)li[Xn]=Gt[Xn]&&Gt[Xn].length%2==0?Gt[Xn].concat(pt[Xn]):pt[Xn];return li}(dt,Xt):dt;return this.getBrowser=function(){var Gt,pt={};return pt.name=s,pt.version=s,j.call(pt,et,Zt.browser),pt.major=typeof(Gt=pt.version)===h?Gt.replace(/[^\d\.]/g,"").split(".")[0]:s,pt},this.getCPU=function(){var pt={};return pt.architecture=s,j.call(pt,et,Zt.cpu),pt},this.getDevice=function(){var pt={};return pt.vendor=s,pt.model=s,pt.type=s,j.call(pt,et,Zt.device),pt},this.getEngine=function(){var pt={};return pt.name=s,pt.version=s,j.call(pt,et,Zt.engine),pt},this.getOS=function(){var pt={};return pt.name=s,pt.version=s,j.call(pt,et,Zt.os),pt},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return et},this.setUA=function(pt){return et=typeof pt===h&&pt.length>350?k(pt,350):pt,this},this.setUA(et),this};St.VERSION="0.7.32",St.BROWSER=Ne([f,v,"major"]),St.CPU=Ne([y]),St.DEVICE=Ne([g,_,A,S,R,O,D,P,B]),St.ENGINE=St.OS=Ne([f,v]),t.exports&&(i=t.exports=St),i.UAParser=St;var at=typeof o!==l&&(o.jQuery||o.Zepto);if(at&&!at.ua){var sn=new St;at.ua=sn.getResult(),at.ua.get=function(){return sn.getUA()},at.ua.set=function(vt){sn.setUA(vt);var Xt=sn.getResult();for(var et in Xt)at.ua[et]=Xt[et]}}}("object"==typeof window?window:Go)}(A1,A1.exports);const m1=new A1.exports;let Ru=m1.getResult();function zt(t){return t&&m1.setUA(t),Ru=m1.getResult(),{name:gk(Ru),version:F6(Ru),os:zp(Ru),osVersion:Ru.os.version}}function gk(t){if("Blink"===t.engine.name&&"WeChat"!==t.browser.name)return nn.CHROME;switch(t.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return nn.CHROME;case"Safari":case"Mobile Safari":return nn.SAFARI;case"Edge":return nn.EDGE;case"Firefox":return nn.FIREFOX;case"QQBrowser":return nn.QQ;case"Opera":return nn.OPERA;case"WeChat":return nn.WECHAT;default:return t.browser.name||""}}function F6(t){let i;return i="Blink"===t.engine.name?t.engine.version||"":t.browser.version||"",i.split(".")[0]}function zp(t){return"Windows"===t.os.name?t.os.version?t.os.name+" "+t.os.version:t.os.name:t.os.name||""}function $b(){return zt().os}function _1(){const t=zt();return!!("WebKit"===Ru.engine.name&&t.os===oi.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&t.name!==nn.SAFARI||Oo()&&t.name!==nn.SAFARI)}function E1(){return zt().name===nn.CHROME}function Di(){return zt().name===nn.SAFARI}function bn(){return zt().name===nn.FIREFOX}function Oo(){return zt().os===oi.IOS}function v1(){const t=zt();return!(t.name!==nn.CHROME||!t.osVersion)&&Number(t.version)<=90}function Xb(){const t=zt();if(t.os!==oi.IOS||!t.osVersion)return!1;const i=t.osVersion.split(".");return Number(i[0])<14||14===Number(i[0])&&Number(i[1])<=6}function Zd(){const t=zt();if(t.os!==oi.IOS||!t.osVersion)return!1;const i=t.osVersion.split(".");return 15===Number(i[0])}function Ak(){const t=zt();if(t.os!==oi.IOS||!t.osVersion)return!1;const i=t.osVersion.split(".");return 15===Number(i[0])&&0===Number(i[1])}function mk(){const t=zt();if(t.os!==oi.IOS||!t.osVersion)return!1;const i=t.osVersion.split(".");return 15===Number(i[0])&&Number(i[1])>=1}function Du(){const t=zt();if(t.os!==oi.IOS||!t.osVersion)return!1;const i=t.osVersion.split(".");return 15===Number(i[0])&&Number(i[1])>=2}function bl(){return Di()&&navigator.maxTouchPoints>0}function ea(){return zt().name===nn.WECHAT}function _k(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function eh(){const t=zt();return t.name!==nn.EDGE&&t.name!==nn.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function Zb(){return zt().os===oi.ANDROID}function $A(){const t=zt();return"Android"===t.os&&("Chrome"===t.name||t.name===nn.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}var Ek={exports:{}},vk=ba.f;ei({target:"Object",stat:!0,forced:Object.defineProperty!==vk,sham:!ve},{defineProperty:vk});var Ck=cc.Object,Q6=Ek.exports=function(t,i,o){return Ck.defineProperty(t,i,o)};Ck.defineProperty.sham&&(Q6.sham=!0);var yk=Ek.exports;function b(t,i,o){return i in t?yk(t,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[i]=o,t}var eT,tT={exports:{}},Ik=function(t,i){return function(){for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];return t.apply(i,o)}},G6=Ik,nT=Object.prototype.toString,C1=(eT=Object.create(null),function(t){var i=nT.call(t);return eT[i]||(eT[i]=i.slice(8,-1).toLowerCase())});function th(t){return t=t.toLowerCase(),function(i){return C1(i)===t}}function rT(t){return Array.isArray(t)}function y1(t){return void 0===t}var I1=th("ArrayBuffer");function S1(t){return null!==t&&"object"==typeof t}function b1(t){if("object"!==C1(t))return!1;var i=Object.getPrototypeOf(t);return null===i||i===Object.prototype}var CK=th("Date"),vs=th("File"),Sk=th("Blob"),H6=th("FileList");function iT(t){return"[object Function]"===nT.call(t)}var W6=th("URLSearchParams");function oT(t,i){if(null!=t)if("object"!=typeof t&&(t=[t]),rT(t))for(var o=0,s=t.length;o<s;o++)i.call(null,t[o],o,t);else for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&i.call(null,t[c],c,t)}var yK=function(t){return function(i){return t&&i instanceof t}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array)),ho={isArray:rT,isArrayBuffer:I1,isBuffer:function(t){return null!==t&&!y1(t)&&null!==t.constructor&&!y1(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){var i="[object FormData]";return t&&("function"==typeof FormData&&t instanceof FormData||nT.call(t)===i||iT(t.toString)&&t.toString()===i)},isArrayBufferView:function(t){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&I1(t.buffer)},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:S1,isPlainObject:b1,isUndefined:y1,isDate:CK,isFile:vs,isBlob:Sk,isFunction:iT,isStream:function(t){return S1(t)&&iT(t.pipe)},isURLSearchParams:W6,isStandardBrowserEnv:function(){return(typeof navigator>"u"||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&typeof window<"u"&&typeof document<"u"},forEach:oT,merge:function t(){var i={};function o(l,p){i[p]=b1(i[p])&&b1(l)?t(i[p],l):b1(l)?t({},l):rT(l)?l.slice():l}for(var s=0,c=arguments.length;s<c;s++)oT(arguments[s],o);return i},extend:function(t,i,o){return oT(i,function(s,c){t[c]=o&&"function"==typeof s?G6(s,o):s}),t},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t},inherits:function(t,i,o,s){t.prototype=Object.create(i.prototype,s),t.prototype.constructor=t,o&&Object.assign(t.prototype,o)},toFlatObject:function(t,i,o){var s,c,l,p={};i=i||{};do{for(c=(s=Object.getOwnPropertyNames(t)).length;c-- >0;)p[l=s[c]]||(i[l]=t[l],p[l]=!0);t=Object.getPrototypeOf(t)}while(t&&(!o||o(t,i))&&t!==Object.prototype);return i},kindOf:C1,kindOfTest:th,endsWith:function(t,i,o){t=String(t),(void 0===o||o>t.length)&&(o=t.length);var s=t.indexOf(i,o-=i.length);return-1!==s&&s===o},toArray:function(t){if(!t)return null;var i=t.length;if(y1(i))return null;for(var o=new Array(i);i-- >0;)o[i]=t[i];return o},isTypedArray:yK,isFileList:H6},XA=ho;function K6(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var bk=function(t,i,o){if(!i)return t;var s;if(o)s=o(i);else if(XA.isURLSearchParams(i))s=i.toString();else{var c=[];XA.forEach(i,function(p,h){null!=p&&(XA.isArray(p)?h+="[]":p=[p],XA.forEach(p,function(g){XA.isDate(g)?g=g.toISOString():XA.isObject(g)&&(g=JSON.stringify(g)),c.push(K6(h)+"="+K6(g))}))}),s=c.join("&")}if(s){var l=t.indexOf("#");-1!==l&&(t=t.slice(0,l)),t+=(-1===t.indexOf("?")?"?":"&")+s}return t},Y6=ho;function ZA(){this.handlers=[]}ZA.prototype.use=function(t,i,o){return this.handlers.push({fulfilled:t,rejected:i,synchronous:!!o&&o.synchronous,runWhen:o?o.runWhen:null}),this.handlers.length-1},ZA.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},ZA.prototype.forEach=function(t){Y6.forEach(this.handlers,function(i){null!==i&&t(i)})};var q6=ZA,IK=ho,sT=ho;function em(t,i,o,s,c){Error.call(this),this.message=t,this.name="AxiosError",i&&(this.code=i),o&&(this.config=o),s&&(this.request=s),c&&(this.response=c)}sT.inherits(em,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var $i=em.prototype,J6={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(t){J6[t]={value:t}}),Object.defineProperties(em,J6),Object.defineProperty($i,"isAxiosError",{value:!0}),em.from=function(t,i,o,s,c,l){var p=Object.create($i);return sT.toFlatObject(t,p,function(h){return h!==Error.prototype}),em.call(p,t.message,i,o,s,c),p.name=t.name,l&&Object.assign(p,l),p};var Tl=em,z6={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Fa=ho,Tk=function(t,i){i=i||new FormData;var o=[];function s(c){return null===c?"":Fa.isDate(c)?c.toISOString():Fa.isArrayBuffer(c)||Fa.isTypedArray(c)?"function"==typeof Blob?new Blob([c]):Buffer.from(c):c}return function c(l,p){if(Fa.isPlainObject(l)||Fa.isArray(l)){if(-1!==o.indexOf(l))throw Error("Circular reference detected in "+p);o.push(l),Fa.forEach(l,function(h,g){if(!Fa.isUndefined(h)){var f,A=p?p+"."+g:g;if(h&&!p&&"object"==typeof h)if(Fa.endsWith(g,"{}"))h=JSON.stringify(h);else if(Fa.endsWith(g,"[]")&&(f=Fa.toArray(h)))return void f.forEach(function(_){!Fa.isUndefined(_)&&i.append(A,s(_))});c(h,A)}}),o.pop()}else i.append(p,s(l))}(t),i},aT=Tl,cT=ho,SK=cT.isStandardBrowserEnv()?{write:function(t,i,o,s,c,l){var p=[];p.push(t+"="+encodeURIComponent(i)),cT.isNumber(o)&&p.push("expires="+new Date(o).toGMTString()),cT.isString(s)&&p.push("path="+s),cT.isString(c)&&p.push("domain="+c),!0===l&&p.push("secure"),document.cookie=p.join("; ")},read:function(t){var i=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},Rk=function(t,i){return t&&!function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}(i)?function(t,i){return i?t.replace(/\/+$/,"")+"/"+i.replace(/^\/+/,""):t}(t,i):i},uT=ho,T1=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],Dk=ho,X6=Dk.isStandardBrowserEnv()?function(){var t,i=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");function s(c){var l=c;return i&&(o.setAttribute("href",l),l=o.href),o.setAttribute("href",l),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}return t=s(window.location.href),function(c){var l=Dk.isString(c)?s(c):c;return l.protocol===t.protocol&&l.host===t.host}}():function(){return!0},wk=Tl;function Nk(t){wk.call(this,t??"canceled",wk.ERR_CANCELED),this.name="CanceledError"}ho.inherits(Nk,wk,{__CANCEL__:!0});var lT=Nk,tm=ho,Z6=SK,RK=bk,ej=Rk,wK=X6,Ok=z6,wu=Tl,tj=lT,wi=ho,hT=function(t,i){IK.forEach(t,function(o,s){s!==i&&s.toUpperCase()===i.toUpperCase()&&(t[i]=o,delete t[s])})},nj=Tl,NK=Tk,OK={"Content-Type":"application/x-www-form-urlencoded"};function rj(t,i){!wi.isUndefined(t)&&wi.isUndefined(t["Content-Type"])&&(t["Content-Type"]=i)}var ij,pT={transitional:z6,adapter:((typeof XMLHttpRequest<"u"||typeof process<"u"&&"[object process]"===Object.prototype.toString.call(process))&&(ij=function(t){return new Promise(function(i,o){var s,c=t.data,l=t.headers,p=t.responseType;function h(){t.cancelToken&&t.cancelToken.unsubscribe(s),t.signal&&t.signal.removeEventListener("abort",s)}tm.isFormData(c)&&tm.isStandardBrowserEnv()&&delete l["Content-Type"];var g=new XMLHttpRequest;if(t.auth){var f=t.auth.username||"",A=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";l.Authorization="Basic "+btoa(f+":"+A)}var _=ej(t.baseURL,t.url);function v(){if(g){var R="getAllResponseHeaders"in g?function(t){var i,o,s,c={};return t&&uT.forEach(t.split("\n"),function(l){if(s=l.indexOf(":"),i=uT.trim(l.substr(0,s)).toLowerCase(),o=uT.trim(l.substr(s+1)),i){if(c[i]&&T1.indexOf(i)>=0)return;c[i]="set-cookie"===i?(c[i]?c[i]:[]).concat([o]):c[i]?c[i]+", "+o:o}}),c}(g.getAllResponseHeaders()):null;(function(t,i,o){var s=o.config.validateStatus;o.status&&s&&!s(o.status)?i(new aT("Request failed with status code "+o.status,[aT.ERR_BAD_REQUEST,aT.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o)):t(o)})(function(O){i(O),h()},function(O){o(O),h()},{data:p&&"text"!==p&&"json"!==p?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:R,config:t,request:g}),g=null}}if(g.open(t.method.toUpperCase(),RK(_,t.params,t.paramsSerializer),!0),g.timeout=t.timeout,"onloadend"in g?g.onloadend=v:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(v)},g.onabort=function(){g&&(o(new wu("Request aborted",wu.ECONNABORTED,t,g)),g=null)},g.onerror=function(){o(new wu("Network Error",wu.ERR_NETWORK,t,g,g)),g=null},g.ontimeout=function(){var R=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";t.timeoutErrorMessage&&(R=t.timeoutErrorMessage),o(new wu(R,(t.transitional||Ok).clarifyTimeoutError?wu.ETIMEDOUT:wu.ECONNABORTED,t,g)),g=null},tm.isStandardBrowserEnv()){var y=(t.withCredentials||wK(_))&&t.xsrfCookieName?Z6.read(t.xsrfCookieName):void 0;y&&(l[t.xsrfHeaderName]=y)}"setRequestHeader"in g&&tm.forEach(l,function(R,D){void 0===c&&"content-type"===D.toLowerCase()?delete l[D]:g.setRequestHeader(D,R)}),tm.isUndefined(t.withCredentials)||(g.withCredentials=!!t.withCredentials),p&&"json"!==p&&(g.responseType=t.responseType),"function"==typeof t.onDownloadProgress&&g.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&g.upload&&g.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(s=function(R){g&&(o(!R||R&&R.type?new tj:R),g.abort(),g=null)},t.cancelToken&&t.cancelToken.subscribe(s),t.signal&&(t.signal.aborted?s():t.signal.addEventListener("abort",s))),c||(c=null);var S=function(t){var i=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return i&&i[1]||""}(_);S&&-1===["http","https","file"].indexOf(S)?o(new wu("Unsupported protocol "+S+":",wu.ERR_BAD_REQUEST,t)):g.send(c)})}),ij),transformRequest:[function(t,i){if(hT(i,"Accept"),hT(i,"Content-Type"),wi.isFormData(t)||wi.isArrayBuffer(t)||wi.isBuffer(t)||wi.isStream(t)||wi.isFile(t)||wi.isBlob(t))return t;if(wi.isArrayBufferView(t))return t.buffer;if(wi.isURLSearchParams(t))return rj(i,"application/x-www-form-urlencoded;charset=utf-8"),t.toString();var o,s=wi.isObject(t),c=i&&i["Content-Type"];if((o=wi.isFileList(t))||s&&"multipart/form-data"===c){var l=this.env&&this.env.FormData;return NK(o?{"files[]":t}:t,l&&new l)}return s||"application/json"===c?(rj(i,"application/json"),function(p,h,g){if(wi.isString(p))try{return(0,JSON.parse)(p),wi.trim(p)}catch(f){if("SyntaxError"!==f.name)throw f}return(0,JSON.stringify)(p)}(t)):t}],transformResponse:[function(t){var i=this.transitional||pT.transitional,c=!(i&&i.silentJSONParsing)&&"json"===this.responseType;if(c||i&&i.forcedJSONParsing&&wi.isString(t)&&t.length)try{return JSON.parse(t)}catch(l){if(c)throw"SyntaxError"===l.name?nj.from(l,nj.ERR_BAD_RESPONSE,this,null,this.response):l}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:null},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};wi.forEach(["delete","get","head"],function(t){pT.headers[t]={}}),wi.forEach(["post","put","patch"],function(t){pT.headers[t]=wi.merge(OK)});var Pk=pT,oj=ho,PK=Pk,Mk=function(t){return!(!t||!t.__CANCEL__)},kk=ho,Lk=function(t,i,o){var s=this||PK;return oj.forEach(o,function(c){t=c.call(s,t,i)}),t},MK=Mk,kK=Pk,LK=lT;function xk(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new LK}var Cs=ho,R1=function(t,i){i=i||{};var o={};function s(f,A){return Cs.isPlainObject(f)&&Cs.isPlainObject(A)?Cs.merge(f,A):Cs.isPlainObject(A)?Cs.merge({},A):Cs.isArray(A)?A.slice():A}function c(f){return Cs.isUndefined(i[f])?Cs.isUndefined(t[f])?void 0:s(void 0,t[f]):s(t[f],i[f])}function l(f){if(!Cs.isUndefined(i[f]))return s(void 0,i[f])}function p(f){return Cs.isUndefined(i[f])?Cs.isUndefined(t[f])?void 0:s(void 0,t[f]):s(void 0,i[f])}function h(f){return f in i?s(t[f],i[f]):f in t?s(void 0,t[f]):void 0}var g={url:l,method:l,data:l,baseURL:p,transformRequest:p,transformResponse:p,paramsSerializer:p,timeout:p,timeoutMessage:p,withCredentials:p,adapter:p,responseType:p,xsrfCookieName:p,xsrfHeaderName:p,onUploadProgress:p,onDownloadProgress:p,decompress:p,maxContentLength:p,maxBodyLength:p,beforeRedirect:p,transport:p,httpAgent:p,httpsAgent:p,cancelToken:p,socketPath:p,responseEncoding:p,validateStatus:h};return Cs.forEach(Object.keys(t).concat(Object.keys(i)),function(f){var A=g[f]||c,_=A(f);Cs.isUndefined(_)&&A!==h||(o[f]=_)}),o},Ua=Tl,fT={};["object","boolean","number","function","string","symbol"].forEach(function(t,i){fT[t]=function(o){return typeof o===t||"a"+(i<1?"n ":" ")+t}});var gT={};fT.transitional=function(t,i,o){function s(c,l){return"[Axios v0.27.2] Transitional option '"+c+"'"+l+(o?". "+o:"")}return function(c,l,p){if(!1===t)throw new Ua(s(l," has been removed"+(i?" in "+i:"")),Ua.ERR_DEPRECATED);return i&&!gT[l]&&(gT[l]=!0,console.warn(s(l," has been deprecated since v"+i+" and will be removed in the near future"))),!t||t(c,l,p)}};var Bk=ho,aj=bk,Fk=q6,Uk=function(t){return xk(t),t.headers=t.headers||{},t.data=Lk.call(t,t.data,t.headers,t.transformRequest),t.headers=kk.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),kk.forEach(["delete","get","head","post","put","patch","common"],function(i){delete t.headers[i]}),(t.adapter||kK.adapter)(t).then(function(i){return xk(t),i.data=Lk.call(t,i.data,i.headers,t.transformResponse),i},function(i){return MK(i)||(xk(t),i&&i.response&&(i.response.data=Lk.call(t,i.response.data,i.response.headers,t.transformResponse))),Promise.reject(i)})},nh=R1,D1=Rk,AT={assertOptions:function(t,i,o){if("object"!=typeof t)throw new Ua("options must be an object",Ua.ERR_BAD_OPTION_VALUE);for(var s=Object.keys(t),c=s.length;c-- >0;){var l=s[c],p=i[l];if(p){var h=t[l],g=void 0===h||p(h,l,t);if(!0!==g)throw new Ua("option "+l+" must be "+g,Ua.ERR_BAD_OPTION_VALUE)}else if(!0!==o)throw new Ua("Unknown option "+l,Ua.ERR_BAD_OPTION)}},validators:fT},rh=AT.validators;function Sc(t){this.defaults=t,this.interceptors={request:new Fk,response:new Fk}}Sc.prototype.request=function(t,i){"string"==typeof t?(i=i||{}).url=t:i=t||{},i.method=(i=nh(this.defaults,i)).method?i.method.toLowerCase():this.defaults.method?this.defaults.method.toLowerCase():"get";var o=i.transitional;void 0!==o&&AT.assertOptions(o,{silentJSONParsing:rh.transitional(rh.boolean),forcedJSONParsing:rh.transitional(rh.boolean),clarifyTimeoutError:rh.transitional(rh.boolean)},!1);var s=[],c=!0;this.interceptors.request.forEach(function(_){"function"==typeof _.runWhen&&!1===_.runWhen(i)||(c=c&&_.synchronous,s.unshift(_.fulfilled,_.rejected))});var l,p=[];if(this.interceptors.response.forEach(function(_){p.push(_.fulfilled,_.rejected)}),!c){var h=[Uk,void 0];for(Array.prototype.unshift.apply(h,s),h=h.concat(p),l=Promise.resolve(i);h.length;)l=l.then(h.shift(),h.shift());return l}for(var g=i;s.length;){var f=s.shift(),A=s.shift();try{g=f(g)}catch(_){A(_);break}}try{l=Uk(g)}catch(_){return Promise.reject(_)}for(;p.length;)l=l.then(p.shift(),p.shift());return l},Sc.prototype.getUri=function(t){t=nh(this.defaults,t);var i=D1(t.baseURL,t.url);return aj(i,t.params,t.paramsSerializer)},Bk.forEach(["delete","get","head","options"],function(t){Sc.prototype[t]=function(i,o){return this.request(nh(o||{},{method:t,url:i,data:(o||{}).data}))}}),Bk.forEach(["post","put","patch"],function(t){function i(o){return function(s,c,l){return this.request(nh(l||{},{method:t,headers:o?{"Content-Type":"multipart/form-data"}:{},url:s,data:c}))}}Sc.prototype[t]=i(),Sc.prototype[t+"Form"]=i(!0)});var Vk=Sc,mT=lT;function Rl(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var i;this.promise=new Promise(function(s){i=s});var o=this;this.promise.then(function(s){if(o._listeners){var c,l=o._listeners.length;for(c=0;c<l;c++)o._listeners[c](s);o._listeners=null}}),this.promise.then=function(s){var c,l=new Promise(function(p){o.subscribe(p),c=p}).then(s);return l.cancel=function(){o.unsubscribe(c)},l},t(function(s){o.reason||(o.reason=new mT(s),i(o.reason))})}Rl.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},Rl.prototype.subscribe=function(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]},Rl.prototype.unsubscribe=function(t){if(this._listeners){var i=this._listeners.indexOf(t);-1!==i&&this._listeners.splice(i,1)}},Rl.source=function(){var t;return{token:new Rl(function(i){t=i}),cancel:t}};var jk=Rl,Qk=ho,Gk=ho,cj=Ik,w1=Vk,uj=R1,Xi=function t(i){var o=new w1(i),s=cj(w1.prototype.request,o);return Gk.extend(s,w1.prototype,o),Gk.extend(s,o),s.create=function(c){return t(uj(i,c))},s}(Pk);Xi.Axios=w1,Xi.CanceledError=lT,Xi.CancelToken=jk,Xi.isCancel=Mk,Xi.VERSION="0.27.2",Xi.toFormData=Tk,Xi.AxiosError=Tl,Xi.Cancel=Xi.CanceledError,Xi.all=function(t){return Promise.all(t)},Xi.spread=function(t){return function(i){return t.apply(null,i)}},Xi.isAxiosError=function(t){return Qk.isObject(t)&&!0===t.isAxiosError},tT.exports=Xi,tT.exports.default=Xi;var es=tT.exports;class xK{constructor(i){b(this,"logger",void 0),b(this,"prefixLists",[]),this.logger=i}debug(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.logger.debug(...this.prefixLists,...o)}info(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.logger.info(...this.prefixLists,...o)}warning(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.logger.warning(...this.prefixLists,...o)}error(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];this.logger.error(...this.prefixLists,...o)}prefix(i){return this.prefixLists.push(i),this}popPrefix(){return this.prefixLists.pop(),this}}class En{constructor(){b(this,"_events",{}),b(this,"addListener",this.on)}getListeners(i){return this._events[i]?this._events[i].map(o=>o.listener):[]}on(i,o){this._events[i]||(this._events[i]=[]);const s=this._events[i];-1===this._indexOfListener(s,o)&&s.push({listener:o,once:!1})}once(i,o){this._events[i]||(this._events[i]=[]);const s=this._events[i];-1===this._indexOfListener(s,o)&&s.push({listener:o,once:!0})}off(i,o){if(!this._events[i])return;const s=this._events[i],c=this._indexOfListener(s,o);-1!==c&&s.splice(c,1),0===this._events[i].length&&delete this._events[i]}removeAllListeners(i){i?delete this._events[i]:this._events={}}emit(i){this._events[i]||(this._events[i]=[]);const o=this._events[i].map(p=>p);for(var s=arguments.length,c=new Array(s>1?s-1:0),l=1;l<s;l++)c[l-1]=arguments[l];for(let p=0;p<o.length;p+=1){const h=o[p];h.once&&this.off(i,h.listener),h.listener.apply(this,c||[])}}_indexOfListener(i,o){let s=i.length;for(;s--;)if(i[s].listener===o)return s;return-1}}const Xp=new class extends En{reportLogUploadError(t){this.emit("REPORT_LOG_UPLOAD",t)}};let L;!function(t){t.UNEXPECTED_ERROR="UNEXPECTED_ERROR",t.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",t.TIMEOUT="TIMEOUT",t.INVALID_PARAMS="INVALID_PARAMS",t.NOT_READABLE="NOT_READABLE",t.NOT_SUPPORTED="NOT_SUPPORTED",t.INVALID_OPERATION="INVALID_OPERATION",t.OPERATION_ABORTED="OPERATION_ABORTED",t.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",t.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",t.NETWORK_ERROR="NETWORK_ERROR",t.NETWORK_TIMEOUT="NETWORK_TIMEOUT",t.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",t.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",t.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",t.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",t.ELECTRON_IS_NULL="ELECTRON_IS_NULL",t.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",t.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",t.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",t.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",t.PERMISSION_DENIED="PERMISSION_DENIED",t.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",t.TRACK_IS_DISABLED="TRACK_IS_DISABLED",t.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",t.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",t.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",t.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",t.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",t.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",t.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",t.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",t.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",t.UID_CONFLICT="UID_CONFLICT",t.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",t.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",t.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",t.INVALID_TRACK="INVALID_TRACK",t.SENDER_NOT_FOUND="SENDER_NOT_FOUND",t.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",t.SET_ANSWER_FAILED="SET_ANSWER_FAILED",t.ICE_FAILED="ICE_FAILED",t.PC_CLOSED="PC_CLOSED",t.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",t.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",t.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",t.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",t.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",t.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",t.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",t.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",t.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",t.INVALID_REMOTE_USER="INVALID_REMOTE_USER",t.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",t.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",t.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",t.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",t.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",t.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",t.WS_ABORT="WS_ABORT",t.WS_DISCONNECT="WS_DISCONNECT",t.WS_ERR="WS_ERR",t.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",t.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",t.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",t.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",t.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",t.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",t.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",t.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",t.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",t.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",t.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",t.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",t.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",t.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",t.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",t.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",t.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",t.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",t.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",t.INVALID_PLUGIN="INVALID_PLUGIN",t.DISCONNECT_P2P="DISCONNECT_P2P",t.INIT_WEBSOCKET_TIMEOUT="INIT_WEBSOCKET_TIMEOUT",t.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",t.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",t.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",t.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT"}(L||(L={}));class V extends Error{constructor(i){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2?arguments[2]:void 0;super(o),b(this,"code",void 0),b(this,"message",void 0),b(this,"data",void 0),b(this,"name","AgoraRTCException"),this.code=i,this.message="AgoraRTCError ".concat(this.code,": ").concat(o),this.data=s}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),"\n").concat(this.stack):"".concat(this.stack)}print(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error";return"error"===i&&N.error(this.toString()),"warning"===i&&N.warning(this.toString()),this}throw(){throw this.print(),this}}const ur={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function _T(t,i){const o=Math.floor(i.timeout*Math.pow(i.timeoutFactor,t));return Math.min(i.maxRetryTimeout,o)}function Va(t,i,o,s){const c=Object.assign({},ur,s);let l=c.timeout;const p=function(){var f=U(function*(){var A;yield(A=l,new Ie(_=>{window.setTimeout(_,A)})),l*=c.timeoutFactor,l=Math.min(c.maxRetryTimeout,l)});return function(){return f.apply(this,arguments)}}();let h=!1;const g=new Ie(function(){var f=U(function*(A,_){i=i||(()=>!1),o=o||(()=>!0);for(let v=0;v<c.maxRetryCount;v+=1){if(h)return _(new V(L.OPERATION_ABORTED));try{const y=yield t();if(!i(y,v)||v+1===c.maxRetryCount)return A(y);yield p()}catch(y){if(!o(y,v)||v+1===c.maxRetryCount)return _(y);yield p()}}});return function(A,_){return f.apply(this,arguments)}}());return g.cancel=()=>h=!0,g}function ET(){const t=new Date;return t.toTimeString().split(" ")[0]+":"+t.getMilliseconds()}function vT(){const t=new Date,i=/((\d+:){2}\d+)/.exec((new Date).toUTCString());return i?i?.[0]+":"+t.getUTCMilliseconds():t.toTimeString().split(" ")[0]+":"+t.getMilliseconds()}const ys={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},N1=Date.now(),rm=t=>{for(const i in ys)if(Object.prototype.hasOwnProperty.call(ys,i)&&ys[i]===t)return i;return"DEFAULT"},N=new class{constructor(){b(this,"proxyServerURL",void 0),b(this,"logLevel",ys.DEBUG),b(this,"uploadState","collecting"),b(this,"uploadLogWaitingList",[]),b(this,"uploadLogUploadingList",[]),b(this,"uploadErrorCount",0),b(this,"currentLogID",0),b(this,"url",void 0),b(this,"extLog",(t,i)=>{this.appendLogToWaitingList(t,...i)})}debug(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];const s=[ys.DEBUG].concat(i);this.log.apply(this,s)}info(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];const s=[ys.INFO].concat(i);this.log.apply(this,s)}warning(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];const s=[ys.WARNING].concat(i);this.log.apply(this,s)}error(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];const s=[ys.ERROR].concat(i);this.log.apply(this,s)}upload(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];const s=[ys.DEBUG].concat(i);this.uploadLog.apply(this,s)}setLogLevel(t){t=Math.min(Math.max(0,t),4),this.logLevel=t}enableLogUpload(){hn("UPLOAD_LOG",!0)}disableLogUpload(){hn("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(t){this.proxyServerURL=t}prefix(t){return new xK(this).prefix(t)}log(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];if(Date.now()-N1<100)return void setTimeout(()=>{this.log(...i)},Date.now()-N1);const s=Math.max(0,Math.min(4,i[0]));if(i[0]=ET()+" Agora-SDK [".concat(rm(s),"]:"),this.appendLogToWaitingList(s,...i),s<this.logLevel)return;const c=ET()+" %cAgora-SDK [".concat(rm(s),"]:");let l=[];if(!J("USE_NEW_LOG"))switch(s){case ys.DEBUG:l=[c,"color: #64B5F6;"].concat(i.slice(1)),console.log.apply(console,l);break;case ys.INFO:l=[c,"color: #1E88E5; font-weight: bold;"].concat(i.slice(1)),console.log.apply(console,l);break;case ys.WARNING:l=[c,"color: #FB8C00; font-weight: bold;"].concat(i.slice(1)),console.warn.apply(console,l);break;case ys.ERROR:l=[c,"color: #B00020; font-weight: bold;"].concat(i.slice(1)),console.error.apply(console,l)}}uploadLog(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];if(Date.now()-N1<100)return void setTimeout(()=>{this.uploadLog(...i)},Date.now()-N1);const s=Math.max(0,Math.min(4,i[0]));i[0]=ET()+" Agora-SDK [".concat(rm(s),"]:"),this.appendLogToWaitingList(s,...i)}appendLogToWaitingList(t){if(!J("UPLOAD_LOG"))return;for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];Array.isArray(o[0])?o[0][0]=vT()+" Agora-SDK [".concat(rm(t),"]:"):o[0]=vT()+" Agora-SDK [".concat(rm(t),"]:");let c="";o.forEach(l=>{"object"==typeof l&&(l=JSON.stringify(l)),c+="".concat(l," ")}),this.uploadLogWaitingList.push({payload_str:c,log_level:t,log_item_id:this.currentLogID++}),"uploading"===this.uploadState&&0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}uploadLogs(){var t=this;return U(function*(){const i=t.uploadLogUploadingList,o={sdk_version:po,process_id:J("PROCESS_ID"),payload:JSON.stringify(i)};return Va(U(function*(){const s=yield es.post(t.url||(t.proxyServerURL?"https://".concat(t.proxyServerURL,"/ls/?h=").concat(J("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(J("LOG_UPLOAD_SERVER"),"/upload/v1")),o,{responseType:"text"});if("OK"!==s.data){const c=new Error("unexpected upload log response");throw c.response=s,c}}),()=>(t.uploadLogUploadingList=[],!1),s=>(Xp.reportLogUploadError(s.response?{status:s.response.status,data:s.response.data,headers:s.response.headers,message:s.message}:s.request?{status:s.request.status,message:s.message}:{status:-1,message:s.message}),!0),{timeout:J("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:J("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})})()}uploadLogInterval(){0===this.uploadLogUploadingList.length&&0===this.uploadLogWaitingList.length||(0===this.uploadLogUploadingList.length&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,J("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),J("UPLOAD_LOG_INTERVAL"))}).catch(t=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),J("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),J("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}},CT={debug:console.log,info:console.log,warning:console.warn,error:console.error},yT={debug:"color: #64B5F6;",info:"color: #1E88E5; font-weight: bold;",warning:"color: #FB8C00; font-weight: bold;",error:"color: #B00020; font-weight: bold;"},Hk={debug:0,info:1,warning:2,error:3},IT=[];let ST,Wk=0,Kk=0,bT=!1;function O1(){const t=new Date;return[t.getTime(),t.toTimeString().split(" ")[0]+":"+t.getMilliseconds()]}function im(t){if(!J("UPLOAD_LOG"))return;let i;switch(t.type){case dn.MISC:i=[t.timestamp,t.level,t.type,t.module,t.instanceId,[t.msg]];break;case dn.INTERNAL_EVENT:case dn.PUBLIC_EVENT:case dn.WEB_EVENT:i=[t.timestamp,t.level,t.type,t.module,t.instanceId,[t.event,t.msg]];break;case dn.INTERNAL_API:case dn.PUBLIC_API:case dn.WEB_API:i=[t.timestamp,t.level,t.type,t.module,t.instanceId,[t.api,t.args,t.result]]}IT.push(i)}function TT(t,i){const[o,s]=O1(),c="warning",l="".concat(s," %cAgora-SDK [").concat(c,"] [INTERNAL API]:"),p={[dn.WEB_API]:"logWebAPI",[dn.PUBLIC_API]:"logPublicAPI",[dn.INTERNAL_API]:"logInternalAPI",[dn.WEB_EVENT]:"logWebEvent",[dn.PUBLIC_EVENT]:"logPublicEvent",[dn.INTERNAL_EVENT]:"logInternalEvent",[dn.MISC]:"logMisc"}[t],h=[l,yT.warning,"Log.".concat(p),i];J("USE_NEW_LOG")&&(M1(c)&&CT.warning.apply(console,h),im({timestamp:o,level:c,module:"Log",instanceId:void 0,type:dn.INTERNAL_API,api:p,args:void 0,result:i.toString()}))}function P1(t){if(Array.isArray(t)){let[s,c]=t;return s||(s="Global"),{module:s,instanceId:c}}let i,o;if("string"!=typeof t.__moduleName)throw new Error("Cannot get __moduleName from log instance.");i=t.__moduleName;try{o=t.__instanceId}catch{throw new Error("Cannot get __instanceId from log instance.")}return{module:i,instanceId:o}}function M1(t){return Hk[t]>=Kk}function Yk(t,i,o,s,c,l){if(t===dn.PUBLIC_API||t===dn.WEB_API||t===dn.INTERNAL_API)try{const{module:p,instanceId:h}=P1(o);c=c&&JSON.stringify(c),l=l instanceof Error?l.toString():l&&JSON.stringify(l);const[g,f]=O1(),A=["".concat(f," %cAgora-SDK [").concat(i,"] [").concat({[dn.PUBLIC_API]:"PUBLIC API",[dn.WEB_API]:"WEB API",[dn.INTERNAL_API]:"INTERNAL API"}[t],"]:"),yT[i],"".concat(p).concat(h?"<".concat(h,">"):"",".").concat(s),c,l];J("USE_NEW_LOG")&&(M1(i)&&CT[i].apply(console,A),im({timestamp:g,level:i,module:p,instanceId:h,type:t,api:s,args:c,result:l}))}catch(p){TT(t,p)}}function RT(t,i,o,s,c){if(t===dn.WEB_EVENT||t===dn.INTERNAL_EVENT||t===dn.PUBLIC_EVENT)try{const{module:l,instanceId:p}=P1(o);"string"!=typeof c&&(c=c instanceof Error?c.toString():JSON.stringify(c));const[h,g]=O1(),f=["".concat(g," %cAgora-SDK [").concat(i,"] [").concat({[dn.WEB_EVENT]:"WEB EVENT",[dn.PUBLIC_EVENT]:"PUBLIC EVENT",[dn.INTERNAL_EVENT]:"INTERNAL EVENT"}[t],"]:"),yT[i],"".concat(l).concat(p?"<".concat(p,">"):"",".on(").concat(s,")"),c||""];J("USE_NEW_LOG")&&(M1(i)&&CT[i].apply(console,f),im({timestamp:h,level:i,module:l,instanceId:p,type:t,event:s,msg:c}))}catch(l){TT(t,l)}}function k1(t){ST=t}function Re(t,i,o){try{const{module:s,instanceId:c}=P1(i),[l,p]=O1(),h=["".concat(p," %cAgora-SDK [").concat(t,"] [MISC]:"),yT[t],"".concat(s).concat(c?"<".concat(c,">"):""),'"'.concat(o,'"')];J("USE_NEW_LOG")&&(M1(t)&&CT[t].apply(console,h),im({timestamp:l,level:t,module:s,instanceId:c,type:dn.MISC,msg:o}))}catch(s){le("warning",["log"],"logMisc",void 0,s)}}function vn(t,i,o,s){RT(dn.INTERNAL_EVENT,t,i,o,s)}function Is(t,i,o,s){RT(dn.PUBLIC_EVENT,t,i,o,s)}function Po(t,i,o,s){RT(dn.WEB_EVENT,t,i,o,s)}function le(t,i,o,s,c){Yk(dn.INTERNAL_API,t,i,o,s,c)}function om(t,i,o,s,c){Yk(dn.WEB_API,t,i,o,s,c)}function Ke(t,i,o,s,c){Yk(dn.PUBLIC_API,t,i,o,s,c)}function kn(t,i){return function(o){return class extends o{get __moduleName(){return t}get __instanceId(){if(i){if("function"==typeof this[i])return this[i]();{const s=i.split(".");return s.length>0?hc(s).call(s,(c,l)=>{try{return c&&c[l]}catch{return}},this):this[i]}}}}}}function L1(t){return DT.apply(this,arguments)}function DT(){return DT=U(function*(t){if(!t&&bT)return;if(bT=!0,!J("UPLOAD_LOG"))return void setTimeout(()=>L1(!0),J("UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF"));if(0===IT.length)return void setTimeout(()=>L1(!0),J("UPLOAD_LOG_INTERVAL"));const i=IT.slice(0,J("UPLOAD_LOG_LENGTH_EACH_TIME")),o={sdk_version:po,log_version:J("LOG_VERSION"),process_id:J("PROCESS_ID"),index:Wk,logs:JSON.stringify(i)};yield Va(U(function*(){const s=yield es.post(ST?"https://".concat(ST,"/ls/?h=").concat(J("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(J("LOG_UPLOAD_SERVER"),"/upload/v1"),o,{responseType:"text"});if("OK"!==s.data)throw new Error("Log service response error ".concat(s.data));return s}),void 0,void 0,{timeout:J("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:J("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")}),IT.splice(0,J("UPLOAD_LOG_LENGTH_EACH_TIME")),Wk+=i.length,setTimeout(()=>L1(!0),J("UPLOAD_LOG_INTERVAL"))}),DT.apply(this,arguments)}const Zp="v4.15.1-0-g31e59714-dirty(12/2/2022, 5:43:26 PM)",po=function(t){if(t.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return t;const i=t.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(i&&i[1]&&i[2]){const c=i[2];return"".concat(i[1],".").concat(c)}const o=t.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(o&&o[1]&&o[2]){const c=o[2];return"".concat(o[1],".").concat(100*(Number(c)+1))}return"4.0.0.999"}("4.15.1"),qk=function(){try{return!0===JSON.parse("true")}catch{return!0}}(),Ss=function(){const t="us".concat("erna","me"),i="pa".concat("sswo","rd"),o=["t","s","t"];o.splice(1,0,"e");const s=o.join(""),c=[];for(let h=0;h<6;h++)c.push("1");const l=c.join(""),p={};return p[t]=s,p[i]=l,Object.assign(p,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=Ss;const BK={"90p":wt(160,90),"90p_1":wt(160,90),"120p":wt(160,120,15,30,65),"120p_1":wt(160,120,15,30,65),"120p_3":wt(120,120,15,30,50),"120p_4":wt(212,120),"180p":wt(320,180,15,30,140),"180p_1":wt(320,180,15,30,140),"180p_3":wt(180,180,15,30,100),"180p_4":wt(240,180,15,30,120),"240p":wt(320,240,15,40,200),"240p_1":wt(320,240,15,40,200),"240p_3":wt(240,240,15,40,140),"240p_4":wt(424,240,15,40,220),"360p":wt(640,360,15,80,400),"360p_1":wt(640,360,15,80,400),"360p_3":wt(360,360,15,80,260),"360p_4":wt(640,360,30,80,600),"360p_6":wt(360,360,30,80,400),"360p_7":wt(480,360,15,80,320),"360p_8":wt(480,360,30,80,490),"360p_9":wt(640,360,15,80,800),"360p_10":wt(640,360,24,80,800),"360p_11":wt(640,360,24,80,1e3),"480p":wt(640,480,15,100,500),"480p_1":wt(640,480,15,100,500),"480p_2":wt(640,480,30,100,1e3),"480p_3":wt(480,480,15,100,400),"480p_4":wt(640,480,30,100,750),"480p_6":wt(480,480,30,100,600),"480p_8":wt(848,480,15,100,610),"480p_9":wt(848,480,30,100,930),"480p_10":wt(640,480,10,100,400),"720p":wt(1280,720,15,120,1130),"720p_1":wt(1280,720,15,120,1130),"720p_2":wt(1280,720,30,120,2e3),"720p_3":wt(1280,720,30,120,1710),"720p_5":wt(960,720,15,120,910),"720p_6":wt(960,720,30,120,1380),"1080p":wt(1920,1080,15,120,2080),"1080p_1":wt(1920,1080,15,120,2080),"1080p_2":wt(1920,1080,30,120,3e3),"1080p_3":wt(1920,1080,30,120,3150),"1080p_5":wt(1920,1080,60,120,4780),"1440p":wt(2560,1440,30,120,4850),"1440p_1":wt(2560,1440,30,120,4850),"1440p_2":wt(2560,1440,60,120,7350),"4k":wt(3840,2160,30,120,8910),"4k_1":wt(3840,2160,30,120,8910),"4k_3":wt(3840,2160,60,120,13500)},lj={"480p":ja(640,480,5),"480p_1":ja(640,480,5),"480p_2":ja(640,480,30),"480p_3":ja(640,480,15),"720p":ja(1280,720,5),"720p_1":ja(1280,720,5),"720p_2":ja(1280,720,30),"720p_3":ja(1280,720,15),"1080p":ja(1920,1080,5),"1080p_1":ja(1920,1080,5),"1080p_2":ja(1920,1080,30),"1080p_3":ja(1920,1080,15)},FK={"1SL1TL":$k(1,1),"3SL3TL":$k(3,3),"2SL3TL":$k(2,3)};function sm(t){return"string"==typeof t?Object.assign({},BK[t]):t}function Jk(t){return"string"==typeof t?Object.assign({},lj[t]):t}function wT(t){return"string"==typeof t?Object.assign({},FK[t]):t}const UK={speech_low_quality:am(16e3,!1),speech_standard:am(32e3,!1,18),music_standard:am(48e3,!1),standard_stereo:am(48e3,!0,56),high_quality:am(48e3,!1,128),high_quality_stereo:am(48e3,!0,192)};function x1(t){return"string"==typeof t?Object.assign({},UK[t]):t}function hn(t,i,o){Object.keys(Mo).includes(t)&&(!o&&Object.keys(zk).includes(t)||(Mo[t]=i))}function J(t){return Mo[t]}const Mo={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",ENABLE_EVENT_REPORT:!0,GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TCC:!0,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_RTX:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_WITH_FALLBACK_PROXY_PENDING_DURATION:2e3,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!0,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,ENABLE_USER_LICENSE_CHECK:!0,SIGNAL_CHANNEL:0,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!0,FINGERPRINT:null,DC_JOIN_WITH_FAILBACK:5e3,DISABLE_WEBAUDIO:!1,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,SPATIALIZER_PARAMETERS:{}},zk={};function am(t,i,o){return{sampleRate:t,stereo:i,bitrate:o}}function wt(t,i,o,s,c){return{width:t,height:i,frameRate:o,bitrateMin:s,bitrateMax:c}}function ja(t,i,o,s,c){return{width:{max:t},height:{max:i},frameRate:o,bitrateMin:s,bitrateMax:c}}function $k(t,i){return{numSpatialLayers:t,numTemporalLayers:i}}qk||(Mo.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],Mo.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],Mo.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],Mo.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],Mo.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],Mo.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],Mo.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",Mo.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",Mo.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",Mo.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",Mo.AREAS=["NORTH_AMERICA","OVERSEA"]);const dj=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],cm=[],ct=[];var ji=au,B1=ba,hj=Ad,F1=function(t,i,o){var s=ji(i);s in t?B1.f(t,s,hj(0,o)):t[s]=o},Xk=DI,pj=dc,Zk=F1,fj=Dt.Array,gj=Math.max,NT=function(t,i,o){for(var s=pj(t),c=Xk(i,s),l=Xk(void 0===o?s:o,s),p=fj(gj(l-c,0)),h=0;c<l;c++,h++)Zk(p,h,t[c]);return p.length=h,p},U1=NT,eL=Math.floor,ef=function(t,i){var o=t.length,s=eL(o/2);return o<8?Aj(t,i):tL(t,ef(U1(t,0,s),i),ef(U1(t,s),i),i)},Aj=function(t,i){for(var o,s,c=t.length,l=1;l<c;){for(s=l,o=t[l];s&&i(t[s-1],o)>0;)t[s]=t[--s];s!==l++&&(t[s]=o)}return t},tL=function(t,i,o,s){for(var c=i.length,l=o.length,p=0,h=0;p<c||h<l;)t[p+h]=p<c&&h<l?s(i[p],o[h])<=0?i[p++]:o[h++]:p<c?i[p++]:o[h++];return t},nL=ef,tf=iu.match(/firefox\/(\d+)/i),rL=!!tf&&+tf[1],um=/MSIE|Trident/.test(iu),V1=iu.match(/AppleWebKit\/(\d+)\./),ta=ei,Ni=nr,j1=Sa,mi=su,Q1=dc,OT=Md,PT=Cr,Dl=nL,wl=il,_i=rL,Nl=um,oL=qh,MT=!!V1&&+V1[1],bc=[],kT=Ni(bc.sort),mj=Ni(bc.push),sL=PT(function(){bc.sort(void 0)}),LT=PT(function(){bc.sort(null)}),rn=wl("sort"),nf=!PT(function(){if(oL)return oL<70;if(!(_i&&_i>3)){if(Nl)return!0;if(MT)return MT<603;var t,i,o,s,c="";for(t=65;t<76;t++){switch(i=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:o=3;break;case 68:case 71:o=4;break;default:o=2}for(s=0;s<47;s++)bc.push({k:i+s,v:o})}for(bc.sort(function(l,p){return p.v-l.v}),s=0;s<bc.length;s++)i=bc[s].k.charAt(0),c.charAt(c.length-1)!==i&&(c+=i);return"DGBEFHACIJK"!==c}});ta({target:"Array",proto:!0,forced:sL||!LT||!rn||!nf},{sort:function(t){void 0!==t&&j1(t);var i=mi(this);if(nf)return void 0===t?kT(i):kT(i,t);var o,s,c=[],l=Q1(i);for(s=0;s<l;s++)s in i&&mj(c,i[s]);for(Dl(c,function(p){return function(h,g){return void 0===g?-1:void 0===h?1:void 0!==p?+p(h,g)||0:OT(h)>OT(g)?1:-1}}(t)),o=c.length,s=0;s<o;)i[s]=c[s++];for(;s<l;)delete i[s++];return i}});var _j=bd("Array").sort,rf=To,Ej=_j,xT=Array.prototype,na=function(t){var i=t.sort;return t===xT||rf(xT,t)&&i===xT.sort?Ej:i};function sf(t,i){if("boolean"!=typeof t)throw new V(L.INVALID_PARAMS,"Invalid ".concat(i,": The value is of the boolean type."))}function si(t,i,o){if(!o.includes(t))throw new V(L.INVALID_PARAMS,"".concat(i," can only be set as ").concat(JSON.stringify(o)))}function on(t,i){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;if(t<o||t>s||(!(arguments.length>4&&void 0!==arguments[4])||arguments[4])&&!cL(t))throw new V(L.INVALID_PARAMS,"invalid ".concat(i,": the value range is [").concat(o,", ").concat(s,"]. integer only"))}function aL(t,i){if("number"!=typeof t){if(!(t.min||t.max||t.ideal||t.exact))throw new V(L.INVALID_PARAMS,"".concat(i," is not a valid ConstrainLong"));void 0!==t.min&&on(t.min,"".concat(i,".min"),0,1/0),void 0!==t.max&&on(t.max,"".concat(i,".max"),1,1/0),void 0!==t.exact&&on(t.exact,"".concat(i,".exact"),1,1/0),void 0!==t.ideal&&on(t.ideal,"".concat(i,".ideal"),1,1/0)}else on(t,i,1,1/0)}function ln(t,i){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,c=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(null==t)throw new V(L.INVALID_PARAMS,"".concat(i||"param"," cannot be empty"));if(!FT(t,o,s,c))throw new V(L.INVALID_PARAMS,"Invalid ".concat(i||"string param",": Length of the string: [").concat(o,",").concat(s,"].").concat(c?" ASCII characters only.":""))}function fo(t,i){if(!Array.isArray(t))throw new V(L.INVALID_PARAMS,"".concat(i," should be an array"))}function lm(t){if("string"!=typeof t||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(t))throw N.error("Invalid Channel Name ".concat(t)),new V(L.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function BT(t){if(!("number"==typeof(i=t)&&Math.floor(i)===i&&0<=i&&i<=4294967295||FT(t,1,255)))throw N.error("Invalid UID ".concat(t," ").concat(typeof t)),new V(L.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var i;"string"==typeof t&&N.warning("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}function Cn(t){return null==t}function FT(t){return"string"==typeof t&&t.length<=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:255)&&t.length>=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)&&(!(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])||vj(t))}function cL(t){return"number"==typeof t&&t%1==0}function vj(t){if("string"!=typeof t)return!1;for(let i=0;i<t.length;i+=1){const o=t.charCodeAt(i);if(o<0||o>255)return!1}return!0}let UT,dn,Ei;(function(t){t.FREE="free",t.UPLOADING="uploading"})(UT||(UT={})),function(t){t[t.MISC=0]="MISC",t[t.INTERNAL_EVENT=1]="INTERNAL_EVENT",t[t.PUBLIC_EVENT=2]="PUBLIC_EVENT",t[t.WEB_EVENT=3]="WEB_EVENT",t[t.INTERNAL_API=4]="INTERNAL_API",t[t.WEB_API=5]="WEB_API",t[t.PUBLIC_API=6]="PUBLIC_API"}(dn||(dn={})),function(t){t.NONE="none",t.INIT="init",t.CANPLAY="canplay",t.PLAYING="playing",t.PAUSED="paused",t.SUSPEND="suspend",t.STALLED="stalled",t.WAITING="waiting",t.ERROR="error",t.DESTROYED="destroyed",t.ABORT="abort",t.ENDED="ended",t.EMPTIED="emptied",t.LOADEDDATA="loadeddata"}(Ei||(Ei={}));const G1={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};function H1(t){return ln(t.reportId,"params.reportId",0,100,!1),ln(t.category,"params.category",0,100,!1),ln(t.event,"params.event",0,100,!1),ln(t.label,"params.label",0,100,!1),on(t.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}const ih={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let gt,gn,uL,Nu,qe,Ve,Ou,Pu,Mu,ku,ko,Fr,je,dm,Bt,yt,Qi,$t,Me,Je,Oi,mt,lL,go;function dL(t){return on(t.timeout,"config.timeout",0,1e5),on(t.timeoutFactor,"config.timeoutFactor",0,100,!1),on(t.maxRetryCount,"config.maxRetryConfig",0,1/0),on(t.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function Cj(t){return si(t.codec,"config.codec",["vp8","vp9","av1","h264"]),si(t.mode,"config.mode",["rtc","live"]),void 0!==t.audioCodec&&si(t.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),void 0!==t.proxyServer&&ln(t.proxyServer,"config.proxyServer",1,1e4),void 0!==t.turnServer&&hm(t.turnServer),void 0!==t.httpRetryConfig&&dL(t.httpRetryConfig),void 0!==t.websocketRetryConfig&&dL(t.websocketRetryConfig),!0}function oh(t){if(!Array.isArray(t)||t.length<1)return!1;try{t.forEach(i=>{if(!i.urls)throw Error()})}catch{return!1}return!0}function hm(t){return ln(t.turnServerURL,"turnServerURL"),ln(t.username,"username"),ln(t.password,"password"),t.udpport&&on(t.udpport,"udpport",1,99999,!0),t.forceturn&&sf(t.forceturn,"forceturn"),t.security&&sf(t.security,"security"),t.tcpport&&on(t.tcpport,"tcpport",1,99999,!0),!0}function hL(t){return void 0!==t.level&&si(t.level,"level",[1,2,3]),!0}(function(t){t.PUBLISH="publish",t.SUBSCRIBE="subscribe",t.WS_COMPRESSOR_INIT="ws_compressor_init",t.SESSION_INIT="session_init",t.JOIN_CHOOSE_SERVER="join_choose_server",t.REQ_USER_ACCOUNT="req_user_account",t.JOIN_GATEWAY="join_gateway",t.REJOIN_GATEWAY="rejoin_gateway",t.STREAM_SWITCH="stream_switch",t.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",t.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",t.FIRST_VIDEO_RECEIVED="first_video_received",t.FIRST_AUDIO_RECEIVED="first_audio_received",t.FIRST_VIDEO_DECODE="first_video_decode",t.FIRST_AUDIO_DECODE="first_audio_decode",t.ON_ADD_AUDIO_STREAM="on_add_audio_stream",t.ON_ADD_VIDEO_STREAM="on_add_video_stream",t.ON_UPDATE_STREAM="on_update_stream",t.ON_REMOVE_STREAM="on_remove_stream",t.USER_ANALYTICS="req_user_analytics"})(gt||(gt={})),function(t){t.SESSION="io.agora.pb.Wrtc.Session",t.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",t.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",t.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",t.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",t.PUBLISH="io.agora.pb.Wrtc.Publish",t.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",t.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",t.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",t.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",t.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",t.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",t.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",t.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",t.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",t.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",t.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",t.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",t.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",t.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",t.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",t.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",t.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",t.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",t.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",t.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",t.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",t.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",t.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",t.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed"}(gn||(gn={})),function(t){t[t.WORKER_EVENT=156]="WORKER_EVENT",t[t.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(uL||(uL={})),function(t){t[t.SESSION=26]="SESSION",t[t.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",t[t.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",t[t.JOIN_GATEWAY=28]="JOIN_GATEWAY",t[t.PUBLISH=30]="PUBLISH",t[t.SUBSCRIBE=29]="SUBSCRIBE",t[t.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",t[t.STREAM_SWITCH=32]="STREAM_SWITCH",t[t.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",t[t.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",t[t.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",t[t.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",t[t.API_INVOKE=41]="API_INVOKE",t[t.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",t[t.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",t[t.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",t[t.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",t[t.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",t[t.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",t[t.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",t[t.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",t[t.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",t[t.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",t[t.WORKER_EVENT=156]="WORKER_EVENT",t[t.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",t[t.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",t[t.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",t[t.USER_ANALYTICS=1e4]="USER_ANALYTICS",t[t.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED"}(Nu||(Nu={})),function(t){t.CREATE_CLIENT="createClient",t.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",t.SET_AREA="setArea",t.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",t.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",t.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",t.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",t.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",t.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",t.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",t.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",t.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",t.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",t.START_PROXY_SERVER="Client.startProxyServer",t.STOP_PROXY_SERVER="Client.stopProxyServer",t.SET_PROXY_SERVER="Client.setProxyServer",t.SET_TURN_SERVER="Client.setTurnServer",t.SET_CLIENT_ROLE="Client.setClientRole",t.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",t.ENABLE_DUAL_STREAM="Client.enableDualStream",t.DISABLE_DUAL_STREAM="Client.disableDualStream",t.JOIN="Client.join",t.LEAVE="Client.leave",t.PUBLISH="Client.publish",t.UNPUBLISH="Client.unpublish",t.SUBSCRIBE="Client.subscribe",t.MASS_SUBSCRIBE="Client.massSubscribe",t.MASS_UNSUBSCRIBE="Client.massUnsubscribe",t.UNSUBSCRIBE="Client.unsubscribe",t.RENEW_TOKEN="Client.renewToken",t.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",t.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",t.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",t.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",t.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",t.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",t.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",t.DATACHANNEL_FAILBACK="Client._datachannelFailback",t.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",t.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",t.START_LIVE_STREAMING="Client.startLiveStreaming",t.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",t.STOP_LIVE_STREAMING="Client.stopLiveStreaming",t.ADD_INJECT_STREAM_URL="Client.addInjectStreamUrl",t.REMOVE_INJECT_STREAM_URL="Client.removeInjectStreamUrl",t.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",t.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",t.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",t.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",t.SET_CONFIG_DISTRIBUTE="_configDistribute",t.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",t.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",t.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",t.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",t.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",t.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",t.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",t.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",t.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",t.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",t.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",t.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",t.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",t.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",t.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",t.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",t.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",t.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",t.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",t.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",t.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",t.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",t.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",t.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",t.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",t.STREAM_TYPE_CHANGE="streamTypeChange",t.CONNECTION_STATE_CHANGE="connectionStateChange",t.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage"}(qe||(qe={})),function(t){t.TRACER="tracer"}(Ve||(Ve={})),function(t){t.IDLE="IDLE",t.INITING="INITING",t.INITEND="INITEND"}(Ou||(Ou={})),function(t){t.STATE_CHANGE="state_change",t.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",t.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",t.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(Pu||(Pu={})),function(t){t[t.ACCESS_POINT=101]="ACCESS_POINT",t[t.UNILBS=201]="UNILBS",t[t.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(Mu||(Mu={})),function(t){t[t.IIIEGAL_APPID=1]="IIIEGAL_APPID",t[t.IIIEGAL_UID=2]="IIIEGAL_UID",t[t.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(ku||(ku={})),function(t){t[t.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",t[t.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",t[t.INTERNAL_ERROR=8]="INTERNAL_ERROR",t[t.NO_AUTHORIZED=9]="NO_AUTHORIZED",t[t.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",t[t.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",t[t.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",t[t.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",t[t.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",t[t.USER_OVERLOAD=16]="USER_OVERLOAD",t[t.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",t[t.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(ko||(ko={})),function(t){t[t.NO_FLAG_SET=100]="NO_FLAG_SET",t[t.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",t[t.INVALID_FALG_SET=102]="INVALID_FALG_SET",t[t.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",t[t.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",t[t.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",t[t.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",t[t.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",t[t.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",t[t.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",t[t.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",t[t.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",t[t.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",t[t.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",t[t.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",t[t.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",t[t.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",t[t.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",t[t.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(Fr||(Fr={})),function(t){t[t.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",t[t.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",t[t.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",t[t.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",t[t.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",t[t.K_TICKET_INVALID=7]="K_TICKET_INVALID",t[t.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",t[t.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",t[t.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",t[t.K_UID_BANNED=14]="K_UID_BANNED",t[t.K_IP_BANNED=15]="K_IP_BANNED",t[t.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",t[t.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",t[t.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",t[t.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",t[t.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",t[t.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",t[t.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",t[t.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",t[t.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",t[t.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",t[t.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",t[t.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",t[t.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",t[t.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",t[t.ERR_INVALID_UID=117]="ERR_INVALID_UID",t[t.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",t[t.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",t[t.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",t[t.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",t[t.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",t[t.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",t[t.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",t[t.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",t[t.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",t[t.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",t[t.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",t[t.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",t[t.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",t[t.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",t[t.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",t[t.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",t[t.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",t[t.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",t[t.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",t[t.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",t[t.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",t[t.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",t[t.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",t[t.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",t[t.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",t[t.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",t[t.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",t[t.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",t[t.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",t[t.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",t[t.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",t[t.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",t[t.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",t[t.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",t[t.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",t[t.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",t[t.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(je||(je={})),function(t){t[t.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",t[t.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",t[t.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY"}(dm||(dm={})),function(t){t.LEAVE="LEAVE",t.NETWORK_ERROR="NETWORK_ERROR",t.SERVER_ERROR="SERVER_ERROR",t.UID_BANNED="UID_BANNED",t.IP_BANNED="IP_BANNED",t.CHANNEL_BANNED="CHANNEL_BANNED",t.FALLBACK="FALLBACK",t.LICENSE_MISSING="LICENSE_MISSING",t.LICENSE_EXPIRED="LICENSE_EXPIRED",t.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",t.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",t.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",t.LICENSE_ILLEGAL="LICENSE_ILLEGAL"}(Bt||(Bt={})),function(t){t.CONNECTION_STATE_CHANGE="connection-state-change",t.MEDIA_RECONNECT_START="media-reconnect-start",t.MEDIA_RECONNECT_END="media-reconnect-end",t.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",t.USER_JOINED="user-joined",t.USER_LEAVED="user-left",t.USER_PUBLISHED="user-published",t.USER_UNPUBLISHED="user-unpublished",t.USER_INFO_UPDATED="user-info-updated",t.CLIENT_BANNED="client-banned",t.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",t.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",t.VOLUME_INDICATOR="volume-indicator",t.CRYPT_ERROR="crypt-error",t.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",t.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",t.NETWORK_QUALITY="network-quality",t.STREAM_TYPE_CHANGED="stream-type-changed",t.STREAM_FALLBACK="stream-fallback",t.RECEIVE_METADATA="receive-metadata",t.STREAM_MESSAGE="stream-message",t.LIVE_STREAMING_ERROR="live-streaming-error",t.LIVE_STREAMING_WARNING="live-streaming-warning",t.INJECT_STREAM_STATUS="stream-inject-status",t.EXCEPTION="exception",t.ERROR="error",t.P2P_LOST="p2p_lost",t.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",t.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",t.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",t.PUBLISHED_USER_LIST="published-user-list",t.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",t.CONTENT_INSPECT_ERROR="content-inspect-error",t.CONTENT_INSPECT_RESULT="content-inspect-result"}(yt||(yt={})),function(t){t.NETWORK_ERROR="NETWORK_ERROR",t.SERVER_ERROR="SERVER_ERROR",t.MULTI_IP="MULTI_IP",t.TIMEOUT="TIMEOUT",t.OFFLINE="OFFLINE",t.LEAVE="LEAVE",t.P2P_FAILED="P2P_FAILED",t.FALLBACK="FALLBACK"}(Qi||(Qi={})),function(t){t.CONNECTING="connecting",t.CONNECTED="connected",t.RECONNECTING="reconnecting",t.CLOSED="closed"}($t||($t={})),function(t){t.WS_CONNECTED="ws_connected",t.WS_RECONNECTING="ws_reconnecting",t.WS_CLOSED="ws_closed",t.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",t.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",t.ON_BINARY_DATA="on_binary_data",t.REQUEST_RECOVER="request_recover",t.REQUEST_JOIN_INFO="request_join_info",t.REQUEST_REJOIN_INFO="req_rejoin_info",t.IS_P2P_DISCONNECTED="is_p2p_dis",t.DISCONNECT_P2P="dis_p2p",t.ABORT_P2P_EXECUTION="abort_p2p_execution",t.NEED_RENEW_SESSION="need-sid",t.REPORT_JOIN_GATEWAY="report_join_gateway",t.REQUEST_TIMEOUT="request_timeout",t.REQUEST_SUCCESS="request_success",t.JOIN_RESPONSE="join_response",t.DATACHANNEL_PRECONNECT="datachannel_preconnect",t.DATACHANNEL_CONNECTING="datachannel_connecting",t.DATACHANNEL_FAILBACK="datachannel_failback"}(Me||(Me={})),function(t){t.PING="ping",t.PING_BACK="ping_back",t.JOIN="join_v3",t.REJOIN="rejoin_v3",t.LEAVE="leave",t.SET_CLIENT_ROLE="set_client_role",t.PUBLISH="publish",t.UNPUBLISH="unpublish",t.SUBSCRIBE="subscribe",t.SUBSCRIBE_STREAMS="subscribe_streams",t.UNSUBSCRIBE="unsubscribe",t.UNSUBSCRIBE_STREAMS="unsubscribe_streams",t.SUBSCRIBE_CHANGE="subscribe_change",t.TRAFFIC_STATS="traffic_stats",t.RENEW_TOKEN="renew_token",t.SWITCH_VIDEO_STREAM="switch_video_stream",t.DEFAULT_VIDEO_STREAM="default_video_stream",t.SET_FALLBACK_OPTION="set_fallback_option",t.GATEWAY_INFO="gateway_info",t.CONTROL="control",t.SEND_METADATA="send_metadata",t.DATA_STREAM="data_stream",t.PICK_SVC_LAYER="pick_svc_layer",t.RESTART_ICE="restart_ice",t.CONNECT_PC="connect_pc",t.SET_VIDEO_PROFILE="set_video_profile",t.SET_PARAMETER="set_parameter"}(Je||(Je={})),function(t){t.PUBLISH_STATS="publish_stats",t.PUBLISH_RELATED_STATS="publish_related_stats",t.SUBSCRIBE_STATS="subscribe_stats",t.SUBSCRIBE_RELATED_STATS="subscribe_related_stats",t.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",t.DENOISER_STATS="denoiser_stats",t.TRANSPORT_STATS="transport_stats",t.EXTENSION_USAGE_STATS="extension_usage_stats"}(Oi||(Oi={})),function(t){t.ON_USER_ONLINE="on_user_online",t.ON_USER_OFFLINE="on_user_offline",t.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",t.ON_PUBLISH_STREAM="on_publish_stream",t.ON_UPLINK_STATS="on_uplink_stats",t.ON_P2P_LOST="on_p2p_lost",t.ON_REMOVE_STREAM="on_remove_stream",t.ON_ADD_AUDIO_STREAM="on_add_audio_stream",t.ON_ADD_VIDEO_STREAM="on_add_video_stream",t.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",t.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",t.ON_USER_BANNED="on_user_banned",t.ON_USER_LICENSE_BANNED="on_user_license_banned",t.ON_NOTIFICATION="on_notification",t.ON_CRYPT_ERROR="on_crypt_error",t.MUTE_AUDIO="mute_audio",t.MUTE_VIDEO="mute_video",t.UNMUTE_AUDIO="unmute_audio",t.UNMUTE_VIDEO="unmute_video",t.ON_P2P_OK="on_p2p_ok",t.RECEIVE_METADATA="receive_metadata",t.ON_DATA_STREAM="on_data_stream",t.ENABLE_LOCAL_VIDEO="enable_local_video",t.DISABLE_LOCAL_VIDEO="disable_local_video",t.ENABLE_LOCAL_AUDIO="enable_local_audio",t.DISABLE_LOCAL_AUDIO="disable_local_audio",t.ON_PUBLISHED_USER_LIST="on_published_user_list"}(mt||(mt={})),function(t){t.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",t.NEED_ANSWER="NEED_ANSWER",t.NEED_RENEGOTIATE="NEED_RENEGOTIATE",t.P2P_LOST="P2P_LOST",t.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",t.NEED_UNPUB="NEED_UNPUB",t.NEED_UNSUB="NEED_UNSUB",t.NEED_UPLOAD="NEED_UPLOAD",t.NEED_CONTROL="NEED_CONTROL",t.START_RECONNECT="START_RECONNECT",t.END_RECONNECT="END_RECONNECT",t.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(lL||(lL={})),function(t){t.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",t.RECEIVE_TRACK_BUFFER="receive_track_buffer",t.ON_AUDIO_BUFFER="on_audio_buffer",t.UPDATE_SOURCE="update_source"}(go||(go={}));const Lu={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,currentPacketLossRate:0},pm={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},yj={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},Ij={uplinkNetworkQuality:0,downlinkNetworkQuality:0},pL={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let ht,Un,ra;(function(t){t.CONNECTED="websocket:connected",t.RECONNECTING="websocket:reconnecting",t.WILL_RECONNECT="websocket:will_reconnect",t.CLOSED="websocket:closed",t.FAILED="websocket:failed",t.ON_MESSAGE="websocket:on_message",t.REQUEST_NEW_URLS="websocket:request_new_urls",t.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",t.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",t.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire"})(ht||(ht={})),function(t){t.TRANSCODE="mix_streaming",t.RAW="raw_streaming",t.INJECT="inject_streaming"}(Un||(Un={})),function(t){t[t.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",t[t.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",t[t.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",t[t.INJECT_STREAM_STATUS_START_TIMEOUT=3]="INJECT_STREAM_STATUS_START_TIMEOUT",t[t.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",t[t.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",t[t.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",t[t.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",t[t.INJECT_STREAM_STATUS_STOP_TIMEOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEOUT",t[t.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",t[t.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN"}(ra||(ra={}));const af={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},W1={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function K1(t,i){ln(t.url,"".concat(i,".url"),1,1e3,!1),Cn(t.x)||on(t.x,"".concat(i,".x"),0,1e4),Cn(t.y)||on(t.y,"".concat(i,".y"),0,1e4),Cn(t.width)||on(t.width,"".concat(i,".width"),0,1e4),Cn(t.height)||on(t.height,"".concat(i,".height"),0,1e4),Cn(t.zOrder)||on(t.zOrder,"".concat(i,".zOrder"),0,255),Cn(t.alpha)||on(t.alpha,"".concat(i,".alpha"),0,1,!1)}const fL={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},cf={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};let ia,uf,Vn,gL,vi,Lo,Zi,Tc,lr,yn,Jn,Qe,br,xu,lf,Bu,df,jt;function AL(t){if(!t.channelName)throw new V(L.INVALID_PARAMS,"invalid channelName in info");if(!t.uid||"number"!=typeof t.uid)throw new V(L.INVALID_PARAMS,"invalid uid in info, uid must be a number");return t.token&&ln(t.token,"info.token",1,2047),BT(t.uid),lm(t.channelName),!0}function mL(t){return si(t,"mediaSource",["screen","window","application"]),!0}(function(t){t.WARNING="@live_uap-warning",t.ERROR="@line_uap-error",t.PUBLISH_STREAM_STATUS="@live_uap-publish-status",t.INJECT_STREAM_STATUS="@live_uap-inject-status",t.WORKER_STATUS="@live_uap-worker-status",t.REQUEST_NEW_ADDRESS="@live_uap-request-address"})(ia||(ia={})),function(t){t.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(uf||(uf={})),function(t){t[t.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",t[t.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",t[t.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",t[t.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",t[t.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",t[t.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",t[t.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",t[t.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",t[t.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",t[t.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",t[t.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",t[t.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",t[t.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",t[t.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",t[t.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",t[t.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",t[t.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",t[t.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",t[t.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",t[t.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",t[t.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(Vn||(Vn={})),function(t){t.CONNECT_FAILED="connect failed",t.CONNECT_TIMEOUT="connect timeout",t.WS_DISCONNECTED="websocket disconnected",t.REQUEST_TIMEOUT="request timeout",t.REQUEST_FAILED="request failed",t.WAIT_STATUS_TIMEOUT="wait status timeout",t.WAIT_STATUS_ERROR="wait status error",t.BAD_STATE="bad state",t.WS_ABORT="ws abort",t.AP_REQUEST_TIMEOUT="AP request timeout",t.AP_JSON_PARSE_ERROR="AP json parse error",t.AP_REQUEST_ERROR="AP request error",t.AP_REQUEST_ABORT="AP request abort"}(gL||(gL={})),function(t){t[t.SetSdkProfile=0]="SetSdkProfile",t[t.SetSourceChannel=1]="SetSourceChannel",t[t.SetSourceUserId=2]="SetSourceUserId",t[t.SetDestChannel=3]="SetDestChannel",t[t.StartPacketTransfer=4]="StartPacketTransfer",t[t.StopPacketTransfer=5]="StopPacketTransfer",t[t.UpdateDestChannel=6]="UpdateDestChannel",t[t.Reconnect=7]="Reconnect",t[t.SetVideoProfile=8]="SetVideoProfile"}(vi||(vi={})),function(t){t.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",t.NETWORK_CONNECTED="NETWORK_CONNECTED",t.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",t.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",t.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",t.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",t.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",t.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",t.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",t.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(Lo||(Lo={})),function(t){t.RELAY_STATE_IDLE="RELAY_STATE_IDLE",t.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",t.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",t.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE"}(Zi||(Zi={})),function(t){t.RELAY_OK="RELAY_OK",t.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",t.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",t.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED"}(Tc||(Tc={})),function(t){t.High="high",t.Low="low",t.Audio="audio",t.Screen="screen",t.ScreenLow="screen_low"}(lr||(lr={})),function(t){t.DISCONNECT="disconnect",t.CONNECTION_STATE_CHANGE="connection-state-change",t.NETWORK_QUALITY="network-quality",t.STREAM_TYPE_CHANGE="stream-type-change",t.IS_P2P_DISCONNECTED="is-p2p-dis",t.DISCONNECT_P2P="dis-p2p",t.REQUEST_NEW_GATEWAY_LIST="req-gate-url",t.NEED_RENEW_SESSION="need-sid",t.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",t.JOIN_RESPONSE="join-response",t.REQUEST_DC_CONNECTION_PARAMS="request-dc-connection-params",t.RESET_CONNECTION_EVENTS="reset-connection-events",t.DATACHANNEL_PRECONNECT="datachannel_preconnect",t.DATACHANNEL_FAILBACK="datachannel_failback"}(yn||(yn={})),function(t){t[t.Nothing=0]="Nothing",t[t.Audio=1]="Audio",t[t.LwoVideo=2]="LwoVideo",t[t.Video=4]="Video",t[t.Data=8]="Data"}(Jn||(Jn={})),function(t){t.NEED_RENEGOTIATE="@need_renegotiate",t.NEED_REPLACE_TRACK="@need_replace_track",t.NEED_CLOSE="@need_close",t.NEED_ENABLE_TRACK="@need_enable_track",t.NEED_DISABLE_TRACK="@need_disable_track",t.NEED_SESSION_ID="@need_sid",t.SET_OPTIMIZATION_MODE="@set_optimization_mode",t.GET_STATS="@get_stats",t.GET_LOW_VIDEO_TRACK="@get_low_video_track",t.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",t.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",t.NEED_MUTE_TRACK="@need_mute_track",t.NEED_UNMUTE_TRACK="@need_unmute_track"}(Qe||(Qe={})),function(t){t.SCREEN_TRACK="screen_track",t.LOW_STREAM="low_stream"}(br||(br={})),function(t){t[t.HIGH_STREAM=0]="HIGH_STREAM",t[t.LOW_STREAM=1]="LOW_STREAM"}(xu||(xu={})),function(t){t[t.DISABLE=0]="DISABLE",t[t.LOW_STREAM=1]="LOW_STREAM",t[t.AUDIO_ONLY=2]="AUDIO_ONLY"}(lf||(lf={})),function(t){t.SOURCE_STATE_CHANGE="source-state-change",t.TRACK_ENDED="track-ended",t.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",t.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",t.CLOSED="closed"}(Bu||(Bu={})),function(t){t.FIRST_FRAME_DECODED="first-frame-decoded",t.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status"}(df||(df={})),function(t){t.CHINA="CHINA",t.ASIA="ASIA",t.NORTH_AMERICA="NORTH_AMERICA",t.EUROPE="EUROPE",t.JAPAN="JAPAN",t.INDIA="INDIA",t.KOREA="KOREA",t.HKMC="HKMC",t.US="US",t.OCEANIA="OCEANIA",t.SOUTH_AMERICA="SOUTH_AMERICA",t.AFRICA="AFRICA",t.OVERSEA="OVERSEA",t.GLOBAL="GLOBAL"}(jt||(jt={}));const Sj=[jt.AFRICA,jt.ASIA,jt.CHINA,jt.EUROPE,jt.GLOBAL,jt.INDIA,jt.JAPAN,jt.NORTH_AMERICA,jt.OCEANIA,jt.OVERSEA,jt.SOUTH_AMERICA];let Ur;!function(t){t.CHINA="CN",t.ASIA="AS",t.NORTH_AMERICA="NA",t.EUROPE="EU",t.JAPAN="JP",t.INDIA="IN",t.KOREA="KR",t.HKMC="HK",t.US="US",t.OCEANIA="OC",t.SOUTH_AMERICA="SA",t.AFRICA="AF",t.OVERSEA="OVERSEA",t.GLOBAL="GLOBAL"}(Ur||(Ur={}));const VT={CHINA:{},ASIA:{CODE:Ur.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:Ur.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:Ur.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:Ur.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","\tuap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:Ur.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:Ur.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:Ur.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:Ur.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:Ur.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:Ur.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:Ur.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:Ur.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:Ur.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]}};let fm,_L,ut,Pe,Ao,Nt,Ci,Rc,zr,Tr,Pi,mo,zn,Dc,cn;qk&&(VT.CHINA={CODE:Ur.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(t){t.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(fm||(fm={}));class gm extends En{constructor(i,o){super(),b(this,"onICEConnectionStateChange",void 0),b(this,"onConnectionStateChange",void 0),b(this,"onDTLSTransportStateChange",void 0),b(this,"onDTLSTransportError",void 0),b(this,"onICETransportStateChange",void 0),b(this,"onFirstAudioReceived",void 0),b(this,"onFirstVideoReceived",void 0),b(this,"onFirstAudioDecoded",void 0),b(this,"onFirstVideoDecoded",void 0),b(this,"onFirstVideoDecodedTimeout",void 0),b(this,"onSelectedLocalCandidateChanged",void 0),b(this,"onSelectedRemoteCandidateChanged",void 0)}}(function(t){t.SEND="sendonly",t.RECV="recvonly",t.SENDRECV="sendrecv",t.INACTIVE="inactive"})(_L||(_L={})),function(t){t.VIDEO="video",t.AUDIO="audio"}(ut||(ut={})),function(t){t.LocalVideoTrack="videoTrack",t.LocalAudioTrack="audioTrack",t.LocalVideoLowTrack="videoLowTrack"}(Pe||(Pe={})),function(t){t.New="new",t.Connected="connected",t.Reconnecting="reconnecting",t.Disconnected="disconnected"}(Ao||(Ao={})),function(t){t.StateChange="stateChange",t.IceConnectionStateChange="iceConnectionStateChange",t.RequestMuteLocal="requestMuteLocal",t.RequestUnmuteLocal="requestUnmuteLocal",t.RequestRePublish="requestRePublish",t.RequestReSubscribe="requestReSubscribe",t.RequestUploadStats="requestUploadStats",t.MediaReconnectStart="MediaReconnectStart",t.MediaReconnectEnd="MediaReconnectEnd",t.NeedSignalRTT="NeedSignalRTT",t.RequestRestartICE="RequestRestartIce",t.PeerConnectionStateChange="PeerConnectionStateChange",t.RequestReconnect="RequestReconnect",t.RequestReconnectPC="RequestReconnectPC",t.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",t.P2PLost="P2PLost",t.UpdateVideoEncoder="UpdateVideoEncoder",t.ConnectionTypeChange="ConnectionTypeChange",t.RequestLowStreamParameter="RequestLowStreamParameter",t.QueryClientConnectionState="QueryClientConnectionState"}(Nt||(Nt={})),function(t){t.ONLINE="ONLINE",t.OFFLINE="OFFLINE"}(Ci||(Ci={})),function(t){t.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",t.ONLINE="ONLINE",t.OFFLINE="OFFLINE"}(Rc||(Rc={})),function(t){t.ON_TRACK="on_track",t.ON_NODE="on_node"}(zr||(zr={})),function(t){t.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",t.REQUEST_CONSTRAINTS="request_constraints"}(Tr||(Tr={})),function(t){t.CONNECTING="CONNECTING",t.RECONNECTING="RECONNECTING",t.CONNECTED="CONNECTED",t.CLOSED="CLOSED"}(Pi||(Pi={})),function(t){t[t.CONNECT_AP=0]="CONNECT_AP",t[t.AP_CONNECTED=1]="AP_CONNECTED",t[t.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",t[t.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",t[t.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",t[t.CONNECT_WORKER=5]="CONNECT_WORKER",t[t.WORKER_CONNECTED=6]="WORKER_CONNECTED",t[t.CLOSED=7]="CLOSED"}(mo||(mo={})),function(t){t.CONNECTION_STATE_CHANGE="connection-state-change",t.STATE_CHANGE="state-change",t.INSPECT_RESULT="inspect-result",t.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",t.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(zn||(zn={})),function(t){t.NETWORK_ERROR="NETWORK_ERROR",t.SERVER_ERROR="SERVER_ERROR",t.MULTI_IP="MULTI_IP",t.TIMEOUT="TIMEOUT",t.OFFLINE="OFFLINE",t.LEAVE="LEAVE",t.P2P_FAILED="P2P_FAILED",t.FALLBACK="FALLBACK"}(Dc||(Dc={})),function(t){t.CONNECTED="transmitter:connected",t.RECONNECTING="transmitter:reconnecting",t.WILL_RECONNECT="transmitter:will_reconnect",t.CLOSED="transmitter:closed",t.FAILED="transmitter:failed",t.ON_MESSAGE="transmitter:on_message",t.REQUEST_NEW_URLS="transmitter:request_new_urls",t.RECONNECT_WAITTING_FINISH="transmitter:reconnect_waitting_finish",t.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",t.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",t.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",t.FAILBACK="transmitter:failback"}(cn||(cn={}));const Gi={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1};function Vr(){return Gi}var jT=typeof ArrayBuffer<"u"&&typeof DataView<"u",QT=Qs,EL=Xr,GT=rt.RangeError,Y1=function(t){if(void 0===t)return 0;var i=QT(t),o=EL(i);if(i!==o)throw GT("Wrong length or index");return o},bj=rt.Array,Am=Math.abs,Fu=Math.pow,Tj=Math.floor,HT=Math.log,vL=Math.LN2,yL=ad,WT=eu,Rj=us,mm=Vh,q1=Yi,KT=ma,IL=eu,Dj=us,YT=function(t,i,o){var s=mm(i);s in t?q1.f(t,s,KT(0,o)):t[s]=o},SL=rt.Array,VK=Math.max,wj=function(t,i,o){for(var s=Dj(t),c=IL(i,s),l=IL(void 0===o?s:o,s),p=SL(VK(l-c,0)),h=0;c<l;c++,h++)YT(p,h,t[c]);return p.length=h,p},bL=Dn,_m=_r,Nj=jT,RL=Fs,J1=$V,ts=An,Em=Mp,vm=Qs,Oj=Xr,z1=Y1,JT_pack=function(t,i,o){var s,c,l,p=bj(o),h=8*o-i-1,g=(1<<h)-1,f=g>>1,A=23===i?Fu(2,-24)-Fu(2,-77):0,_=t<0||0===t&&1/t<0?1:0,v=0;for((t=Am(t))!=t||t===1/0?(c=t!=t?1:0,s=g):(s=Tj(HT(t)/vL),t*(l=Fu(2,-s))<1&&(s--,l*=2),(t+=s+f>=1?A/l:A*Fu(2,1-f))*l>=2&&(s++,l/=2),s+f>=g?(c=0,s=g):s+f>=1?(c=(t*l-1)*Fu(2,i),s+=f):(c=t*Fu(2,f-1)*Fu(2,i),s=0));i>=8;)p[v++]=255&c,c/=256,i-=8;for(s=s<<i|c,h+=i;h>0;)p[v++]=255&s,s/=256,h-=8;return p[--v]|=128*_,p},JT_unpack=function(t,i){var o,s=t.length,c=8*s-i-1,l=(1<<c)-1,p=l>>1,h=c-7,g=s-1,f=t[g--],A=127&f;for(f>>=7;h>0;)A=256*A+t[g--],h-=8;for(o=A&(1<<-h)-1,A>>=-h,h+=i;h>0;)o=256*o+t[g--],h-=8;if(0===A)A=1-p;else{if(A===l)return o?NaN:f?-1/0:1/0;o+=Fu(2,i),A-=p}return(f?-1:1)*o*Fu(2,A-i)},$1=jg,DL=du,Pj=Kr.f,hf=Yi.f,Mj=wj,wL=lu,ym=On.PROPER,pf=On.CONFIGURABLE,ff=as.get,NL=as.set,zT="ArrayBuffer",OL="Wrong index",Qa=rt.ArrayBuffer,wc=Qa,gf=wc&&wc.prototype,Ga=rt.DataView,Nc=Ga&&Ga.prototype,sh=Object.prototype,Lj=rt.Array,X1=rt.RangeError,xj=bL(function(t){for(var i=yL(this),o=Rj(i),s=arguments.length,c=WT(s>1?arguments[1]:void 0,o),l=s>2?arguments[2]:void 0,p=void 0===l?o:WT(l,o);p>c;)i[c++]=t;return i}),Bj=bL([].reverse),PL=JT_pack,ML=JT_unpack,kL=function(t){return[255&t]},LL=function(t){return[255&t,t>>8&255]},xL=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},$T=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Fj=function(t){return PL(t,23,4)},XT=function(t){return PL(t,52,8)},Im=function(t,i){hf(t.prototype,i,{get:function(){return ff(this)[i]}})},Oc=function(t,i,o,s){var c=z1(o),l=ff(t);if(c+i>l.byteLength)throw X1(OL);var p=ff(l.buffer).bytes,h=c+l.byteOffset,g=Mj(p,h,h+i);return s?g:Bj(g)},Ha=function(t,i,o,s,c,l){var p=z1(o),h=ff(t);if(p+i>h.byteLength)throw X1(OL);for(var g=ff(h.buffer).bytes,f=p+h.byteOffset,A=s(+c),_=0;_<i;_++)g[f+_]=A[l?_:i-_-1]};if(Nj){var BL=ym&&Qa.name!==zT;if(ts(function(){Qa(1)})&&ts(function(){new Qa(-1)})&&!ts(function(){return new Qa,new Qa(1.5),new Qa(NaN),BL&&!pf}))BL&&pf&&RL(Qa,"name",zT);else{(wc=function(t){return Em(this,gf),new Qa(z1(t))}).prototype=gf;for(var ZT,FL=Pj(Qa),UL=0;FL.length>UL;)(ZT=FL[UL++])in wc||RL(wc,ZT,Qa[ZT]);gf.constructor=wc}DL&&$1(Nc)!==sh&&DL(Nc,sh);var ah=new Ga(new wc(2)),eR=bL(Nc.setInt8);ah.setInt8(0,2147483648),ah.setInt8(1,2147483649),!ah.getInt8(0)&&ah.getInt8(1)||J1(Nc,{setInt8:function(t,i){eR(this,t,i<<24>>24)},setUint8:function(t,i){eR(this,t,i<<24>>24)}},{unsafe:!0})}else gf=(wc=function(t){Em(this,gf);var i=z1(t);NL(this,{bytes:xj(Lj(i),0),byteLength:i}),_m||(this.byteLength=i)}).prototype,Nc=(Ga=function(t,i,o){Em(this,Nc),Em(t,gf);var s=ff(t).byteLength,c=vm(i);if(c<0||c>s)throw X1("Wrong offset");if(c+(o=void 0===o?s-c:Oj(o))>s)throw X1("Wrong length");NL(this,{buffer:t,byteLength:o,byteOffset:c}),_m||(this.buffer=t,this.byteLength=o,this.byteOffset=c)}).prototype,_m&&(Im(wc,"byteLength"),Im(Ga,"buffer"),Im(Ga,"byteLength"),Im(Ga,"byteOffset")),J1(Nc,{getInt8:function(t){return Oc(this,1,t)[0]<<24>>24},getUint8:function(t){return Oc(this,1,t)[0]},getInt16:function(t){var i=Oc(this,2,t,arguments.length>1?arguments[1]:void 0);return(i[1]<<8|i[0])<<16>>16},getUint16:function(t){var i=Oc(this,2,t,arguments.length>1?arguments[1]:void 0);return i[1]<<8|i[0]},getInt32:function(t){return $T(Oc(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return $T(Oc(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return ML(Oc(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return ML(Oc(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,i){Ha(this,1,t,kL,i)},setUint8:function(t,i){Ha(this,1,t,kL,i)},setInt16:function(t,i){Ha(this,2,t,LL,i,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,i){Ha(this,2,t,LL,i,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,i){Ha(this,4,t,xL,i,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,i){Ha(this,4,t,xL,i,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,i){Ha(this,4,t,Fj,i,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,i){Ha(this,8,t,XT,i,arguments.length>2?arguments[2]:void 0)}});wL(wc,zT),wL(Ga,"DataView");var Sm={ArrayBuffer:wc,DataView:Ga},Z1=Ii,Af=Dn,VL=An,mf=Io,tR=eu,Uj=Xr,Vj=qv,nR=Sm.ArrayBuffer,rR=Sm.DataView,jL=rR.prototype,bm=Af(nR.prototype.slice),jj=Af(jL.getUint8),Qj=Af(jL.setUint8);Z1({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:VL(function(){return!new nR(2).slice(1,void 0).byteLength})},{slice:function(t,i){if(bm&&void 0===i)return bm(mf(this),t);for(var o=mf(this).byteLength,s=tR(t,o),c=tR(void 0===i?o:i,o),l=new(Vj(this,nR))(Uj(c-s)),p=new rR(this),h=new rR(l),g=0;s<c;)Qj(h,g++,jj(p,s++));return l}});var ns,_f,e0,Pc={exports:{}},Gj=jT,t0=_r,xo=rt,iR=Er,n0=tn,Ol=Ki,r0=rE,QL=C_,oR=Fs,sR=Us.exports,Hj=Yi.f,Wj=zc,aR=jg,Ef=du,GL=hi,o0=JC,Tm=xo.Int8Array,s0=Tm&&Tm.prototype,Kj=xo.Uint8ClampedArray,HL=Kj&&Kj.prototype,Mc=Tm&&aR(Tm),Wa=s0&&aR(s0),Yj=Object.prototype,vf=xo.TypeError,cR=GL("toStringTag"),Rm=o0("TYPED_ARRAY_TAG"),Dm=o0("TYPED_ARRAY_CONSTRUCTOR"),Uu=Gj&&!!Ef&&"Opera"!==r0(xo.opera),WL=!1,oa={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},uR={BigInt64Array:8,BigUint64Array:8},KL=function(t){if(!n0(t))return!1;var i=r0(t);return Ol(oa,i)||Ol(uR,i)};for(ns in oa)(e0=(_f=xo[ns])&&_f.prototype)?oR(e0,Dm,_f):Uu=!1;for(ns in uR)(e0=(_f=xo[ns])&&_f.prototype)&&oR(e0,Dm,_f);if((!Uu||!iR(Mc)||Mc===Function.prototype)&&(Mc=function(){throw vf("Incorrect invocation")},Uu))for(ns in oa)xo[ns]&&Ef(xo[ns],Mc);if((!Uu||!Wa||Wa===Yj)&&(Wa=Mc.prototype,Uu))for(ns in oa)xo[ns]&&Ef(xo[ns].prototype,Wa);if(Uu&&aR(HL)!==Wa&&Ef(HL,Wa),t0&&!Ol(Wa,cR))for(ns in WL=!0,Hj(Wa,cR,{get:function(){return n0(this)?this[Rm]:void 0}}),oa)xo[ns]&&oR(xo[ns],Rm,ns);var ch={NATIVE_ARRAY_BUFFER_VIEWS:Uu,TYPED_ARRAY_CONSTRUCTOR:Dm,TYPED_ARRAY_TAG:WL&&Rm,aTypedArray:function(t){if(KL(t))return t;throw vf("Target is not a typed array")},aTypedArrayConstructor:function(t){if(iR(t)&&(!Ef||Wj(Mc,t)))return t;throw vf(QL(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,i,o,s){if(t0){if(o)for(var c in oa){var l=xo[c];if(l&&Ol(l.prototype,t))try{delete l.prototype[t]}catch{try{l.prototype[t]=i}catch{}}}Wa[t]&&!o||sR(Wa,t,o?i:Uu&&s0[t]||i,s)}},exportTypedArrayStaticMethod:function(t,i,o){var s,c;if(t0){if(Ef){if(o)for(s in oa)if((c=xo[s])&&Ol(c,t))try{delete c[t]}catch{}if(Mc[t]&&!o)return;try{return sR(Mc,t,o?i:Uu&&Mc[t]||i)}catch{}}for(s in oa)!(c=xo[s])||c[t]&&!o||sR(c,t,i)}},isView:function(t){if(!n0(t))return!1;var i=r0(t);return"DataView"===i||Ol(oa,i)||Ol(uR,i)},isTypedArray:KL,TypedArray:Mc,TypedArrayPrototype:Wa},lR=An,qL=CM,qj=rt.ArrayBuffer,Pl=rt.Int8Array,dR=!ch.NATIVE_ARRAY_BUFFER_VIEWS||!lR(function(){Pl(1)})||!lR(function(){new Pl(-1)})||!qL(function(t){new Pl,new Pl(null),new Pl(1.5),new Pl(t)},!0)||lR(function(){return 1!==new Pl(new qj(2),1,void 0).length}),hR=tn,Jj=Math.floor,zj=Number.isInteger||function(t){return!hR(t)&&isFinite(t)&&Jj(t)===t},JL=Qs,jK=rt.RangeError,$j=rt.RangeError,a0=function(t,i){var o=function(t){var i=JL(t);if(i<0)throw jK("The argument can't be less than 0");return i}(t);if(o%i)throw $j("Wrong offset");return o},zL=jv,c0=io,GK=TM,$L=ad,Cf=us,pR=XV,HK=Gv,XL=OA,ZL=ch.aTypedArrayConstructor,fR=od,Xj=rt,ex=Array.isArray||function(t){return"Array"==fR(t)},Zj=SM,tx=tn,eQ=hi("species"),tQ=Xj.Array,WK=jv,nx=jC,nQ=ad,rQ=us,rx=function(t,i){return new(function(t){var i;return ex(t)&&(Zj(i=t.constructor)&&(i===tQ||ex(i.prototype))||tx(i)&&null===(i=i[eQ]))&&(i=void 0),void 0===i?tQ:i}(t))(0===i?0:i)},ix=Dn([].push),Ml=function(t){var i=1==t,o=2==t,s=3==t,c=4==t,l=6==t,p=7==t,h=5==t||l;return function(g,f,A,_){for(var v,y,S=nQ(g),R=nx(S),D=WK(f,A),O=rQ(R),P=0,B=_||rx,G=i?B(g,O):o||p?B(g,0):void 0;O>P;P++)if((h||P in R)&&(y=D(v=R[P],P,S),t))if(i)G[P]=y;else if(y)switch(t){case 3:return!0;case 5:return v;case 6:return P;case 2:ix(G,v)}else switch(t){case 4:return!1;case 7:ix(G,v)}return l?-1:s||c?c:G}},iQ={forEach:Ml(0),map:Ml(1),filter:Ml(2),some:Ml(3),every:Ml(4),find:Ml(5),findIndex:Ml(6),filterReject:Ml(7)},ox=Ii,sx=rt,gR=io,KK=dR,AR=Mp,ax=ma,uh=Fs,lh=zj,Lc=Xr,cx=Y1,l0=a0,ux=Vh,wm=Ki,sQ=rE,yf=tn,aQ=kw,Ll=Rd,lx=zc,ki=du,xl=Kr.f,dx=function(t){var i,o,s,c,l,p,h=GK(this),g=$L(t),f=arguments.length,A=f>1?arguments[1]:void 0,_=void 0!==A,v=HK(g);if(v&&!XL(v))for(p=(l=pR(g,v)).next,g=[];!(c=c0(p,l)).done;)g.push(c.value);for(_&&f>2&&(A=zL(A,arguments[2])),o=Cf(g),s=new(ZL(h))(o),i=0;o>i;i++)s[i]=_?A(g[i],i):g[i];return s},YK=iQ.forEach,hx=wA,mR=Yi,px=Pr,d0=as.get,fx=as.set,h0=mR.f,gx=Hr.f,p0=Math.round,f0=sx.RangeError,ER=Sm.ArrayBuffer,Ax=ER.prototype,mx=Sm.DataView,g0=ch.NATIVE_ARRAY_BUFFER_VIEWS,_x=ch.TYPED_ARRAY_CONSTRUCTOR,vR=ch.TYPED_ARRAY_TAG,A0=ch.TypedArray,If=ch.TypedArrayPrototype,CR=ch.aTypedArrayConstructor,m0=ch.isTypedArray,Nm="BYTES_PER_ELEMENT",_0="Wrong length",E0=function(t,i){CR(t);for(var o=0,s=i.length,c=new t(s);s>o;)c[o]=i[o++];return c},dh=function(t,i){h0(t,i,{get:function(){return d0(this)[i]}})},yR=function(t){var i;return lx(Ax,t)||"ArrayBuffer"==(i=sQ(t))||"SharedArrayBuffer"==i},IR=function(t,i){return m0(t)&&!aQ(i)&&i in t&&lh(+i)&&i>=0},SR=function(t,i){return i=ux(i),IR(t,i)?ax(2,t[i]):gx(t,i)},_o=function(t,i,o){return i=ux(i),!(IR(t,i)&&yf(o)&&wm(o,"value"))||wm(o,"get")||wm(o,"set")||o.configurable||wm(o,"writable")&&!o.writable||wm(o,"enumerable")&&!o.enumerable?h0(t,i,o):(t[i]=o.value,t)};_r?(g0||(Hr.f=SR,mR.f=_o,dh(If,"buffer"),dh(If,"byteOffset"),dh(If,"byteLength"),dh(If,"length")),ox({target:"Object",stat:!0,forced:!g0},{getOwnPropertyDescriptor:SR,defineProperty:_o}),Pc.exports=function(t,i,o){var s=t.match(/\d+$/)[0]/8,c=t+(o?"Clamped":"")+"Array",l="get"+t,p="set"+t,h=sx[c],g=h,f=g&&g.prototype,A={},_=function(v,y){h0(v,y,{get:function(){return R=y,(D=d0(this)).view[l](R*s+D.byteOffset,!0);var R,D},set:function(S){return D=y,O=S,P=d0(this),o&&(O=(O=p0(O))<0?0:O>255?255:255&O),void P.view[p](D*s+P.byteOffset,O,!0);var D,O,P},enumerable:!0})};g0?KK&&(g=i(function(v,y,S,R){return AR(v,f),px(yf(y)?yR(y)?void 0!==R?new h(y,l0(S,s),R):void 0!==S?new h(y,l0(S,s)):new h(y):m0(y)?E0(g,y):gR(dx,g,y):new h(cx(y)),v,g)}),ki&&ki(g,A0),YK(xl(h),function(v){v in g||uh(g,v,h[v])}),g.prototype=f):(g=i(function(v,y,S,R){AR(v,f);var D,O,P,B=0,G=0;if(yf(y)){if(!yR(y))return m0(y)?E0(g,y):gR(dx,g,y);D=y,G=l0(S,s);var Y=y.byteLength;if(void 0===R){if(Y%s||(O=Y-G)<0)throw f0(_0)}else if((O=Lc(R)*s)+G>Y)throw f0(_0);P=O/s}else P=cx(y),D=new ER(O=P*s);for(fx(v,{buffer:D,byteOffset:G,byteLength:O,length:P,view:new mx(D)});B<P;)_(v,B++)}),ki&&ki(g,A0),f=g.prototype=Ll(If)),f.constructor!==g&&uh(f,"constructor",g),uh(f,_x,g),vR&&uh(f,vR,c),A[c]=g,ox({global:!0,forced:g!=h,sham:!g0},A),Nm in g||uh(g,Nm,s),Nm in f||uh(f,Nm,s),hx(c)}):Pc.exports=function(){},(0,Pc.exports)("Uint8",function(t){return function(i,o,s){return t(this,i,o,s)}});var Bl=us,Ex=Qs,qK=ch.aTypedArray;(0,ch.exportTypedArrayMethod)("at",function(t){var i=qK(this),o=Bl(i),s=Ex(t),c=s>=0?s:o+s;return c<0||c>=o?void 0:i[c]});var bR=io,TR=ch,RR=us,v0=a0,uQ=ad,C0=An,lQ=rt.RangeError,vx=rt.Int8Array,dQ=vx&&vx.prototype,hQ=dQ&&dQ.set,JK=TR.aTypedArray,zK=TR.exportTypedArrayMethod,Cx=!C0(function(){var t=new Uint8ClampedArray(2);return bR(hQ,t,{length:1,0:3},1),3!==t[1]}),$K=Cx&&TR.NATIVE_ARRAY_BUFFER_VIEWS&&C0(function(){var t=new vx(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]});zK("set",function(t){JK(this);var i=v0(arguments.length>1?arguments[1]:void 0,1),o=uQ(t);if(Cx)return bR(hQ,this,o,i);var s=this.length,c=RR(o),l=0;if(c+i>s)throw lQ("Wrong length");for(;l<c;)this[i+l]=o[l++]},!Cx||$K);var yx=wj,Ix=Math.floor,DR=function(t,i){var o=t.length,s=Ix(o/2);return o<8?pQ(t,i):fQ(t,DR(yx(t,0,s),i),DR(yx(t,s),i),i)},pQ=function(t,i){for(var o,s,c=t.length,l=1;l<c;){for(s=l,o=t[l];s&&i(t[s-1],o)>0;)t[s]=t[--s];s!==l++&&(t[s]=o)}return t},fQ=function(t,i,o,s){for(var c=i.length,l=o.length,p=0,h=0;p<c||h<l;)t[p+h]=p<c&&h<l?s(i[p],o[h])<=0?i[p++]:o[h++]:p<c?i[p++]:o[h++];return t},wR=DR,Sf=Bh.match(/firefox\/(\d+)/i),y0=!!Sf&&+Sf[1],bf=/MSIE|Trident/.test(Bh),Tf=Bh.match(/AppleWebKit\/(\d+)\./),I0=An,S0=ag,Sx=wR,kR=y0,LR=bf,gQ=Mw,AQ=!!Tf&&+Tf[1],mQ=rt.Array,XK=ch.aTypedArray,b0=ch.exportTypedArrayMethod,Vu=rt.Uint16Array,ju=Vu&&Dn(Vu.prototype.sort),T0=!(!ju||I0(function(){ju(new Vu(2),null)})&&I0(function(){ju(new Vu(2),{})})),bx=!!ju&&!I0(function(){if(gQ)return gQ<74;if(kR)return kR<67;if(LR)return!0;if(AQ)return AQ<602;var t,i,o=new Vu(516),s=mQ(516);for(t=0;t<516;t++)i=t%4,o[t]=515-t,s[t]=t-2*i+3;for(ju(o,function(c,l){return(c/4|0)-(l/4|0)}),t=0;t<516;t++)if(o[t]!==s[t])return!0});b0("sort",function(t){return void 0!==t&&S0(t),bx?ju(this,t):Sx(XK(this),function(i){return function(o,s){return void 0!==i?+i(o,s)||0:s!=s?-1:o!=o?1:0===o&&0===s?1/o>0&&1/s<0?1:-1:o>s}}(t))},!bx||T0);var xR=wA,Tx=Sm.ArrayBuffer;let Rr;Ii({global:!0,forced:rt.ArrayBuffer!==Tx},{ArrayBuffer:Tx}),xR("ArrayBuffer"),function(t){t[t.CHOOSE_SERVER=11]="CHOOSE_SERVER",t[t.CLOUD_PROXY=18]="CLOUD_PROXY",t[t.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",t[t.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK"}(Rr||(Rr={}));var Rx=bi,Om=Array.isArray||function(t){return"Array"==Rx(t)},Dx=Dt,wx=Om,ZK=mu,_Q=ds,Nx=Jr("species"),EQ=Dx.Array,Ox=function(t,i){return new(function(t){var i;return wx(t)&&(ZK(i=t.constructor)&&(i===EQ||wx(i.prototype))||_Q(i)&&null===(i=i[Nx]))&&(i=void 0),void 0===i?EQ:i}(t))(0===i?0:i)},Px=cu,FR=Eg,vQ=su,eY=dc,CQ=Ox,Rf=nr([].push),xc=function(t){var i=1==t,o=2==t,s=3==t,c=4==t,l=6==t,p=7==t,h=5==t||l;return function(g,f,A,_){for(var v,y,S=vQ(g),R=FR(S),D=Px(f,A),O=eY(R),P=0,B=_||CQ,G=i?B(g,O):o||p?B(g,0):void 0;O>P;P++)if((h||P in R)&&(y=D(v=R[P],P,S),t))if(i)G[P]=y;else if(y)switch(t){case 3:return!0;case 5:return v;case 6:return P;case 2:Rf(G,v)}else switch(t){case 4:return!1;case 7:Rf(G,v)}return l?-1:s||c?c:G}},UR={forEach:xc(0),map:xc(1),filter:xc(2),some:xc(3),every:xc(4),find:xc(5),findIndex:xc(6),filterReject:xc(7)},Mx=UR.forEach,VR=il("forEach")?[].forEach:function(t){return Mx(this,t,arguments.length>1?arguments[1]:void 0)};ei({target:"Array",proto:!0,forced:[].forEach!=VR},{forEach:VR});var tY=bd("Array").forEach,yQ=gc,kx=qi,nY=To,rY=tY,Lx=Array.prototype,iY={DOMTokenList:!0,NodeList:!0},xx=su,Bx=RE;ei({target:"Object",stat:!0,forced:Cr(function(){Bx(1)})},{keys:function(t){return Bx(xx(t))}});var Fx=cc.Object.keys,jR=xy,SQ=ei,bQ=Om,Ux=nr([].reverse),Vx=[1,2];SQ({target:"Array",proto:!0,forced:String(Vx)===String(Vx.reverse())},{reverse:function(){return bQ(this)&&(this.length=this.length),Ux(this)}});var oY=bd("Array").reverse,jx=To,TQ=oY,D0=Array.prototype,Qx=Cr,Gx=qh,DQ=Jr("species"),QR=function(t){return Gx>=51||!Qx(function(){var i=[];return(i.constructor={})[DQ]=function(){return{foo:1}},1!==i[t](Boolean).foo})},wQ=ei,GR=Dt,Hx=Om,HR=mu,NQ=ds,w0=DI,Wx=dc,OQ=ru,Kx=F1,PQ=Jr,Yx=iv,MQ=QR("slice"),WR=PQ("species"),KR=GR.Array,kQ=Math.max;wQ({target:"Array",proto:!0,forced:!MQ},{slice:function(t,i){var o,s,c,l=OQ(this),p=Wx(l),h=w0(t,p),g=w0(void 0===i?p:i,p);if(Hx(l)&&((HR(o=l.constructor)&&(o===KR||Hx(o.prototype))||NQ(o)&&null===(o=o[WR]))&&(o=void 0),o===KR||void 0===o))return Yx(l,h,g);for(s=new(void 0===o?KR:o)(kQ(g-h,0)),c=0;h<g;h++,c++)h in l&&Kx(s,c,l[h]);return s.length=c,s}});var qx=bd("Array").slice,LQ=To,sY=qx,Pm=Array.prototype;function Te(t,i,o,s,c){var l,p,h,g={};return function(t){var i=t.forEach;return t===Lx||nY(Lx,t)&&i===Lx.forEach||kx(iY,yQ(t))?rY:i}(l=Fx(s)).call(l,function(f){g[f]=s[f]}),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=jR(p=function(t){var i=t.reverse;return t===D0||jx(D0,t)&&i===D0.reverse?TQ:i}(h=function(t){var i=t.slice;return t===Pm||LQ(Pm,t)&&i===Pm.slice?sY:i}(o).call(o)).call(h)).call(p,function(f,A){return A(t,i,f)||f},g),c&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(c):void 0,g.initializer=void 0),void 0===g.initializer&&(yk(t,i,g),g=null),g}var Jx=bd("Array").keys,hh=gc,BQ=qi,zx=To,FQ=Jx,N0=Array.prototype,UQ={DOMTokenList:!0,NodeList:!0},ph=function(t){var i=t.keys;return t===N0||zx(N0,t)&&i===N0.keys||BQ(UQ,hh(t))?FQ:i};function O0(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function YR(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?O0(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):O0(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}let P0=0,M0=0;function Ka(t,i,o,s){return new Ie((c,l)=>{i.timeout=i.timeout||J("HTTP_CONNECT_TIMEOUT"),i.responseType=i.responseType||"json",i.data&&!o?(i.data=JSON.stringify(i.data),P0+=Ch(i.data)):o&&(i.data.size?P0+=i.data.size:i.data instanceof FormData?P0+=function(p){let h=0;return/DingTalk/i.test(navigator.userAgent)&&p.realFormData&&(p=p.realFormData),p.forEach(g=>{h+="string"==typeof g?Ch(g):g.size}),h+138}(i.data):P0+=Ch(JSON.stringify(i.data))),i.headers=i.headers||{},i.headers["Content-Type"]=i.headers["Content-Type"]||"application/json",i.method="POST",i.url=t,es.request(i).then(p=>{"string"==typeof p.data?M0+=Ch(p.data):p.data instanceof ArrayBuffer||p.data instanceof Uint8Array?M0+=p.data.byteLength:M0+=Ch(JSON.stringify(p.data)),s&&c({data:p.data,headers:p.headers}),c(p.data)}).catch(p=>{es.isCancel(p)?l(new V(L.OPERATION_ABORTED,"cancel token canceled")):l("ECONNABORTED"===p.code?new V(L.NETWORK_TIMEOUT,p.message):p.response?new V(L.NETWORK_RESPONSE_ERROR,p.response.status):new V(L.NETWORK_ERROR,p.message))})})}function $x(t,i){return qR.apply(this,arguments)}function qR(){return qR=U(function*(t,i){const o=new Blob([i.data],{type:"buffer"});return yield Ka(t,YR(YR({},i),{},{data:o,headers:{"Content-Type":"application/octet-stream"}}),!0)}),qR.apply(this,arguments)}const $n=new class extends En{set networkState(t){N.info("[".concat(this._moduleName,"]")+"network state changed, "+this._networkState+" -> "+t),this.emit(Rc.NETWORK_STATE_CHANGE,t,this._networkState),t===Ci.ONLINE?this.emit(Rc.ONLINE):t===Ci.OFFLINE&&(this.onlineWaiter=new Ie(i=>{this.once(Rc.ONLINE,()=>{this.onlineWaiter=void 0,i(Ci.ONLINE)})}),this.emit(Rc.OFFLINE)),this._networkState=t}get networkState(){return this._networkState}constructor(){super(),b(this,"_moduleName","network-indicator"),b(this,"_networkState",Ci.ONLINE),b(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=Ci.ONLINE}),window.addEventListener("offline",()=>{this.networkState=Ci.OFFLINE})}};let JR=!1;const Bo=new class extends En{constructor(){super(...arguments),b(this,"onAutoplayFailed",void 0),b(this,"onAudioAutoplayFailed",void 0)}};function VQ(){if(zt(),!JR){const t=i=>{i.preventDefault(),JR=!1,$A()?document.body.removeEventListener("click",t,!0):(document.body.removeEventListener("touchstart",t,!0),document.body.removeEventListener("mousedown",t,!0))};JR=!0,$A()?document.body.addEventListener("click",t,!0):(document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)),N.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),Bo.onAutoplayFailed?Bo.onAutoplayFailed():N.warning(Bo.onAudioAutoplayFailed?"AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.\n\n  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .":"We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.\n\n  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.\n\n  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."),Bo.emit("autoplay-failed")}}function Xx(t){return(new TextEncoder).encode(t)}const jQ=function(t,i){const o=new Uint8Array(t.byteLength+i.byteLength);return o.set(new Uint8Array(t),0),o.set(new Uint8Array(i),t.byteLength),o},QQ=function(){var t=U(function*(i){return function(o,s){let c="";return new Uint8Array(o).forEach(l=>{c+=l.toString(16).padStart(2,"0")}),c}(yield crypto.subtle.digest("SHA-256",Xx(i)))});return function(o){return t.apply(this,arguments)}}();var zR;function GQ(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function ft(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?GQ(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):GQ(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}function Df(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{report:pe};return function(i,o,s){const c=i[o];if("function"==typeof c){const l="AgoraRTCClient"===i.constructor.name?"Client":i.constructor.name;s.value=function(){for(var p=arguments.length,h=new Array(p),g=0;g<p;g++)h[g]=arguments[g];const f=t.report.reportApiInvoke(this._sessionId||null,{name:"".concat(l,".").concat(o),options:h,tag:Ve.TRACER,reportResult:t.reportResult});try{const A=c.apply(this,h);return f.onSuccess(t.reportResult&&A),A}catch(A){throw f.onError(A),A}}}return s}}function Bc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{report:pe};return function(i,o,s){const c=s.value;if("function"==typeof c){let l;l=t.className?t.className:"AgoraRTCClient"===i.constructor.name?"Client":i.constructor.name,s.value=U(function*(){let p;for(var h=arguments.length,g=new Array(h),f=0;f<h;f++)g[f]=arguments[f];try{g.length>0&&(JSON.stringify(g),p=g)}catch{N.warning("arguments for method ".concat(l,".").concat(o," not serializable from apiInvoke.")),p=[]}const A=(t.report||pe).reportApiInvoke(this._sessionId||null,{name:"".concat(l,".").concat(o),options:p,tag:Ve.TRACER});try{const _=yield c.apply(this,g);return A.onSuccess(),_}catch(_){throw A.onError(_),_}})}return s}}const pe=new(kn("AgoraRTCEventReport")(zR=class{constructor(){var t=this;b(this,"baseInfoMap",new Map),b(this,"proxyServer",void 0),b(this,"clientList",cm),b(this,"eventUploadTimer",void 0),b(this,"setSessionIdTimer",void 0),b(this,"url",void 0),b(this,"backupUrl",void 0),b(this,"_appId",void 0),b(this,"keyEventUploadPendingItems",[]),b(this,"normalEventUploadPendingItems",[]),b(this,"apiInvokeUploadPendingItems",[]),b(this,"apiInvokeCount",0),b(this,"ltsList",[]),b(this,"lastSendNormalEventTime",Date.now()),b(this,"customReportCounterTimer",void 0),b(this,"customReportCount",0),b(this,"extApiInvoke",function(){var i=U(function*(o){for(const s of o){const c=ft(ft({},s),{},{sid:null,invokeId:++t.apiInvokeCount,tag:Ve.TRACER});t.sendApiInvoke(c)}});return function(o){return i.apply(this,arguments)}}()),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),J("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),J("EVENT_REPORT_SEND_INTERVAL"))}adjustSessionStartTime(t){if(!this.baseInfoMap.has(t)&&!this.baseInfoMap.get(t))return N.error("adjust session ".concat(t," start time, sid is not exist or info is undefined")),void le("error",this,"adjustSessionStartTime","adjust session ".concat(t," start time, sid is not exist or info is undefined"));const i=this.baseInfoMap.get(t),o=Date.now(),s=i.startTime;i.startTime=o,N.debug("rewrite session ".concat(t," startTime: ").concat(o," , ").concat(o-s,"ms")),le("debug",this,"adjustSessionStartTime",void 0,"rewrite session ".concat(t," startTime: ").concat(o," , ").concat(o-s,"ms")),this.baseInfoMap.set(t,i)}setAppId(t){this._appId=t}reportApiInvoke(t,i,o){i.timeout=i.timeout||6e4,i.reportResult=void 0===i.reportResult||i.reportResult;const s=Date.now();this.apiInvokeCount+=1;const c=this.apiInvokeCount,l=()=>({tag:i.tag,invokeId:c,sid:t,name:i.name,apiInvokeTime:s,options:i.options,states:i.states||null}),p=!!J("SHOW_REPORT_INVOKER_LOG");p&&N.info("".concat(i.name," start"),i.options);let h=!1;Ar(i.timeout).then(()=>{h||(this.sendApiInvoke(ft(ft({},l()),{},{error:L.API_INVOKE_TIMEOUT,success:!1})),N.debug("".concat(i.name," timeout")))});const g=new V(L.UNEXPECTED_ERROR,"".concat(i.name,": this api invoke is end"));return{onSuccess:f=>{const A=()=>{if(h)throw g;return h=!0,this.sendApiInvoke(ft(ft({},l()),{},{success:!0},i.reportResult&&{result:f})),p&&N.info("".concat(i.name," onSuccess")),f};return o?Um(A,i.name+"Success",o,()=>h=!0):A()},onError:f=>{const A=()=>{if(h)throw f;h=!0,this.sendApiInvoke(ft(ft({},l()),{},{success:!1,error:f})),p&&N.info("".concat(i.name," onFailure"),f.toString())};return o?Um(A,i.name+"Error",o,()=>h=!0):A()}}}sessionInit(t,i){if(this.baseInfoMap.has(t))return;const o=Date.now(),s=this.createBaseInfo(t,o);s.cname=i.cname;const c=Object.assign({},{willUploadConsoleLog:J("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:qk?"global":"oversea",areas:J("AREAS")&&J("AREAS").join(",")},i.extend),l=Date.now(),p=ft(ft({},s),{},{eventType:gt.SESSION_INIT,appid:i.appid,browser:navigator.userAgent,build:Zp,lts:l,elapse:l-o,extend:JSON.stringify(c),mode:i.mode,process:J("PROCESS_ID"),appType:J("APP_TYPE"),success:!0,version:po});this.send({type:gn.SESSION,data:p},!0)}joinChooseServer(t,i){const o=this.baseInfoMap.get(t);if(!o)return;const s=o.info,c=Date.now(),l=ft(ft({},s),{},{eventType:gt.JOIN_CHOOSE_SERVER,lts:c,eventElapse:c-i.lts,chooseServerAddr:i.csAddr,errorCode:i.ec,elapse:c-o.startTime,success:i.succ,chooseServerAddrList:JSON.stringify(i.serverList),uid:i.uid?parseInt(i.uid):null,cid:i.cid?parseInt(i.cid):null,chooseServerIp:i.csIp||"",opid:i.opid,unilbsServerIds:i.unilbsServerIds,extend:i.extend||void 0,isHttp3:i.isHttp3});this.send({type:gn.JOIN_CHOOSE_SERVER,data:l},!0)}reqUserAccount(t,i){const o=this.baseInfoMap.get(t);if(!o)return;const s=o.info,c=Date.now(),l=ft(ft({},s),{},{eventType:gt.REQ_USER_ACCOUNT,lts:c,success:i.success,serverAddress:i.serverAddr,stringUid:i.stringUid,uid:i.uid,errorCode:i.errorCode,elapse:c-o.startTime,eventElapse:c-i.lts,extend:JSON.stringify(i.extend)});this.send({type:gn.REQ_USER_ACCOUNT,data:l},!0)}joinGateway(t,i){const o=this.baseInfoMap.get(t);if(!o)return;const s=o.info;i.vid&&(s.vid=i.vid),s.uid=i.uid,s.cid=i.cid;const c=Date.now(),{firstSuccess:l,avoidJoinStartTime:p,isProxy:h,addr:g}=i,f=c-(l&&p?p:o.startTime),A=ft(ft({},s),{},{eventType:gt.JOIN_GATEWAY,lts:c,gatewayAddr:i.addr,success:i.succ,errorCode:i.ec,elapse:f,eventElapse:c-i.lts,firstSuccess:l,signalChannel:i.signalChannel}),_=A.success?1:0;if(i.succ&&(o.lastJoinSuccessTime=c),l)this.send({type:gn.JOIN_GATEWAY,data:A},!0);else{let v;if(g)if(h){const S=g.match(/h=(\d{1,3}-){3}\d{1,3}/g),R=g.match(/p=[0-9]{1,6}/g);v={isSuccess:_,gatewayIp:S&&S.length?S[0].split("=")[1].replace(/-/g,"."):"",port:R&&R.length?R[0].split("=")[1]:"",isProxy:h?1:0}}else{const S=g.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),R=g.match(/:[0-9]{1,6}/g);v={isSuccess:_,gatewayIp:S&&S.length?S[0].split("//")[1].replace(/-/g,"."):"",port:R&&R.length?R[0].split(":")[1]:"",isProxy:h?1:0}}else v={isSuccess:_,gatewayIp:"",port:"",isProxy:h?1:0};delete A.success,delete A.eventType,delete A.firstSuccess,A.vid=Number(A.vid);const y=Object.assign({},A,v,{eventType:gt.REJOIN_GATEWAY});this.send({type:gn.RE_JOIN_GATEWAY,data:y},!0)}}joinChannelTimeout(t,i){const o=this.baseInfoMap.get(t);if(!o)return;const s=Date.now(),c=ft(ft({},o.info),{},{lts:s,timeout:i,elapse:s-o.startTime});this.send({type:gn.JOIN_CHANNEL_TIMEOUT,data:c},!0)}publish(t,i){const o=this.baseInfoMap.get(t);if(!o)return;const s=o.info,c=Date.now(),l=ft(ft({},s),{},{eventType:gt.PUBLISH,lts:c,eventElapse:i.eventElapse,elapse:c-o.startTime,success:i.succ,errorCode:i.ec,videoName:i.videoName,audioName:i.audioName,screenName:i.screenName,screenshare:i.screenshare,audio:i.audio,video:i.video,p2pid:i.p2pid,publishRequestid:i.publishRequestid});this.send({type:gn.PUBLISH,data:l},!0)}subscribe(t,i,o){const s=this.baseInfoMap.get(t);if(!s)return;const c=s.info,l=Date.now(),p=ft(ft({},c),{},{eventType:gt.SUBSCRIBE,lts:l,eventElapse:i.eventElapse,elapse:l-s.startTime,success:i.succ,errorCode:i.ec,video:i.video,audio:i.audio,subscribeRequestid:i.subscribeRequestid,p2pid:i.p2pid},o&&{extend:JSON.stringify({isMassSubscribe:!0})});"string"==typeof i.peerid?p.peerSuid=i.peerid:p.peer=i.peerid,this.send({type:gn.SUBSCRIBE,data:p},!0)}wsCompressorInit(t){var i;const o=[...ph(i=this.baseInfoMap).call(i)],c=this.baseInfoMap.get(o.length?o[0]:"UnableToGetSid");if(!c)return;const l=c.info,p=Date.now(),h=ft(ft({},l),{},{eventType:gt.WS_COMPRESSOR_INIT,lts:p,eventElapse:t.eventElapse,elapse:p-c.startTime,status:t.status?1:2});this.send({type:gn.WS_COMPRESSOR_INIT,data:h},!0)}firstRemoteVideoDecode(t,i,o,s){const c=this.baseInfoMap.get(t);if(!c)return;const l=c.info,p=Date.now(),h=ft(ft(ft({},l),s),{},{elapse:p-c.startTime,eventType:i,lts:p,firstDecodeFrame:Math.max(p-c.startTime,0),apEnd:Math.max(s.apEnd-c.startTime,0),apStart:Math.max(s.apStart-c.startTime,0),joinGwEnd:Math.max(s.joinGwEnd-c.startTime,0),joinGwStart:Math.max(s.joinGwStart-c.startTime,0),pcEnd:Math.max(s.pcEnd-c.startTime,0),pcStart:Math.max(s.pcStart-c.startTime,0),subscriberEnd:Math.max(s.subscriberEnd-c.startTime,0),subscriberStart:Math.max(s.subscriberStart-c.startTime,0),videoAddNotify:Math.max(s.videoAddNotify-c.startTime,0)});this.send({type:o,data:h},!0)}firstRemoteFrame(t,i,o,s){const c=this.baseInfoMap.get(t);if(!c)return;const l=c.info,p=Date.now(),h=ft(ft(ft({},l),s),{},{elapse:p-c.startTime,eventType:i,lts:p});this.send({type:o,data:h},!0)}onGatewayStream(t,i,o,s){const c=this.baseInfoMap.get(t);if(!c)return;const l=c.info,p=Date.now(),h=ft(ft(ft({},l),s),{},{eventType:i,lts:p});this.send({type:o,data:h},!0)}streamSwitch(t,i){const o=this.baseInfoMap.get(t);if(!o)return;const s=o.info,c=Date.now(),l=ft(ft({},s),{},{eventType:gt.STREAM_SWITCH,lts:c,isDual:i.isdual,elapse:c-o.startTime,success:i.succ});this.send({type:gn.STREAM_SWITCH,data:l},!0)}requestProxyAppCenter(t,i){const o=this.baseInfoMap.get(t);if(!o)return;const s=o.info,c=Date.now(),l=ft(ft({},s),{},{eventType:gt.REQUEST_PROXY_APPCENTER,lts:c,eventElapse:c-i.lts,elapse:c-o.startTime,APAddr:i.APAddr,workerManagerList:i.workerManagerList,response:i.response,errorCode:i.ec,success:i.succ});this.send({type:gn.REQUEST_PROXY_APPCENTER,data:l},!0)}requestProxyWorkerManager(t,i){const o=this.baseInfoMap.get(t);if(!o)return;const s=o.info,c=Date.now(),l=ft(ft({},s),{},{eventType:gt.REQUEST_PROXY_WORKER_MANAGER,lts:c,eventElapse:c-i.lts,elapse:c-o.startTime,workerManagerAddr:i.workerManagerAddr,response:i.response,errorCode:i.ec,success:i.succ});this.send({type:gn.REQUEST_PROXY_WORKER_MANAGER,data:l},!0)}setProxyServer(t){this.proxyServer=t,N.debug(t?"reportProxyServerurl: ".concat(t):"disable reportProxyServerurl: ".concat(t)),le("debug",this,"setProxyServer",t)}peerPublishStatus(t,i){const o=this.baseInfoMap.get(t);if(!o)return;const s=o.info,c=Date.now(),l=ft(ft({},s),{},{subscribeElapse:i.subscribeElapse,peer:i.peer,peerPublishDuration:Math.max(i.audioPublishDuration,i.videoPublishDuration),audiotag:i.audioPublishDuration>0?1:-1,videotag:i.videoPublishDuration>0?1:-1,lts:c,elapse:c-o.startTime,joinChannelSuccessElapse:c-(o.lastJoinSuccessTime||c),peerPublishDurationVideo:i.videoPublishDuration,peerPublishDurationAudio:i.audioPublishDuration});this.send({type:gn.PEER_PUBLISH_STATUS,data:l},!0)}workerEvent(t,i){const o=this.baseInfoMap.get(t);if(!o)return;const s=o.info,c=Date.now();(function(l,p,h){const g=l[p];if(!g||"string"!=typeof g)return[l];l[p]="";const f=Ch(JSON.stringify(l));let A=0;const _=[];let v=0;for(let y=0;y<g.length;y++)v+=g.charCodeAt(y)<=127?1:3,v<=1300-f||(_[_.length]=vh(vh({},l),{},{[p]:g.substring(A,y)}),A=y,v=g.charCodeAt(y)<=127?1:3);return A!==g.length-1&&(_[_.length]=vh(vh({},l),{},{[p]:g.substring(A)})),_})(ft(ft(ft({},s),i),{},{elapse:c-o.startTime,lts:c,productType:"WebRTC"}),"payload").forEach(l=>this.send({type:gn.WORKER_EVENT,data:l},!0))}apworkerEvent(t,i){const o=this.baseInfoMap.get(t);if(!o)return;const s=o.info,c=Date.now(),l=ft(ft(ft({},s),i),{},{elapse:c-o.startTime,lts:c});this.send({type:gn.AP_WORKER_EVENT,data:l},!0)}joinWebProxyAP(t,i){const o=this.baseInfoMap.get(t);if(!o)return;const s=o.info,c=Date.now(),l=ft(ft(ft({},s),i),{},{elapse:c-o.startTime,lts:c,extend:i.extend||void 0});this.send({type:gn.JOIN_WEB_PROXY_AP,data:l},!0)}WebSocketQuit(t,i){const o=this.baseInfoMap.get(t);if(!o)return;const s=o.info,c=Date.now(),l=ft(ft(ft({},s),i),{},{elapse:c-o.startTime,lts:c});this.send({type:gn.WEBSOCKET_QUIT,data:l},!0)}sendCustomReportMessage(t,i){var o=this;return U(function*(){if(o.customReportCount+=i.length,o.customReportCount>J("CUSTOM_REPORT_LIMIT"))throw new V(L.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);o.customReportCounterTimer||(o.customReportCounterTimer=window.setInterval(()=>{o.customReportCount=0},5e3));const s=i.map(c=>({type:gn.USER_ANALYTICS,data:ft({sid:t},c)}));try{J("NEW_REPORT_SERVER")?yield o.postDataToStatsCollector2(s):yield o.postDataToStatsCollector(s)}catch(c){throw N.error("send custom report message failed",c.toString()),new V(L.CUSTOM_REPORT_SEND_FAILED,c.message)}})()}autoplayFailed(t,i,o,s){if(!t)return;const c=this.baseInfoMap.get(t);if(!c)return;const l=c.info,p=Date.now(),h=ft(ft({},l),{},{vid:void 0===l.vid?0:Number(l.vid),lts:p,elapse:p-c.startTime,cbRegistered:Bo.onAutoplayFailed||Bo.onAudioAutoplayFailed?1:-1,errorMsg:o,mediaType:i,trackId:s,extend:void 0});this.send({type:gn.AUTOPLAY_FAILED,data:h},!0)}sendApiInvoke(t){const i=J("NOT_REPORT_EVENT");if(t.tag&&i.includes&&i.includes(t.tag))return!1;if(null===t.sid)return this.apiInvokeUploadPendingItems.push(t),!1;const o=this.baseInfoMap.get(t.sid);if(!o)return this.apiInvokeUploadPendingItems.push(t),!1;const{cname:s,uid:c,cid:l}=o.info;let p;if(t.lts=t.lts||Date.now(),t.error)if(t.error instanceof V){const{code:g,message:f}=t.error;p=g||f||t.error.toString()}else p=t.error.toString();const h={invokeId:t.invokeId,sid:t.sid,cname:s,cid:l,uid:c,lts:t.lts,success:t.success,elapse:t.lts-o.startTime,execElapse:t.lts-t.apiInvokeTime,apiName:t.name,options:t.options?JSON.stringify(t.options):void 0,execStates:t.states?JSON.stringify(t.states):void 0,execResult:t.result?JSON.stringify(t.result):void 0,errorCode:t.error?p:void 0,errorMsg:t.error?JSON.stringify(t.error):void 0};return this.send({type:gn.API_INVOKE,data:h},!1),!0}appendSessionId(){this.clientList.forEach(t=>{if(t._sessionId){const i=this.apiInvokeUploadPendingItems.length;for(let o=0;o<i;o++){const s=this.apiInvokeUploadPendingItems.shift();s&&(s.sid=t._sessionId,this.sendApiInvoke(Object.assign({},s)))}}})}send(t,i){if(i)return this.keyEventUploadPendingItems.push(t),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(t),this.normalEventUploadPendingItems.length>J("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(t,i){const o=[],s=[];for(;t.length;){const l=t.shift();o.length<20?o.push(l):s.push(l)}t.push(...s);for(const l of[...o]){var c;-1!==this.ltsList.indexOf(l.data.lts)?(l.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(l.data.lts)):(this.ltsList.push(l.data.lts),na(c=this.ltsList).call(c,(p,h)=>p-h))}return i||(this.lastSendNormalEventTime=Date.now()),J("ENABLE_EVENT_REPORT")&&o.length&&(J("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(o):this.postDataToStatsCollector(o)).catch((l=>p=>{J("EVENT_REPORT_RETRY")&&(i?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(l):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(l),this.normalEventUploadPendingItems.length>J("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-J("NORMAL_EVENT_QUEUE_CAPACITY")),N.warning("report: drop normal events"))))})(o)),t}postDataToStatsCollector2(t){var i=this;return U(function*(){$n.networkState===Ci.OFFLINE&&(yield Ie.race([$n.onlineWaiter,Ar(2*ur.maxRetryTimeout)]));const o=l=>{let p=new Uint8Array;return l.forEach(h=>{const g=Xx(JSON.stringify(h.data)),f=new ArrayBuffer(5),A=(v=>{let y=0;return Object.entries(gn).forEach(S=>{let[R,D]=S;D===v.type&&(y=Nu[R])}),y})(h),_=new DataView(f);_.setUint16(0,g.byteLength,!0),_.setUint8(2,255&A),_.setUint8(3,A>>>8&255),_.setUint8(4,A>>>16&255),p=jQ(p,new Uint8Array(f)),p=jQ(p,g)}),p},s="event";let c=i.proxyServer?"https://".concat(i.proxyServer,"/rs/?h=").concat(J("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(s):"https://".concat(J("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(s);for(let l=0;l<2;l+=1){1===l&&(c=i.proxyServer?"https://".concat(i.proxyServer,"/rs/?h=").concat(J("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(s):"https://".concat(J("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(s));try{yield Ka(c,{timeout:1e4,data:o(t),headers:ft(ft({token:"32f24ab2ddb74f508aa9286c356cec84",biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},i._appId&&{appid:i._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(p){if(1===l)throw p;continue}return}})()}postDataToStatsCollector(t){var i=arguments,o=this;return U(function*(){let s=i.length>1&&void 0!==i[1]&&i[1];const c={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:t.map(h=>JSON.stringify(h)),vid:(h=>{const g=h&&h.data.sid&&o.baseInfoMap.get(h.data.sid);return g&&g.info.vid&&+g.info.vid||0})(t[0])};$n.networkState===Ci.OFFLINE&&(yield Ie.race([$n.onlineWaiter,Ar(2*ur.maxRetryTimeout)]));const l=s?"/events/proto-raws":"/events/messages";let p=o.url||(o.proxyServer?"https://".concat(o.proxyServer,"/rs/?h=").concat(J("EVENT_REPORT_DOMAIN"),"&p=").concat(J("STATS_COLLECTOR_PORT"),"&d=").concat(l):"https://".concat(J("EVENT_REPORT_DOMAIN"),":").concat(J("STATS_COLLECTOR_PORT")).concat(l));for(let h=0;h<2;h+=1){1===h&&(p=o.backupUrl||(o.proxyServer?"https://".concat(o.proxyServer,"/rs/?h=").concat(J("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(J("STATS_COLLECTOR_PORT"),"&d=").concat(l):"https://".concat(J("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(J("STATS_COLLECTOR_PORT")).concat(l)));try{s?yield $x(p,{timeout:1e4,data:c}):yield Ka(p,{timeout:1e4,data:c})}catch(g){if(1===h)throw g;continue}return}})()}createBaseInfo(t,i){const o=Object.assign({},ih);return o.sid=t,this.baseInfoMap.set(t,{info:o,startTime:i}),o}reportResourceTiming(t,i){const o=performance.getEntriesByName(t),s=o[o.length-1];s&&this.reportApiInvoke(i,{name:"Client.resourceTiming",options:s,tag:Ve.TRACER}).onSuccess()}})||zR);Xp.on("REPORT_LOG_UPLOAD",t=>{t.networkState=$n.networkState,pe.reportApiInvoke(null,{name:"logUploadError",options:t,tag:Ve.TRACER})});class HQ extends En{constructor(i,o){super(),b(this,"trackMediaType",void 0),b(this,"_ID",void 0),b(this,"_hints",[]),b(this,"_isClosed",!1),b(this,"_originMediaStreamTrack",void 0),b(this,"_mediaStreamTrack",void 0),b(this,"_external",{}),this._ID=o||xn(8,"track-"),this._originMediaStreamTrack=i,this._mediaStreamTrack=i,ct.includes(this)||ct.push(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(i){if(!i){pe.reportApiInvoke(null,{name:qe.GET_MEDIA_STREAM_TRACK,options:[],tag:Ve.TRACER}).onSuccess(this._mediaStreamTrack&&"string"==typeof this._mediaStreamTrack.label?this._mediaStreamTrack.label:"")}return this._mediaStreamTrack}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,function(i){const o=ct.indexOf(i);-1!==o&&ct.splice(o,1)}(this),this.emit(Bu.CLOSED)}}let Dr,aY=1;class eo{constructor(i){b(this,"lockingPromise",Ie.resolve()),b(this,"locks",0),b(this,"name",""),b(this,"lockId",void 0),this.lockId=aY++,i&&(this.name=i),N.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(i){let o;this.locks+=1,N.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat("string"==typeof i?i:""));const s=new Ie(l=>{o=()=>{this.locks-=1,N.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat("string"==typeof i?i:"")),l()}}),c=this.lockingPromise.then(()=>o);return this.lockingPromise=this.lockingPromise.then(()=>s),c}}function Mm(t,i){return function(o,s,c){const l=c.value;if("function"!=typeof l)throw new Error("Cannot use mutex on object property.");return c.value=U(function*(){const p=this[i];if(!p)throw new Error("mutex property key ".concat(i," doesn't exist on ").concat(t));const h=yield p.lock("From ".concat(t,".").concat(s));try{for(var g=arguments.length,f=new Array(g),A=0;A<g;A++)f[A]=arguments[A];return yield l.apply(this,f)}finally{h()}}),c}}class $R extends HQ{get muted(){return this._muted}get enabled(){return this._enabled}constructor(i,o){super(i,o),b(this,"_enabled",!0),b(this,"_muted",!1),b(this,"_isClosed",!1),b(this,"_enabledMutex",void 0),b(this,"processor",void 0),b(this,"processorContext",void 0),b(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new eo("".concat(o)),i.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){return this._originMediaStreamTrack.label}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,N.debug("[".concat(this.getTrackId(),"] close")),le("debug",this,"close"),this.emit(Qe.NEED_CLOSE),super.close())}_updateOriginMediaStreamTrack(i,o){var s=this;return U(function*(){i!==s._originMediaStreamTrack&&(s._originMediaStreamTrack.removeEventListener("ended",s._handleTrackEnded),o&&s._originMediaStreamTrack.stop(),i.addEventListener("ended",s._handleTrackEnded),s._originMediaStreamTrack=i,s._muted&&(s._originMediaStreamTrack.enabled=!1),s._mediaStreamTrack=s._originMediaStreamTrack,s._updatePlayerSource(),yield Hn(s,Qe.NEED_REPLACE_TRACK,s),s.processor&&s.processor.updateInput({track:s._originMediaStreamTrack,context:s.processorContext}))})()}_getDefaultPlayerConfig(){return{}}onTrackEnded(){N.debug("[".concat(this.getTrackId(),"] track ended")),Po("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(Bu.TRACK_ENDED)}stateCheck(i,o){if(N.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(i,": ").concat(o,"]")),le("debug",this,"stateCheck",{stateName:i,state:o,muted:this._muted,enabled:this._enabled}),sf(o,i),this._enabled&&this._muted&&"enabled"===i&&!1===o)throw new V(L.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print();if(!this._enabled&&!this._muted&&"muted"===i&&!0===o)throw new V(L.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}function Zx(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}(0,Pc.exports)("Float32",function(t){return function(i,o,s){return t(this,i,o,s)}}),function(t){t.IOS_15_INTERRUPTION_START="ios15-interruption-start",t.IOS_15_INTERRUPTION_END="ios15-interruption-end",t.IOS_INTERRUPTION_START="ios-interruption-start",t.IOS_INTERRUPTION_END="ios-interruption-end",t.STATE_CHANGE="state-change"}(Dr||(Dr={}));const eB=window.AudioContext||window.webkitAudioContext;let bs=null;const _t=new class extends En{constructor(){var t;super(...arguments),t=this,b(this,"prevState",void 0),b(this,"curState",void 0),b(this,"currentTime",void 0),b(this,"currentTimeStuckAt",void 0),b(this,"interruptDetectorTrack",void 0),b(this,"onLocalAudioTrackMute",()=>{N.info("ios15-interruption-start"),vn("info",["WebAudio"],"ios15-interruption-start"),this.emit(Dr.IOS_15_INTERRUPTION_START)}),b(this,"onLocalAudioTrackUnmute",U(function*(){N.info("ios15-interruption-end"),vn("info",["WebAudio"],"ios15-interruption-end"),"running"!==t.curState||t.duringInterruption?N.info("ios15-interruption-end-canceled"):(bs&&(yield bs.suspend()),t.emit(Dr.IOS_15_INTERRUPTION_END))}))}get duringInterruption(){return"running"===this.prevState&&"interrupted"===this.curState}bindInterruptDetectorTrack(t){N.debug("webaudio bindInterruptDetectorTrack ".concat(t.getTrackId())),le("debug",["WebAudio"],"bindInterruptDetectorTrack",t.getTrackId()),this.interruptDetectorTrack||(this.interruptDetectorTrack=t,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(t){N.debug("webaudio unbindInterruptDetectorTrack ".concat(t.getTrackId())),le("debug",["WebAudio"],"unbindInterruptDetectorTrack",t.getTrackId()),this.interruptDetectorTrack&&this.interruptDetectorTrack===t&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function wf(){if(!bs){if(function XR(){if(!eB)return N.error("your browser is not support web audio"),void Re("error",["WebAudio"],"your browser is not support web audio");N.info("create audio context"),om("info",["WebAudio"],"WebAudioContext");const t=function(i){for(var o=1;o<arguments.length;o++){var s=null!=arguments[o]?arguments[o]:{};o%2?Zx(Object(s),!0).forEach(function(c){b(i,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(s)):Zx(Object(s)).forEach(function(c){Object.defineProperty(i,c,Object.getOwnPropertyDescriptor(s,c))})}return i}({},J("WEBAUDIO_INIT_OPTIONS"));N.debug("audio context init option:",JSON.stringify(t)),bs=new eB(t),_t.curState=bs.state,bs.onstatechange=()=>{_t.prevState=_t.curState,_t.curState=bs?bs.state:void 0,(Oo()||bl())&&"running"===_t.prevState&&"interrupted"===_t.curState&&(N.info("ios-interruption-start"),vn("info",["AudioState"],"ios-interruption-start"),_t.emit(Dr.IOS_INTERRUPTION_START)),(Oo()||bl())&&"interrupted"===_t.prevState&&"running"===_t.curState&&(N.info("ios-interruption-end"),vn("info",["AudioState"],"ios-interruption-end"),_t.emit(Dr.IOS_INTERRUPTION_END)),_t.prevState!==_t.curState&&(N.debug("AudioContext State Change","".concat(_t.prevState,"=>").concat(_t.curState)),Po("debug",["AudioContext",void 0],"statechange","".concat(_t.prevState,"=>").concat(_t.curState)),_t.emit(Dr.STATE_CHANGE))},setInterval(()=>{var i;const o=null===(i=bs)||void 0===i?void 0:i.currentTime;_t.currentTime!==o?(_t.currentTimeStuckAt&&(N.debug("AudioContext current time resume at ".concat(o)),_t.currentTimeStuckAt=void 0),_t.currentTime=o):(o!==_t.currentTimeStuckAt&&(pe.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:o},tag:Ve.TRACER}).onSuccess(),N.warning("AudioContext current time stuck at ".concat(o))),_t.currentTimeStuckAt=o)},5e3),function(){var i=U(function*(o){const s=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let c,l=!1,p=!1,h=!1;function g(O){"running"===o.state?f(!1):Oo()||bl()?"suspended"===o.state&&(f(!0),O&&o.resume().then(_,_)):"closed"!==o.state&&(f(!0),O&&o.resume().then(_,_))}function f(O){if(l!==O){l=O;for(let P=0,B=s;P<B.length;P+=1){const G=B[P];O?window.addEventListener(G,v,{capture:!0,passive:!0}):window.removeEventListener(G,v,{capture:!0,passive:!0})}}}function _(){g(!1)}function v(){g(!0)}function y(O){if(!h)if(c.paused)if(O){let P;S(!1),h=!0;try{P=c.play(),P?P.then(R,R):(c.addEventListener("playing",R),c.addEventListener("abort",R),c.addEventListener("error",R))}catch{R()}}else S(!0);else S(!1)}function S(O){if(p!==O){p=O;for(let P=0,B=s;P<B.length;P++){const G=B[P];O?window.addEventListener(G,D,{capture:!0,passive:!0}):window.removeEventListener(G,D,{capture:!0,passive:!0})}}}function R(){c.removeEventListener("playing",R),c.removeEventListener("abort",R),c.removeEventListener("error",R),h=!1,y(!1)}function D(){y(!0)}if(Oo()){const O=o.createMediaStreamDestination(),P=document.createElement("div");P.innerHTML="<audio x-webkit-airplay='deny'></audio>",c=P.children.item(0),c.controls=!1,c.disableRemotePlayback=!0,c.preload="auto",c.srcObject=O.stream,y(!0)}_t.on(Dr.STATE_CHANGE,function A(){g(!0)}),g(!1)});return function(o){return i.apply(this,arguments)}}()(bs)}(),!bs)throw new V(L.NOT_SUPPORTED,"can not create audio context");return bs}return bs}function Nf(t){if(function(){if(null!==k0)return k0;const s=wf(),c=s.createBufferSource(),l=s.createGain(),p=s.createGain();c.connect(l),c.connect(p),c.disconnect(l);let h=!1;try{c.disconnect(l)}catch{h=!0}return c.disconnect(),k0=h,h}())return;le("debug",["WebAudio"],"polyfillAudioNode");const i=t.connect,o=t.disconnect;t.connect=(s,c,l)=>(t._inputNodes||(t._inputNodes=[]),t._inputNodes.includes(s)||(s instanceof AudioNode?(t._inputNodes.push(s),i.call(t,s,c,l)):i.call(t,s,c)),t),t.disconnect=(s,c,l)=>{o.call(t),s?lD(t._inputNodes,s):t._inputNodes=[];for(const p of t._inputNodes)i.call(t,p)}}let k0=null;function L0(t,i){let o=!1;const s=1/i;if(J("DISABLE_WEBAUDIO")){const c=window.setInterval(()=>{o?window.clearInterval(c):t(performance.now()/1e3)},1e3*s)}else{const c=wf();let l=c.createGain();l.gain.value=0,l.connect(c.destination);const p=()=>{if(o)return void(l=null);const h=c.createOscillator();h.onended=p,h.connect(l),h.start(0),h.stop(c.currentTime+s),t(c.currentTime)};p()}return()=>{o=!0}}const Eo=N.prefix("[inject-node]");class cY{constructor(){b(this,"nodeLists",[]),b(this,"prevNode",void 0),b(this,"nextNode",void 0)}get firstNode(){return this.nodeLists[0]}get lastNode(){return this.nodeLists[this.nodeLists.length-1]}get isActive(){return!!this.nodeLists.length}get isConnected(){return!(!this.prevNode||!this.nextNode)}connect(i,o){Eo.debug("connect audio node, current list:"+this.nodeLists.length),this.nodeLists.length?(this.prevNode&&this.prevNode.disconnect(),i.connect(this.firstNode),this.nextNode&&this.lastNode&&this.lastNode.disconnect(),this.lastNode.connect(o),this.nodeLists.forEach((s,c)=>{const l=this.nodeLists[c+1];l&&s.connect(l)})):i.connect(o),this.nextNode=o,this.prevNode=i}disconnect(){var i;Eo.debug("disconnect audio node, current list:"+this.nodeLists.length),this.nodeLists.forEach(o=>{o.disconnect()}),null===(i=this.prevNode)||void 0===i||i.disconnect(),this.prevNode=void 0,this.nextNode=void 0}addNode(i){Eo.debug("add node in inject node, current list:",this.nodeLists.length),this.prevNode&&this.nextNode?(this.firstNode||(Eo.debug("new node is the first node"),this.prevNode.disconnect(),this.prevNode.connect(i),i.connect(this.nextNode)),this.nextNode&&this.lastNode&&(this.lastNode.disconnect(this.nextNode),this.lastNode.connect(i),i.connect(this.nextNode)),this.nodeLists.push(i)):Eo.debug("add node is called before inject node connected")}removeNode(i){Eo.debug("remove node in inject node, current list:",this.nodeLists.length);const o=this.nodeLists.indexOf(i);if(-1===o)return void Eo.debug("$[inject-node] cannot find the node to be removed");const s=this.nodeLists[o+1],c=this.nodeLists[o-1];0===o&&this.prevNode&&this.nextNode&&(this.prevNode.disconnect(i),this.prevNode.connect(s||this.nextNode)),o===this.nodeLists.length-1&&this.nextNode&&c&&(c.disconnect(i),c.connect(this.nextNode)),0!==o&&o!==this.nodeLists.length-1&&(c.disconnect(i),c.connect(s)),Eo.debug("remove node in inject node success, current list:",this.nodeLists.length)}}class tB{constructor(){b(this,"context",void 0),b(this,"analyserNode",void 0),b(this,"sourceNode",void 0),this.context=wf(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(i){if(i!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=i,i?.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||Oo()||bl()||"running"!==this.context.state&&this.context.resume(),!this.analyserNode))return 0;const i=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(i);else{const s=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(s);for(let c=0;c<i.length;++c)i[c]=s[c]/128-1}const o=hc(i).call(i,(s,c)=>s+c*c,0)/i.length;return Math.max(10*Math.log10(o)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var i,o;null===(i=this.sourceNode)||void 0===i||i.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,null===(o=this.sourceNode)||void 0===o||o.connect(this.analyserNode)}catch{N.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class nB extends En{get processSourceNode(){return this.sourceNode}set processedNode(i){var o;if(!this.isDestroyed&&this._processedNode!==i){try{var s;null===(s=this.sourceNode)||void 0===s||s.disconnect(this.outputNode)}catch{}null===(o=this._processedNode)||void 0===o||o.disconnect(),this._processedNode=i,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),b(this,"outputNode",void 0),b(this,"outputTrack",void 0),b(this,"isPlayed",!1),b(this,"sourceNode",void 0),b(this,"context",void 0),b(this,"audioBufferNode",void 0),b(this,"destNode",void 0),b(this,"injectNode",void 0),b(this,"audioOutputLevel",0),b(this,"volumeLevelAnalyser",void 0),b(this,"_processedNode",void 0),b(this,"playNode",void 0),b(this,"isDestroyed",!1),b(this,"onNoAudioInput",void 0),b(this,"isNoAudioInput",!1),b(this,"_noAudioInputCount",0),this.context=wf(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),Nf(this.outputNode),this.injectNode=new cY,this.volumeLevelAnalyser=new tB}startGetAudioBuffer(i){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(i),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=o=>{this.emit(go.ON_AUDIO_BUFFER,function(s){for(let c=0;c<s.outputBuffer.numberOfChannels;c+=1){const l=s.outputBuffer.getChannelData(c);for(let p=0;p<l.length;p+=1)l[p]=0}return s.inputBuffer}(o))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!Vr().webAudioMediaStreamDest)throw new V(L.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(i){"running"!==this.context.state&&Ns(()=>{_t.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=i||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}checkHasAudioInput(){var i=arguments,o=this;return U(function*(){let s=i.length>0&&void 0!==i[0]?i[0]:0;if(s>5)return o.isNoAudioInput=!0,o.onNoAudioInput&&o.onNoAudioInput(),!1;Oo()||bl()?"suspended"===o.context.state&&o.context.resume():"running"!==o.context.state&&o.context.resume();const c=o.volumeLevelAnalyser.getAnalyserNode();let l;c.getFloatTimeDomainData?(l=new Float32Array(c.fftSize),c.getFloatTimeDomainData(l)):(l=new Uint8Array(c.fftSize),c.getByteTimeDomainData(l));let p=!1;for(let h=0;h<l.length;h++)0!==l[h]&&(p=!0);return p?(o.isNoAudioInput=!1,!0):(yield Ar(200),(yield o.checkHasAudioInput(s?s+1:1))&&p)})()}getAudioVolume(){return this.outputNode.gain.value}setVolume(i){this.outputNode.gain.setValueAtTime(i,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}injectAudioNode(i){this.injectNode.addNode(i)}removeAudioNode(i){this.injectNode.removeNode(i)}disconnect(){var i,o;null===(i=this.processedNode)||void 0===i||i.disconnect(),null===(o=this.sourceNode)||void 0===o||o.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var i;this.processedNode?null===(i=this.processedNode)||void 0===i||i.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class rB extends nB{get isFreeze(){return!1}constructor(i,o,s){var c,l;if(super(),c=this,b(this,"sourceNode",void 0),b(this,"track",void 0),b(this,"clonedTrack",void 0),b(this,"audioElement",void 0),b(this,"isCurrentTrackCloned",!1),b(this,"isRemoteTrack",!1),b(this,"originVolumeLevelAnalyser",void 0),b(this,"rebuildWebAudio",U(function*(){if(N.debug("ready to rebuild web audio, state:",c.context.state),c.isNoAudioInput&&(yield c.checkHasAudioInput()),!c.isNoAudioInput||c.isDestroyed)return document.body.removeEventListener("click",c.rebuildWebAudio,!0),void N.debug("rebuild web audio success, current volume status",c.getAccurateVolumeLevel());c.context.resume().then(()=>N.info("resume success")),N.debug("rebuild web audio because of ios 12 bugs"),c.disconnect();const g=c.track;c.track=c.track.clone(),c.isCurrentTrackCloned?g.stop():c.isCurrentTrackCloned=!0;const f=new MediaStream([c.track]);c.sourceNode=c.context.createMediaStreamSource(f),Nf(c.sourceNode),c.volumeLevelAnalyser.rebuildAnalyser();const A=c.outputNode.gain.value;c.outputNode=c.context.createGain(),c.outputNode.gain.setValueAtTime(A,c.context.currentTime),Nf(c.outputNode),c.emit(go.UPDATE_SOURCE),c.connect(),c.audioElement.srcObject=f,c.isPlayed&&c.play(c.playNode),c.checkHasAudioInput()})),"audio"!==i.kind)throw new V(L.UNEXPECTED_ERROR);this.track=i;const p=new MediaStream([this.track]);if(this.isRemoteTrack=!!o,this.sourceNode=this.context.createMediaStreamSource(p),Nf(this.sourceNode),s){const g=s.clone();g.enabled=!0,this.clonedTrack=g,N.debug("create an unmuted track ".concat(g.id," from the original track ").concat(s.id," to get the volume"));const f=this.context.createMediaStreamSource(new MediaStream([g]));Nf(f),this.originVolumeLevelAnalyser=new tB,this.originVolumeLevelAnalyser.updateSource(f)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=p;const h=zt();o&&h.os===oi.IOS&&Number(null===(l=h.osVersion)||void 0===l?void 0:l.split(".")[0])<15&&(_t.on(Dr.STATE_CHANGE,()=>{"suspended"===this.context.state?document.body.addEventListener("click",this.rebuildWebAudio,!0):"running"===this.context.state&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(g=>{g||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(i){this.sourceNode.disconnect(),this.track=i,this.isCurrentTrackCloned=!1;const o=new MediaStream([i]);this.sourceNode=this.context.createMediaStreamSource(o),Nf(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(go.UPDATE_SOURCE),this.audioElement.srcObject=o}destroy(){var i;this.audioElement.srcObject=null,this.audioElement.remove(),_t.off("state-change",this.rebuildWebAudio),null===(i=this.originVolumeLevelAnalyser)||void 0===i||i.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(i){return this.context.createMediaStreamSource(new MediaStream([i]))}updateOriginTrack(i){const o=i.clone();o.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=o),N.debug("create an unmuted track ".concat(o.id," from the original track ").concat(i.id," to get the volume"));const s=this.context.createMediaStreamSource(new MediaStream([o]));Nf(s),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(s)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}function iB(t,i){return x0.apply(this,arguments)}function x0(){return x0=U(function*(t,i){const o=(c,l)=>c?"number"!=typeof c?c.max||c.exact||c.ideal||c.min||l:c:l,s={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxHeight:o(i.height,1080),maxWidth:o(i.width,1920)}}};return i.frameRate&&"number"!=typeof i.frameRate?(s.video.mandatory.maxFrameRate=i.frameRate.max,s.video.mandatory.minFrameRate=i.frameRate.min):"number"==typeof i.frameRate&&(s.video.mandatory.maxFrameRate=i.frameRate),yield navigator.mediaDevices.getUserMedia(s)}),x0.apply(this,arguments)}function B0(t){return Fc.apply(this,arguments)}function Fc(){return Fc=U(function*(t){const i=yield WQ(t.mediaSource),o=yield(s=i,new Ie((c,l)=>{const p=document.createElement("div");p.innerText="share screen",p.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const h=document.createElement("div");h.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const g=document.createElement("div");g.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",g.setAttribute("style","height: 12%;");const f=document.createElement("div");f.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const A=document.createElement("div");A.setAttribute("style","text-align: right; padding: 16px 0;");const _=document.createElement("button");_.innerHTML="cancel",_.setAttribute("style","width: 85px;"),_.onclick=()=>{document.body.removeChild(v);const y=new Error("NotAllowedError");y.name="NotAllowedError",l(y)},A.appendChild(_),h.appendChild(g),h.appendChild(f),h.appendChild(A);const v=document.createElement("div");v.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),v.appendChild(p),v.appendChild(h),document.body.appendChild(v),s.map(y=>{if(y.id){const S=document.createElement("div");S.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let R=y.thumbnail;const{width:D}=R.getSize();D>1920&&(R=R.resize({width:1920})),S.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+R.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+y.name.replace(/[\u00A0-\u9999<>\&]/g,function(O){return"&#"+O.charCodeAt(0)+";"})+"</span>",S.onclick=()=>{document.body.removeChild(v),c(y.id)},f.appendChild(S)}})}));var s;return yield iB(o,t)}),Fc.apply(this,arguments)}function WQ(t){return ZR.apply(this,arguments)}function ZR(){return ZR=U(function*(t){let i=["window","screen"];"application"!==t&&"window"!==t||(i=["window"]),"screen"===t&&(i=["screen"]);const o=eD();if(!o)throw new V(L.ELECTRON_IS_NULL);let s=null;try{var c;s=(null===(c=o.desktopCapturer)||void 0===c?void 0:c.getSources({types:i}))||o.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:i})}catch{s=null}s&&s.then||(s=new Ie((l,p)=>{o.desktopCapturer.getSources({types:i},(h,g)=>{h?p(h):l(g)})}));try{return yield s}catch(l){throw new V(L.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,l.toString())}}),ZR.apply(this,arguments)}let F0=null;function eD(){if(F0)return F0;try{return F0=window.require("electron"),F0}catch{return null}}const U0=new eo("safari");let tD=!1,oB=!1;function vo(t,i){return $r.apply(this,arguments)}function $r(){return $r=U(function*(t,i){let o=0,s=null;for(;o<2;)try{s=yield nD(t,i,o>0);break}catch(c){if(c instanceof V)throw N.error("[".concat(i,"] ").concat(c.toString())),le("error",[],"getLocalStream",{config:t,id:i},c.toString()),c;const l=fh(c.name||c.code||c,c.message);if(l.code===L.MEDIA_OPTION_INVALID){N.debug("[".concat(i,"] detect media option invalid, retry")),Re("debug",[],"[".concat(i,"] detect media option invalid, retry")),o+=1,yield Ar(500);continue}throw N.error("[".concat(i,"] ").concat(l.toString())),le("error",[],"getLocalStream",{config:t,id:i},l.toString()),l}if(!s)throw new V(L.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return s}),$r.apply(this,arguments)}function nD(t,i,o){return km.apply(this,arguments)}function km(){return km=U(function*(t,i,o){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new V(L.NOT_SUPPORTED,"can not find getUserMedia");o&&(t.video&&(delete t.video.width,delete t.video.height),t.screen&&(delete t.screen.width,delete t.screen.height));const s=Vr(),c=new MediaStream;if(t.audioSource&&c.addTrack(t.audioSource),t.videoSource&&c.addTrack(t.videoSource),!t.audio&&!t.video&&!t.screen)return N.debug("Using Video Source/ Audio Source"),Re("debug",[],"Using Video Source/ Audio Source"),c;if(t.screen)if(eD())gh(c,t.screen.sourceId?yield iB(t.screen.sourceId,t.screen):yield B0(t.screen));else if(E1()&&t.screen.extensionId&&t.screen.mandatory){if(!s.getStreamFromExtension)throw new V(L.NOT_SUPPORTED,"This browser does not support screen sharing");N.debug("[".concat(i,'] Screen access on chrome stable, looking for extension"')),Re("debug",[],"[".concat(i,'] Screen access on chrome stable, looking for extension"'));const _=yield(l=t.screen.extensionId,p=i,new Ie((v,y)=>{try{chrome.runtime.sendMessage(l,{getStream:!0},S=>{if(!S||!S.streamId)return N.error("[".concat(p,"] No response from Chrome Plugin. Plugin not installed properly"),S),le("error",[],"getSourceIdFromExtension",{extensionId:l,streamId:p},"No response from Chrome Plugin. Plugin not installed properly, ".concat(S)),void y(new V(L.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));v(S.streamId)})}catch(S){N.error("[".concat(p,"] AgoraRTC screensharing plugin is not accessible(").concat(l,")"),S.toString()),le("error",[],"getSourceIdFromExtension",{extensionId:l,streamId:p},"AgoraRTC screensharing plugin is not accessible(".concat(l,"), ").concat(S.toString())),y(new V(L.CHROME_PLUGIN_NOT_INSTALL))}}));t.screen.mandatory.chromeMediaSourceId=_,gh(c,yield navigator.mediaDevices.getUserMedia({video:{mandatory:t.screen.mandatory}}))}else if(s.getDisplayMedia){t.screen.mediaSource&&mL(t.screen.mediaSource);const _={width:t.screen.width,height:t.screen.height,frameRate:t.screen.frameRate,displaySurface:"screen"===t.screen.mediaSource?"monitor":t.screen.mediaSource};N.debug("[".concat(i,"] getDisplayMedia:"),JSON.stringify({video:_,audio:!!t.screenAudio})),om("debug",["mediaDevices",i],"getDisplayMedia",{video:_,audio:!!t.screenAudio,trackId:i}),gh(c,yield navigator.mediaDevices.getDisplayMedia({video:_,audio:!!t.screenAudio}))}else{if(!bn())throw N.error("[".concat(i,"] This browser does not support screenSharing")),new V(L.NOT_SUPPORTED,"This browser does not support screen sharing");{t.screen.mediaSource&&mL(t.screen.mediaSource);const _={video:{mediaSource:t.screen.mediaSource,width:t.screen.width,height:t.screen.height,frameRate:t.screen.frameRate}};N.debug("[".concat(i,"] getUserMedia: ").concat(JSON.stringify(_))),om("debug",["mediaDevices",i],"getUserMedia",_),gh(c,yield navigator.mediaDevices.getUserMedia(_))}}var l,p;if(!t.video&&!t.audio)return c;let h={video:t.video,audio:t.audio},g=J("MEDIA_DEVICE_CONSTRAINTS");if(g)try{"string"==typeof g&&(g=JSON.parse(g)),h=function _(v,y){if(!J0(v)||!J0(y)||Array.isArray(v)&&!Array.isArray(y)||!Array.isArray(v)&&Array.isArray(y))return y;if(Array.isArray(y)&&Array.isArray(v)){const S=[...v];for(let R=0;R<y.length;R++)S[R]=_(v[R],y[R]);return S}{const S=vh({},v);for(const R in y)Object.prototype.hasOwnProperty.call(y,R)&&(S[R]=Object.prototype.hasOwnProperty.call(v,R)?_(v[R],y[R]):y[R]);return S}}(h,g),Re("debug",["mediaDevices",i],"merge configConstraints ".concat(JSON.stringify(g)))}catch{}N.debug("[".concat(i,"] GetUserMedia"),JSON.stringify(h)),om("debug",["mediaDevices",i],"getUserMedia",h),zt();let f,A=null;(Di()||Oo()||_1())&&(A=yield U0.lock());try{f=yield navigator.mediaDevices.getUserMedia(h)}catch(_){throw A&&A(),_}return h.audio&&(tD=!0),h.video&&(oB=!0),gh(c,f),A&&A(),c}),km.apply(this,arguments)}function fh(t,i){switch(t){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new V(L.MEDIA_OPTION_INVALID,"".concat(t,": ").concat(i));case"NotFoundError":case"DevicesNotFoundError":return new V(L.DEVICE_NOT_FOUND,"".concat(t,": ").concat(i));case"NotSupportedError":return new V(L.NOT_SUPPORTED,"".concat(t,": ").concat(i));case"NotReadableError":return new V(L.NOT_READABLE,"".concat(t,": ").concat(i));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new V(L.PERMISSION_DENIED,"".concat(t,": ").concat(i));case"ConstraintNotSatisfiedError":return new V(L.CONSTRAINT_NOT_SATISFIED,"".concat(t,": ").concat(i));default:return N.error("getUserMedia unexpected error",t),le("error",[],"handleGetUserMediaError",void 0,t),new V(L.UNEXPECTED_ERROR,"".concat(t,": ").concat(i))}}function gh(t,i){const o=t.getVideoTracks()[0],s=t.getAudioTracks()[0],c=i.getVideoTracks()[0],l=i.getAudioTracks()[0];l&&(s&&t.removeTrack(s),t.addTrack(l)),c&&(o&&t.removeTrack(o),t.addTrack(c))}const to=new class extends En{get state(){return this._state}set state(t){t!==this._state&&(this.emit(Pu.STATE_CHANGE,t),this._state=t)}constructor(){super(),b(this,"_state",Ou.IDLE),b(this,"isAccessMicrophonePermission",!1),b(this,"isAccessCameraPermission",!1),b(this,"lastAccessMicrophonePermission",!1),b(this,"lastAccessCameraPermission",!1),b(this,"checkdeviceMatched",!1),b(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(J("ENUMERATE_DEVICES_INTERVAL")||Zb()&&eh())&&this.updateDevicesInfo()},J("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(t=>N.error(t.toString()))}enumerateDevices(t,i){var o=arguments,s=this;return U(function*(){let c=o.length>2&&void 0!==o[2]&&o[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new V(L.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const l=yield navigator.mediaDevices.enumerateDevices(),p=s.checkMediaDeviceInfoIsOk(l);let h=!s.isAccessMicrophonePermission&&t,g=!s.isAccessCameraPermission&&i;p.audio&&(h=!1),p.video&&(g=!1);let f=null,A=null,_=null;if(!c&&(h||g)){if(U0.isLocked&&(N.debug("[device manager] wait GUM lock"),(yield U0.lock())(),N.debug("[device manager] GUM unlock")),tD&&(h=!1,s.isAccessMicrophonePermission=!0),oB&&(g=!1,s.isAccessCameraPermission=!0),N.debug("[device manager] check media device permissions",t,i,h,g),h&&g){try{_=yield navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(v){const y=fh(v.name||v.code||v,v.message);if(y.code===L.PERMISSION_DENIED)throw y;N.warning("getUserMedia failed in getDevices",y)}s.isAccessCameraPermission=!0,s.isAccessMicrophonePermission=!0}else if(h){try{f=yield navigator.mediaDevices.getUserMedia({audio:t})}catch(v){const y=fh(v.name||v.code||v,v.message);if(y.code===L.PERMISSION_DENIED)throw y;N.warning("getUserMedia failed in getDevices",y)}s.isAccessMicrophonePermission=!0}else if(g){try{A=yield navigator.mediaDevices.getUserMedia({video:i})}catch(v){const y=fh(v.name||v.code||v,v.message);if(y.code===L.PERMISSION_DENIED)throw y;N.warning("getUserMedia failed in getDevices",y)}s.isAccessCameraPermission=!0}N.debug("[device manager] mic permission",t,"cam permission",i)}try{const v=yield navigator.mediaDevices.enumerateDevices();return f&&f.getTracks().forEach(y=>y.stop()),A&&A.getTracks().forEach(y=>y.stop()),_&&_.getTracks().forEach(y=>y.stop()),f=null,A=null,_=null,v}catch(v){return f&&f.getTracks().forEach(y=>y.stop()),A&&A.getTracks().forEach(y=>y.stop()),_&&_.getTracks().forEach(y=>y.stop()),f=null,A=null,_=null,new V(L.ENUMERATE_DEVICES_FAILED,v.toString()).throw()}})()}getRecordingDevices(){var t=arguments,i=this;return U(function*(){let o=t.length>0&&void 0!==t[0]&&t[0];return(yield i.enumerateDevices(!0,!1,o)).filter(s=>"audioinput"===s.kind)})()}getCamerasDevices(){var t=arguments,i=this;return U(function*(){let o=t.length>0&&void 0!==t[0]&&t[0];return(yield i.enumerateDevices(!1,!0,o)).filter(s=>"videoinput"===s.kind)})()}getSpeakers(){var t=arguments,i=this;return U(function*(){let o=t.length>0&&void 0!==t[0]&&t[0];return(yield i.enumerateDevices(!0,!1,o)).filter(s=>"audiooutput"===s.kind)})()}searchDeviceIdByName(t){let i=null;return this.deviceInfoMap.forEach(o=>{o.device.label===t&&(i=o.device.deviceId)}),i}getDeviceById(t){var i=this;return U(function*(){const o=(yield i.enumerateDevices(!0,!0,!0)).find(s=>s.deviceId===t);if(!o)throw new V(L.DEVICE_NOT_FOUND,"deviceId: ".concat(t));return o})()}init(){var t=this;return U(function*(){t.state=Ou.INITING;try{yield t.updateDevicesInfo(),t.state=Ou.INITEND}catch(i){throw N.warning("Device Detection functionality cannot start properly.",i.toString()),t.state=Ou.IDLE,!("boolean"==typeof isSecureContext?isSecureContext:"https:"===location.protocol||"file:"===location.protocol||"localhost"===location.hostname||"127.0.0.1"===location.hostname||"::1"===location.hostname)&&new V(L.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),i}})()}updateDevicesInfo(){var t=this;return U(function*(){const i=yield t.enumerateDevices(!0,!0,!0),o=Date.now(),s=[];if(i[0]&&i[0].label&&!1===t.checkdeviceMatched){t.checkdeviceMatched=!0;const l=i.find(h=>"audioinput"===h.kind&&"default"===h.deviceId),p=i.find(h=>"audiooutput"===h.kind&&"default"===h.deviceId);l&&p?p.groupId===l.groupId?N.debug("[device-check] default input ".concat(l.label," and output ").concat(p.label," is the same group")):N.warning("[device-check] default input ".concat(l.label," and output ").concat(p.label," is not the same group")):N.debug("[device-check] default input or output not found")}const c=t.checkMediaDeviceInfoIsOk(i);if(i.forEach(l=>{if(!l.deviceId)return;const p=t.deviceInfoMap.get("".concat(l.kind,"_").concat(l.deviceId));if("ACTIVE"!==(p?p.state:"INACTIVE")){const h={initAt:o,updateAt:o,device:l,state:"ACTIVE"};t.deviceInfoMap.set("".concat(l.kind,"_").concat(l.deviceId),h),s.push(h)}p&&(p.updateAt=o)}),t.deviceInfoMap.forEach((l,p)=>{"ACTIVE"===l.state&&l.updateAt!==o&&(l.state="INACTIVE",s.push(l))}),t.state!==Ou.INITEND)return c.audio&&(t.lastAccessMicrophonePermission=!0,t.isAccessMicrophonePermission=!0),void(c.video&&(t.lastAccessCameraPermission=!0,t.isAccessCameraPermission=!0));s.forEach(l=>{switch(l.device.kind){case"audioinput":t.lastAccessMicrophonePermission&&t.isAccessMicrophonePermission&&t.emit(Pu.RECORDING_DEVICE_CHANGED,l);break;case"videoinput":t.lastAccessCameraPermission&&t.isAccessCameraPermission&&t.emit(Pu.CAMERA_DEVICE_CHANGED,l);break;case"audiooutput":t.lastAccessMicrophonePermission&&t.isAccessMicrophonePermission&&t.emit(Pu.PLAYOUT_DEVICE_CHANGED,l)}}),c.audio&&(t.lastAccessMicrophonePermission=!0,t.isAccessMicrophonePermission=!0),c.video&&(t.lastAccessCameraPermission=!0,t.isAccessCameraPermission=!0)})()}checkMediaDeviceInfoIsOk(t){const i=t.filter(c=>"audioinput"===c.kind),o=t.filter(c=>"videoinput"===c.kind),s={audio:!1,video:!1};for(const c of i)if(c.label&&c.deviceId){s.audio=!0;break}for(const c of o)if(c.label&&c.deviceId){s.video=!0;break}return s}};var rD;let sB=kn("AudioElementPlayCenter")(rD=class{constructor(){b(this,"onAutoplayFailed",void 0),b(this,"elementMap",new Map),b(this,"elementStateMap",new Map),b(this,"elementsNeedToResume",[]),b(this,"sinkIdMap",new Map),b(this,"autoResumeAfterInterruption",()=>{Array.from(this.elementMap.entries()).forEach(t=>{let[i,o]=t;const s=this.elementStateMap.get(i),c=o.srcObject.getAudioTracks()[0];Zd()?c&&"live"===c.readyState&&"running"===_t.curState&&(N.debug("auto resume after interruption for iOS 15"),Re("debug",["AudioElementPlayCenter",i],"auto resume after interruption for iOS15"),o.pause(),o.play()):s&&"paused"===s&&c&&"live"===c.readyState&&"running"===_t.curState&&(N.debug("auto resume after interruption for iOS"),Re("debug",["AudioElementPlayCenter",i],"auto resume after interruption for iOS"),o.play())})}),b(this,"autoResumeAfterInterruptionOnIOS15",()=>{Array.from(this.elementMap.entries()).forEach(t=>{let[i,o]=t;const s=o.srcObject.getAudioTracks()[0];s&&"live"===s.readyState&&(N.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),le("debug",["AudioElementPlayCenter",i],"autoResumeAfterInterruptionOnIOS15"),o.pause(),o.play())})}),this.autoResumeAudioElement(),_t.on(Dr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),_t.on(Dr.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15),_t.on(Dr.STATE_CHANGE,()=>{Oo()&&"suspended"===_t.prevState&&"running"===_t.curState&&this.autoResumeAfterInterruption()})}setSinkID(t,i){var o=this;return U(function*(){const s=o.elementMap.get(t);if(o.sinkIdMap.set(t,i),s)try{yield s.setSinkId(i)}catch(c){throw new V(L.PERMISSION_DENIED,"can not set sink id: "+c.toString())}})()}play(t,i,o,s){if(this.elementMap.has(i))return;const c=document.createElement("audio");c.autoplay=!0,c.srcObject=new MediaStream([t]),this.bindAudioElementEvents(i,c),this.elementMap.set(i,c),this.elementStateMap.set(i,Ei.INIT),this.setVolume(i,o);const l=this.sinkIdMap.get(i);if(l)try{c.setSinkId(l).catch(h=>{N.warning("[".concat(i,"] set sink id failed"),h.toString()),om("warning",["HTMLAudioElement",i],"setSinkId",h.toString())})}catch(h){N.warning("[".concat(i,"] set sink id failed"),h.toString())}const p=c.play();p&&p.then&&p.catch(h=>{s&&pe.autoplayFailed(s,"audio",h.message,i),N.warning("audio element play warning",h.toString()),om("warning",["HTMLAudioElement",i],"play",h.toString()),this.elementMap.has(i)&&"NotAllowedError"===h.name&&(N.warning("detected audio element autoplay failed"),le("warning",["AudioElementPlayCenter",i],"play",h.toString()),this.elementsNeedToResume.push(c),Ns(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),VQ()}))})}updateTrack(t,i){const o=this.elementMap.get(t);o&&(o.srcObject=new MediaStream([i]))}isPlaying(t){return this.elementMap.has(t)}setVolume(t,i){const o=this.elementMap.get(t);o&&(i=Math.max(0,Math.min(100,i)),o.volume=i/100)}stop(t){const i=this.elementMap.get(t);if(this.sinkIdMap.delete(t),!i)return;const o=this.elementsNeedToResume.indexOf(i);this.elementsNeedToResume.splice(o,1),i.srcObject=null,i.remove(),this.elementMap.delete(t),this.elementStateMap.delete(t)}bindAudioElementEvents(t,i){aB.forEach(o=>{i.addEventListener(o,s=>{const c=this.elementStateMap.get(t),l="pause"===s.type?"paused":s.type;N.debug("[".concat(t,"] audio-element-status change ").concat(c," => ").concat(l)),Po("debug",["HTMLAudioElement",t],"statusChange","".concat(c," => ").concat(l)),this.elementStateMap.set(t,l)})})}getPlayerState(t){return this.elementStateMap.get(t)||"uninit"}autoResumeAudioElement(){const t=()=>{this.elementsNeedToResume.forEach(i=>{i.play().then(o=>{N.debug("Auto resume audio element success"),le("debug",["AudioElementPlayCenter"],"autoResumeAudioElement")}).catch(o=>{N.warning("Auto resume audio element failed!",o),le("warning",["AudioElementPlayCenter"],"autoResumeAudioElement",o.toString())})}),this.elementsNeedToResume=[]};new Ie(i=>{document.body?i():window.addEventListener("load",()=>i())}).then(()=>{$A()?document.body.addEventListener("click",t,!0):(document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0))})}})||rD;const aB=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended"],Fo=new sB;function or(){return function(t,i,o){const s=o.value;return"function"==typeof s&&(o.value=function(){this._isClosed&&new V(L.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning");for(var c=arguments.length,l=new Array(c),p=0;p<c;p++)l[p]=arguments[p];const h=s.apply(this,l);return h instanceof Ie?new Ie((g,f)=>{h.then(g).catch(f)}):h}),o}}var KQ,YQ,qQ,JQ,zQ,$Q,XQ,ZQ,cB,uB,iD,V0,j0,jr,lB,Q0,dB,e7,t7,hB,Ah,n7,r7,pB,fB,gB,AB,mB,jn,oD,i7=bd("Array").values,o7=gc,s7=qi,a7=To,G0=i7,sD=Array.prototype,_B={DOMTokenList:!0,NodeList:!0},Ts=function(t){var i=t.values;return t===sD||a7(sD,t)&&i===sD.values||s7(_B,o7(t))?G0:i};function EB(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function Lm(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?EB(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):EB(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}class vB extends En{constructor(i){super(),b(this,"name","VideoProcessorDestination"),b(this,"ID","0"),b(this,"_source",void 0),b(this,"videoContext",void 0),b(this,"inputTrack",void 0),this.videoContext=i}get kind(){return"video"}get enabled(){return!0}pipe(){throw new V(L.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new V(L.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(i){if(i.context!==this.videoContext)throw new Error("ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.\nProbably you are making pipeline like this:\nvideoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).");i.track&&i.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=i.track,this.emit(zr.ON_TRACK,i.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(zr.ON_TRACK,void 0)}}class CB extends En{set chained(i){this._chained=i}get chained(){return this._chained}constructor(i,o){super(),b(this,"constraintsMap",new Map),b(this,"statsRegistry",[]),b(this,"usageRegistry",[]),b(this,"trackId",void 0),b(this,"direction",void 0),b(this,"_chained",!1),this.trackId=i,this.direction=o}getConstraints(){var i=this;return U(function*(){return yield yi(i,Tr.REQUEST_CONSTRAINTS)})()}requestApplyConstraints(i,o){var s=this;return U(function*(){var c;return N.info("processor ".concat(o.name," requestApplyConstraints for ").concat(s.trackId)),i&&s.constraintsMap.set(o,i),Hn(s,Tr.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ts(c=s.constraintsMap).call(c)))})()}requestRevertConstraints(i){var o=this;return U(function*(){var s;if(o.constraintsMap.has(i))return N.info("processor ".concat(i.name," requestRevertConstraints for ").concat(o.trackId)),o.constraintsMap.delete(i),Hn(o,Tr.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ts(s=o.constraintsMap).call(s)))})()}registerStats(i,o,s){this.statsRegistry.find(c=>c.processorID===i.ID&&c.processorName===i.name&&c.type===o)||this.statsRegistry.push({processorName:i.name,processorID:i.ID,type:o,cb:s})}unregisterStats(i,o){const s=this.statsRegistry.findIndex(c=>c.processorID===i.ID&&c.processorName===i.name&&c.type===o);-1!==s&&this.statsRegistry.splice(s,1)}gatherStats(){const i=[];for(const{processorID:o,processorName:s,type:c,cb:l}of this.statsRegistry)try{const p=l();i.push({processorID:o,processorName:s,type:c,stats:p})}catch(p){N.error(new V(L.UNEXPECTED_ERROR,p.message))}return i}registerUsage(i,o){this.usageRegistry.find(s=>s.processorID===i.ID&&s.processorName===i.name)||this.usageRegistry.push({processorID:i.ID,processorName:i.name,cb:o})}unregisterUsage(i){const o=this.usageRegistry.findIndex(s=>s.processorID===i.ID&&s.processorName===i.name);-1!==o&&this.usageRegistry.splice(o,1)}gatherUsage(){var i=this;return U(function*(){const o=[];if(!i.chained)return[];for(const{cb:s}of i.usageRegistry)try{let c=s();c instanceof Ie&&(c=yield c),o.push(Lm(Lm({},c),{},{direction:i.direction}))}catch(c){N.error("gather extension usage error",c)}return o})()}getDirection(){return this.direction}}class H0 extends En{constructor(i){super(),b(this,"name","AudioProcessorDestination"),b(this,"ID","0"),b(this,"inputTrack",void 0),b(this,"inputNode",void 0),b(this,"audioProcessorContext",void 0),b(this,"_source",void 0),this.audioProcessorContext=i}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new V(L.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new V(L.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(zr.ON_TRACK,void 0),this.emit(zr.ON_NODE,void 0)}updateInput(i){if(i.context!==this.audioProcessorContext)throw new Error("ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.\n        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).");i.track&&this.inputTrack!==i.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=i.track,this.emit(zr.ON_TRACK,this.inputTrack)),i.node&&this.inputNode!==i.node&&(this.audioProcessorContext.chained=!0,this.inputNode=i.node,this.emit(zr.ON_NODE,this.inputNode))}}class yB extends En{set chained(i){this._chained=i}get chained(){return this._chained}constructor(i,o,s){super(),b(this,"constraintsMap",new Map),b(this,"statsRegistry",[]),b(this,"audioContext",void 0),b(this,"trackId",void 0),b(this,"direction",void 0),b(this,"usageRegistry",[]),b(this,"_chained",!1),this.audioContext=i,this.trackId=o,this.direction=s}getConstraints(){var i=this;return U(function*(){return yi(i,Tr.REQUEST_CONSTRAINTS)})()}getAudioContext(){return this.audioContext}requestApplyConstraints(i,o){var s=this;return U(function*(){var c;return N.info("processor ".concat(o.name," requestApplyConstraints for ").concat(s.trackId)),i&&s.constraintsMap.set(o,i),Hn(s,Tr.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ts(c=s.constraintsMap).call(c)))})()}requestRevertConstraints(i){var o=this;return U(function*(){var s;if(o.constraintsMap.has(i))return o.constraintsMap.delete(i),Hn(o,Tr.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ts(s=o.constraintsMap).call(s)))})()}registerStats(i,o,s){this.statsRegistry.find(c=>c.processorID===i.ID&&c.processorName===i.name&&c.type===o)||this.statsRegistry.push({processorName:i.name,processorID:i.ID,type:o,cb:s})}unregisterStats(i,o){const s=this.statsRegistry.findIndex(c=>c.processorID===i.ID&&c.processorName===i.name&&c.type===o);-1!==s&&this.statsRegistry.splice(s,1)}gatherStats(){const i=[];for(const{processorID:o,processorName:s,type:c,cb:l}of this.statsRegistry)try{const p=l();i.push({processorID:o,processorName:s,type:c,stats:p})}catch(p){N.error(new V(L.UNEXPECTED_ERROR,p.message))}return i}registerUsage(i,o){this.usageRegistry.find(s=>s.processorID===i.ID&&s.processorName===i.name)||this.usageRegistry.push({processorID:i.ID,processorName:i.name,cb:o})}unregisterUsage(i){const o=this.usageRegistry.findIndex(s=>s.processorID===i.ID&&s.processorName===i.name);-1!==o&&this.usageRegistry.splice(o,1)}gatherUsage(){var i=this;return U(function*(){const o=[];if(!i.chained)return[];for(const{cb:s}of i.usageRegistry)try{let c=s();c instanceof Ie&&(c=yield c),o.push(Lm(Lm({},c),{},{direction:i.direction}))}catch(c){N.error("gather extension usage error",c)}return o})()}getDirection(){return this.direction}}class aD extends En{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),b(this,"context",void 0),b(this,"processSourceNode",void 0),b(this,"outputTrack",void 0),b(this,"processedNode",void 0),b(this,"clonedTrack",void 0),b(this,"outputNode",void 0),this.outputNode=new IB}setVolume(){}createOutputTrack(){throw new V(L.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class IB{disconnect(){}connect(){}}function SB(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function W0(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?SB(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):SB(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}let Li=(KQ=kn("LocalAudioTrack","getTrackId"),YQ=or(),qQ=Mm("LocalAudioTrack","_enabledMutex"),JQ=Bc({className:"LocalAudioTrack"}),zQ=or(),$Q=Mm("LocalAudioTrack","_enabledMutex"),XQ=Bc({className:"LocalAudioTrack"}),ZQ=or(),cB=or(),uB=or(),iD=or(),V0=or(),KQ((Te((jr=class extends $R{get isPlaying(){return this._useAudioElement?Fo.isPlaying(this.getTrackId()):this._source.isPlayed}constructor(t,i,o,s){super(t,o),b(this,"trackMediaType","audio"),b(this,"_encoderConfig",void 0),b(this,"_source",void 0),b(this,"_enabled",!0),b(this,"_volume",100),b(this,"_useAudioElement",!1),b(this,"_bypassWebAudio",!1),b(this,"processor",void 0),b(this,"processorContext",void 0),b(this,"processorDestination",void 0),b(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=i,this._getOriginVolumeLevel=!!s,J("DISABLE_WEBAUDIO")?(this._source=new aD,this._useAudioElement=!0,this._bypassWebAudio=!0):(this._source=new rB(t,!1,this._getOriginVolumeLevel?t:void 0),J("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0)),this.processorContext=new yB(this._source.context,this.getTrackId(),"local"),this.processorDestination=new H0(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(go.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setVolume(t){on(t,"volume",0,1e3);const i=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.LOCAL_AUDIO_TRACK_SET_VOLUME,options:[this.getTrackId(),t]},300);this._volume=t,this._source.setVolume(t/100),this._useAudioElement&&Fo.setVolume(this.getTrackId(),t);try{if(this._bypassWebAudio)return N.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio.")),void i.onSuccess();const o=this._source.createOutputTrack();this._mediaStreamTrack!==o&&(this._mediaStreamTrack=o,Hn(this,Qe.NEED_REPLACE_TRACK,this).then(()=>{N.debug("[".concat(this.getTrackId(),"] replace web audio track success")),Re("debug",this,"replace web audio track success")}).catch(s=>{N.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),s),Re("warning",this,"replace web audio track failed ".concat(s.toString()))}))}catch{}i.onSuccess()}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}setPlaybackDevice(t){var i=this;return U(function*(){const o=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[i.getTrackId(),t]});if(!i._useAudioElement)throw new V(L.NOT_SUPPORTED,"your browser does not support setting the audio output device");try{yield Fo.setSinkID(i.getTrackId(),t)}catch(s){throw o.onError(s),s}o.onSuccess()})()}setEnabled(t,i,o){var s=this;return U(function*(){return s._setEnabled(t,i,o)})()}_setEnabled(t,i,o){var s=this;return U(function*(){if(!o){if(t===s._enabled)return;s.stateCheck("enabled",t)}if(N.info("[".concat(s.getTrackId(),"] start setEnabled"),t),le("info",s,"setEnabled",t),t){s._originMediaStreamTrack.enabled=!0;try{o||(s._enabled=!0),yield Hn(s,Qe.NEED_ENABLE_TRACK,s),N.info("[".concat(s.getTrackId(),"] setEnabled to ").concat(t," success")),le("info",s,"setEnabled",t,"success")}catch(c){throw o||(s._enabled=!1),N.error("[".concat(s.getTrackId(),"] setEnabled to true error"),c.toString()),le("error",s,"setEnabled",t,c.toString()),c}}else{s._originMediaStreamTrack.enabled=!1,o||(s._enabled=!1);try{yield Hn(s,Qe.NEED_DISABLE_TRACK,s)}catch(c){throw o||(s._enabled=!0),N.error("[".concat(s.getTrackId(),"] setEnabled to false error"),c.toString()),le("info",s,"setEnabled",t,c.toString()),c}}})()}setMuted(t){var i=this;return U(function*(){t!==i._muted&&(i.stateCheck("muted",t),i._muted=t,i._originMediaStreamTrack.enabled=!t,N.debug("[".concat(i.getTrackId(),"] start set muted: ").concat(t)),le("debug",i,"setMuted",t),t?yield Hn(i,Qe.NEED_MUTE_TRACK,i):yield Hn(i,Qe.NEED_UNMUTE_TRACK,i))})()}getStats(){return Co(()=>{N.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead"),Re("warning",this,"LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),Uc(this,Qe.GET_STATS)||W0({},Lu)}setAudioFrameCallback(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!t)return this._source.removeAllListeners(go.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(i),this._source.removeAllListeners(go.ON_AUDIO_BUFFER),this._source.on(go.ON_AUDIO_BUFFER,o=>t(o))}play(){const t=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.LOCAL_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});N.debug("[".concat(this.getTrackId(),"] start audio playback")),le("debug",this,"play"),this._useAudioElement?(N.debug("[".concat(this.getTrackId(),"] start audio playback in element")),Re("debug",this,"start audio playback in element"),Fo.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play(),t.onSuccess()}stop(){const t=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.LOCAL_AUDIO_TRACK_STOP,options:[this.getTrackId()]});N.debug("[".concat(this.getTrackId(),"] stop audio playback")),le("debug",this,"stop"),this._useAudioElement?Fo.stop(this.getTrackId()):this._source.stop(),t.onSuccess()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];N.debug("[".concat(this.getTrackId(),"] update player source track")),le("debug",this,"_updatePlayerSource"),t&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Fo.updateTrack(this.getTrackId(),this._mediaStreamTrack)}_updateOriginMediaStreamTrack(t,i){var o=this;return U(function*(){o._originMediaStreamTrack!==t&&(o._originMediaStreamTrack.removeEventListener("ended",o._handleTrackEnded),t.addEventListener("ended",o._handleTrackEnded),i&&o._originMediaStreamTrack.stop(),o._originMediaStreamTrack=t,o._muted&&(o._originMediaStreamTrack.enabled=!1),o.processor&&o.processor.updateInput({track:t,context:o.processorContext}),o._mediaStreamTrack!==o._source.outputTrack?(o._mediaStreamTrack=o._originMediaStreamTrack,o._updatePlayerSource(),yield Hn(o,Qe.NEED_REPLACE_TRACK,o)):o._source.updateTrack(o._originMediaStreamTrack),o._getOriginVolumeLevel&&o._source.updateOriginTrack(t))})()}renewMediaStreamTrack(t){return Ie.resolve(void 0)}pipe(t){if(this._bypassWebAudio)throw new V(L.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===t)return t;if(t._source)throw new V(L.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),t}unpipe(){var t;if(!this.processor)return;const i=this.processor;null===(t=this._source.processSourceNode)||void 0===t||t.disconnect(),this.processor._source=!1,this.processor=void 0,i.reset()}bindProcessorDestinationEvents(){var t=this;this.processorDestination.on(zr.ON_TRACK,function(){var i=U(function*(o){o?o!==t._mediaStreamTrack&&(t._mediaStreamTrack=o,t._updatePlayerSource(!1),t._source.processedNode=t._source.createMediaStreamSourceNode(o),yield Hn(t,Qe.NEED_REPLACE_TRACK,t)):t._mediaStreamTrack!==t._originMediaStreamTrack&&(t._mediaStreamTrack=t._originMediaStreamTrack,t._updatePlayerSource(),yield Hn(t,Qe.NEED_REPLACE_TRACK,t))});return function(o){return i.apply(this,arguments)}}()),this.processorDestination.on(zr.ON_NODE,i=>{this._source.processedNode=i})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(zr.ON_TRACK),this.processorDestination.removeAllListeners(zr.ON_NODE)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(Tr.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(Tr.REQUEST_CONSTRAINTS)}}).prototype,"setPlaybackDevice",[YQ],Object.getOwnPropertyDescriptor(jr.prototype,"setPlaybackDevice"),jr.prototype),Te(jr.prototype,"setEnabled",[qQ,JQ,zQ],Object.getOwnPropertyDescriptor(jr.prototype,"setEnabled"),jr.prototype),Te(jr.prototype,"setMuted",[$Q,XQ,ZQ],Object.getOwnPropertyDescriptor(jr.prototype,"setMuted"),jr.prototype),Te(jr.prototype,"getStats",[cB],Object.getOwnPropertyDescriptor(jr.prototype,"getStats"),jr.prototype),Te(jr.prototype,"setAudioFrameCallback",[uB],Object.getOwnPropertyDescriptor(jr.prototype,"setAudioFrameCallback"),jr.prototype),Te(jr.prototype,"play",[iD],Object.getOwnPropertyDescriptor(jr.prototype,"play"),jr.prototype),Te(jr.prototype,"stop",[V0],Object.getOwnPropertyDescriptor(jr.prototype,"stop"),jr.prototype),j0=jr))||j0),mh=(lB=kn("MicrophoneAudioTrack","getTrackId"),Q0=or(),dB=Mm("MicrophoneAudioTrack","_enabledMutex"),e7=Bc({className:"MicrophoneAudioTrack"}),t7=or(),lB((Te((Ah=class extends Li{constructor(t,i,o,s){super(t,i.encoderConfig?x1(i.encoderConfig):{},s,J("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),b(this,"_config",void 0),b(this,"_deviceName","default"),b(this,"_constraints",void 0),b(this,"_originalConstraints",void 0),b(this,"_enabled",!0),Ke("info",this,"constructor",{trackId:s,deviceId:t.label,constraints:o}),this._config=i,this._constraints=o,this._originalConstraints=o,this._deviceName=t.label,"boolean"==typeof i.bypassWebAudio&&(this._bypassWebAudio=i.bypassWebAudio),Zd()&&_t.bindInterruptDetectorTrack(this),this.bindProcessorContextEvents()}setDevice(t){var i=this;return U(function*(){const o=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.MIC_AUDIO_TRACK_SET_DEVICE,options:[i.getTrackId(),t]});if(N.info("[".concat(i.getTrackId(),"] start set device to ").concat(t)),le("info",i,"setDevice",t),i._enabled)try{const s=yield to.getDeviceById(t),c={};c.audio=W0({},i._constraints),c.audio.deviceId={exact:t},i._originMediaStreamTrack.stop();let l=null;try{l=yield vo(c,i.getTrackId())}catch(p){throw N.error("[".concat(i.getTrackId(),"] setDevice failed"),p.toString()),le("error",i,"setDevice",t,p.toString()),l=yield vo({video:i._constraints},i.getTrackId()),yield i._updateOriginMediaStreamTrack(l.getAudioTracks()[0],!1),p}yield i._updateOriginMediaStreamTrack(l.getAudioTracks()[0],!1),i._deviceName=s.label,i._config.microphoneId=t,i._constraints.deviceId={exact:t}}catch(s){throw o.onError(s),N.error("[".concat(i.getTrackId(),"] setDevice error"),s.toString()),le("error",i,"setDevice",t,s.toString()),s}else try{const s=yield to.getDeviceById(t);i._deviceName=s.label,i._config.microphoneId=t,i._constraints.deviceId={exact:t}}catch(s){throw o.onError(s),N.error("[".concat(i.getTrackId(),"] setDevice error"),s.toString()),le("error",i,"setDevice",t,s.toString()),s}o.onSuccess(),N.info("[".concat(i.getTrackId(),"] set device to ").concat(t," success")),le("info",i,"setDevice",t,"success")})()}setEnabled(t,i,o){var s=()=>super._setEnabled,c=this;return U(function*(){if(i)return N.debug("[".concat(c.getTrackId(),"] setEnabled false (do not close microphone)")),Re("debug",c,"setEnabled false (do not close microphone)"),yield s().call(c,t);if(!o){if(t===c._enabled)return;c.stateCheck("enabled",t)}if(N.info("[".concat(c.getTrackId(),"] start setEnabled"),t),le("info",c,"setEnabled",t),!t){var l;c._originMediaStreamTrack.onended=null,c._originMediaStreamTrack.stop(),null===(l=c._source.clonedTrack)||void 0===l||l.stop(),o||(c._enabled=!1);try{yield Hn(c,Qe.NEED_DISABLE_TRACK,c)}catch(g){throw N.error("[".concat(c.getTrackId(),"] setEnabled false failed"),g.toString()),le("error",c,"setEnabled",t,g.toString()),g}return}const p=W0({},c._constraints),h=to.searchDeviceIdByName(c._deviceName);h&&!p.deviceId&&(p.deviceId=h);try{o||(c._enabled=!0);const g=yield vo({audio:c._constraints},c.getTrackId());yield c._updateOriginMediaStreamTrack(g.getAudioTracks()[0],!1),yield Hn(c,Qe.NEED_ENABLE_TRACK,c)}catch(g){throw o||(c._enabled=!1),N.error("[".concat(c.getTrackId(),"] setEnabled true failed"),g.toString()),le("error",c,"setEnabled",t,g.toString()),g}N.info("[".concat(c.getTrackId(),"] setEnabled success")),le("info",c,"setEnabled",t,"success")})()}close(){super.close(),Zd()&&_t.unbindInterruptDetectorTrack(this)}onTrackEnded(){var t=this;if((Oo()||bl())&&this._enabled&&!this._isClosed&&_t.duringInterruption){const i=function(){var o=U(function*(){_t.off(Dr.IOS_INTERRUPTION_END,i),t._enabled&&!t._isClosed&&(N.debug("[".concat(t.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),Re("debug",t,"try capture microphone media device for interrupted iOS device"),yield t.setEnabled(!1),yield t.setEnabled(!0))});return function(){return o.apply(this,arguments)}}();_t.on(Dr.IOS_INTERRUPTION_END,i)}else N.debug("[".concat(this.getTrackId(),"] track ended")),Po("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(Bu.TRACK_ENDED)}renewMediaStreamTrack(t){var i=this;return U(function*(){const o=t||i._constraints,s=to.searchDeviceIdByName(i._deviceName);if(s&&!o.deviceId&&(o.deviceId=s),i._constraints=o,i._enabled){i._originMediaStreamTrack.stop();const c=yield vo({audio:i._constraints},i.getTrackId());yield i._updateOriginMediaStreamTrack(c.getAudioTracks()[0],!0)}})()}bindProcessorContextEvents(){var t=this;this.processorContext.on(Tr.REQUEST_UPDATE_CONSTRAINTS,function(){var i=U(function*(o,s,c){try{const l=Object.assign({},t._originalConstraints,...o);yield t.renewMediaStreamTrack(l),s()}catch(l){c(l)}});return function(o,s,c){return i.apply(this,arguments)}}()),this.processorContext.on(Tr.REQUEST_CONSTRAINTS,function(){var i=U(function*(o){o(t._originMediaStreamTrack.getSettings())});return function(o){return i.apply(this,arguments)}}())}}).prototype,"setDevice",[Q0],Object.getOwnPropertyDescriptor(Ah.prototype,"setDevice"),Ah.prototype),Te(Ah.prototype,"setEnabled",[dB,e7,t7],Object.getOwnPropertyDescriptor(Ah.prototype,"setEnabled"),Ah.prototype),hB=Ah))||hB),c7=(n7=kn("BufferSourceAudioTrack","getTrackId"),r7=or(),pB=or(),fB=or(),gB=or(),AB=or(),n7((Te((jn=class extends Li{constructor(t,i,o,s){super(i.createOutputTrack(),o,s),b(this,"source",void 0),b(this,"_bufferSource",void 0),Ke("info",this,"constructor",{trackId:s}),this.source=t,this._bufferSource=i,this._bufferSource.on(go.AUDIO_SOURCE_STATE_CHANGE,c=>{this.emit(Bu.SOURCE_STATE_CHANGE,c)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(t){const i=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.BUFFER_AUDIO_TRACK_START,options:[this.getTrackId(),t,this.duration]});t&&this._bufferSource.updateOptions(t),this._bufferSource.startProcessAudioBuffer(),i.onSuccess()}pauseProcessAudioBuffer(){const t=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.BUFFER_AUDIO_TRACK_PAUSE,options:[this.getTrackId()]});this._bufferSource.pauseProcessAudioBuffer(),t.onSuccess()}seekAudioBuffer(t){const i=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.BUFFER_AUDIO_TRACK_SEEK,options:[this.getTrackId()]});this._bufferSource.seekAudioBuffer(t),i.onSuccess()}resumeProcessAudioBuffer(){const t=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.BUFFER_AUDIO_TRACK_RESUME,options:[this.getTrackId()]});this._bufferSource.resumeProcessAudioBuffer(),t.onSuccess()}stopProcessAudioBuffer(){const t=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.BUFFER_AUDIO_TRACK_STOP,options:[this.getTrackId()]});this._bufferSource.stopProcessAudioBuffer(),t.onSuccess()}}).prototype,"startProcessAudioBuffer",[r7],Object.getOwnPropertyDescriptor(jn.prototype,"startProcessAudioBuffer"),jn.prototype),Te(jn.prototype,"pauseProcessAudioBuffer",[pB],Object.getOwnPropertyDescriptor(jn.prototype,"pauseProcessAudioBuffer"),jn.prototype),Te(jn.prototype,"seekAudioBuffer",[fB],Object.getOwnPropertyDescriptor(jn.prototype,"seekAudioBuffer"),jn.prototype),Te(jn.prototype,"resumeProcessAudioBuffer",[gB],Object.getOwnPropertyDescriptor(jn.prototype,"resumeProcessAudioBuffer"),jn.prototype),Te(jn.prototype,"stopProcessAudioBuffer",[AB],Object.getOwnPropertyDescriptor(jn.prototype,"stopProcessAudioBuffer"),jn.prototype),mB=jn))||mB),Ln=kn("MixingAudioTrack","getTrackId")(oD=class extends Li{get isActive(){for(const t of this.trackList)if(t._enabled&&!t._isClosed&&!t.muted)return!0;return!1}constructor(){const t=wf().createMediaStreamDestination();super(t.stream.getAudioTracks()[0],void 0,xn(8,"track-mix-")),b(this,"trackList",void 0),b(this,"destNode",void 0);try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=t,this.trackList=[]}hasAudioTrack(t){return-1!==this.trackList.indexOf(t)}addAudioTrack(t){if(-1!==this.trackList.indexOf(t))return N.debug("track ".concat(t.getTrackId()," is already added")),void Re("debug",this,"track already added");N.debug("add ".concat(t.getTrackId()," to mixing track")),le("debug",this,"addAudioTrack",t.getTrackId()),t._source.outputNode.connect(this.destNode),this.trackList.push(t),this.updateEncoderConfig()}removeAudioTrack(t){if(-1!==this.trackList.indexOf(t)){N.debug("remove ".concat(t.getTrackId()," from mixing track")),le("debug",this,"removeAudioTrack",t.getTrackId());try{t._source.outputNode.disconnect(this.destNode)}catch{}lD(this.trackList,t),this.updateEncoderConfig()}}updateEncoderConfig(){const t={};this.trackList.forEach(i=>{i._encoderConfig&&((i._encoderConfig.bitrate||0)>(t.bitrate||0)&&(t.bitrate=i._encoderConfig.bitrate),(i._encoderConfig.sampleRate||0)>(t.sampleRate||0)&&(t.sampleRate=i._encoderConfig.sampleRate),(i._encoderConfig.sampleSize||0)>(t.sampleSize||0)&&(t.sampleSize=i._encoderConfig.sampleSize),i._encoderConfig.stereo&&(t.stereo=!0))}),this._encoderConfig=t}})||oD;class cD extends En{constructor(){super(...arguments),b(this,"resultStorage",new Map)}setLocalAudioStats(i,o,s){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",i,this.checkAudioInputLevel(s,o)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",i,this.checkSendAudioBitrate(s,o))}setLocalVideoStats(i,o,s){this.record("SEND_VIDEO_BITRATE_TOO_LOW",i,this.checkSendVideoBitrate(s,o)),this.record("FRAMERATE_INPUT_TOO_LOW",i,this.checkFramerateInput(s,o)),this.record("FRAMERATE_SENT_TOO_LOW",i,this.checkFramerateSent(s))}setRemoteAudioStats(i,o){const s=i.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",s,this.checkAudioOutputLevel(o))}setRemoteVideoStats(i,o){const s=i.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",s,this.checkVideoDecode(o))}record(i,o,s){this.resultStorage.has(i)||this.resultStorage.set(i,{result:[],isPrevNormal:!0});const c=this.resultStorage.get(i);if(c&&(c.result.push(s),c.result.length>=5)){const l=c.result.includes(!0);c.isPrevNormal&&!l&&this.emit("exception",bB[i],i,o),!c.isPrevNormal&&l&&this.emit("exception",bB[i]+2e3,i+"_RECOVER",o),c.isPrevNormal=l,c.result=[]}}checkAudioOutputLevel(i){return!(i.receiveBitrate>0&&0===i.receiveLevel)}checkAudioInputLevel(i,o){return o instanceof Ln&&!o.isActive||!!o.muted||0!==i.sendVolumeLevel}checkFramerateInput(i,o){let s=null;o._encoderConfig&&o._encoderConfig.frameRate&&(s=Qu(o._encoderConfig.frameRate));const c=i.captureFrameRate;return!s||!c||!(s>10&&c<5||s<10&&s>=5&&c<=1)}checkFramerateSent(i){return!(i.captureFrameRate&&i.sendFrameRate&&i.captureFrameRate>5&&i.sendFrameRate<=1)}checkSendVideoBitrate(i,o){return!!o.muted||0!==i.sendBitrate}checkSendAudioBitrate(i,o){return o instanceof Ln&&!o.isActive||!!o.muted||0!==i.sendBitrate}checkVideoDecode(i){return 0===i.receiveBitrate||0!==i.decodeFrameRate}}const bB={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},Uo=new class{markSubscribeStart(t,i){performance.mark("agora-web-sdk/".concat(t,"/subscribe-").concat(i))}markPublishStart(t,i){performance.mark("agora-web-sdk/".concat(t,"/publish-").concat(i))}measureFromSubscribeStart(t,i){const o=performance.getEntriesByName("agora-web-sdk/".concat(t,"/subscribe-").concat(i));if(o.length>0){const s=o[o.length-1];return Math.round(performance.now()-s.startTime)}return 0}measureFromPublishStart(t,i){const o=performance.getEntriesByName("agora-web-sdk/".concat(t,"/publish-").concat(i));if(o.length>0){const s=o[o.length-1];return Math.round(performance.now()-s.startTime)}return 0}};function TB(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function Fl(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?TB(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):TB(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}class _h{constructor(i){b(this,"store",void 0),b(this,"onStatsException",void 0),b(this,"onUploadPublishDuration",void 0),b(this,"localStats",new Map),b(this,"remoteStats",new Map),b(this,"updateStatsInterval",void 0),b(this,"trafficStats",void 0),b(this,"trafficStatsPeerList",[]),b(this,"uplinkStats",void 0),b(this,"exceptionMonitor",void 0),b(this,"p2pChannel",void 0),b(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=i,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new cD,this.exceptionMonitor.on("exception",(o,s,c)=>{this.onStatsException&&this.onStatsException(o,s,c)})}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(Pe.LocalAudioTrack)||Fl({},Lu)}getLocalVideoTrackStats(){return this.localStats.get(Pe.LocalVideoTrack)||Fl({},pm)}getRemoteAudioTrackStats(i){const o=(l,p)=>{if(!this.trafficStats)return p;const h=this.trafficStats.peer_delay.find(g=>g.peer_uid===l);return h&&(p.publishDuration=h.B_ppad+(Date.now()-this.trafficStats.timestamp)),p},s={};if(i){var c;const l=null===(c=this.remoteStats.get(i))||void 0===c?void 0:c.audioStats;l&&(s[i]=o(i,l))}else Array.from(this.remoteStats.entries()).forEach(l=>{let[p,{audioStats:h}]=l;h&&(s[p]=o(p,h))});return s}getRemoteNetworkQualityStats(i){const o={};if(i){var s;const c=null===(s=this.remoteStats.get(i))||void 0===s?void 0:s.networkStats;c&&(o[i]=c)}else Array.from(this.remoteStats.entries()).forEach(c=>{let[l,{networkStats:p}]=c;p&&(o[l]=p)});return o}getRemoteVideoTrackStats(i){const o=(l,p)=>{if(!this.trafficStats)return p;const h=this.trafficStats.peer_delay.find(g=>g.peer_uid===l);return h&&(p.publishDuration=h.B_ppvd+(Date.now()-this.trafficStats.timestamp)),p},s={};if(i){var c;const l=null===(c=this.remoteStats.get(i))||void 0===c?void 0:c.videoStats;l&&(s[i]=o(i,l))}else Array.from(this.remoteStats.entries()).forEach(l=>{let[p,{videoStats:h}]=l;h&&(s[p]=o(p,h))});return s}getRTCStats(){let i=0,o=0,s=0,c=0;const l=this.localStats.get(Pe.LocalAudioTrack);l&&(i+=l.sendBytes,o+=l.sendBitrate);const p=this.localStats.get(Pe.LocalVideoTrack);p&&(i+=p.sendBytes,o+=p.sendBitrate);const h=this.localStats.get(Pe.LocalVideoLowTrack);h&&(i+=h.sendBytes,o+=h.sendBitrate),this.remoteStats.forEach(f=>{let{audioStats:A,videoStats:_}=f;A&&(s+=A.receiveBytes,c+=A.receiveBitrate),_&&(s+=_.receiveBytes,c+=_.receiveBitrate)});let g=1;return this.trafficStats&&(g+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:g,SendBitrate:o,SendBytes:i,RecvBytes:s,RecvBitrate:c,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(i){this.localStats.set(i,void 0)}removeLocalStats(i){i?this.localStats.delete(i):this.localStats.clear()}addRemoteStats(i){this.remoteStats.set(i,{})}removeRemoteStats(i){i?this.remoteStats.delete(i):this.remoteStats.clear()}addP2PChannel(i){this.p2pChannel=i}updateTrafficStats(i){i.peer_delay=i.peer_delay.filter(o=>void 0!==o.B_ppad||void 0!==o.B_ppvd),i.peer_delay.filter(o=>-1===this.trafficStatsPeerList.indexOf(o.peer_uid)).forEach(o=>{var s;const c=null===(s=this.p2pChannel)||void 0===s?void 0:s.getRemoteMedia(o.peer_uid),l=null!=c&&c.videoSSRC?Uo.measureFromSubscribeStart(this.store.clientId,c.videoSSRC):0,p=null!=c&&c.audioSSRC?Uo.measureFromSubscribeStart(this.store.clientId,c.audioSSRC):0;void 0!==o.B_ppad&&void 0!==o.B_ppvd&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(o.peer_uid,o.B_ppad,o.B_ppvd,l>p?l:p),this.trafficStatsPeerList.push(o.peer_uid))}),this.trafficStats=i}updateUplinkStats(i){this.uplinkStats&&this.uplinkStats.B_fir!==i.B_fir&&N.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(i.B_fir)),this.uplinkStats=i}static isRemoteVideoFreeze(i,o,s){return!!i&&(!!s&&o.framesDecodeFreezeTime>s.framesDecodeFreezeTime||!(!s||o.framesDecodeCount>s.framesDecodeCount))}static isRemoteAudioFreeze(i){return!!i&&i._isFreeze()}isLocalVideoFreeze(i){return!(!i.inputFrame||!i.sentFrame)&&i.inputFrame.frameRate>5&&i.sentFrame.frameRate<3}updateLocalStats(i){Array.from(this.localStats.entries()).forEach(o=>{let[s,c]=o;switch(s){case Pe.LocalVideoTrack:case Pe.LocalVideoLowTrack:{const l=c,p=Fl({},pm),h=i.getStats(),g=i.getLocalMedia(s);if(h){const f=h.videoSend.find(A=>A.ssrc===g?.ssrcs[0].ssrcId);if(f){const A=i.getLocalVideoSize(),_=i.getEncoderConfig(Pe.LocalVideoTrack);"H264"!==f.codec&&"VP8"!==f.codec&&"VP9"!==f.codec&&"AV1X"!==f.codec&&"AV1"!==f.codec||(p.codecType=f.codec),p.sendBytes=f.bytes,p.sendBitrate=l?8*Math.max(0,p.sendBytes-l.sendBytes):0,f.inputFrame?(p.captureFrameRate=f.inputFrame.frameRate,p.captureResolutionHeight=f.inputFrame.height,p.captureResolutionWidth=f.inputFrame.width):A&&(p.captureResolutionWidth=A.width,p.captureResolutionHeight=A.height),f.sentFrame?(p.sendFrameRate=f.sentFrame.frameRate,p.sendResolutionHeight=f.sentFrame.height,p.sendResolutionWidth=f.sentFrame.width):A&&(p.sendResolutionWidth=A.width,p.sendResolutionHeight=A.height),f.avgEncodeMs&&(p.encodeDelay=f.avgEncodeMs),_&&_.bitrateMax&&(p.targetSendBitrate=1e3*_.bitrateMax),p.sendPackets=f.packets,p.sendPacketsLost=f.packetsLost,p.totalDuration=l?l.totalDuration+1:1,p.totalFreezeTime=l?l.totalFreezeTime:0,this.isLocalVideoFreeze(f)&&(p.totalFreezeTime+=1)}this.trafficStats&&(p.sendPacketsLost=this.trafficStats.B_pvlr4/100)}this.localStats.set(s,p),p&&g&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,g.track,p);break}case Pe.LocalAudioTrack:{const l=c,p=Fl({},Lu),h=i.getStats(),g=i.getLocalMedia(s);if(h){const f=h.audioSend.find(A=>A.ssrc===g?.ssrcs[0].ssrcId);if(f){if("opus"!==f.codec&&"aac"!==f.codec&&"PCMU"!==f.codec&&"PCMA"!==f.codec&&"G722"!==f.codec||(p.codecType=f.codec),f.inputLevel)p.sendVolumeLevel=Math.round(32767*f.inputLevel);else{const A=i.getLocalAudioVolume();A&&(p.sendVolumeLevel=Math.round(32767*A))}p.sendBytes=f.bytes,p.sendPackets=f.packets,p.sendPacketsLost=f.packetsLost,p.sendBitrate=l?8*Math.max(0,p.sendBytes-l.sendBytes):0}}this.trafficStats&&(p.sendPacketsLost=this.trafficStats.B_pvlr4/100),this.localStats.set(Pe.LocalAudioTrack,p),p&&g&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,g.track,p);break}}})}updateRemoteStats(i){Array.from(this.remoteStats.entries()).forEach(o=>{let[s,{videoStats:c,audioStats:l,videoPcStats:p}]=o;const h=l,g=c,f=p,A=Fl({},yj),_=Fl({},pL),v=Fl({},Ij),{audioTrack:y,videoTrack:S,audioSSRC:R,videoSSRC:D}=i.getRemoteMedia(s),O=i.getStats(),P=O?.audioRecv.find(Y=>Y.ssrc===R),B=O?.videoRecv.find(Y=>Y.ssrc===D),G=this.trafficStats&&this.trafficStats.peer_delay.find(Y=>Y.peer_uid===s);if(P&&("opus"!==P.codec&&"aac"!==P.codec&&"PCMU"!==P.codec&&"PCMA"!==P.codec&&"G722"!==P.codec||(A.codecType=P.codec),P.outputLevel?A.receiveLevel=Math.round(32767*P.outputLevel):y&&(A.receiveLevel=Math.round(32767*y.getVolumeLevel())),A.receiveBytes=P.bytes,A.receivePackets=P.packets,A.receivePacketsLost=P.packetsLost,A.packetLossRate=A.receivePacketsLost/(A.receivePackets+A.receivePacketsLost),A.receiveBitrate=h?8*Math.max(0,A.receiveBytes-h.receiveBytes):0,A.totalDuration=h?h.totalDuration+1:1,A.totalFreezeTime=h?h.totalFreezeTime:0,A.freezeRate=A.totalFreezeTime/A.totalDuration,A.receiveDelay=P.jitterBufferMs,A.totalDuration>10&&_h.isRemoteAudioFreeze(y)&&(A.totalFreezeTime+=1)),B){"H264"!==B.codec&&"VP8"!==B.codec&&"VP9"!==B.codec&&"AV1X"!==B.codec&&"AV1"!==B.codec||(_.codecType=B.codec),_.receiveBytes=B.bytes,_.receiveBitrate=g?8*Math.max(0,_.receiveBytes-g.receiveBytes):0,_.decodeFrameRate=B.decodeFrameRate<0?0:B.decodeFrameRate,_.renderFrameRate=B.decodeFrameRate<0?0:B.decodeFrameRate,B.outputFrame&&(_.renderFrameRate=B.outputFrame.frameRate),B.receivedFrame?(_.receiveFrameRate=B.receivedFrame.frameRate,_.receiveResolutionHeight=B.receivedFrame.height,_.receiveResolutionWidth=B.receivedFrame.width):S&&(_.receiveResolutionHeight=S._videoHeight||0,_.receiveResolutionWidth=S._videoWidth||0),void 0!==B.framesRateFirefox&&(_.receiveFrameRate=Math.round(B.framesRateFirefox)),_.receivePackets=B.packets,_.receivePacketsLost=B.packetsLost,_.packetLossRate=_.receivePacketsLost/(_.receivePackets+_.receivePacketsLost),_.totalDuration=g?g.totalDuration+1:1,_.totalFreezeTime=g?g.totalFreezeTime:0,_.receiveDelay=B.jitterBufferMs||0;const Y=!!D&&i.getRemoteVideoIsReady(D);S&&Y&&_h.isRemoteVideoFreeze(S,B,f)&&(_.totalFreezeTime+=1),_.freezeRate=_.totalFreezeTime/_.totalDuration}G&&(A.end2EndDelay=G.B_ad,_.end2EndDelay=G.B_vd,A.transportDelay=G.B_ed,_.transportDelay=G.B_ed,A.currentPacketLossRate=G.B_ealr4/100,_.currentPacketLossRate=G.B_evlr4/100,v.uplinkNetworkQuality=G.B_punq?G.B_punq:0,v.downlinkNetworkQuality=G.B_pdnq?G.B_pdnq:0),this.remoteStats.set(s,{audioStats:A,videoStats:_,videoPcStats:B,networkStats:v}),y&&this.exceptionMonitor.setRemoteAudioStats(y,A),S&&this.exceptionMonitor.setRemoteVideoStats(S,_)})}}function RB(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function K0(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?RB(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):RB(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}function Eh(t){return t.match(/^[\.\:\d]+$/)?"".concat(t.replace(/[^\d]/g,"-"),".").concat(J("TURN_DOMAIN")):(N.info("Cannot recognized as IP address ".concat(t,". Used As Host instead")),t)}function Ya(t,i){var o,s;const c=J("GATEWAY_DOMAINS");let l=c[1]&&-1!==i.indexOf(c[1])?1:0;t.addresses=t.addresses||[];const p=t.addresses.map(g=>g.domain_prefix?{address:"".concat(g.domain_prefix,".").concat(c[l++%c.length],":").concat(g.port)}:g.ip.match(/^[\.\:\d]+$/)?{ip:g.ip,port:g.port,address:"".concat(g.ip.replace(/[^\d]/g,"-"),".").concat(c[l++%c.length],":").concat(g.port)}:(N.info("Cannot recognized as IP address ".concat(g.ip,". Used As Host instead")),{ip:g.ip,port:g.port,address:"".concat(g.ip,":").concat(g.port)}));if(null!==(o=t.detail)&&void 0!==o&&o[18]&&"string"==typeof(null===(s=t.detail)||void 0===s?void 0:s[18])){const f=t.detail[18]?.split(";");for(let A=0;A<f.length;A++){var h;const _=Ba(h=f[A]).call(h);p[A]&&_&&(p[A].ip6=_)}}return{gatewayAddrs:p,uid:t.uid,cid:t.cid,cert:t.cert,vid:t.detail&&t.detail[8],uni_lbs_ip:t.detail&&t.detail[1],res:t,csIp:t.detail&&t.detail[502]}}function Qu(t){return"number"==typeof t?t:t.exact||t.ideal||t.max||t.min||0}function uD(t){const i=t._encoderConfig;if(!i)return{};const o={resolution:i.width&&i.height?"".concat(Qu(i.width),"x").concat(Qu(i.height)):void 0,maxVideoBW:i.bitrateMax,minVideoBW:i.bitrateMin};return"number"==typeof i.frameRate?(o.maxFrameRate=i.frameRate,o.minFrameRate=i.frameRate):i.frameRate&&(o.maxFrameRate=i.frameRate.max||i.frameRate.ideal||i.frameRate.exact||i.frameRate.min,o.minFrameRate=i.frameRate.min||i.frameRate.ideal||i.frameRate.exact||i.frameRate.max),o}function rs(t,i,o){var s;const c=i.videoSend.find(h=>h.ssrc===t);if(!c)return null;const l=null==o||null===(s=o.videoSend.find(h=>h.ssrc===t))||void 0===s?void 0:s.inputFrame,p={id:xn(10,""),timestamp:new Date(i.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:c.ssrc.toString()};return c.inputFrame&&(l&&c.inputFrame.height===l.height||(p.A_fhi=c.inputFrame.height?c.inputFrame.height.toString():"0"),l&&c.inputFrame.width===l.width||(p.A_fwi=c.inputFrame.width?c.inputFrame.width.toString():"0"),l&&c.inputFrame.frameRate===l.frameRate||(p.A_fri=c.inputFrame.frameRate?c.inputFrame.frameRate.toString():"0")),p}function sa(t){return t>=0&&t<.17?1:t>=.17&&t<.36?2:t>=.36&&t<.59?3:t>=.59&&t<=1?4:t>1?5:0}function Rs(t,i){let o,s,c;switch(i){case Rr.CHOOSE_SERVER:o=4096,s="choose server";break;case Rr.CLOUD_PROXY:o=1048576,s="proxy";break;case Rr.CLOUD_PROXY_5:o=4194304,s="proxy5";break;case Rr.CLOUD_PROXY_FALLBACK:o=4194310,s="proxy fallback";break;default:throw new V(L.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:t.detail&&t.detail[502],retry:!1})}if(t.response_body.forEach(l=>{l.buffer&&l.buffer.flag===o&&(c={code:l.buffer.code,addresses:(l.buffer.edges_services||[]).map(p=>K0(K0({},p),{},{ticket:l.buffer.cert})),server_ts:t.enter_ts,uid:l.buffer.uid,cid:l.buffer.cid,cname:l.buffer.cname,detail:K0(K0({},l.buffer.detail),t.detail),flag:l.buffer.flag,opid:t.opid,cert:l.buffer.cert})}),!c)throw new V(L.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(s," from multi unilbs response"),{csIp:t.detail&&t.detail[502]});return c}function Ds(t,i){return xm.apply(this,arguments)}function xm(){return xm=U(function*(t,i){return yield Ie.all(t.addresses.map(function(){var o=U(function*(s){return{address:Eh(s.ip),tcpport:s.port,udpport:s.port,username:i&&J("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?i.toString():Ss.username,password:i&&J("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?yield QQ(i.toString()):Ss.password}});return function(s){return o.apply(this,arguments)}}()))}),xm.apply(this,arguments)}function Bm(t,i){const o=i._videoWidth||i.getMediaStreamTrack(!0).getSettings().width;return o||N.warning("cannot get original video track's width, default scale down 4 times for low stream"),o?o/Qu(t.width):4}function ws(t){let{candidateType:i,relayProtocol:o,type:s,address:c,port:l,protocol:p}=t;return"local-candidate"===s?{candidateType:i,relayProtocol:o,protocol:p}:{candidateType:i,relayProtocol:o,address:c,port:l,protocol:p}}function Of(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function vh(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?Of(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Of(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}function Ch(t){return window.TextEncoder?(new TextEncoder).encode(t).length:t.length}function Ar(t){return new Ie(i=>{window.setTimeout(i,t)})}function u7(t){const i=new V(L.TIMEOUT,"timeout");return new Ie((o,s)=>{window.setTimeout(()=>s(i),t)})}function xn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,i=arguments.length>1?arguments[1]:void 0;const o=Math.random().toString(16).substr(2,t).toLowerCase();return o.length===t?"".concat(i).concat(o):"".concat(i).concat(o)+xn(t-o.length,"")}function Y0(){return xn(32,"").toUpperCase()}const q0=()=>{};function DB(t){return new Ie((i,o)=>{let s=!1;const c=document.createElement("video");c.setAttribute("autoplay",""),c.setAttribute("muted",""),c.muted=!0,c.autoplay=!0,c.setAttribute("playsinline",""),c.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(c);const l=Oo()?"canplay":"playing";c.addEventListener(l,()=>{const p=c.videoWidth,h=c.videoHeight;!p&&bn()||(s=!0,c.srcObject=null,c.remove(),i([p,h]))}),c.srcObject=new MediaStream([t]),c.play().catch(q0),setTimeout(()=>{s||(c.srcObject=null,c.remove(),i([c.videoWidth,c.videoHeight]))},4e3)})}function Pf(t){return Ie.all(t.map(i=>i.then(o=>{throw o},o=>o))).then(i=>{throw i},i=>i)}function yi(t,i){for(var o=arguments.length,s=new Array(o>2?o-2:0),c=2;c<o;c++)s[c-2]=arguments[c];return 0===t.getListeners(i).length?Ie.reject(new V(L.UNEXPECTED_ERROR,"can not emit promise")):new Ie((l,p)=>{t.emit(i,...s,l,p)})}function Hn(t,i){if(0===t.getListeners(i).length)return Ie.resolve();for(var o=arguments.length,s=new Array(o>2?o-2:0),c=2;c<o;c++)s[c-2]=arguments[c];return yi(t,i,...s)}function Uc(t,i){if(0===t.getListeners(i).length)return null;for(var o=arguments.length,s=new Array(o>2?o-2:0),c=2;c<o;c++)s[c-2]=arguments[c];return yh(t,i,...s)}function yh(t,i){let o=null,s=null;for(var c=arguments.length,l=new Array(c>2?c-2:0),p=2;p<c;p++)l[p-2]=arguments[p];if(t.emit(i,...l,h=>{o=h},h=>{s=h}),null!==s)throw s;if(null===o)throw new V(L.UNEXPECTED_ERROR,"handler is not sync");return o}function lD(t,i){const o=t.indexOf(i);-1!==o&&t.splice(o,1)}function wB(t){const i=[];return t.forEach(o=>{-1===i.indexOf(o)&&i.push(o)}),i}function Ns(t){Ie.resolve().then(t)}function en(t){return JSON.parse(JSON.stringify(t))}const Ul={};function Co(t,i){Ul[i]||(Ul[i]=!0,t())}function Fm(t){const i=window.atob(t),o=new Uint8Array(new ArrayBuffer(i.length));for(let s=0;s<i.length;s+=1)o[s]=i.charCodeAt(s);return o}function qa(t){let i="";for(let o=0;o<t.length;o+=1)i+=String.fromCharCode(t[o]);return window.btoa(i)}const Vl=new class{constructor(){b(this,"fnMap",new Map)}throttleByKey(t,i,o,s){for(var c=arguments.length,l=new Array(c>4?c-4:0),p=4;p<c;p++)l[p-4]=arguments[p];if(this.fnMap.has(i)){const h=this.fnMap.get(i);if(h.threshold!==o){h.fn(...h.args),clearTimeout(h.timer);const g=window.setTimeout(()=>{const f=this.fnMap.get(i);f&&f.fn(...f.args),this.fnMap.delete(i)},o);this.fnMap.set(i,{fn:t,threshold:o,timer:g,args:l,skipFn:s})}else h.skipFn&&h.skipFn(...h.args),this.fnMap.set(i,vh(vh({},h),{},{fn:t,args:l,skipFn:s}))}else{const h=window.setTimeout(()=>{const g=this.fnMap.get(i);g&&g.fn(...g.args),this.fnMap.delete(i)},o);this.fnMap.set(i,{fn:t,threshold:o,timer:h,args:l,skipFn:s})}}},Um=Vl.throttleByKey.bind(Vl),Vc=function(){var t=U(function*(i){let{fragementLength:o,referenceList:s,asyncMapHandler:c,allFailedhandler:l,promisesCollector:p}=i,h=0;const g=o;let f,A=0;const _=function(){var v=U(function*(){const y=(()=>{const S=h*g;return s.slice(S,S+g).map(c)})();p&&p.push(...y);try{f=yield Pf(y)}catch(S){if(A+=g,h++,!(A>=s.length))return void(yield _());l(S)}y.forEach(S=>S.cancel())});return function(){return v.apply(this,arguments)}}();return yield _(),f});return function(o){return t.apply(this,arguments)}}();function J0(t){return"object"==typeof t&&null!==t&&!(t instanceof RegExp)}var NB=Cr,Mf=Jr("iterator"),z0=!NB(function(){var t=new URL("b?a=1&b=2&c=3","http://a"),i=t.searchParams,o="";return t.pathname="c%20d",i.forEach(function(s,c){i.delete("b"),o+=c+s}),!t.toJSON||!i.sort||"http://a/c%20d?a=1&c=3"!==t.href||"3"!==i.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!i[Mf]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("http://a#\u0431").hash||"a1c3"!==o||"x"!==new URL("http://x",void 0).host}),$0=ve,Gu=an,d7=Cr,aa=RE,X0=Xg,dD=qr,OB=su,Vm=Eg,kf=Object.assign,hD=Object.defineProperty,h7=nr([].concat),jm=!kf||d7(function(){if($0&&1!==kf({b:1},kf(hD({},"a",{enumerable:!0,get:function(){hD(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},i={},o=Symbol(),s="abcdefghijklmnopqrst";return t[o]=7,s.split("").forEach(function(c){i[c]=c}),7!=kf({},t)[o]||aa(kf({},i)).join("")!=s})?function(t,i){for(var o=OB(t),s=arguments.length,c=1,l=X0.f,p=dD.f;s>c;)for(var h,g=Vm(arguments[c++]),f=l?h7(aa(g),l(g)):aa(g),A=f.length,_=0;A>_;)h=f[_++],$0&&!Gu(p,g,h)||(o[h]=g[h]);return o}:kf,PB=Ro,pD=BE,p7=cu,MB=an,f7=su,g7=function(t,i,o,s){try{return s?i(PB(o)[0],o[1]):i(o)}catch(c){pD(t,"throw",c)}},Lf=eA,fD=mu,kB=dc,gD=F1,LB=LE,xB=ME,Z0=Dt.Array,Ih=nr,AD=2147483647,A7=/[^\0-\u007E]/,BB=/[.\u3002\uFF0E\uFF61]/g,FB="Overflow: input needs wider integers to process",xf=Dt.RangeError,m7=Ih(BB.exec),jl=Math.floor,mD=String.fromCharCode,UB=Ih("".charCodeAt),VB=Ih([].join),Ql=Ih([].push),_7=Ih("".replace),E7=Ih("".split),v7=Ih("".toLowerCase),jB=function(t){return t+22+75*(t<26)},C7=function(t,i,o){var s=0;for(t=o?jl(t/700):t>>1,t+=jl(t/i);t>455;)t=jl(t/35),s+=36;return jl(s+36*t/(t+38))},y7=function(t){var i,o,s=[],c=(t=function(O){for(var P=[],B=0,G=O.length;B<G;){var Y=UB(O,B++);if(Y>=55296&&Y<=56319&&B<G){var ae=UB(O,B++);56320==(64512&ae)?Ql(P,((1023&Y)<<10)+(1023&ae)+65536):(Ql(P,Y),B--)}else Ql(P,Y)}return P}(t)).length,l=128,p=0,h=72;for(i=0;i<t.length;i++)(o=t[i])<128&&Ql(s,mD(o));var g=s.length,f=g;for(g&&Ql(s,"-");f<c;){var A=AD;for(i=0;i<t.length;i++)(o=t[i])>=l&&o<A&&(A=o);var _=f+1;if(A-l>jl((AD-p)/_))throw xf(FB);for(p+=(A-l)*_,l=A,i=0;i<t.length;i++){if((o=t[i])<l&&++p>AD)throw xf(FB);if(o==l){for(var v=p,y=36;;){var S=y<=h?1:y>=h+26?26:y-h;if(v<S)break;var R=v-S,D=36-S;Ql(s,mD(jB(S+R%D))),v=jl(R/D),y+=36}Ql(s,mD(jB(v))),h=C7(p,_,f==g),p=0,f++}}p++,l++}return VB(s,"")},I7=Dt.TypeError,_D=ei,eC=Dt,ED=Ws,vD=an,Hu=nr,CD=z0,yD=fp,S7=Pn,uY=gu,tC=ev,ID=xd,QB=nS,SD=Si,b7=qi,T7=cu,R7=gc,GB=Ro,HB=ds,Os=Md,D7=Zg,WB=Ad,KB=LE,w7=ME,Bf=function(t,i){if(t<i)throw I7("Not enough arguments");return t},N7=nL,O7=Jr("iterator"),nC="URLSearchParams",YB="URLSearchParamsIterator",qB=ID.set,Ja=ID.getterFor(nC),P7=ID.getterFor(YB),JB=ED("fetch"),rC=ED("Request"),Qm=ED("Headers"),zB=rC&&rC.prototype,iC=Qm&&Qm.prototype,M7=eC.RegExp,k7=eC.TypeError,$B=eC.decodeURIComponent,L7=eC.encodeURIComponent,x7=Hu("".charAt),B7=Hu([].join),Ff=Hu([].push),XB=Hu("".replace),lY=Hu([].shift),F7=Hu([].splice),ZB=Hu("".split),U7=Hu("".slice),V7=/\+/g,j7=Array(4),dY=function(t){return j7[t-1]||(j7[t-1]=M7("((?:%[\\da-f]{2}){"+t+"})","gi"))},hY=function(t){try{return $B(t)}catch{return t}},Q7=function(t){var i=XB(t,V7," "),o=4;try{return $B(i)}catch{for(;o;)i=XB(i,dY(o--),hY);return i}},pY=/[!'()~]|%20/g,G7={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},H7=function(t){return G7[t]},W7=function(t){return XB(L7(t),pY,H7)},e3=tC(function(t,i){qB(this,{type:YB,iterator:KB(Ja(t).entries),kind:i})},"Iterator",function(){var t=P7(this),i=t.kind,o=t.iterator.next(),s=o.value;return o.done||(o.value="keys"===i?s.key:"values"===i?s.value:[s.key,s.value]),o},!0),K7=function(t){this.entries=[],this.url=null,void 0!==t&&(HB(t)?this.parseObject(t):this.parseQuery("string"==typeof t?"?"===x7(t,0)?U7(t,1):t:Os(t)))};K7.prototype={type:nC,bindURL:function(t){this.url=t,this.update()},parseObject:function(t){var i,o,s,c,l,p,h,g=w7(t);if(g)for(o=(i=KB(t,g)).next;!(s=vD(o,i)).done;){if(l=(c=KB(GB(s.value))).next,(p=vD(l,c)).done||(h=vD(l,c)).done||!vD(l,c).done)throw k7("Expected sequence with length 2");Ff(this.entries,{key:Os(p.value),value:Os(h.value)})}else for(var f in t)b7(t,f)&&Ff(this.entries,{key:f,value:Os(t[f])})},parseQuery:function(t){if(t)for(var i,o,s=ZB(t,"&"),c=0;c<s.length;)(i=s[c++]).length&&(o=ZB(i,"="),Ff(this.entries,{key:Q7(lY(o)),value:Q7(B7(o,"="))}))},serialize:function(){for(var t,i=this.entries,o=[],s=0;s<i.length;)t=i[s++],Ff(o,W7(t.key)+"="+W7(t.value));return B7(o,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var bD=function(){QB(this,Gm),qB(this,new K7(arguments.length>0?arguments[0]:void 0))},Gm=bD.prototype;if(S7(Gm,{append:function(t,i){Bf(arguments.length,2);var o=Ja(this);Ff(o.entries,{key:Os(t),value:Os(i)}),o.updateURL()},delete:function(t){Bf(arguments.length,1);for(var i=Ja(this),o=i.entries,s=Os(t),c=0;c<o.length;)o[c].key===s?F7(o,c,1):c++;i.updateURL()},get:function(t){Bf(arguments.length,1);for(var i=Ja(this).entries,o=Os(t),s=0;s<i.length;s++)if(i[s].key===o)return i[s].value;return null},getAll:function(t){Bf(arguments.length,1);for(var i=Ja(this).entries,o=Os(t),s=[],c=0;c<i.length;c++)i[c].key===o&&Ff(s,i[c].value);return s},has:function(t){Bf(arguments.length,1);for(var i=Ja(this).entries,o=Os(t),s=0;s<i.length;)if(i[s++].key===o)return!0;return!1},set:function(t,i){Bf(arguments.length,1);for(var o,s=Ja(this),c=s.entries,l=!1,p=Os(t),h=Os(i),g=0;g<c.length;g++)(o=c[g]).key===p&&(l?F7(c,g--,1):(l=!0,o.value=h));l||Ff(c,{key:p,value:h}),s.updateURL()},sort:function(){var t=Ja(this);N7(t.entries,function(i,o){return i.key>o.key?1:-1}),t.updateURL()},forEach:function(t){for(var i,o=Ja(this).entries,s=T7(t,arguments.length>1?arguments[1]:void 0),c=0;c<o.length;)s((i=o[c++]).value,i.key,this)},keys:function(){return new e3(this,"keys")},values:function(){return new e3(this,"values")},entries:function(){return new e3(this,"entries")}},{enumerable:!0}),yD(Gm,O7,Gm.entries,{name:"entries"}),yD(Gm,"toString",function(){return Ja(this).serialize()},{enumerable:!0}),uY(bD,nC),_D({global:!0,forced:!CD},{URLSearchParams:bD}),!CD&&SD(Qm)){var Y7=Hu(iC.has),fY=Hu(iC.set),t3=function(t){if(HB(t)){var i,o=t.body;if(R7(o)===nC)return i=t.headers?new Qm(t.headers):new Qm,Y7(i,"content-type")||fY(i,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),D7(t,{body:WB(0,Os(o)),headers:WB(0,i)})}return t};if(SD(JB)&&_D({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return JB(t,arguments.length>1?t3(arguments[1]):{})}}),SD(rC)){var TD=function(t){return QB(this,zB),new rC(t,arguments.length>1?t3(arguments[1]):{})};zB.constructor=TD,TD.prototype=zB,_D({global:!0,forced:!0},{Request:TD})}}var ca,J7=ei,n3=ve,z7=z0,RD=Dt,r3=cu,ua=nr,$7=TE.f,oC=fp,X7=nS,DD=qi,wD=jm,Uf=function(t){var i=f7(t),o=fD(this),s=arguments.length,c=s>1?arguments[1]:void 0,l=void 0!==c;l&&(c=p7(c,s>2?arguments[2]:void 0));var p,h,g,f,A,_,v=xB(i),y=0;if(!v||this==Z0&&Lf(v))for(p=kB(i),h=o?new this(p):Z0(p);p>y;y++)_=l?c(i[y],y):i[y],gD(h,y,_);else for(A=(f=LB(i,v)).next,h=o?new this:[];!(g=MB(A,f)).done;y++)_=l?g7(f,c,[g.value,y],!0):g.value,gD(h,y,_);return h.length=y,h},za=NT,Z7=NS.codeAt,Wu=Md,t9=gu,o3={URLSearchParams:bD,getState:Ja},n9=xd.set,sC=xd.getterFor("URL"),r9=o3.URLSearchParams,i9=o3.getState,Hm=RD.URL,Wm=RD.TypeError,aC=RD.parseInt,o9=Math.floor,a3=Math.pow,la=ua("".charAt),$a=ua(/./.exec),Km=ua([].join),s9=ua(1..toString),a9=ua([].pop),Vf=ua([].push),c3=ua("".replace),c9=ua([].shift),u9=ua("".split),Ym=ua("".slice),ND=ua("".toLowerCase),gY=ua([].unshift),OD="Invalid scheme",jf="Invalid host",l9="Invalid port",d9=/[a-z]/i,AY=/[\d+-.a-z]/i,u3=/\d/,mY=/^0x/i,h9=/^[0-7]+$/,p9=/^\d+$/,f9=/^[\da-f]+$/i,_Y=/[\0\t\n\r #%/:<>?@[\\\]^|]/,g9=/[\0\t\n\r #/:<>?@[\\\]^|]/,A9=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,EY=/[\t\n\r]/g,cC=function(t){var i,o,s,c;if("number"==typeof t){for(i=[],o=0;o<4;o++)gY(i,t%256),t=o9(t/256);return Km(i,".")}if("object"==typeof t){for(i="",s=function(l){for(var p=null,h=1,g=null,f=0,A=0;A<8;A++)0!==l[A]?(f>h&&(p=g,h=f),g=null,f=0):(null===g&&(g=A),++f);return f>h&&(p=g,h=f),p}(t),o=0;o<8;o++)c&&0===t[o]||(c&&(c=!1),s===o?(i+=o?":":"::",c=!0):(i+=s9(t[o],16),o<7&&(i+=":")));return"["+i+"]"}return t},uC={},m9=wD({},uC,{" ":1,'"':1,"<":1,">":1,"`":1}),l3=wD({},m9,{"#":1,"?":1,"{":1,"}":1}),PD=wD({},l3,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Sh=function(t,i){var o=Z7(t,0);return o>32&&o<127&&!DD(i,t)?t:encodeURIComponent(t)},MD={ftp:21,file:null,http:80,https:443,ws:80,wss:443},qm=function(t,i){var o;return 2==t.length&&$a(d9,la(t,0))&&(":"==(o=la(t,1))||!i&&"|"==o)},d3=function(t){var i;return t.length>1&&qm(Ym(t,0,2))&&(2==t.length||"/"===(i=la(t,2))||"\\"===i||"?"===i||"#"===i)},vY=function(t){return"."===t||"%2e"===ND(t)},Qf={},_9={},kD={},lC={},jc={},Jm={},Gl={},LD={},xD={},BD={},h3={},FD={},Hl={},UD={},E9={},VD={},bh={},Qc={},p3={},Xa={},Qr={},jD=function(t,i,o){var s,c,l,p=Wu(t);if(i){if(c=this.parse(p))throw Wm(c);this.searchParams=null}else{if(void 0!==o&&(s=new jD(o,!0)),c=this.parse(p,null,s))throw Wm(c);(l=i9(new r9)).bindURL(this),this.searchParams=l}};jD.prototype={type:"URL",parse:function(t,i,o){var s,c,l,p,h,g=this,f=i||Qf,A=0,_="",v=!1,y=!1,S=!1;for(t=Wu(t),i||(g.scheme="",g.username="",g.password="",g.host=null,g.port=null,g.path=[],g.query=null,g.fragment=null,g.cannotBeABaseURL=!1,t=c3(t,A9,"")),t=c3(t,EY,""),s=Uf(t);A<=s.length;){switch(c=s[A],f){case Qf:if(!c||!$a(d9,c)){if(i)return OD;f=kD;continue}_+=ND(c),f=_9;break;case _9:if(c&&($a(AY,c)||"+"==c||"-"==c||"."==c))_+=ND(c);else{if(":"!=c){if(i)return OD;_="",f=kD,A=0;continue}if(i&&(g.isSpecial()!=DD(MD,_)||"file"==_&&(g.includesCredentials()||null!==g.port)||"file"==g.scheme&&!g.host))return;if(g.scheme=_,i)return void(g.isSpecial()&&MD[g.scheme]==g.port&&(g.port=null));_="","file"==g.scheme?f=UD:g.isSpecial()&&o&&o.scheme==g.scheme?f=lC:g.isSpecial()?f=LD:"/"==s[A+1]?(f=jc,A++):(g.cannotBeABaseURL=!0,Vf(g.path,""),f=p3)}break;case kD:if(!o||o.cannotBeABaseURL&&"#"!=c)return OD;if(o.cannotBeABaseURL&&"#"==c){g.scheme=o.scheme,g.path=za(o.path),g.query=o.query,g.fragment="",g.cannotBeABaseURL=!0,f=Qr;break}f="file"==o.scheme?UD:Jm;continue;case lC:if("/"!=c||"/"!=s[A+1]){f=Jm;continue}f=xD,A++;break;case jc:if("/"==c){f=BD;break}f=Qc;continue;case Jm:if(g.scheme=o.scheme,c==ca)g.username=o.username,g.password=o.password,g.host=o.host,g.port=o.port,g.path=za(o.path),g.query=o.query;else if("/"==c||"\\"==c&&g.isSpecial())f=Gl;else if("?"==c)g.username=o.username,g.password=o.password,g.host=o.host,g.port=o.port,g.path=za(o.path),g.query="",f=Xa;else{if("#"!=c){g.username=o.username,g.password=o.password,g.host=o.host,g.port=o.port,g.path=za(o.path),g.path.length--,f=Qc;continue}g.username=o.username,g.password=o.password,g.host=o.host,g.port=o.port,g.path=za(o.path),g.query=o.query,g.fragment="",f=Qr}break;case Gl:if(!g.isSpecial()||"/"!=c&&"\\"!=c){if("/"!=c){g.username=o.username,g.password=o.password,g.host=o.host,g.port=o.port,f=Qc;continue}f=BD}else f=xD;break;case LD:if(f=xD,"/"!=c||"/"!=la(_,A+1))continue;A++;break;case xD:if("/"!=c&&"\\"!=c){f=BD;continue}break;case BD:if("@"==c){v&&(_="%40"+_),v=!0,l=Uf(_);for(var R=0;R<l.length;R++){var D=l[R];if(":"!=D||S){var O=Sh(D,PD);S?g.password+=O:g.username+=O}else S=!0}_=""}else if(c==ca||"/"==c||"?"==c||"#"==c||"\\"==c&&g.isSpecial()){if(v&&""==_)return"Invalid authority";A-=Uf(_).length+1,_="",f=h3}else _+=c;break;case h3:case FD:if(i&&"file"==g.scheme){f=VD;continue}if(":"!=c||y){if(c==ca||"/"==c||"?"==c||"#"==c||"\\"==c&&g.isSpecial()){if(g.isSpecial()&&""==_)return jf;if(i&&""==_&&(g.includesCredentials()||null!==g.port))return;if(p=g.parseHost(_))return p;if(_="",f=bh,i)return;continue}"["==c?y=!0:"]"==c&&(y=!1),_+=c}else{if(""==_)return jf;if(p=g.parseHost(_))return p;if(_="",f=Hl,i==FD)return}break;case Hl:if(!$a(u3,c)){if(c==ca||"/"==c||"?"==c||"#"==c||"\\"==c&&g.isSpecial()||i){if(""!=_){var P=aC(_,10);if(P>65535)return l9;g.port=g.isSpecial()&&P===MD[g.scheme]?null:P,_=""}if(i)return;f=bh;continue}return l9}_+=c;break;case UD:if(g.scheme="file","/"==c||"\\"==c)f=E9;else{if(!o||"file"!=o.scheme){f=Qc;continue}if(c==ca)g.host=o.host,g.path=za(o.path),g.query=o.query;else if("?"==c)g.host=o.host,g.path=za(o.path),g.query="",f=Xa;else{if("#"!=c){d3(Km(za(s,A),""))||(g.host=o.host,g.path=za(o.path),g.shortenPath()),f=Qc;continue}g.host=o.host,g.path=za(o.path),g.query=o.query,g.fragment="",f=Qr}}break;case E9:if("/"==c||"\\"==c){f=VD;break}o&&"file"==o.scheme&&!d3(Km(za(s,A),""))&&(qm(o.path[0],!0)?Vf(g.path,o.path[0]):g.host=o.host),f=Qc;continue;case VD:if(c==ca||"/"==c||"\\"==c||"?"==c||"#"==c){if(!i&&qm(_))f=Qc;else if(""==_){if(g.host="",i)return;f=bh}else{if(p=g.parseHost(_))return p;if("localhost"==g.host&&(g.host=""),i)return;_="",f=bh}continue}_+=c;break;case bh:if(g.isSpecial()){if(f=Qc,"/"!=c&&"\\"!=c)continue}else if(i||"?"!=c)if(i||"#"!=c){if(c!=ca&&(f=Qc,"/"!=c))continue}else g.fragment="",f=Qr;else g.query="",f=Xa;break;case Qc:if(c==ca||"/"==c||"\\"==c&&g.isSpecial()||!i&&("?"==c||"#"==c)){if(".."===(h=ND(h=_))||"%2e."===h||".%2e"===h||"%2e%2e"===h?(g.shortenPath(),"/"==c||"\\"==c&&g.isSpecial()||Vf(g.path,"")):vY(_)?"/"==c||"\\"==c&&g.isSpecial()||Vf(g.path,""):("file"==g.scheme&&!g.path.length&&qm(_)&&(g.host&&(g.host=""),_=la(_,0)+":"),Vf(g.path,_)),_="","file"==g.scheme&&(c==ca||"?"==c||"#"==c))for(;g.path.length>1&&""===g.path[0];)c9(g.path);"?"==c?(g.query="",f=Xa):"#"==c&&(g.fragment="",f=Qr)}else _+=Sh(c,l3);break;case p3:"?"==c?(g.query="",f=Xa):"#"==c?(g.fragment="",f=Qr):c!=ca&&(g.path[0]+=Sh(c,uC));break;case Xa:i||"#"!=c?c!=ca&&("'"==c&&g.isSpecial()?g.query+="%27":g.query+="#"==c?"%23":Sh(c,uC)):(g.fragment="",f=Qr);break;case Qr:c!=ca&&(g.fragment+=Sh(c,m9))}A++}},parseHost:function(t){var i,o,s;if("["==la(t,0)){if("]"!=la(t,t.length-1)||!(i=function(c){var l,p,h,g,f,A,_,v=[0,0,0,0,0,0,0,0],y=0,S=null,R=0,D=function(){return la(c,R)};if(":"==D()){if(":"!=la(c,1))return;R+=2,S=++y}for(;D();){if(8==y)return;if(":"!=D()){for(l=p=0;p<4&&$a(f9,D());)l=16*l+aC(D(),16),R++,p++;if("."==D()){if(0==p||(R-=p,y>6))return;for(h=0;D();){if(g=null,h>0){if(!("."==D()&&h<4))return;R++}if(!$a(u3,D()))return;for(;$a(u3,D());){if(f=aC(D(),10),null===g)g=f;else{if(0==g)return;g=10*g+f}if(g>255)return;R++}v[y]=256*v[y]+g,2!=++h&&4!=h||y++}if(4!=h)return;break}if(":"==D()){if(R++,!D())return}else if(D())return;v[y++]=l}else{if(null!==S)return;R++,S=++y}}if(null!==S)for(A=y-S,y=7;0!=y&&A>0;)_=v[y],v[y--]=v[S+A-1],v[S+--A]=_;else if(8!=y)return;return v}(Ym(t,1,-1))))return jf;this.host=i}else if(this.isSpecial()){if(t=function(t){var i,o,s=[],c=E7(_7(v7(t),BB,"."),".");for(i=0;i<c.length;i++)Ql(s,m7(A7,o=c[i])?"xn--"+y7(o):o);return VB(s,".")}(t),$a(_Y,t)||null===(i=function(c){var l,p,h,g,f,A,_,v=u9(c,".");if(v.length&&""==v[v.length-1]&&v.length--,(l=v.length)>4)return c;for(p=[],h=0;h<l;h++){if(""==(g=v[h]))return c;if(f=10,g.length>1&&"0"==la(g,0)&&(f=$a(mY,g)?16:8,g=Ym(g,8==f?1:2)),""===g)A=0;else{if(!$a(10==f?p9:8==f?h9:f9,g))return c;A=aC(g,f)}Vf(p,A)}for(h=0;h<l;h++)if(A=p[h],h==l-1){if(A>=a3(256,5-l))return null}else if(A>255)return null;for(_=a9(p),h=0;h<p.length;h++)_+=p[h]*a3(256,3-h);return _}(t)))return jf;this.host=i}else{if($a(g9,t))return jf;for(i="",o=Uf(t),s=0;s<o.length;s++)i+=Sh(o[s],uC);this.host=i}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return DD(MD,this.scheme)},shortenPath:function(){var t=this.path,i=t.length;!i||"file"==this.scheme&&1==i&&qm(t[0],!0)||t.length--},serialize:function(){var t=this,i=t.scheme,o=t.username,s=t.password,c=t.host,l=t.port,p=t.path,h=t.query,g=t.fragment,f=i+":";return null!==c?(f+="//",t.includesCredentials()&&(f+=o+(s?":"+s:"")+"@"),f+=cC(c),null!==l&&(f+=":"+l)):"file"==i&&(f+="//"),f+=t.cannotBeABaseURL?p[0]:p.length?"/"+Km(p,"/"):"",null!==h&&(f+="?"+h),null!==g&&(f+="#"+g),f},setHref:function(t){var i=this.parse(t);if(i)throw Wm(i);this.searchParams.update()},getOrigin:function(){var t=this.scheme,i=this.port;if("blob"==t)try{return new Gf(t.path[0]).origin}catch{return"null"}return"file"!=t&&this.isSpecial()?t+"://"+cC(this.host)+(null!==i?":"+i:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(t){this.parse(Wu(t)+":",Qf)},getUsername:function(){return this.username},setUsername:function(t){var i=Uf(Wu(t));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var o=0;o<i.length;o++)this.username+=Sh(i[o],PD)}},getPassword:function(){return this.password},setPassword:function(t){var i=Uf(Wu(t));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var o=0;o<i.length;o++)this.password+=Sh(i[o],PD)}},getHost:function(){var t=this.host,i=this.port;return null===t?"":null===i?cC(t):cC(t)+":"+i},setHost:function(t){this.cannotBeABaseURL||this.parse(t,h3)},getHostname:function(){var t=this.host;return null===t?"":cC(t)},setHostname:function(t){this.cannotBeABaseURL||this.parse(t,FD)},getPort:function(){var t=this.port;return null===t?"":Wu(t)},setPort:function(t){this.cannotHaveUsernamePasswordPort()||(""==(t=Wu(t))?this.port=null:this.parse(t,Hl))},getPathname:function(){var t=this.path;return this.cannotBeABaseURL?t[0]:t.length?"/"+Km(t,"/"):""},setPathname:function(t){this.cannotBeABaseURL||(this.path=[],this.parse(t,bh))},getSearch:function(){var t=this.query;return t?"?"+t:""},setSearch:function(t){""==(t=Wu(t))?this.query=null:("?"==la(t,0)&&(t=Ym(t,1)),this.query="",this.parse(t,Xa)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var t=this.fragment;return t?"#"+t:""},setHash:function(t){""!=(t=Wu(t))?("#"==la(t,0)&&(t=Ym(t,1)),this.fragment="",this.parse(t,Qr)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Gf=function(t){var i=X7(this,zm),s=n9(i,new jD(t,!1,arguments.length>1?arguments[1]:void 0));n3||(i.href=s.serialize(),i.origin=s.getOrigin(),i.protocol=s.getProtocol(),i.username=s.getUsername(),i.password=s.getPassword(),i.host=s.getHost(),i.hostname=s.getHostname(),i.port=s.getPort(),i.pathname=s.getPathname(),i.search=s.getSearch(),i.searchParams=s.getSearchParams(),i.hash=s.getHash())},zm=Gf.prototype,no=function(t,i){return{get:function(){return sC(this)[t]()},set:i&&function(o){return sC(this)[i](o)},configurable:!0,enumerable:!0}};if(n3&&$7(zm,{href:no("serialize","setHref"),origin:no("getOrigin"),protocol:no("getProtocol","setProtocol"),username:no("getUsername","setUsername"),password:no("getPassword","setPassword"),host:no("getHost","setHost"),hostname:no("getHostname","setHostname"),port:no("getPort","setPort"),pathname:no("getPathname","setPathname"),search:no("getSearch","setSearch"),searchParams:no("getSearchParams"),hash:no("getHash","setHash")}),oC(zm,"toJSON",function(){return sC(this).serialize()},{enumerable:!0}),oC(zm,"toString",function(){return sC(this).serialize()},{enumerable:!0}),Hm){var f3=Hm.createObjectURL,g3=Hm.revokeObjectURL;f3&&oC(Gf,"createObjectURL",r3(f3,Hm)),g3&&oC(Gf,"revokeObjectURL",r3(g3,Hm))}t9(Gf,"URL"),J7({global:!0,forced:!z7,sham:!n3},{URL:Gf});var dC=cc.URL;const A3={[Mu.ACCESS_POINT]:{[Fr.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[Fr.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[Fr.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[Fr.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[Fr.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[Fr.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[Fr.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[Fr.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voice service available",retry:!0},[Fr.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[Fr.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[Fr.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[Fr.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[Fr.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[Fr.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[Fr.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[Fr.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[Fr.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[Fr.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[Mu.UNILBS]:{[ko.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[ko.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[ko.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[ko.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[ko.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[ko.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[ko.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[ko.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[ko.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[ko.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[ko.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[ko.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[Mu.STRING_UID_ALLOCATOR]:{[ku.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[ku.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[ku.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function $m(t){const i=A3[Math.floor(t/1e4)];if(!i)return{desc:"unkonw error",retry:!1};const o=i[t%1e4];if(!o){if(Math.floor(t/1e4)===Mu.ACCESS_POINT){const s=t%1e4;if("1"===s.toString()[0])return{desc:t.toString(),retry:!1};if("2"===s.toString()[0])return{desc:t.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return o}const QD={[je.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[je.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[je.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[je.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[je.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[je.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[je.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[je.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[je.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[je.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[je.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[je.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[je.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[je.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[je.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[je.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[je.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[je.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[je.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[je.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[je.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[je.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[je.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[je.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[je.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[je.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[je.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[je.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[je.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[je.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[je.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[je.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[je.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[je.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[je.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[je.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[je.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[je.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[je.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[je.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[je.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[je.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[je.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[je.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[je.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[je.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[je.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[je.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[je.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[je.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[je.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[je.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[je.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[je.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[je.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[je.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[je.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[je.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[je.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[je.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[je.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[je.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[je.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[je.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function Xm(t){return QD[t]||{desc:"UNKNOW_ERROR_".concat(t),action:"failed"}}var GD={exports:{}};(function(t,i){t.exports=function(){var o={d:function(X,x){for(var q in x)o.o(x,q)&&!o.o(X,q)&&Object.defineProperty(X,q,{enumerable:!0,get:x[q]})},o:function(X,x){return Object.prototype.hasOwnProperty.call(X,x)},r:function(X){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(X,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(X,"__esModule",{value:!0})}},s={};o.r(s),o.d(s,{DataViewIndexOutOfBoundsError:function(){return re},DecodeError:function(){return G},Decoder:function(){return St},EXT_TIMESTAMP:function(){return Y},Encoder:function(){return z},ExtData:function(){return P},ExtensionCodec:function(){return Oe},decode:function(){return sn},decodeArrayStream:function(){return Xn},decodeAsync:function(){return li},decodeMulti:function(){return vt},decodeMultiStream:function(){return mr},decodeStream:function(){return A_},decodeTimestampExtension:function(){return fe},decodeTimestampToTimeSpec:function(){return _e},encode:function(){return Q},encodeDateToTimeSpec:function(){return te},encodeTimeSpecToTimestamp:function(){return ae},encodeTimestampExtension:function(){return Z}});var c=4294967295;function l(X,x,q){var ie=Math.floor(q/4294967296),W=q;X.setUint32(x,ie),X.setUint32(x+4,W)}function p(X,x){return 4294967296*X.getInt32(x)+X.getUint32(x+4)}var h=function(X,x){var q="function"==typeof Symbol&&X[Symbol.iterator];if(!q)return X;var ie,W,de=q.call(X),ue=[];try{for(;(void 0===x||x-- >0)&&!(ie=de.next()).done;)ue.push(ie.value)}catch(ye){W={error:ye}}finally{try{ie&&!ie.done&&(q=de.return)&&q.call(de)}finally{if(W)throw W.error}}return ue},g=function(X,x){for(var q=0,ie=x.length,W=X.length;q<ie;q++,W++)X[W]=x[q];return X},f=typeof TextEncoder<"u"&&typeof TextDecoder<"u";function A(X){for(var x=X.length,q=0,ie=0;ie<x;){var W=X.charCodeAt(ie++);if(0!=(4294967168&W))if(0==(4294965248&W))q+=2;else{if(W>=55296&&W<=56319&&ie<x){var de=X.charCodeAt(ie);56320==(64512&de)&&(++ie,W=((1023&W)<<10)+(1023&de)+65536)}q+=0==(4294901760&W)?3:4}else q++}return q}var _=f?new TextEncoder:void 0,v=f?typeof process<"u"?200:0:c,y=_?.encodeInto?function(X,x,q){_.encodeInto(X,x.subarray(q))}:function(X,x,q){x.set(_.encode(X),q)};function S(X,x,q){for(var ie=x,W=ie+q,de=[],ue="";ie<W;){var ye=X[ie++];if(0==(128&ye))de.push(ye);else if(192==(224&ye)){var tt=63&X[ie++];de.push((31&ye)<<6|tt)}else if(224==(240&ye)){tt=63&X[ie++];var At=63&X[ie++];de.push((31&ye)<<12|tt<<6|At)}else if(240==(248&ye)){var we=(7&ye)<<18|(tt=63&X[ie++])<<12|(At=63&X[ie++])<<6|63&X[ie++];we>65535&&(de.push((we-=65536)>>>10&1023|55296),we=56320|1023&we),de.push(we)}else de.push(ye);de.length>=4096&&(ue+=String.fromCharCode.apply(String,g([],h(de))),de.length=0)}return de.length>0&&(ue+=String.fromCharCode.apply(String,g([],h(de)))),ue}var R,D=f?new TextDecoder:null,O=f?typeof process<"u"?200:0:c,P=function(X,x){this.type=X,this.data=x},B=(R=function(X,x){return(R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(q,ie){q.__proto__=ie}||function(q,ie){for(var W in ie)Object.prototype.hasOwnProperty.call(ie,W)&&(q[W]=ie[W])})(X,x)},function(X,x){if("function"!=typeof x&&null!==x)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");function q(){this.constructor=X}R(X,x),X.prototype=null===x?Object.create(x):(q.prototype=x.prototype,new q)}),G=function(X){function x(q){var ie=X.call(this,q)||this,W=Object.create(x.prototype);return Object.setPrototypeOf(ie,W),Object.defineProperty(ie,"name",{configurable:!0,enumerable:!1,value:x.name}),ie}return B(x,X),x}(Error),Y=-1;function ae(X){var x,q=X.sec,ie=X.nsec;if(q>=0&&ie>=0&&q<=17179869183){if(0===ie&&q<=4294967295){var W=new Uint8Array(4);return(x=new DataView(W.buffer)).setUint32(0,q),W}var de=q/4294967296,ue=4294967295&q;return W=new Uint8Array(8),(x=new DataView(W.buffer)).setUint32(0,ie<<2|3&de),x.setUint32(4,ue),W}return W=new Uint8Array(12),(x=new DataView(W.buffer)).setUint32(0,ie),l(x,4,q),W}function te(X){var x=X.getTime(),q=Math.floor(x/1e3),ie=1e6*(x-1e3*q),W=Math.floor(ie/1e9);return{sec:q+W,nsec:ie-1e9*W}}function Z(X){return X instanceof Date?ae(te(X)):null}function _e(X){var x=new DataView(X.buffer,X.byteOffset,X.byteLength);switch(X.byteLength){case 4:return{sec:x.getUint32(0),nsec:0};case 8:var q=x.getUint32(0);return{sec:4294967296*(3&q)+x.getUint32(4),nsec:q>>>2};case 12:return{sec:p(x,4),nsec:x.getUint32(0)};default:throw new G("Unrecognized data size for timestamp (expected 4, 8, or 12): "+X.length)}}function fe(X){var x=_e(X);return new Date(1e3*x.sec+x.nsec/1e6)}var Se={type:Y,encode:Z,decode:fe},Oe=function(){function X(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(Se)}return X.prototype.register=function(x){var q=x.type,ie=x.encode,W=x.decode;if(q>=0)this.encoders[q]=ie,this.decoders[q]=W;else{var de=1+q;this.builtInEncoders[de]=ie,this.builtInDecoders[de]=W}},X.prototype.tryToEncode=function(x,q){for(var ie=0;ie<this.builtInEncoders.length;ie++)if(null!=(W=this.builtInEncoders[ie])&&null!=(de=W(x,q)))return new P(-1-ie,de);for(ie=0;ie<this.encoders.length;ie++){var W,de;if(null!=(W=this.encoders[ie])&&null!=(de=W(x,q)))return new P(ie,de)}return x instanceof P?x:null},X.prototype.decode=function(x,q,ie){var W=q<0?this.builtInDecoders[-1-q]:this.decoders[q];return W?W(x,q,ie):new P(q,x)},X.defaultCodec=new X,X}();function Ye(X){return X instanceof Uint8Array?X:ArrayBuffer.isView(X)?new Uint8Array(X.buffer,X.byteOffset,X.byteLength):X instanceof ArrayBuffer?new Uint8Array(X):Uint8Array.from(X)}var Ee=function(X){var x="function"==typeof Symbol&&Symbol.iterator,q=x&&X[x],ie=0;if(q)return q.call(X);if(X&&"number"==typeof X.length)return{next:function(){return X&&ie>=X.length&&(X=void 0),{value:X&&X[ie++],done:!X}}};throw new TypeError(x?"Object is not iterable.":"Symbol.iterator is not defined.")},z=function(){function X(x,q,ie,W,de,ue,ye,tt){void 0===x&&(x=Oe.defaultCodec),void 0===q&&(q=void 0),void 0===ie&&(ie=100),void 0===W&&(W=2048),void 0===de&&(de=!1),void 0===ue&&(ue=!1),void 0===ye&&(ye=!1),void 0===tt&&(tt=!1),this.extensionCodec=x,this.context=q,this.maxDepth=ie,this.initialBufferSize=W,this.sortKeys=de,this.forceFloat32=ue,this.ignoreUndefined=ye,this.forceIntegerToFloat=tt,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return X.prototype.getUint8Array=function(){return this.bytes.subarray(0,this.pos)},X.prototype.reinitializeState=function(){this.pos=0},X.prototype.encode=function(x){return this.reinitializeState(),this.doEncode(x,1),this.getUint8Array()},X.prototype.doEncode=function(x,q){if(q>this.maxDepth)throw new Error("Too deep objects in depth "+q);null==x?this.encodeNil():"boolean"==typeof x?this.encodeBoolean(x):"number"==typeof x?this.encodeNumber(x):"string"==typeof x?this.encodeString(x):this.encodeObject(x,q)},X.prototype.ensureBufferSizeToWrite=function(x){var q=this.pos+x;this.view.byteLength<q&&this.resizeBuffer(2*q)},X.prototype.resizeBuffer=function(x){var q=new ArrayBuffer(x),ie=new Uint8Array(q),W=new DataView(q);ie.set(this.bytes),this.view=W,this.bytes=ie},X.prototype.encodeNil=function(){this.writeU8(192)},X.prototype.encodeBoolean=function(x){this.writeU8(!1===x?194:195)},X.prototype.encodeNumber=function(x){Number.isSafeInteger(x)&&!this.forceIntegerToFloat?x>=0?x<128?this.writeU8(x):x<256?(this.writeU8(204),this.writeU8(x)):x<65536?(this.writeU8(205),this.writeU16(x)):x<4294967296?(this.writeU8(206),this.writeU32(x)):(this.writeU8(207),this.writeU64(x)):x>=-32?this.writeU8(224|x+32):x>=-128?(this.writeU8(208),this.writeI8(x)):x>=-32768?(this.writeU8(209),this.writeI16(x)):x>=-2147483648?(this.writeU8(210),this.writeI32(x)):(this.writeU8(211),this.writeI64(x)):this.forceFloat32?(this.writeU8(202),this.writeF32(x)):(this.writeU8(203),this.writeF64(x))},X.prototype.writeStringHeader=function(x){if(x<32)this.writeU8(160+x);else if(x<256)this.writeU8(217),this.writeU8(x);else if(x<65536)this.writeU8(218),this.writeU16(x);else{if(!(x<4294967296))throw new Error("Too long string: "+x+" bytes in UTF-8");this.writeU8(219),this.writeU32(x)}},X.prototype.encodeString=function(x){if(x.length>v){var q=A(x);this.ensureBufferSizeToWrite(5+q),this.writeStringHeader(q),y(x,this.bytes,this.pos),this.pos+=q}else q=A(x),this.ensureBufferSizeToWrite(5+q),this.writeStringHeader(q),function(ie,W,de){for(var ue=ie.length,ye=de,tt=0;tt<ue;){var At=ie.charCodeAt(tt++);if(0!=(4294967168&At)){if(0==(4294965248&At))W[ye++]=At>>6&31|192;else{if(At>=55296&&At<=56319&&tt<ue){var we=ie.charCodeAt(tt);56320==(64512&we)&&(++tt,At=((1023&At)<<10)+(1023&we)+65536)}0==(4294901760&At)?(W[ye++]=At>>12&15|224,W[ye++]=At>>6&63|128):(W[ye++]=At>>18&7|240,W[ye++]=At>>12&63|128,W[ye++]=At>>6&63|128)}W[ye++]=63&At|128}else W[ye++]=At}}(x,this.bytes,this.pos),this.pos+=q},X.prototype.encodeObject=function(x,q){var ie=this.extensionCodec.tryToEncode(x,this.context);if(null!=ie)this.encodeExtension(ie);else if(Array.isArray(x))this.encodeArray(x,q);else if(ArrayBuffer.isView(x))this.encodeBinary(x);else{if("object"!=typeof x)throw new Error("Unrecognized object: "+Object.prototype.toString.apply(x));this.encodeMap(x,q)}},X.prototype.encodeBinary=function(x){var q=x.byteLength;if(q<256)this.writeU8(196),this.writeU8(q);else if(q<65536)this.writeU8(197),this.writeU16(q);else{if(!(q<4294967296))throw new Error("Too large binary: "+q);this.writeU8(198),this.writeU32(q)}var ie=Ye(x);this.writeU8a(ie)},X.prototype.encodeArray=function(x,q){var ie,W,de=x.length;if(de<16)this.writeU8(144+de);else if(de<65536)this.writeU8(220),this.writeU16(de);else{if(!(de<4294967296))throw new Error("Too large array: "+de);this.writeU8(221),this.writeU32(de)}try{for(var ue=Ee(x),ye=ue.next();!ye.done;ye=ue.next())this.doEncode(ye.value,q+1)}catch(At){ie={error:At}}finally{try{ye&&!ye.done&&(W=ue.return)&&W.call(ue)}finally{if(ie)throw ie.error}}},X.prototype.countWithoutUndefined=function(x,q){var ie,W,de=0;try{for(var ue=Ee(q),ye=ue.next();!ye.done;ye=ue.next())void 0!==x[ye.value]&&de++}catch(tt){ie={error:tt}}finally{try{ye&&!ye.done&&(W=ue.return)&&W.call(ue)}finally{if(ie)throw ie.error}}return de},X.prototype.encodeMap=function(x,q){var ie,W,de=Object.keys(x);this.sortKeys&&de.sort();var ue=this.ignoreUndefined?this.countWithoutUndefined(x,de):de.length;if(ue<16)this.writeU8(128+ue);else if(ue<65536)this.writeU8(222),this.writeU16(ue);else{if(!(ue<4294967296))throw new Error("Too large map object: "+ue);this.writeU8(223),this.writeU32(ue)}try{for(var ye=Ee(de),tt=ye.next();!tt.done;tt=ye.next()){var At=tt.value,we=x[At];this.ignoreUndefined&&void 0===we||(this.encodeString(At),this.doEncode(we,q+1))}}catch(xe){ie={error:xe}}finally{try{tt&&!tt.done&&(W=ye.return)&&W.call(ye)}finally{if(ie)throw ie.error}}},X.prototype.encodeExtension=function(x){var q=x.data.length;if(1===q)this.writeU8(212);else if(2===q)this.writeU8(213);else if(4===q)this.writeU8(214);else if(8===q)this.writeU8(215);else if(16===q)this.writeU8(216);else if(q<256)this.writeU8(199),this.writeU8(q);else if(q<65536)this.writeU8(200),this.writeU16(q);else{if(!(q<4294967296))throw new Error("Too large extension object: "+q);this.writeU8(201),this.writeU32(q)}this.writeI8(x.type),this.writeU8a(x.data)},X.prototype.writeU8=function(x){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,x),this.pos++},X.prototype.writeU8a=function(x){var q=x.length;this.ensureBufferSizeToWrite(q),this.bytes.set(x,this.pos),this.pos+=q},X.prototype.writeI8=function(x){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,x),this.pos++},X.prototype.writeU16=function(x){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,x),this.pos+=2},X.prototype.writeI16=function(x){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,x),this.pos+=2},X.prototype.writeU32=function(x){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,x),this.pos+=4},X.prototype.writeI32=function(x){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,x),this.pos+=4},X.prototype.writeF32=function(x){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,x),this.pos+=4},X.prototype.writeF64=function(x){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,x),this.pos+=8},X.prototype.writeU64=function(x){var q,ie,W,ue;this.ensureBufferSizeToWrite(8),ue=W=x,(q=this.view).setUint32(ie=this.pos,W/4294967296),q.setUint32(ie+4,ue),this.pos+=8},X.prototype.writeI64=function(x){this.ensureBufferSizeToWrite(8),l(this.view,this.pos,x),this.pos+=8},X}(),ee={};function Q(X,x){return void 0===x&&(x=ee),new z(x.extensionCodec,x.context,x.maxDepth,x.initialBufferSize,x.sortKeys,x.forceFloat32,x.ignoreUndefined,x.forceIntegerToFloat).encode(X)}function K(X){return(X<0?"-":"")+"0x"+Math.abs(X).toString(16).padStart(2,"0")}var ne=function(){function X(x,q){void 0===x&&(x=16),void 0===q&&(q=16),this.maxKeyLength=x,this.maxLengthPerKey=q,this.hit=0,this.miss=0,this.caches=[];for(var ie=0;ie<this.maxKeyLength;ie++)this.caches.push([])}return X.prototype.canBeCached=function(x){return x>0&&x<=this.maxKeyLength},X.prototype.find=function(x,q,ie){var W,de,ue=this.caches[ie-1];try{e:for(var ye=function(it){var Yt="function"==typeof Symbol&&Symbol.iterator,ar=Yt&&it[Yt],Qo=0;if(ar)return ar.call(it);if(it&&"number"==typeof it.length)return{next:function(){return it&&Qo>=it.length&&(it=void 0),{value:it&&it[Qo++],done:!it}}};throw new TypeError(Yt?"Object is not iterable.":"Symbol.iterator is not defined.")}(ue),tt=ye.next();!tt.done;tt=ye.next()){for(var At=tt.value,we=At.bytes,xe=0;xe<ie;xe++)if(we[xe]!==x[q+xe])continue e;return At.str}}catch(it){W={error:it}}finally{try{tt&&!tt.done&&(de=ye.return)&&de.call(ye)}finally{if(W)throw W.error}}return null},X.prototype.store=function(x,q){var ie=this.caches[x.length-1],W={bytes:x,str:q};ie.length>=this.maxLengthPerKey?ie[Math.random()*ie.length|0]=W:ie.push(W)},X.prototype.decode=function(x,q,ie){var W=this.find(x,q,ie);if(null!=W)return this.hit++,W;this.miss++;var de=S(x,q,ie),ue=Uint8Array.prototype.slice.call(x,q,q+ie);return this.store(ue,de),de},X}(),me=function(X,x){var q,ie,W,de,ue={label:0,sent:function(){if(1&W[0])throw W[1];return W[1]},trys:[],ops:[]};return de={next:ye(0),throw:ye(1),return:ye(2)},"function"==typeof Symbol&&(de[Symbol.iterator]=function(){return this}),de;function ye(tt){return function(At){return function(we){if(q)throw new TypeError("Generator is already executing.");for(;ue;)try{if(q=1,ie&&(W=2&we[0]?ie.return:we[0]?ie.throw||((W=ie.return)&&W.call(ie),0):ie.next)&&!(W=W.call(ie,we[1])).done)return W;switch(ie=0,W&&(we=[2&we[0],W.value]),we[0]){case 0:case 1:W=we;break;case 4:return ue.label++,{value:we[1],done:!1};case 5:ue.label++,ie=we[1],we=[0];continue;case 7:we=ue.ops.pop(),ue.trys.pop();continue;default:if(!((W=(W=ue.trys).length>0&&W[W.length-1])||6!==we[0]&&2!==we[0])){ue=0;continue}if(3===we[0]&&(!W||we[1]>W[0]&&we[1]<W[3])){ue.label=we[1];break}if(6===we[0]&&ue.label<W[1]){ue.label=W[1],W=we;break}if(W&&ue.label<W[2]){ue.label=W[2],ue.ops.push(we);break}W[2]&&ue.ops.pop(),ue.trys.pop();continue}we=x.call(X,ue)}catch(xe){we=[6,xe],ie=0}finally{q=W=0}if(5&we[0])throw we[1];return{value:we[0]?we[1]:void 0,done:!0}}([tt,At])}}},Ne=function(X){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var x,q=X[Symbol.asyncIterator];return q?q.call(X):(X="function"==typeof __values?__values(X):X[Symbol.iterator](),x={},ie("next"),ie("throw"),ie("return"),x[Symbol.asyncIterator]=function(){return this},x);function ie(W){x[W]=X[W]&&function(de){return new Promise(function(ue,ye){var tt,At,we;tt=ue,At=ye,we=(de=X[W](de)).done,Promise.resolve(de.value).then(function(it){tt({value:it,done:we})},At)})}}},ce=function(X){return this instanceof ce?(this.v=X,this):new ce(X)},T=function(X,x,q){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ie,W=q.apply(X,x||[]),de=[];return ie={},ue("next"),ue("throw"),ue("return"),ie[Symbol.asyncIterator]=function(){return this},ie;function ue(xe){W[xe]&&(ie[xe]=function(it){return new Promise(function(Yt,ar){de.push([xe,it,Yt,ar])>1||ye(xe,it)})})}function ye(xe,it){try{(Yt=W[xe](it)).value instanceof ce?Promise.resolve(Yt.value.v).then(tt,At):we(de[0][2],Yt)}catch(ar){we(de[0][3],ar)}var Yt}function tt(xe){ye("next",xe)}function At(xe){ye("throw",xe)}function we(xe,it){xe(it),de.shift(),de.length&&ye(de[0][0],de[0][1])}},k=new DataView(new ArrayBuffer(0)),j=new Uint8Array(k.buffer),re=function(){try{k.getInt8(0)}catch(X){return X.constructor}throw new Error("never reached")}(),be=new re("Insufficient data"),dt=new ne,St=function(){function X(x,q,ie,W,de,ue,ye,tt){void 0===x&&(x=Oe.defaultCodec),void 0===q&&(q=void 0),void 0===ie&&(ie=c),void 0===W&&(W=c),void 0===de&&(de=c),void 0===ue&&(ue=c),void 0===ye&&(ye=c),void 0===tt&&(tt=dt),this.extensionCodec=x,this.context=q,this.maxStrLength=ie,this.maxBinLength=W,this.maxArrayLength=de,this.maxMapLength=ue,this.maxExtLength=ye,this.keyDecoder=tt,this.totalPos=0,this.pos=0,this.view=k,this.bytes=j,this.headByte=-1,this.stack=[]}return X.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},X.prototype.setBuffer=function(x){this.bytes=Ye(x),this.view=function(q){if(q instanceof ArrayBuffer)return new DataView(q);var ie=Ye(q);return new DataView(ie.buffer,ie.byteOffset,ie.byteLength)}(this.bytes),this.pos=0},X.prototype.appendBuffer=function(x){if(-1!==this.headByte||this.hasRemaining(1)){var q=this.bytes.subarray(this.pos),ie=Ye(x),W=new Uint8Array(q.length+ie.length);W.set(q),W.set(ie,q.length),this.setBuffer(W)}else this.setBuffer(x)},X.prototype.hasRemaining=function(x){return this.view.byteLength-this.pos>=x},X.prototype.createExtraByteError=function(x){var q=this.view;return new RangeError("Extra "+(q.byteLength-this.pos)+" of "+q.byteLength+" byte(s) found at buffer["+x+"]")},X.prototype.decode=function(x){this.reinitializeState(),this.setBuffer(x);var q=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return q},X.prototype.decodeMulti=function(x){return me(this,function(q){switch(q.label){case 0:this.reinitializeState(),this.setBuffer(x),q.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return q.sent(),[3,1];case 3:return[2]}})},X.prototype.decodeAsync=function(x){var q,ie,W,de,ue,tt,At;return ue=this,void 0,At=function(){var we,xe,it,Yt,ar,Qo,nc,Wn;return me(this,function(Yc){switch(Yc.label){case 0:we=!1,Yc.label=1;case 1:Yc.trys.push([1,6,7,12]),q=Ne(x),Yc.label=2;case 2:return[4,q.next()];case 3:if((ie=Yc.sent()).done)return[3,5];if(it=ie.value,we)throw this.createExtraByteError(this.totalPos);this.appendBuffer(it);try{xe=this.doDecodeSync(),we=!0}catch(Pq){if(!(Pq instanceof re))throw Pq}this.totalPos+=this.pos,Yc.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return Yt=Yc.sent(),W={error:Yt},[3,12];case 7:return Yc.trys.push([7,,10,11]),ie&&!ie.done&&(de=q.return)?[4,de.call(q)]:[3,9];case 8:Yc.sent(),Yc.label=9;case 9:return[3,11];case 10:if(W)throw W.error;return[7];case 11:return[7];case 12:if(we){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,xe]}throw Qo=(ar=this).headByte,nc=ar.pos,Wn=ar.totalPos,new RangeError("Insufficient data in parsing "+K(Qo)+" at "+Wn+" ("+nc+" in the current buffer)")}})},new((tt=void 0)||(tt=Promise))(function(we,xe){function it(Qo){try{ar(At.next(Qo))}catch(nc){xe(nc)}}function Yt(Qo){try{ar(At.throw(Qo))}catch(nc){xe(nc)}}function ar(Qo){var nc;Qo.done?we(Qo.value):(nc=Qo.value,nc instanceof tt?nc:new tt(function(Wn){Wn(nc)})).then(it,Yt)}ar((At=At.apply(ue,[])).next())})},X.prototype.decodeArrayStream=function(x){return this.decodeMultiAsync(x,!0)},X.prototype.decodeStream=function(x){return this.decodeMultiAsync(x,!1)},X.prototype.decodeMultiAsync=function(x,q){return T(this,arguments,function(){var ie,W,de,ue,ye,tt,At,we,xe;return me(this,function(it){switch(it.label){case 0:ie=q,W=-1,it.label=1;case 1:it.trys.push([1,13,14,19]),de=Ne(x),it.label=2;case 2:return[4,ce(de.next())];case 3:if((ue=it.sent()).done)return[3,12];if(ye=ue.value,q&&0===W)throw this.createExtraByteError(this.totalPos);this.appendBuffer(ye),ie&&(W=this.readArraySize(),ie=!1,this.complete()),it.label=4;case 4:it.trys.push([4,9,,10]),it.label=5;case 5:return[4,ce(this.doDecodeSync())];case 6:return[4,it.sent()];case 7:return it.sent(),0==--W?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((tt=it.sent())instanceof re))throw tt;return[3,10];case 10:this.totalPos+=this.pos,it.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return At=it.sent(),we={error:At},[3,19];case 14:return it.trys.push([14,,17,18]),ue&&!ue.done&&(xe=de.return)?[4,ce(xe.call(de))]:[3,16];case 15:it.sent(),it.label=16;case 16:return[3,18];case 17:if(we)throw we.error;return[7];case 18:return[7];case 19:return[2]}})})},X.prototype.doDecodeSync=function(){e:for(;;){var x=this.readHeadByte(),q=void 0;if(x>=224)q=x-256;else if(x<192)if(x<128)q=x;else if(x<144){if(0!=(W=x-128)){this.pushMapState(W),this.complete();continue e}q={}}else if(x<160){if(0!=(W=x-144)){this.pushArrayState(W),this.complete();continue e}q=[]}else{var ie=x-160;q=this.decodeUtf8String(ie,0)}else if(192===x)q=null;else if(194===x)q=!1;else if(195===x)q=!0;else if(202===x)q=this.readF32();else if(203===x)q=this.readF64();else if(204===x)q=this.readU8();else if(205===x)q=this.readU16();else if(206===x)q=this.readU32();else if(207===x)q=this.readU64();else if(208===x)q=this.readI8();else if(209===x)q=this.readI16();else if(210===x)q=this.readI32();else if(211===x)q=this.readI64();else if(217===x)ie=this.lookU8(),q=this.decodeUtf8String(ie,1);else if(218===x)ie=this.lookU16(),q=this.decodeUtf8String(ie,2);else if(219===x)ie=this.lookU32(),q=this.decodeUtf8String(ie,4);else if(220===x){if(0!==(W=this.readU16())){this.pushArrayState(W),this.complete();continue e}q=[]}else if(221===x){if(0!==(W=this.readU32())){this.pushArrayState(W),this.complete();continue e}q=[]}else if(222===x){if(0!==(W=this.readU16())){this.pushMapState(W),this.complete();continue e}q={}}else if(223===x){if(0!==(W=this.readU32())){this.pushMapState(W),this.complete();continue e}q={}}else if(196===x){var W=this.lookU8();q=this.decodeBinary(W,1)}else if(197===x)W=this.lookU16(),q=this.decodeBinary(W,2);else if(198===x)W=this.lookU32(),q=this.decodeBinary(W,4);else if(212===x)q=this.decodeExtension(1,0);else if(213===x)q=this.decodeExtension(2,0);else if(214===x)q=this.decodeExtension(4,0);else if(215===x)q=this.decodeExtension(8,0);else if(216===x)q=this.decodeExtension(16,0);else if(199===x)W=this.lookU8(),q=this.decodeExtension(W,1);else if(200===x)W=this.lookU16(),q=this.decodeExtension(W,2);else{if(201!==x)throw new G("Unrecognized type byte: "+K(x));W=this.lookU32(),q=this.decodeExtension(W,4)}this.complete();for(var de=this.stack;de.length>0;){var ue=de[de.length-1];if(0===ue.type){if(ue.array[ue.position]=q,ue.position++,ue.position!==ue.size)continue e;de.pop(),q=ue.array}else{if(1===ue.type){if("string"!=(ye=typeof q)&&"number"!==ye)throw new G("The type of key must be string or number but "+typeof q);if("__proto__"===q)throw new G("The key __proto__ is not allowed");ue.key=q,ue.type=2;continue e}if(ue.map[ue.key]=q,ue.readCount++,ue.readCount!==ue.size){ue.key=null,ue.type=1;continue e}de.pop(),q=ue.map}}return q}var ye},X.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},X.prototype.complete=function(){this.headByte=-1},X.prototype.readArraySize=function(){var x=this.readHeadByte();switch(x){case 220:return this.readU16();case 221:return this.readU32();default:if(x<160)return x-144;throw new G("Unrecognized array type byte: "+K(x))}},X.prototype.pushMapState=function(x){if(x>this.maxMapLength)throw new G("Max length exceeded: map length ("+x+") > maxMapLengthLength ("+this.maxMapLength+")");this.stack.push({type:1,size:x,key:null,readCount:0,map:{}})},X.prototype.pushArrayState=function(x){if(x>this.maxArrayLength)throw new G("Max length exceeded: array length ("+x+") > maxArrayLength ("+this.maxArrayLength+")");this.stack.push({type:0,size:x,array:new Array(x),position:0})},X.prototype.decodeUtf8String=function(x,q){var ie;if(x>this.maxStrLength)throw new G("Max length exceeded: UTF-8 byte length ("+x+") > maxStrLength ("+this.maxStrLength+")");if(this.bytes.byteLength<this.pos+q+x)throw be;var W,ye,At,de=this.pos+q;return W=this.stateIsMapKey()&&(null===(ie=this.keyDecoder)||void 0===ie?void 0:ie.canBeCached(x))?this.keyDecoder.decode(this.bytes,de,x):x>O?(At=this.bytes.subarray(ye=de,ye+x),D.decode(At)):S(this.bytes,de,x),this.pos+=q+x,W},X.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},X.prototype.decodeBinary=function(x,q){if(x>this.maxBinLength)throw new G("Max length exceeded: bin length ("+x+") > maxBinLength ("+this.maxBinLength+")");if(!this.hasRemaining(x+q))throw be;var ie=this.pos+q,W=this.bytes.subarray(ie,ie+x);return this.pos+=q+x,W},X.prototype.decodeExtension=function(x,q){if(x>this.maxExtLength)throw new G("Max length exceeded: ext length ("+x+") > maxExtLength ("+this.maxExtLength+")");var ie=this.view.getInt8(this.pos+q),W=this.decodeBinary(x,q+1);return this.extensionCodec.decode(W,ie,this.context)},X.prototype.lookU8=function(){return this.view.getUint8(this.pos)},X.prototype.lookU16=function(){return this.view.getUint16(this.pos)},X.prototype.lookU32=function(){return this.view.getUint32(this.pos)},X.prototype.readU8=function(){var x=this.view.getUint8(this.pos);return this.pos++,x},X.prototype.readI8=function(){var x=this.view.getInt8(this.pos);return this.pos++,x},X.prototype.readU16=function(){var x=this.view.getUint16(this.pos);return this.pos+=2,x},X.prototype.readI16=function(){var x=this.view.getInt16(this.pos);return this.pos+=2,x},X.prototype.readU32=function(){var x=this.view.getUint32(this.pos);return this.pos+=4,x},X.prototype.readI32=function(){var x=this.view.getInt32(this.pos);return this.pos+=4,x},X.prototype.readU64=function(){var x,q,ie=4294967296*(x=this.view).getUint32(q=this.pos)+x.getUint32(q+4);return this.pos+=8,ie},X.prototype.readI64=function(){var x=p(this.view,this.pos);return this.pos+=8,x},X.prototype.readF32=function(){var x=this.view.getFloat32(this.pos);return this.pos+=4,x},X.prototype.readF64=function(){var x=this.view.getFloat64(this.pos);return this.pos+=8,x},X}(),at={};function sn(X,x){return void 0===x&&(x=at),new St(x.extensionCodec,x.context,x.maxStrLength,x.maxBinLength,x.maxArrayLength,x.maxMapLength,x.maxExtLength).decode(X)}function vt(X,x){return void 0===x&&(x=at),new St(x.extensionCodec,x.context,x.maxStrLength,x.maxBinLength,x.maxArrayLength,x.maxMapLength,x.maxExtLength).decodeMulti(X)}var Xt=function(X,x){var q,ie,W,de,ue={label:0,sent:function(){if(1&W[0])throw W[1];return W[1]},trys:[],ops:[]};return de={next:ye(0),throw:ye(1),return:ye(2)},"function"==typeof Symbol&&(de[Symbol.iterator]=function(){return this}),de;function ye(tt){return function(At){return function(we){if(q)throw new TypeError("Generator is already executing.");for(;ue;)try{if(q=1,ie&&(W=2&we[0]?ie.return:we[0]?ie.throw||((W=ie.return)&&W.call(ie),0):ie.next)&&!(W=W.call(ie,we[1])).done)return W;switch(ie=0,W&&(we=[2&we[0],W.value]),we[0]){case 0:case 1:W=we;break;case 4:return ue.label++,{value:we[1],done:!1};case 5:ue.label++,ie=we[1],we=[0];continue;case 7:we=ue.ops.pop(),ue.trys.pop();continue;default:if(!((W=(W=ue.trys).length>0&&W[W.length-1])||6!==we[0]&&2!==we[0])){ue=0;continue}if(3===we[0]&&(!W||we[1]>W[0]&&we[1]<W[3])){ue.label=we[1];break}if(6===we[0]&&ue.label<W[1]){ue.label=W[1],W=we;break}if(W&&ue.label<W[2]){ue.label=W[2],ue.ops.push(we);break}W[2]&&ue.ops.pop(),ue.trys.pop();continue}we=x.call(X,ue)}catch(xe){we=[6,xe],ie=0}finally{q=W=0}if(5&we[0])throw we[1];return{value:we[0]?we[1]:void 0,done:!0}}([tt,At])}}},et=function(X){return this instanceof et?(this.v=X,this):new et(X)},Zt=function(X,x,q){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ie,W=q.apply(X,x||[]),de=[];return ie={},ue("next"),ue("throw"),ue("return"),ie[Symbol.asyncIterator]=function(){return this},ie;function ue(xe){W[xe]&&(ie[xe]=function(it){return new Promise(function(Yt,ar){de.push([xe,it,Yt,ar])>1||ye(xe,it)})})}function ye(xe,it){try{(Yt=W[xe](it)).value instanceof et?Promise.resolve(Yt.value.v).then(tt,At):we(de[0][2],Yt)}catch(ar){we(de[0][3],ar)}var Yt}function tt(xe){ye("next",xe)}function At(xe){ye("throw",xe)}function we(xe,it){xe(it),de.shift(),de.length&&ye(de[0][0],de[0][1])}};function pt(X){if(null==X)throw new Error("Assertion Failure: value must not be null nor undefined")}function Gt(X){return null!=X[Symbol.asyncIterator]?X:function(x){return Zt(this,arguments,function(){var q,ie,de;return Xt(this,function(ue){switch(ue.label){case 0:q=x.getReader(),ue.label=1;case 1:ue.trys.push([1,,9,10]),ue.label=2;case 2:return[4,et(q.read())];case 3:return ie=ue.sent(),de=ie.value,ie.done?[4,et(void 0)]:[3,5];case 4:return[2,ue.sent()];case 5:return pt(de),[4,et(de)];case 6:return[4,ue.sent()];case 7:return ue.sent(),[3,2];case 8:return[3,10];case 9:return q.releaseLock(),[7];case 10:return[2]}})})}(X)}function li(X,x){return void 0===x&&(x=at),q=this,void 0,de=function(){var ue;return function(ye,tt){var At,we,xe,it,Yt={label:0,sent:function(){if(1&xe[0])throw xe[1];return xe[1]},trys:[],ops:[]};return it={next:ar(0),throw:ar(1),return:ar(2)},"function"==typeof Symbol&&(it[Symbol.iterator]=function(){return this}),it;function ar(Qo){return function(nc){return function(Wn){if(At)throw new TypeError("Generator is already executing.");for(;Yt;)try{if(At=1,we&&(xe=2&Wn[0]?we.return:Wn[0]?we.throw||((xe=we.return)&&xe.call(we),0):we.next)&&!(xe=xe.call(we,Wn[1])).done)return xe;switch(we=0,xe&&(Wn=[2&Wn[0],xe.value]),Wn[0]){case 0:case 1:xe=Wn;break;case 4:return Yt.label++,{value:Wn[1],done:!1};case 5:Yt.label++,we=Wn[1],Wn=[0];continue;case 7:Wn=Yt.ops.pop(),Yt.trys.pop();continue;default:if(!((xe=(xe=Yt.trys).length>0&&xe[xe.length-1])||6!==Wn[0]&&2!==Wn[0])){Yt=0;continue}if(3===Wn[0]&&(!xe||Wn[1]>xe[0]&&Wn[1]<xe[3])){Yt.label=Wn[1];break}if(6===Wn[0]&&Yt.label<xe[1]){Yt.label=xe[1],xe=Wn;break}if(xe&&Yt.label<xe[2]){Yt.label=xe[2],Yt.ops.push(Wn);break}xe[2]&&Yt.ops.pop(),Yt.trys.pop();continue}Wn=tt.call(ye,Yt)}catch(Yc){Wn=[6,Yc],we=0}finally{At=xe=0}if(5&Wn[0])throw Wn[1];return{value:Wn[0]?Wn[1]:void 0,done:!0}}([Qo,nc])}}}(this,function(ye){return ue=Gt(X),[2,new St(x.extensionCodec,x.context,x.maxStrLength,x.maxBinLength,x.maxArrayLength,x.maxMapLength,x.maxExtLength).decodeAsync(ue)]})},new((W=void 0)||(W=Promise))(function(ue,ye){function tt(xe){try{we(de.next(xe))}catch(it){ye(it)}}function At(xe){try{we(de.throw(xe))}catch(it){ye(it)}}function we(xe){var it;xe.done?ue(xe.value):(it=xe.value,it instanceof W?it:new W(function(Yt){Yt(it)})).then(tt,At)}we((de=de.apply(q,[])).next())});var q,W,de}function Xn(X,x){void 0===x&&(x=at);var q=Gt(X);return new St(x.extensionCodec,x.context,x.maxStrLength,x.maxBinLength,x.maxArrayLength,x.maxMapLength,x.maxExtLength).decodeArrayStream(q)}function mr(X,x){void 0===x&&(x=at);var q=Gt(X);return new St(x.extensionCodec,x.context,x.maxStrLength,x.maxBinLength,x.maxArrayLength,x.maxMapLength,x.maxExtLength).decodeStream(q)}function A_(X,x){return void 0===x&&(x=at),mr(X,x)}return s}()})(GD),(0,Pc.exports)("Int8",function(t){return function(i,o,s){return t(this,i,o,s)}}),(0,Pc.exports)("Int16",function(t){return function(i,o,s){return t(this,i,o,s)}}),(0,Pc.exports)("Int32",function(t){return function(i,o,s){return t(this,i,o,s)}}),(0,Pc.exports)("Uint16",function(t){return function(i,o,s){return t(this,i,o,s)}}),(0,Pc.exports)("Uint32",function(t){return function(i,o,s){return t(this,i,o,s)}}),(0,Pc.exports)("Float64",function(t){return function(i,o,s){return t(this,i,o,s)}});const m3=()=>function(t){const i=window.atob("AGFzbQEAAAABMAlgA39/fwF/YAF/AGACf38AYAF/AX9gAn9/AX9gA39/fwBgBH9/f38AYAABf2AAAAI6AgNlbnYWZW1zY3JpcHRlbl9yZXNpemVfaGVhcAADA2VudhVlbXNjcmlwdGVuX21lbWNweV9iaWcAAAMjIggAAAAAAQEDAQEEBAQEAQEGAQYCBQUAAgAHAwEDAAIHAQMEBQFwAQYGBQYBAYACgAIGCQF/AUHQ48ACCweUAQoGbWVtb3J5AgARX193YXNtX2NhbGxfY3RvcnMAAhlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQAGbWFsbG9jABwEZnJlZQAdEF9fZXJybm9fbG9jYXRpb24AGwx6bGliQ29tcHJlc3MAGglzdGFja1NhdmUAIQxzdGFja1Jlc3RvcmUAIgpzdGFja0FsbG9jACMJCwEAQQELBRgZDA0PCq6FAiIDAAELpQcBBH8gAEH//wNxIQMgAEEQdiEEQQEhACACQQFGBEAgAyABLQAAaiIAQfH/A2sgACAAQfD/A0sbIgAgBGoiA0EQdCIEQYCAPGogBCADQfD/A0sbIAByDwsgAQR/IAJBEE8EQAJAAkACQCACQa8rSwRAA0AgAkGwK2shAkHbAiEFIAEhAANAIAMgAC0AAGoiAyAEaiADIAAtAAFqIgNqIAMgAC0AAmoiA2ogAyAALQADaiIDaiADIAAtAARqIgNqIAMgAC0ABWoiA2ogAyAALQAGaiIDaiADIAAtAAdqIgNqIAMgAC0ACGoiA2ogAyAALQAJaiIDaiADIAAtAApqIgNqIAMgAC0AC2oiA2ogAyAALQAMaiIDaiADIAAtAA1qIgNqIAMgAC0ADmoiA2ogAyAALQAPaiIDaiEEIABBEGohACAFQQFrIgUNAAsgBEHx/wNwIQQgA0Hx/wNwIQMgAUGwK2ohASACQa8rSw0ACyACRQ0DIAJBEEkNAQsDQCADIAEtAABqIgAgBGogACABLQABaiIAaiAAIAEtAAJqIgBqIAAgAS0AA2oiAGogACABLQAEaiIAaiAAIAEtAAVqIgBqIAAgAS0ABmoiAGogACABLQAHaiIAaiAAIAEtAAhqIgBqIAAgAS0ACWoiAGogACABLQAKaiIAaiAAIAEtAAtqIgBqIAAgAS0ADGoiAGogACABLQANaiIAaiAAIAEtAA5qIgBqIAAgAS0AD2oiA2ohBCABQRBqIQEgAkEQayICQQ9LDQALIAJFDQELIAJBAWshBiACQQNxIgUEQCABIQADQCACQQFrIQIgAyAALQAAaiIDIARqIQQgAEEBaiIBIQAgBUEBayIFDQALCyAGQQNJDQADQCADIAEtAABqIgAgAS0AAWoiBSABLQACaiIGIAEtAANqIgMgBiAFIAAgBGpqamohBCABQQRqIQEgAkEEayICDQALCyAEQfH/A3AhBCADQfH/A3AhAwsgBEEQdCADcg8LAkAgAkUNACACQQFrIQYgAkEDcSIFBEAgASEAA0AgAkEBayECIAMgAC0AAGoiAyAEaiEEIABBAWoiASEAIAVBAWsiBQ0ACwsgBkEDSQ0AA0AgAyABLQAAaiIAIAEtAAFqIgUgAS0AAmoiBiABLQADaiIDIAYgBSAAIARqampqIQQgAUEEaiEBIAJBBGsiAg0ACwsgBEHx/wNwQRB0IANB8f8DayADIANB8P8DSxtyBSAACwsKACAAIAEgAhADC4UJAQJ/IAFFBEBBAA8LIABBf3MhAAJAIAJFDQAgAUEDcUUNACABLQAAIABB/wFxc0ECdEGACGooAgAgAEEIdnMhACACQQFrIgRBACABQQFqIgNBA3EbRQRAIAMhASAEIQIMAQsgAS0AASAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUECaiEDAkAgAkECayIERQ0AIANBA3FFDQAgAS0AAiAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUEDaiEDAkAgAkEDayIERQ0AIANBA3FFDQAgAS0AAyAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAkEEayECIAFBBGohAQwCCyADIQEgBCECDAELIAMhASAEIQILIAJBH0sEQANAIAEoAhwgASgCGCABKAIUIAEoAhAgASgCDCABKAIIIAEoAgQgASgCACAAcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAc3MiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAc3MiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAcyEAIAFBIGohASACQSBrIgJBH0sNAAsLIAJBA0sEQANAIAEoAgAgAHMiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzIQAgAUEEaiEBIAJBBGsiAkEDSw0ACwsCQCACRQ0AIAJBAXEEfyABLQAAIABB/wFxc0ECdEGACGooAgAgAEEIdnMhACABQQFqIQEgAkEBawUgAgshAyACQQFGDQADQCABLQABIAEtAAAgAEH/AXFzQQJ0QYAIaigCACAAQQh2cyIAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUECaiEBIANBAmsiAw0ACwsgAEF/cwsKACAAIAEgAhAFC9wEAQN/AkBByN8ALQAAQTFHDQAgAEUNACAAQQA2AhggACgCICIBRQRAIABBADYCKCAAQQE2AiBBASEBCyAAKAIkRQRAIABBAjYCJAsgACgCKEEBQcQtIAERAAAiAUUNACAAIAE2AhwgAUEPNgIwIAFBADYCHCABQQA2AhggAUEqNgIEIAEgADYCACABQQs2AlAgAUGAgAI2AiwgAUH//wE2AjQgAUGAEDYCTCABQQQ2AlggAUH/DzYCVCABIAAoAihBgIACQQIgACgCIBEAADYCOCABIAAoAiggASgCLEECIAAoAiARAAA2AkAgACgCKCABKAJMQQIgACgCIBEAACECIAFBADYCwC0gASACNgJEIAFBgAg2ApwtIAEgACgCKEGACEEEIAAoAiARAAAiAjYCCCABIAEoApwtIgNBAnQ2AgwCQAJAIAEoAjhFDQAgASgCQEUNACACRQ0AIAEoAkQNAQsgAUGaBTYCBCAAQbjfACgCADYCGCAAEAgPCyABQQA2AogBIAFBCTYChAEgAUEIOgAkIAEgAiADQQNsajYCmC0gASACIANBfnFqNgKkLSAAEAkNACAAKAIcIgAgACgCLEEBdDYCPCAAKAJEIgEgACgCTEEBdEECayIDakEAOwEAIAEgAxAgIABBADYCtC0gAEKAgICAIDcCdCAAQgA3AmggAEKAgICAIDcCXCAAQQA2AkggACAAKAKEAUEMbCIBQYTIAGovAQA2ApABIAAgAUGAyABqLwEANgKMASAAIAFBgsgAai8BADYCgAEgACABQYbIAGovAQA2AnwLC6kCAQN/AkAgAEUNACAAKAIgRQ0AIAAoAiQiA0UNACAAKAIcIgFFDQAgASgCACAARw0AAkACQCABKAIEIgJBOWsOOQECAgICAgICAgICAgECAgIBAgICAgICAgICAgICAgICAgIBAgICAgICAgICAgIBAgICAgICAgICAQALIAJBmgVGDQAgAkEqRw0BCwJ/An8CfyABKAIIIgIEQCAAKAIoIAIgAxECACAAKAIcIQELIAEoAkQiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAEoAkAiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAEoAjgiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAAoAiggASAAKAIkEQIAIABBADYCHAsLlgIBA39BfiECAkAgAEUNACAAKAIgRQ0AIAAoAiRFDQAgACgCHCIBRQ0AIAEoAgAgAEcNAAJAAkAgASgCBCIDQTlrDjkBAgICAgICAgICAgIBAgICAQICAgICAgICAgICAgICAgICAQICAgICAgICAgICAQICAgICAgICAgEACyADQZoFRg0AIANBKkcNAQsgAEECNgIsIABBADYCCCAAQgA3AhQgAUEANgIUIAEgASgCCDYCECABKAIYIgJBf0wEQCABQQAgAmsiAjYCGAsgAUE5QSpB8QAgAhsgAkECRhs2AgQgAAJ/IAJBAkYEQEEAQQBBABAGDAELQQBBAEEAEAQLNgIwQQAhAiABQQA2AiggARAQCyACC9wIAQt/IAAoAiwiB0GGAmshCyAAKAJ0IQUgByEBA0AgACgCPCAFayAAKAJsIghrIQYgASALaiAITQRAIAAoAjgiASABIAdqIAcgBmsQHxogACAAKAJwIAdrNgJwIAAgACgCbCAHayIINgJsIAAgACgCXCAHazYCXCAAKAJMIgRBAWshCiAAKAJEIARBAXRqIQMgACgCLCEBIARBA3EiAgRAA0AgA0ECayIDQQAgAy8BACIFIAFrIgkgBSAJSRs7AQAgBEEBayEEIAJBAWsiAg0ACwsgCkEDTwRAA0AgA0ECayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EEayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EGayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EIayIDQQAgAy8BACICIAFrIgUgAiAFSRs7AQAgBEEEayIEDQALCyABQQFrIQogACgCQCABQQF0aiEDIAEhBCABQQNxIgIEQANAIANBAmsiA0EAIAMvAQAiBSABayIJIAUgCUkbOwEAIARBAWshBCACQQFrIgINAAsLIApBA08EQANAIANBAmsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBBGsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBBmsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBCGsiA0EAIAMvAQAiAiABayIFIAIgBUkbOwEAIARBBGsiBA0ACwsgBiAHaiEGCwJAIAAoAgAiASgCBCIERQ0AIAAoAnQhAiAGIAQgBCAGSxsiAwRAIAAoAjghBSABIAQgA2s2AgQgBSAIaiACaiABKAIAIAMQHyEEAkACQAJAIAEoAhwoAhhBAWsOAgABAgsgASABKAIwIAQgAxAENgIwDAELIAEgASgCMCAEIAMQBjYCMAsgASABKAIAIANqNgIAIAEgASgCCCADajYCCCAAKAJ0IQILIAAgAiADaiIFNgJ0AkAgACgCtC0iAyAFakEDSQ0AIAAgACgCOCIJIAAoAmwgA2siAWoiBC0AACICNgJIIAAgACgCVCIIIAQtAAEgAiAAKAJYIgZ0c3EiBDYCSANAIANFDQEgACABIAlqLQACIAQgBnRzIAhxIgQ2AkggACgCQCAAKAI0IAFxQQF0aiAAKAJEIARBAXRqIgIvAQA7AQAgAiABOwEAIAAgA0EBayIDNgK0LSABQQFqIQEgAyAFakECSw0ACwsgBUGFAksNACAAKAIAKAIERQ0AIAAoAiwhAQwBCwsCQCAAKAI8IgQgACgCwC0iAU0NACAAKAJ0IAAoAmxqIgMgAUsEQCAAKAI4IANqIAQgA2siAUGCAiABQYICSRsiARAgIAAgASADajYCwC0PCyADQYICaiIDIAFNDQAgACgCOCABaiAEIAFrIgQgAyABayIBIAEgBEsbIgEQICAAIAAoAsAtIAFqNgLALQsLsSwBCn8CQCAARQ0AIAAoAiBFDQAgACgCJEUNACAAKAIcIgFFDQAgASgCACAARw0AAkACQCABKAIEIgNBOWsOOQECAgICAgICAgICAgECAgIBAgICAgICAgICAgICAgICAgIBAgICAgICAgICAgIBAgICAgICAgICAQALIANBmgVGDQAgA0EqRw0BCwJAAkAgACgCDEUNACAAKAIEIgIEQCAAKAIARQ0BCyADQZoFRw0BCyAAQbDfACgCADYCGA8LIAAoAhBFBEAgAEG83wAoAgA2AhgPCyABKAIoIQUgAUEDNgIoAkAgASgCFARAIAEQEwJAIAAoAhAiAyABKAIUIgQgAyAESRsiAkUNACAAKAIMIAEoAhAgAhAfGiAAIAAoAgwgAmo2AgwgASABKAIQIAJqNgIQIAAgACgCFCACajYCFCAAIAAoAhAgAmsiAzYCECABIAEoAhQgAmsiBDYCFCAEDQAgASABKAIINgIQQQAhBAsgAwRAIAEoAgQhAwwCCyABQX82AigPCyACDQAgBUEBdEF3QQAgBUEEShtqQQZIDQAgAEG83wAoAgA2AhgPCwJAAkACQAJAAn8CQAJAAkACQAJAAkAgA0EqRwRAIANBmgVHDQEgACgCBEUNAiAAQbzfACgCADYCGA8LIAEoAjBBDHRBgPABayEDQQAhAgJAIAEoAogBQQFKDQAgASgChAEiBUECSA0AQcAAIQIgBUEGSA0AQYABQcABIAVBBkYbIQILIAEgBEEBajYCFCABKAIIIARqIAIgA3IiAkEgciACIAEoAmwbIgJBCHY6AAAgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQR9wIAJyQR9zOgAAIAEoAmwEQCAAKAIwIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQRh2OgAAIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAkEQdjoAACAAKAIwIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQQh2OgAAIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAjoAAAsgAEEAQQBBABAENgIwIAFB8QA2AgQgACgCHCICEBMCQCAAKAIQIgMgAigCFCIEIAMgBEkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQNBCABKAIEIQMLAkACQAJAAkACQAJAAkAgA0E5RgR/IABBAEEAQQAQBjYCMCABIAEoAhQiAkEBajYCFCACIAEoAghqQR86AAAgASABKAIUIgJBAWo2AhQgAiABKAIIakGLAToAACABIAEoAhQiAkEBajYCFCACIAEoAghqQQg6AAAgASgCHCICDQIgASABKAIUIgJBAWo2AhQgAiABKAIIakEAOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBADoAACABIAEoAhQiAkEBajYCFCACIAEoAghqQQA6AAAgASABKAIUIgJBAWo2AhQgAiABKAIIakEAOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBADoAAEECIQIgASgChAEiA0EJRwRAQQQgASgCiAFBAUpBAnQgA0ECSBshAgsgASABKAIUIgNBAWo2AhQgAyABKAIIaiACOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBAzoAACABQfEANgIEIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQCyABKAIUDQEgASgCBAUgAwtBxQBrDiMCBgYGAwYGBgYGBgYGBgYGBgYGBgYGBAYGBgYGBgYGBgYGBQYLIAFBfzYCKA8LIAIoAiQhAyACKAIcIQQgAigCECEFIAIoAiwhBiACKAIAIQggASABKAIUIgdBAWo2AhRBAiECIAcgASgCCGogBkEAR0EBdCAIQQBHciAFQQBHQQJ0ciAEQQBHQQN0ciADQQBHQQR0cjoAACABKAIcKAIEIQMgASABKAIUIgRBAWo2AhQgBCABKAIIaiADOgAAIAEoAhwoAgQhAyABIAEoAhQiBEEBajYCFCAEIAEoAghqIANBCHY6AAAgASgCHC8BBiEDIAEgASgCFCIEQQFqNgIUIAQgASgCCGogAzoAACABKAIcLQAHIQMgASABKAIUIgRBAWo2AhQgBCABKAIIaiADOgAAIAEoAoQBIgNBCUcEQEEEIAEoAogBQQFKQQJ0IANBAkgbIQILIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAjoAACABKAIcKAIMIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACOgAAIAEoAhwiAigCEAR/IAIoAhQhAiABIAEoAhQiA0EBajYCFCADIAEoAghqIAI6AAAgASgCHCgCFCECIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAkEIdjoAACABKAIcBSACCygCLARAIAAgACgCMCABKAIIIAEoAhQQBjYCMAsgAUHFADYCBCABQQA2AiALIAEoAhwiBCgCECIDBEAgASgCFCICIAQvARQgASgCICIGayIFaiABKAIMIgRLBEADQCABKAIIIAJqIAMgBmogBCACayIEEB8aIAEgASgCDCIDNgIUAkAgAiADTw0AIAEoAhwoAixFDQAgACAAKAIwIAEoAgggAmogAyACaxAGNgIwCyABIAEoAiAgBGo2AiAgACgCHCICEBMCQCAAKAIQIgMgAigCFCIGIAMgBkkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQEQCABQX82AigPCyABKAIgIQYgASgCHCgCECEDQQAhAiAFIARrIgUgASgCDCIESw0ACwsgASgCCCACaiADIAZqIAUQHxogASABKAIUIAVqIgM2AhQCQCACIANPDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCACaiADIAJrEAY2AjALIAFBADYCIAsgAUHJADYCBAsgASgCHCgCHARAIAEoAhQiAiEFA0ACQCACIAEoAgxHDQACQCACIAVNDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQC0EAIQJBACEFIAEoAhRFDQAgAUF/NgIoDwsgASgCHCgCHCEDIAEgASgCICIEQQFqNgIgIAMgBGotAAAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAMEQCABKAIUIQIMAQsLAkAgASgCHCgCLEUNACABKAIUIgIgBU0NACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAFBADYCIAsgAUHbADYCBAsCQCABKAIcKAIkRQ0AIAEoAhQiAiEFA0ACQCACIAEoAgxHDQACQCACIAVNDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQC0EAIQJBACEFIAEoAhRFDQAgAUF/NgIoDwsgASgCHCgCJCEDIAEgASgCICIEQQFqNgIgIAMgBGotAAAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAMEQCABKAIUIQIMAQsLIAEoAhwoAixFDQAgASgCFCICIAVNDQAgACAAKAIwIAEoAgggBWogAiAFaxAGNgIwCyABQecANgIECyABKAIcKAIsBEAgASgCDCABKAIUIgJBAmpJBEAgACgCHCICEBMCQCAAKAIQIgMgAigCFCIEIAMgBEkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQNBUEAIQILIAAoAjAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAAoAjAhAiABIAEoAhQiA0EBajYCFCADIAEoAghqIAJBCHY6AAAgAEEAQQBBABAGNgIwCyABQfEANgIEIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQCyABKAIURQ0AIAFBfzYCKA8LIAAoAgQNAQsgASgCdA0AIAEoAgRBmgVGDQgLIAEoAoQBIgJFBEAgAUEDEAwMBAsCQAJAIAEoAogBQQJrDgIAAQQLA0ACQAJAIAEoAnQNACABEAogASgCdA0AIAFBADYCtC0MAQsgAUEANgJgIAEoAjggASgCbGotAAAhAiABKAKkLSABKAKgLSIDQQF0akEAOwEAIAEgA0EBajYCoC0gAyABKAKYLWogAjoAACABIAJBAnRqQZQBaiICIAIvAQBBAWo7AQAgASABKAJ0QQFrNgJ0IAEgASgCbEEBaiICNgJsIAEoAqAtIAEoApwtQQFrRw0BIAEgASgCXCIEQQBOBH8gASgCOCAEagVBAAsgAiAEa0EAEBQgASABKAJsNgJcIAEoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALIAEoAgAoAhANAQwHCwsgASgCoC1FDQcgASABKAJcIgNBAE4EfyABKAI4IANqBUEACyABKAJsIANrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEEUNBQwHCwNAAkACQAJAIAEoAnQiAkGDAk8EQCABQQA2AmAMAQsgARAKIAEoAnQiAgRAIAFBADYCYCACQQJLDQEgASgCbCEDDAILIAFBADYCtC0gASgCoC1FDQogASABKAJcIgNBAE4EfyABKAI4IANqBUEACyABKAJsIANrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEEUNCAwKCyABKAJsIgNFBEBBACEDDAELIAEoAjggA2oiBkEBayIFLQAAIgQgBi0AAEcNACAEIAUtAAJHDQAgBCAFLQADRw0AIAZBggJqIQlBfyEIAkACQAJAAkACQAJAA0AgBiAIaiIFLQAEIARGBEAgBCAFLQAFRw0CIAQgBS0ABkcNAyAEIAUtAAdHDQQgBCAGIAhBCGoiCmoiBy0AAEcNByAEIAUtAAlHDQUgBCAFLQAKRw0GIAVBC2ohByAIQfYBSg0HIAohCCAEIActAABGDQEMBwsLIAVBBGohBwwFCyAFQQVqIQcMBAsgBUEGaiEHDAMLIAVBB2ohBwwCCyAFQQlqIQcMAQsgBUEKaiEHCyABIAIgByAJa0GCAmoiBCACIARJGyICNgJgIAJBA0kNACABKAKkLSABKAKgLSIDQQF0akEBOwEAIAEgA0EBajYCoC0gAyABKAKYLWogAkEDayICOgAAIAJB/wFxQYDNAGotAABBAnQgAWpBmAlqIgIgAi8BAEEBajsBACABQYDJAC0AAEECdGpBiBNqIgIgAi8BAEEBajsBACABKAJgIQIgAUEANgJgIAEgASgCdCACazYCdCABIAIgASgCbGoiAjYCbCABKAKgLSABKAKcLUEBa0cNAgwBCyABKAI4IANqLQAAIQIgASgCpC0gASgCoC0iA0EBdGpBADsBACABIANBAWo2AqAtIAMgASgCmC1qIAI6AAAgASACQQJ0akGUAWoiAiACLwEAQQFqOwEAIAEgASgCdEEBazYCdCABIAEoAmxBAWoiAjYCbCABKAKgLSABKAKcLUEBa0cNAQsgASABKAJcIgRBAE4EfyABKAI4IARqBUEACyACIARrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEA0ACwwECyABQX82AigPCyABQX82AigPCyABQQMgAkEMbEGIyABqKAIAEQQACyICQX5xQQJGBEAgAUGaBTYCBAsgAkF9cQ0BCyAAKAIQDQMgAUF/NgIoDwsgAkEBRw0BCyABQQBBAEEAEBIgASgCRCICIAEoAkxBAXRBAmsiA2pBADsBACACIAMQICABKAJ0RQRAIAFBADYCtC0gAUEANgJcIAFBADYCbAsgACgCHCICEBMCQCAAKAIQIgQgAigCFCIDIAMgBEsbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrIgQ2AhAgAiACKAIUIANrIgM2AhQgAw0AIAIgAigCCDYCEAsgBA0AIAFBfzYCKAsLC7YNAQt/IAAoAgAiBCgCBCEJQQEhCAJAIAQoAhAiAyAAKAK8LUEqakEDdSICSQ0AIAAoAiwiBSAAKAIMQQVrIgYgBSAGSRshCiABQQRHIQsDQCAKIAMgAmsiAyAAKAJsIAAoAlxrIgYgBCgCBGoiAkH//wMgAkH//wNJGyIFIAMgBUkbIgNLBEAgAiADRw0CIAFFDQIgCyADRXENAgsgAEEAQQAgAUEERiACIANGcSIHEBIgACgCFCAAKAIIakEEayADOgAAIAAoAhQgACgCCGpBA2sgA0EIdjoAACAAKAIUIAAoAghqQQJrIANBf3MiAjoAACAAKAIUIAAoAghqQQFrIAJBCHY6AAAgACgCACICKAIcIgQQEwJAIAIoAhAiBSAEKAIUIgwgBSAMSRsiBUUNACACKAIMIAQoAhAgBRAfGiACIAIoAgwgBWo2AgwgBCAEKAIQIAVqNgIQIAIgAigCFCAFajYCFCACIAIoAhAgBWs2AhAgBCAEKAIUIAVrIgI2AhQgAg0AIAQgBCgCCDYCEAsCfyAGBEAgACgCACgCDCAAKAI4IAAoAlxqIAMgBiADIAZJGyICEB8aIAAoAgAiBCAEKAIMIAJqNgIMIAQgBCgCECACazYCECAEIAQoAhQgAmo2AhQgACAAKAJcIAJqNgJcIAMgAmshAwsgAwsEQCAAKAIAIgIoAgwhBSADIAIoAgQiBiADIAZJGyIEBEAgAiAGIARrNgIEIAUgAigCACAEEB8hBQJAAkACQCACKAIcKAIYQQFrDgIAAQILIAIgAigCMCAFIAQQBDYCMAwBCyACIAIoAjAgBSAEEAY2AjALIAIgAigCACAEajYCACACIAIoAgggBGo2AgggACgCACICKAIMIQULIAIgAyAFajYCDCACIAIoAhAgA2s2AhAgAiACKAIUIANqNgIUCyAAKAIAIQQgBwRAQQAhCAwCCyAEKAIQIgMgACgCvC1BKmpBA3UiAk8NAAsLAkAgCSAEKAIEayIDRQRAIAAoAmwhAgwBCwJAIAAoAiwiAiADTQRAIABBAjYCsC0gACgCOCAEKAIAIAJrIAIQHxogACAAKAIsIgQ2AmwgBCECDAELAkAgACgCPCAAKAJsIgRrIANLDQAgACAEIAJrIgQ2AmwgACgCOCIFIAIgBWogBBAfGiAAKAKwLSICQQFLDQAgACACQQFqNgKwLQsgACgCOCAAKAJsaiAAKAIAKAIAIANrIAMQHxogACAAKAJsIANqIgI2AmwgACgCLCEECyAAIAI2AlwgACAEIAAoArQtIgVrIgQgAyADIARLGyAFajYCtC0LIAIgACgCwC1LBEAgACACNgLALQtBAyEDAkAgCEUNACAAKAIAIgQoAgQhAwJAAkAgAUF7cUUNACADDQBBASEDIAIgACgCXEYNAiAAKAI8IAJBf3NqIQVBACEDDAELIAMgACgCPCACQX9zaiIFTQ0AIAAoAlwiByAAKAIsIgZIDQAgACACIAZrIgM2AmwgACAHIAZrNgJcIAAoAjgiAiACIAZqIAMQHxogACgCsC0iA0EBTQRAIAAgA0EBajYCsC0LIAAoAiwgBWohBSAAKAIAIgQoAgQhAwsCQCADIAUgAyAFSRsiAkUEQCAAKAJsIQMMAQsgACgCbCEFIAAoAjghBiAEIAMgAms2AgQgBSAGaiAEKAIAIAIQHyEDAkACQAJAIAQoAhwoAhhBAWsOAgABAgsgBCAEKAIwIAMgAhAENgIwDAELIAQgBCgCMCADIAIQBjYCMAsgBCAEKAIAIAJqNgIAIAQgBCgCCCACajYCCCAAIAAoAmwgAmoiAzYCbAsgAyAAKALALUsEQCAAIAM2AsAtCyADIAAoAlwiBmsiBCAAKAIsIgMgACgCDCAAKAK8LUEqakEDdWsiAkH//wMgAkH//wNJGyICIAIgA0sbSQRAQQAhAyABRQ0BIAFBBEYgBEEAR3JFDQEgAiAESQ0BIAAoAgAoAgQNAQtBACEFIAAgACgCOCAGaiACIAQgAiAESRsiAwJ/IAFBBEYEQCAAKAIAKAIERSACIARPcSEFCyAFCxASIAAgACgCXCADajYCXCAAKAIAIgAoAhwiAxATAkAgACgCECICIAMoAhQiBCACIARJGyICRQ0AIAAoAgwgAygCECACEB8aIAAgACgCDCACajYCDCADIAMoAhAgAmo2AhAgACAAKAIUIAJqNgIUIAAgACgCECACazYCECADIAMoAhQgAmsiADYCFCAADQAgAyADKAIINgIQC0ECQQAgBRshAwsgAwu5CwENfwJAA0ACQAJAIAAoAnRBhQJNBEAgABAKIAAoAnQhAgJAIAENACACQYYCTw0AQQAPCyACRQ0EIAJBA0kNAQsgACAAKAJUIAAoAmwiAiAAKAI4ai0AAiAAKAJIIAAoAlh0c3EiAzYCSCAAKAJAIAIgACgCNHFBAXRqIAAoAkQgA0EBdGoiBC8BACIDOwEAIAQgAjsBACADRQ0AIAAoAixBhgJrIAIgA2tJDQAgACAAIAMQDiICNgJgDAELIAAoAmAhAgsCQCACQQNPBEAgACgCpC0gACgCoC0iA0EBdGogACgCbCAAKAJwayIEOwEAIAAgA0EBajYCoC0gAyAAKAKYLWogAkEDayICOgAAIAJB/wFxQYDNAGotAABBAnQgAGpBmAlqIgIgAi8BAEEBajsBACAAIARBAWtB//8DcSICIAJBB3ZBgAJqIAJBgAJJG0GAyQBqLQAAQQJ0akGIE2oiAiACLwEAQQFqOwEAIAAgACgCdCAAKAJgIgJrIgM2AnQgACgCnC1BAWshBiAAKAKgLSEHAkAgA0EDSQ0AIAIgACgCgAFLDQAgACACQQFrIgM2AmAgACgCSCEEIAAoAmwhAiAAKAI0IQggACgCQCEJIAAoAkQhCiAAKAJUIQsgACgCOCEMIAAoAlghDQNAIAAgAiIFQQFqIgI2AmwgACAFIAxqLQADIAQgDXRzIAtxIgQ2AkggCSACIAhxQQF0aiAKIARBAXRqIg4vAQA7AQAgDiACOwEAIAAgA0EBayIDNgJgIAMNAAsgACAFQQJqIgI2AmwgBiAHRw0DDAILIABBADYCYCAAIAAoAmwgAmoiAjYCbCAAIAAoAjggAmoiAy0AACIENgJIIAAgACgCVCADLQABIAQgACgCWHRzcTYCSCAGIAdHDQIMAQsgACgCOCAAKAJsai0AACECIAAoAqQtIAAoAqAtIgNBAXRqQQA7AQAgACADQQFqNgKgLSADIAAoApgtaiACOgAAIAAgAkECdGpBlAFqIgIgAi8BAEEBajsBACAAIAAoAnRBAWs2AnQgACAAKAJsQQFqIgI2AmwgACgCoC0gACgCnC1BAWtHDQELQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQCyAAKAIAKAIQDQALQQAPCyAAIAAoAmwiAkECIAJBAkkbNgK0LSABQQRGBEBBACEDIAAgACgCXCIEQQBOBH8gACgCOCAEagUgAwsgAiAEa0EBEBQgACAAKAJsNgJcIAAoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALQQNBAiAAKAIAKAIQGw8LAkAgACgCoC1FDQBBACEDIAAgACgCXCIEQQBOBH8gACgCOCAEagUgAwsgAiAEa0EAEBQgACAAKAJsNgJcIAAoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALIAAoAgAoAhANAEEADwtBAQukBAEQfyAAKAJ8IgMgA0ECdiAAKAJ4IgQgACgCjAFJGyEJQQAgACgCbCIDIAAoAixrQYYCaiICIAIgA0sbIQwgACgCdCIHIAAoApABIgIgAiAHSxshDSAAKAI4Ig4gA2oiBUGCAmohDyAEIAVqIgMtAAAhCiADQQFrLQAAIQsgACgCNCEQIAAoAkAhEQNAAkACQCABIA5qIgMgBGoiAi0AACAKRw0AIAJBAWstAAAgC0cNACADLQAAIAUtAABHDQBBAiEGIAMtAAEgBS0AAUcNAAJAAkACQAJAAkACQAJAA0AgBSAGaiICLQABIAMtAANHDQYgAi0AAiADLQAERw0FIAItAAMgAy0ABUcNBCACLQAEIAMtAAZHDQMgAi0ABSADLQAHRw0CIAItAAYgAy0ACEcNASACLQAHIAMtAAlGBEAgBkH5AUshCCAFIAZBCGoiBmohAiAIDQggAy0ACiEIIANBCGohAyACLQAAIAhGDQEMCAsLIAJBB2ohAgwGCyACQQZqIQIMBQsgAkEFaiECDAQLIAJBBGohAgwDCyACQQNqIQIMAgsgAkECaiECDAELIAJBAWohAgsgAiAPayICQYICaiIDIARMDQAgACABNgJwIAMgDU4EQCADIQQMAgsgAyAFai0AACEKIAIgBWotAIECIQsgAyEECyAJQQFrIglFDQAgDCARIAEgEHFBAXRqLwEAIgFJDQELCyAHIAQgBCAHSxsL3Q4BB38DQAJAAkACQCAAKAJ0QYUCSw0AIAAQCiAAKAJ0IQICQCABDQAgAkGGAk8NAEEADwsgAkUNAiACQQJLDQAgACAAKAJgIgI2AnggACAAKAJwNgJkQQIhAyAAQQI2AmAMAQtBAiEDIAAgACgCVCAAKAJsIgIgACgCOGotAAIgACgCSCAAKAJYdHNxIgQ2AkggACgCQCACIAAoAjRxQQF0aiAAKAJEIARBAXRqIgUvAQAiBDsBACAFIAI7AQAgACAAKAJgIgI2AnggACAAKAJwNgJkIABBAjYCYCAERQ0AAkAgAiAAKAKAAU8NACAAKAIsQYYCayAAKAJsIARrSQ0AIAAgACAEEA4iAzYCYCADQQVLDQAgACgCiAFBAUcEQCADQQNHDQFBAyEDIAAoAmwgACgCcGtBgSBJDQELQQIhAyAAQQI2AmALIAAoAnghAgsCQCACQQNJDQAgAiADSQ0AIAAoAnQhBCAAKAKkLSAAKAKgLSIDQQF0aiAAKAJsIgUgACgCZEF/c2oiBjsBACAAIANBAWo2AqAtIAMgACgCmC1qIAJBA2siAjoAACACQf8BcUGAzQBqLQAAQQJ0IABqQZgJaiICIAIvAQBBAWo7AQAgACAGQQFrQf//A3EiAiACQQd2QYACaiACQYACSRtBgMkAai0AAEECdGpBiBNqIgIgAi8BAEEBajsBACAAIAAoAngiAkECayIDNgJ4IAAgACgCdCACa0EBajYCdCAEIAVqQQNrIQUgACgCnC1BAWshByAAKAJsIQIgACgCoC0hCANAIAAgAiIEQQFqIgI2AmwgAiAFTQRAIAAgACgCVCAEIAAoAjhqLQADIAAoAkggACgCWHRzcSIGNgJIIAAoAkAgACgCNCACcUEBdGogACgCRCAGQQF0aiIGLwEAOwEAIAYgAjsBAAsgACADQQFrIgM2AnggAw0ACyAAQQI2AmAgAEEANgJoIAAgBEECaiICNgJsIAcgCEcNAkEAIQMgACAAKAJcIgRBAE4EfyAAKAI4IARqBSADCyACIARrQQAQFCAAIAAoAmw2AlwgACgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgACgCACgCEA0CQQAPCyAAKAJoBEAgACgCbCAAKAI4akEBay0AACECIAAoAqQtIAAoAqAtIgNBAXRqQQA7AQAgACADQQFqNgKgLSADIAAoApgtaiACOgAAIAAgAkECdGpBlAFqIgIgAi8BAEEBajsBAAJAIAAoAqAtIAAoApwtQQFrRw0AQQAhAyAAIAAoAlwiAkEATgR/IAAoAjggAmoFIAMLIAAoAmwgAmtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgACAAKAJsQQFqNgJsIAAgACgCdEEBazYCdCAAKAIAKAIQDQJBAA8FIABBATYCaCAAIAAoAmxBAWo2AmwgACAAKAJ0QQFrNgJ0DAILAAsLIAAoAmgEQCAAKAJsIAAoAjhqQQFrLQAAIQIgACgCpC0gACgCoC0iA0EBdGpBADsBACAAIANBAWo2AqAtIAMgACgCmC1qIAI6AAAgACACQQJ0akGUAWoiAiACLwEAQQFqOwEAIABBADYCaAsgACAAKAJsIgJBAiACQQJJGzYCtC0gAUEERgRAQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBARAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQC0EDQQIgACgCACgCEBsPCwJAIAAoAqAtRQ0AQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQCyAAKAIAKAIQDQBBAA8LQQELYQAgAEEANgK8LSAAQQA7AbgtIABBuBZqQajPADYCACAAIABB/BRqNgKwFiAAQawWakGUzwA2AgAgACAAQYgTajYCpBYgAEGgFmpBgM8ANgIAIAAgAEGUAWo2ApgWIAAQEQvwBAEDfyAAQZQBaiECA0AgAiABQQJ0IgNqQQA7AQAgAiADQQRyakEAOwEAIAFBAmoiAUGeAkcNAAsgAEEAOwH8FCAAQQA7AYgTIABBxBVqQQA7AQAgAEHAFWpBADsBACAAQbwVakEAOwEAIABBuBVqQQA7AQAgAEG0FWpBADsBACAAQbAVakEAOwEAIABBrBVqQQA7AQAgAEGoFWpBADsBACAAQaQVakEAOwEAIABBoBVqQQA7AQAgAEGcFWpBADsBACAAQZgVakEAOwEAIABBlBVqQQA7AQAgAEGQFWpBADsBACAAQYwVakEAOwEAIABBiBVqQQA7AQAgAEGEFWpBADsBACAAQYAVakEAOwEAIABB/BNqQQA7AQAgAEH4E2pBADsBACAAQfQTakEAOwEAIABB8BNqQQA7AQAgAEHsE2pBADsBACAAQegTakEAOwEAIABB5BNqQQA7AQAgAEHgE2pBADsBACAAQdwTakEAOwEAIABB2BNqQQA7AQAgAEHUE2pBADsBACAAQdATakEAOwEAIABBzBNqQQA7AQAgAEHIE2pBADsBACAAQcQTakEAOwEAIABBwBNqQQA7AQAgAEG8E2pBADsBACAAQbgTakEAOwEAIABBtBNqQQA7AQAgAEGwE2pBADsBACAAQawTakEAOwEAIABBqBNqQQA7AQAgAEGkE2pBADsBACAAQaATakEAOwEAIABBnBNqQQA7AQAgAEGYE2pBADsBACAAQZQTakEAOwEAIABBkBNqQQA7AQAgAEGME2pBADsBACAAQgA3AqwtIABBlAlqQQE7AQAgAEEANgKoLSAAQQA2AqAtC7IDAQJ/IAAgAC8BuC0gA0H//wNxIgUgACgCvC0iBHRyIgM7AbgtAkACQAJ/IARBDk4EQCAAIAAoAhQiBEEBajYCFCAEIAAoAghqIAM6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAAQbktai0AADoAACAAIAVBECAAKAK8LSIEa3YiAzsBuC0gBEENawwBCyAEQQNqCyIEQQlOBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiADOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGohBCAAQbktai0AACEDDAELIARBAUgNASAAIAAoAhQiBEEBajYCFCAEIAAoAghqIQQLIAQgAzoAAAsgAEEANgK8LSAAQQA7AbgtIAAgACgCFCIDQQFqNgIUIAMgACgCCGogAjoAACAAIAAoAhQiA0EBajYCFCADIAAoAghqIAJBCHY6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiACQX9zIgM6AAAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiADQQh2OgAAIAAoAgggACgCFGogASACEB8aIAAgACgCFCACajYCFAusAQEBfwJAIAACfyAAKAK8LSIBQRBGBEAgACAAKAIUIgFBAWo2AhQgASAAKAIIaiAALQC4LToAACAAIAAoAhQiAUEBajYCFCABIAAoAghqIABBuS1qLQAAOgAAIABBADsBuC1BAAwBCyABQQhIDQEgACAAKAIUIgFBAWo2AhQgASAAKAIIaiAALQC4LToAACAAIABBuS1qLQAAOwG4LSAAKAK8LUEIaws2ArwtCwuhEwENfwJ/AkACQAJAIAAoAoQBQQFOBEAgACgCACIGKAIsQQJHDQNB/4D/n38hBANAAkAgBEEBcUUNACAAIAVBAnRqLwGUAUUNAEEAIQQMBAsCQCAEQQJxRQ0AIAAgBUECdEEEcmovAZQBRQ0AQQAhBAwECyAEQQJ2IQQgBUECaiIFQSBHDQALDAELIAJBBWoiBQwDCwJAIAAvAbgBDQAgAC8BvAENACAALwHIAQ0AQSAhBQNAIAAgBUECdCIEai8BlAENASAAIARBBHJqLwGUAQ0BIAAgBEEIcmovAZQBDQEgACAEQQxyai8BlAENAUEAIQQgBUEEaiIFQYACRw0ACwwBC0EBIQQLIAYgBDYCLAsgACAAQZgWahAVIAAgAEGkFmoQFSAALwGWASEEIAAgAEGcFmooAgAiCkECdGpB//8DOwGaASAKQQBOBEBBB0GKASAEGyEJQQRBAyAEGyELIABBwBVqIQ4gAEHEFWohDyAAQbwVaiEQQX8hDANAIAQhBSAAIAgiDUEBaiIIQQJ0ai8BlgEhBAJAAkAgB0EBaiIGIAlODQAgBCAFRw0AIAYhBwwBCwJ/IAYgC0gEQCAAIAVBAnRqQfwUaiIHLwEAIAZqDAELIAUEQCAFIAxHBEAgACAFQQJ0akH8FGoiBiAGLwEAQQFqOwEACyAQIgcvAQBBAWoMAQsgB0EJTARAIA4iBy8BAEEBagwBCyAPIgcvAQBBAWoLIQYgByAGOwEAQQAhBwJ/IARFBEBBAyELQYoBDAELQQNBBCAEIAVGIgYbIQtBBkEHIAYbCyEJIAUhDAsgCiANRw0ACwsgAEGKE2ovAQAhBCAAIABBqBZqKAIAIgpBAnRqQY4TakH//wM7AQBBACEHIApBAE4EQEEHQYoBIAQbIQlBBEEDIAQbIQsgAEHAFWohDiAAQcQVaiEPIABBvBVqIRBBfyEMQQAhCANAIAQhBSAAIAgiDUEBaiIIQQJ0akGKE2ovAQAhBAJAAkAgB0EBaiIGIAlODQAgBCAFRw0AIAYhBwwBCwJ/IAYgC0gEQCAAIAVBAnRqQfwUaiIHLwEAIAZqDAELIAUEQCAFIAxHBEAgACAFQQJ0akH8FGoiBiAGLwEAQQFqOwEACyAQIgcvAQBBAWoMAQsgB0EJTARAIA4iBy8BAEEBagwBCyAPIgcvAQBBAWoLIQYgByAGOwEAQQAhBwJ/IARFBEBBAyELQYoBDAELQQNBBCAEIAVGIgYbIQtBBkEHIAYbCyEJIAUhDAsgCiANRw0ACwsgACAAQbAWahAVIAAgACgCqC0Cf0ESIABBuhVqLwEADQAaQREgAEGCFWovAQANABpBECAAQbYVai8BAA0AGkEPIABBhhVqLwEADQAaQQ4gAEGyFWovAQANABpBDSAAQYoVai8BAA0AGkEMIABBrhVqLwEADQAaQQsgAEGOFWovAQANABpBCiAAQaoVai8BAA0AGkEJIABBkhVqLwEADQAaQQggAEGmFWovAQANABpBByAAQZYVai8BAA0AGkEGIABBohVqLwEADQAaQQUgAEGaFWovAQANABpBBCAAQZ4Vai8BAA0AGkEDQQIgAEH+FGovAQAbCyIIQQNsaiIEQRFqNgKoLSAEQRtqQQN2IgQgACgCrC1BCmpBA3YiBSAEIAVJGwshBAJAAkAgAUUNACACQQRqIARLDQAgACABIAIgAxASDAELIAAoArwtIQYCQCAEIAVHBEAgACgCiAFBBEcNAQsgACAALwG4LSADQQJqQf//A3EiBCAGdHIiBTsBuC0gAAJ/IAZBDk4EQCAAIAAoAhQiBkEBajYCFCAGIAAoAghqIAU6AAAgACAAKAIUIgVBAWo2AhQgBSAAKAIIaiAAQbktai0AADoAACAAIARBECAAKAK8LSIFa3Y7AbgtIAVBDWsMAQsgBkEDags2ArwtIABBwM8AQcDYABAWDAELIAAvAbgtIANBBGpB//8DcSIHIAZ0ciEFAkAgBkEOTgRAIAAgBTsBuC0gACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAFOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAEG5LWotAAA6AAAgACgCvC0iBUENayEEIAdBECAFa3YhBQwBCyAGQQNqIQQLIAAgBDYCvC0gAEGcFmooAgAiCkGA/gNqQf//A3EiByAEdCEGIABBqBZqKAIAIQkCfyAEQQxOBEAgACAFIAZyIgQ7AbgtIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBDoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIABBuS1qLQAAOgAAIAAoArwtIgVBC2shBCAHQRAgBWt2DAELIARBBWohBCAFIAZyCyEFIAAgBDYCvC0gCUH//wNxIgcgBHQhBgJ/IARBDE4EQCAAIAUgBnIiBDsBuC0gACAAKAIUIgVBAWo2AhQgBSAAKAIIaiAEOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAEG5LWotAAA6AAAgACgCvC0iBUELayEEIAdBECAFa3YMAQsgBEEFaiEEIAUgBnILIQUgACAENgK8LSAIQf3/A2pB//8DcSIHIAR0IQYCfyAEQQ1OBEAgACAFIAZyIgQ7AbgtIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBDoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIABBuS1qLQAAOgAAIAAoArwtIgVBDGshBCAHQRAgBWt2DAELIARBBGohBCAFIAZyCyEGIAAgBDYCvC1BACEFIABBuS1qIQ0DQCAAIAYgACAFQZDcAGotAABBAnRqQf4Uai8BACIHIAR0ciIGOwG4LSAAAn8gBEEOTgRAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogBjoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIA0tAAA6AAAgACAHQRAgACgCvC0iBGt2IgY7AbgtIARBDWsMAQsgBEEDagsiBDYCvC0gBSAIRyEHIAVBAWohBSAHDQALIAAgAEGUAWoiBCAKEBcgACAAQYgTaiIFIAkQFyAAIAQgBRAWCyAAEBEgAwRAAkACfyAAKAK8LSIEQQlOBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAALQC4LToAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIQQgAEG5LWotAAAMAQsgBEEBSA0BIAAgACgCFCIEQQFqNgIUIAQgACgCCGohBCAALQC4LQshBSAEIAU6AAALIABBADYCvC0gAEEAOwG4LQsLsRUBFX8jAEEgayEKIAEoAgAhCSABKAIIIgIoAgAhBSACKAIMIQ0gAEKAgICA0McANwLQKEF/IRACQCANQQBKBEBBACECA0ACQCAJIAJBAnRqIgMvAQAEQCAAIAAoAtAoQQFqIgM2AtAoIAAgA0ECdGpB3BZqIAI2AgAgACACakHYKGpBADoAACACIRAMAQsgA0EAOwECCyACQQFqIgIgDUcNAAsgACgC0CgiBEEBSg0BCwNAIAAgBEEBaiICNgLQKCAAIAJBAnRqQdwWaiAQQQFqIgNBACAQQQJIIgQbIgI2AgAgCSACQQJ0IgdqQQE7AQAgACACakHYKGpBADoAACAAIAAoAqgtQQFrNgKoLSAFBEAgACAAKAKsLSAFIAdqLwECazYCrC0LIAMgECAEGyEQIAAoAtAoIgRBAkgNAAsLIAEgEDYCBCAEQQF2IQgDQCAAIAhBAnRqQdwWaigCACELAkAgCCICQQF0IgMgBEoNACAAIAtqQdgoaiEPIAkgC0ECdGohBiAIIQUDQAJAIAMgBE4EQCADIQIMAQsgCSAAQdwWaiICIANBAXIiBEECdGooAgAiDkECdGovAQAiByAJIAIgA0ECdGooAgAiDEECdGovAQAiAk8EQCACIAdHBEAgAyECDAILIAMhAiAAQdgoaiIDIA5qLQAAIAMgDGotAABLDQELIAQhAgsgBi8BACIEIAkgACACQQJ0akHcFmooAgAiA0ECdGovAQAiB0kEQCAFIQIMAgsCQCAEIAdHDQAgDy0AACAAIANqQdgoai0AAEsNACAFIQIMAgsgACAFQQJ0akHcFmogAzYCACACIQUgAkEBdCIDIAAoAtAoIgRMDQALCyAAIAJBAnRqQdwWaiALNgIAIAhBAk4EQCAIQQFrIQggACgC0CghBAwBCwsgACgC0CghAwNAIA0hCCAAIANBAWsiBDYC0CggACgC4BYhCyAAIAAgA0ECdGpB3BZqKAIAIg02AuAWQQEhAgJAIANBA0gNACAAIA1qQdgoaiEPQQIhAyAJIA1BAnRqIQZBASEFA0ACQCADIAROBEAgAyECDAELIAkgAEHcFmoiAiADQQFyIgRBAnRqKAIAIg5BAnRqLwEAIgcgCSACIANBAnRqKAIAIgxBAnRqLwEAIgJPBEAgAiAHRwRAIAMhAgwCCyADIQIgAEHYKGoiAyAOai0AACADIAxqLQAASw0BCyAEIQILIAYvAQAiBCAJIAAgAkECdGpB3BZqKAIAIgNBAnRqLwEAIgdJBEAgBSECDAILAkAgBCAHRw0AIA8tAAAgACADakHYKGotAABLDQAgBSECDAILIAAgBUECdGpB3BZqIAM2AgAgAiEFIAJBAXQiAyAAKALQKCIETA0ACwtBAiEDIABB3BZqIgYgAkECdGogDTYCACAAIAAoAtQoQQFrIgQ2AtQoIAAoAuAWIQIgBiAEQQJ0aiALNgIAIAAgACgC1ChBAWsiBDYC1CggBiAEQQJ0aiACNgIAIAkgCEECdGoiDiAJIAJBAnRqIgQvAQAgCSALQQJ0aiIFLwEAajsBACAAQdgoaiIMIAhqIg8gAiAMai0AACICIAsgDGotAAAiByACIAdLG0EBajoAACAEIAg7AQIgBSAIOwECIAAgCDYC4BZBASEFQQEhAgJAIAAoAtAoIgRBAkgNAANAAn8gAyADIARODQAaIAkgBiADQQFyIgRBAnRqKAIAIgtBAnRqLwEAIgIgCSAGIANBAnRqKAIAIg1BAnRqLwEAIgdPBEAgAyACIAdHDQEaIAMgCyAMai0AACAMIA1qLQAASw0BGgsgBAshAiAOLwEAIgQgCSAAIAJBAnRqQdwWaigCACIDQQJ0ai8BACIHSQRAIAUhAgwCCwJAIAQgB0cNACAPLQAAIAAgA2pB2ChqLQAASw0AIAUhAgwCCyAAIAVBAnRqQdwWaiADNgIAIAIhBSACQQF0IgMgACgC0CgiBEwNAAsLIAhBAWohDSAAIAJBAnRqQdwWaiAINgIAIAAoAtAoIgNBAUoNAAsgACAAKALUKEEBayICNgLUKCAAQdwWaiIDIAJBAnRqIAAoAuAWNgIAIAEoAgQhByABKAIIIgIoAhAhBiACKAIIIREgAigCBCETIAIoAgAhEiABKAIAIQwgAEHUFmoiAUIANwEAIABBzBZqIhRCADcBACAAQcQWaiIVQgA3AQAgAEG8FmoiFkIANwEAQQAhCCAMIAMgACgC1ChBAnRqKAIAQQJ0akEAOwECAkAgACgC1CgiAkG7BEoNACACQQFqIQJBACEOA0AgDCAAIAJBAnRqQdwWaigCACIEQQJ0Ig1qIgUgDCAFLwECQQJ0ai8BAiIDQQFqIAYgAyAGSBsiDzsBAiADIAZOIQMCQCAEIAdKDQAgACAPQQF0akG8FmoiCyALLwEAQQFqOwEAQQAhCyAEIBFOBEAgEyAEIBFrQQJ0aigCACELCyAAIAAoAqgtIAUvAQAiBCALIA9qbGo2AqgtIBJFDQAgACAAKAKsLSALIA0gEmovAQJqIARsajYCrC0LIAMgDmohDiACQQFqIgJBvQRHDQALIA5FDQAgACAGQQF0akG8FmohDwNAIAYhAgNAIAAgAiIDQQFrIgJBAXRqQbwWaiIELwEAIgVFDQALIAQgBUEBazsBACAAIANBAXRqQbwWaiICIAIvAQBBAmo7AQAgDyAPLwEAQQFrIgI7AQAgDkECSiEDIA5BAmshDiADDQALIAZFDQBBvQQhBQNAIAJB//8DcSEDIAUhAgNAIAMEQCAAIAJBAWsiAkECdGpB3BZqKAIAIgQgB0oNASAMIARBAnRqIgQvAQIiBSAGRwRAIAAgACgCqC0gBC8BACAGIAVrbGo2AqgtIAQgBjsBAgsgA0EBayEDIAIhBQwBCwsgBkEBayIGRQ0BIAAgBkEBdGpBvBZqLwEAIQIMAAsACyAKIBYvAQBBAXQiAjsBAiAKIAIgAEG+FmovAQBqQQF0IgI7AQQgCiACIABBwBZqLwEAakEBdCICOwEGIAogAiAAQcIWai8BAGpBAXQiAjsBCCAKIAIgFS8BAGpBAXQiAjsBCiAKIAIgAEHGFmovAQBqQQF0IgI7AQwgCiACIABByBZqLwEAakEBdCICOwEOIAogAiAAQcoWai8BAGpBAXQiAjsBECAKIAIgFC8BAGpBAXQiAjsBEiAKIAIgAEHOFmovAQBqQQF0IgI7ARQgCiACIABB0BZqLwEAakEBdCICOwEWIAogAiAAQdIWai8BAGpBAXQiAjsBGCAKIAEvAQAgAmpBAXQiAjsBGiAKIABB1hZqLwEAIAJqQQF0IgI7ARwgCiACIABB2BZqLwEAakEBdDsBHiAQQQBOBEADQCAJIAhBAnRqIgcvAQIiBARAIAogBEEBdGoiACAALwEAIgBBAWo7AQAgBEEDcSEDQQAhAiAEQQFrQQNPBEAgBEH8/wNxIQUDQCAAQQN2QQFxIABBAnZBAXEgAEECcSACIABBAXFyQQJ0cnJBAXRyIgRBAXQhAiAAQQR2IQAgBUEEayIFDQALCyADBEADQCACIABBAXFyIgRBAXQhAiAAQQF2IQAgA0EBayIDDQALCyAHIAQ7AQALIAggEEchACAIQQFqIQggAA0ACwsL2QgBCn8CQCAAKAKgLUUEQCAAKAK8LSEDDAELIABBuS1qIQgDQCAEQQFqIQogACgCmC0gBGotAAAhBQJAIAACfyAAKAKkLSAEQQF0ai8BACIHRQRAIAEgBUECdGoiAy8BAiEEIAAgAC8BuC0gAy8BACIFIAAoArwtIgN0ciIHOwG4LUEQIARrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAHOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIAMgBGpBEGsMAgsgAyAEagwBCyAFQYDNAGotAAAiC0ECdCIJQYAIciABaiIDLwEGIQQgACAALwG4LSADLwEEIgwgACgCvC0iBnRyIgM7AbgtIAACf0EQIARrIAZIBEAgACAAKAIUIgZBAWo2AhQgBiAAKAIIaiADOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAxBECAAKAK8LSIGa3YiAzsBuC0gBCAGakEQawwBCyAEIAZqCyIENgK8LSALQQhrQRNNBEAgACADIAUgCUGw3ABqKAIAa0H//wNxIgYgBHRyIgM7AbgtIAACf0EQIAlBwNkAaigCACIFayAESARAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAzoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIAgtAAA6AAAgACAGQRAgACgCvC0iBGt2IgM7AbgtIAQgBWpBEGsMAQsgBCAFagsiBDYCvC0LIAIgB0EBayIFIAVBB3ZBgAJqIAVBgAJJG0GAyQBqLQAAIgtBAnQiCWoiBi8BAiEHIAAgAyAGLwEAIgwgBHRyIgY7AbgtIAACf0EQIAdrIARIBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAGOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogCC0AADoAACAAIAxBECAAKAK8LSIEa3YiBjsBuC0gBCAHakEQawwBCyAEIAdqCyIDNgK8LSALQQRJDQEgACAGIAUgCUGw3QBqKAIAa0H//wNxIgUgA3RyIgc7AbgtQRAgCUHA2gBqKAIAIgRrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAHOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIAMgBGpBEGsMAQsgAyAEagsiAzYCvC0LIAoiBCAAKAKgLUkNAAsLIAFBgghqLwEAIQQgACAALwG4LSABLwGACCIKIAN0ciIFOwG4LUEQIARrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAFOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogAEG5LWotAAA6AAAgACAKQRAgACgCvC0iA2t2OwG4LSAAIAMgBGpBEGs2ArwtDwsgACADIARqNgK8LQuXCwEMfyACQQBOBEBBBEEDIAEvAQIiChshBkEHQYoBIAobIQMgAEG5LWohCEF/IQcDQCAKIQkgASALIgxBAWoiC0ECdGovAQIhCgJAAkAgBUEBaiIEIANODQAgCSAKRw0AIAQhBQwBCwJAIAQgBkgEQCAAIAlBAnRqIgVB/BRqIQ0gBUH+FGohDiAAKAK8LSEFA0AgDi8BACEDIAAgAC8BuC0gDS8BACIGIAV0ciIHOwG4LSAAAn9BECADayAFSARAIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBzoAACAAIAAoAhQiBUEBajYCFCAFIAAoAghqIAgtAAA6AAAgACAGQRAgACgCvC0iBWt2OwG4LSADIAVqQRBrDAELIAMgBWoLIgU2ArwtIARBAWsiBA0ACwwBCyAAAn8gCQRAAkAgByAJRgRAIAAoArwtIQMgBCEFDAELIAAgCUECdGoiBEH+FGovAQAhAyAAIAAvAbgtIARB/BRqLwEAIgYgACgCvC0iBHRyIgc7AbgtIAACf0EQIANrIARIBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAHOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogCC0AADoAACAAIAZBECAAKAK8LSIEa3Y7AbgtIAMgBGpBEGsMAQsgAyAEagsiAzYCvC0LIAAvAbgtIAAvAbwVIgcgA3RyIQQCQEEQIAAvAb4VIgZrIANIBEAgACAEOwG4LSAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAYgACgCvC0iBGpBEGshAyAHQRAgBGt2IQQMAQsgAyAGaiEDCyAAIAM2ArwtIAAgBCAFQf3/A2pB//8DcSIFIAN0ciIEOwG4LSADQQ9OBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAEOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIANBDmsMAgsgA0ECagwBCyAFQQlMBEAgAC8BuC0gAC8BwBUiByAAKAK8LSIDdHIhBAJAQRAgAC8BwhUiBmsgA0gEQCAAIAQ7AbgtIAAgACgCFCIDQQFqNgIUIAMgACgCCGogBDoAACAAIAAoAhQiA0EBajYCFCADIAAoAghqIAgtAAA6AAAgBiAAKAK8LSIEakEQayEDIAdBECAEa3YhBAwBCyADIAZqIQMLIAAgAzYCvC0gACAEIAVB/v8DakH//wNxIgUgA3RyIgQ7AbgtIANBDk4EQCAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAAgBUEQIAAoArwtIgNrdjsBuC0gA0ENawwCCyADQQNqDAELIAAvAbgtIAAvAcQVIgcgACgCvC0iA3RyIQQCQEEQIAAvAcYVIgZrIANIBEAgACAEOwG4LSAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAYgACgCvC0iBGpBEGshAyAHQRAgBGt2IQQMAQsgAyAGaiEDCyAAIAM2ArwtIAAgBCAFQfb/A2pB//8DcSIFIAN0ciIEOwG4LSADQQpOBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAEOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIANBCWsMAQsgA0EHags2ArwtC0EAIQUCfyAKRQRAQYoBIQNBAwwBC0EGQQcgCSAKRiIEGyEDQQNBBCAEGwshBiAJIQcLIAIgDEcNAAsLCwkAIAEgAmwQHAsGACABEB0LXwEBfyMAQUBqIgMkACADQQA2AjAgA0IANwMoIAMgADYCCCADIAI2AhQgAyABNgIMIAMgAUEDbDYCGCADQQhqEAcgA0EIahALIANBCGoQCCADKAIcIQEgA0FAayQAIAELBgBB1N8AC6QuAQx/IwBBEGsiDCQAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIABB9AFNBEBB2N8AKAIAIgZBECAAQQtqQXhxIABBC0kbIgRBA3YiAXYiAEEDcQRAIABBf3NBAXEgAWoiAkEDdCIDQYjgAGooAgAiAUEIaiEAAkAgASgCCCIEIANBgOAAaiIDRgRAQdjfACAGQX4gAndxNgIADAELIAQgAzYCDCADIAQ2AggLIAEgAkEDdCICQQNyNgIEIAEgAmoiASABKAIEQQFyNgIEDA0LIARB4N8AKAIAIghNDQEgAARAAkAgACABdEECIAF0IgBBACAAa3JxIgBBACAAa3FBAWsiACAAQQx2QRBxIgB2IgFBBXZBCHEiAiAAciABIAJ2IgBBAnZBBHEiAXIgACABdiIAQQF2QQJxIgFyIAAgAXYiAEEBdkEBcSIBciAAIAF2aiICQQN0IgNBiOAAaigCACIBKAIIIgAgA0GA4ABqIgNGBEBB2N8AIAZBfiACd3EiBjYCAAwBCyAAIAM2AgwgAyAANgIICyABQQhqIQAgASAEQQNyNgIEIAEgBGoiAyACQQN0IgUgBGsiAkEBcjYCBCABIAVqIAI2AgAgCARAIAhBA3YiBUEDdEGA4ABqIQRB7N8AKAIAIQECfyAGQQEgBXQiBXFFBEBB2N8AIAUgBnI2AgAgBAwBCyAEKAIICyEFIAQgATYCCCAFIAE2AgwgASAENgIMIAEgBTYCCAtB7N8AIAM2AgBB4N8AIAI2AgAMDQtB3N8AKAIAIglFDQEgCUEAIAlrcUEBayIAIABBDHZBEHEiAHYiAUEFdkEIcSICIAByIAEgAnYiAEECdkEEcSIBciAAIAF2IgBBAXZBAnEiAXIgACABdiIAQQF2QQFxIgFyIAAgAXZqQQJ0QYjiAGooAgAiAygCBEF4cSAEayEBIAMhAgNAAkAgAigCECIARQRAIAIoAhQiAEUNAQsgACgCBEF4cSAEayICIAEgASACSyICGyEBIAAgAyACGyEDIAAhAgwBCwsgAyAEaiILIANNDQIgAygCGCEKIAMgAygCDCIFRwRAIAMoAggiAEHo3wAoAgBJGiAAIAU2AgwgBSAANgIIDAwLIANBFGoiAigCACIARQRAIAMoAhAiAEUNBCADQRBqIQILA0AgAiEHIAAiBUEUaiICKAIAIgANACAFQRBqIQIgBSgCECIADQALIAdBADYCAAwLC0F/IQQgAEG/f0sNACAAQQtqIgBBeHEhBEHc3wAoAgAiCEUNAEEfIQcgBEH///8HTQRAIABBCHYiACAAQYD+P2pBEHZBCHEiAHQiASABQYDgH2pBEHZBBHEiAXQiAiACQYCAD2pBEHZBAnEiAnRBD3YgACABciACcmsiAEEBdCAEIABBFWp2QQFxckEcaiEHC0EAIARrIQECQAJAAkAgB0ECdEGI4gBqKAIAIgJFBEBBACEADAELQQAhACAEQQBBGSAHQQF2ayAHQR9GG3QhAwNAAkAgAigCBEF4cSAEayIGIAFPDQAgAiEFIAYiAQ0AQQAhASACIQAMAwsgACACKAIUIgYgBiACIANBHXZBBHFqKAIQIgJGGyAAIAYbIQAgA0EBdCEDIAINAAsLIAAgBXJFBEBBAiAHdCIAQQAgAGtyIAhxIgBFDQMgAEEAIABrcUEBayIAIABBDHZBEHEiAHYiAkEFdkEIcSIDIAByIAIgA3YiAEECdkEEcSICciAAIAJ2IgBBAXZBAnEiAnIgACACdiIAQQF2QQFxIgJyIAAgAnZqQQJ0QYjiAGooAgAhAAsgAEUNAQsDQCAAKAIEQXhxIARrIgYgAUkhAyAGIAEgAxshASAAIAUgAxshBSAAKAIQIgIEfyACBSAAKAIUCyIADQALCyAFRQ0AIAFB4N8AKAIAIARrTw0AIAQgBWoiByAFTQ0BIAUoAhghCSAFIAUoAgwiA0cEQCAFKAIIIgBB6N8AKAIASRogACADNgIMIAMgADYCCAwKCyAFQRRqIgIoAgAiAEUEQCAFKAIQIgBFDQQgBUEQaiECCwNAIAIhBiAAIgNBFGoiAigCACIADQAgA0EQaiECIAMoAhAiAA0ACyAGQQA2AgAMCQsgBEHg3wAoAgAiAE0EQEHs3wAoAgAhAQJAIAAgBGsiAkEQTwRAQeDfACACNgIAQezfACABIARqIgM2AgAgAyACQQFyNgIEIAAgAWogAjYCACABIARBA3I2AgQMAQtB7N8AQQA2AgBB4N8AQQA2AgAgASAAQQNyNgIEIAAgAWoiACAAKAIEQQFyNgIECyABQQhqIQAMCwsgBEHk3wAoAgAiA0kEQEHk3wAgAyAEayIBNgIAQfDfAEHw3wAoAgAiACAEaiICNgIAIAIgAUEBcjYCBCAAIARBA3I2AgQgAEEIaiEADAsLQQAhACAEQS9qIggCf0Gw4wAoAgAEQEG44wAoAgAMAQtBvOMAQn83AgBBtOMAQoCggICAgAQ3AgBBsOMAIAxBDGpBcHFB2KrVqgVzNgIAQcTjAEEANgIAQZTjAEEANgIAQYAgCyIBaiIGQQAgAWsiB3EiBSAETQ0KQZDjACgCACIBBEBBiOMAKAIAIgIgBWoiCSACTQ0LIAEgCUkNCwtBlOMALQAAQQRxDQUCQAJAQfDfACgCACIBBEBBmOMAIQADQCABIAAoAgAiAk8EQCACIAAoAgRqIAFLDQMLIAAoAggiAA0ACwtBABAeIgNBf0YNBiAFIQZBtOMAKAIAIgBBAWsiASADcQRAIAUgA2sgASADakEAIABrcWohBgsgBCAGTw0GIAZB/v///wdLDQZBkOMAKAIAIgAEQEGI4wAoAgAiASAGaiICIAFNDQcgACACSQ0HCyAGEB4iACADRw0BDAgLIAYgA2sgB3EiBkH+////B0sNBSAGEB4iAyAAKAIAIAAoAgRqRg0EIAMhAAsCQCAEQTBqIAZNDQAgAEF/Rg0AQbjjACgCACIBIAggBmtqQQAgAWtxIgFB/v///wdLBEAgACEDDAgLIAEQHkF/RwRAIAEgBmohBiAAIQMMCAtBACAGaxAeGgwFCyAAIQMgAEF/Rw0GDAQLAAtBACEFDAcLQQAhAwwFCyADQX9HDQILQZTjAEGU4wAoAgBBBHI2AgALIAVB/v///wdLDQEgBRAeIgNBABAeIgBPDQEgA0F/Rg0BIABBf0YNASAAIANrIgYgBEEoak0NAQtBiOMAQYjjACgCACAGaiIANgIAQYzjACgCACAASQRAQYzjACAANgIACwJAAkACQEHw3wAoAgAiAQRAQZjjACEAA0AgAyAAKAIAIgIgACgCBCIFakYNAiAAKAIIIgANAAsMAgtB6N8AKAIAIgBBACAAIANNG0UEQEHo3wAgAzYCAAtBACEAQZzjACAGNgIAQZjjACADNgIAQfjfAEF/NgIAQfzfAEGw4wAoAgA2AgBBpOMAQQA2AgADQCAAQQN0IgFBiOAAaiABQYDgAGoiAjYCACABQYzgAGogAjYCACAAQQFqIgBBIEcNAAtB5N8AIAZBKGsiAEF4IANrQQdxQQAgA0EIakEHcRsiAWsiAjYCAEHw3wAgASADaiIBNgIAIAEgAkEBcjYCBCAAIANqQSg2AgRB9N8AQcDjACgCADYCAAwCCyABIANPDQAgASACSQ0AIAAoAgxBCHENACAAIAUgBmo2AgRB8N8AIAFBeCABa0EHcUEAIAFBCGpBB3EbIgBqIgI2AgBB5N8AQeTfACgCACAGaiIDIABrIgA2AgAgAiAAQQFyNgIEIAEgA2pBKDYCBEH03wBBwOMAKAIANgIADAELQejfACgCACADSwRAQejfACADNgIACyADIAZqIQJBmOMAIQACQAJAAkACQAJAAkADQCACIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQZjjACEAA0AgASAAKAIAIgJPBEAgAiAAKAIEaiICIAFLDQMLIAAoAgghAAwACwALIAAgAzYCACAAIAAoAgQgBmo2AgQgA0F4IANrQQdxQQAgA0EIakEHcRtqIgcgBEEDcjYCBCACQXggAmtBB3FBACACQQhqQQdxG2oiBiAHayAEayECIAQgB2ohBCABIAZGBEBB8N8AIAQ2AgBB5N8AQeTfACgCACACaiIANgIAIAQgAEEBcjYCBAwDCyAGQezfACgCAEYEQEHs3wAgBDYCAEHg3wBB4N8AKAIAIAJqIgA2AgAgBCAAQQFyNgIEIAAgBGogADYCAAwDCyAGKAIEIgBBA3FBAUYEQCAAQXhxIQgCQCAAQf8BTQRAIAYoAggiASAAQQN2IgVBA3RBgOAAakYaIAEgBigCDCIARgRAQdjfAEHY3wAoAgBBfiAFd3E2AgAMAgsgASAANgIMIAAgATYCCAwBCyAGKAIYIQkCQCAGIAYoAgwiA0cEQCAGKAIIIgAgAzYCDCADIAA2AggMAQsCQCAGQRRqIgAoAgAiAQ0AIAZBEGoiACgCACIBDQBBACEDDAELA0AgACEFIAEiA0EUaiIAKAIAIgENACADQRBqIQAgAygCECIBDQALIAVBADYCAAsgCUUNAAJAIAYgBigCHCIBQQJ0QYjiAGoiACgCAEYEQCAAIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiABd3E2AgAMAgsgCUEQQRQgCSgCECAGRhtqIAM2AgAgA0UNAQsgAyAJNgIYIAYoAhAiAARAIAMgADYCECAAIAM2AhgLIAYoAhQiAEUNACADIAA2AhQgACADNgIYCyAGIAhqIQYgAiAIaiECCyAGIAYoAgRBfnE2AgQgBCACQQFyNgIEIAIgBGogAjYCACACQf8BTQRAIAJBA3YiAUEDdEGA4ABqIQACf0HY3wAoAgAiAkEBIAF0IgFxRQRAQdjfACABIAJyNgIAIAAMAQsgACgCCAshASAAIAQ2AgggASAENgIMIAQgADYCDCAEIAE2AggMAwtBHyEAIAJB////B00EQCACQQh2IgAgAEGA/j9qQRB2QQhxIgB0IgEgAUGA4B9qQRB2QQRxIgF0IgMgA0GAgA9qQRB2QQJxIgN0QQ92IAAgAXIgA3JrIgBBAXQgAiAAQRVqdkEBcXJBHGohAAsgBCAANgIcIARCADcCECAAQQJ0QYjiAGohAQJAQdzfACgCACIDQQEgAHQiBXFFBEBB3N8AIAMgBXI2AgAgASAENgIAIAQgATYCGAwBCyACQQBBGSAAQQF2ayAAQR9GG3QhACABKAIAIQMDQCADIgEoAgRBeHEgAkYNAyAAQR12IQMgAEEBdCEAIAEgA0EEcWpBEGoiBSgCACIDDQALIAUgBDYCACAEIAE2AhgLIAQgBDYCDCAEIAQ2AggMAgtB5N8AIAZBKGsiAEF4IANrQQdxQQAgA0EIakEHcRsiBWsiBzYCAEHw3wAgAyAFaiIFNgIAIAUgB0EBcjYCBCAAIANqQSg2AgRB9N8AQcDjACgCADYCACABIAJBJyACa0EHcUEAIAJBJ2tBB3EbakEvayIAIAAgAUEQakkbIgVBGzYCBCAFQaDjACkCADcCECAFQZjjACkCADcCCEGg4wAgBUEIajYCAEGc4wAgBjYCAEGY4wAgAzYCAEGk4wBBADYCACAFQRhqIQADQCAAQQc2AgQgAEEIaiEDIABBBGohACACIANLDQALIAEgBUYNAyAFIAUoAgRBfnE2AgQgASAFIAFrIgZBAXI2AgQgBSAGNgIAIAZB/wFNBEAgBkEDdiICQQN0QYDgAGohAAJ/QdjfACgCACIDQQEgAnQiAnFFBEBB2N8AIAIgA3I2AgAgAAwBCyAAKAIICyECIAAgATYCCCACIAE2AgwgASAANgIMIAEgAjYCCAwEC0EfIQAgAUIANwIQIAZB////B00EQCAGQQh2IgAgAEGA/j9qQRB2QQhxIgB0IgIgAkGA4B9qQRB2QQRxIgJ0IgMgA0GAgA9qQRB2QQJxIgN0QQ92IAAgAnIgA3JrIgBBAXQgBiAAQRVqdkEBcXJBHGohAAsgASAANgIcIABBAnRBiOIAaiECAkBB3N8AKAIAIgNBASAAdCIFcUUEQEHc3wAgAyAFcjYCACACIAE2AgAgASACNgIYDAELIAZBAEEZIABBAXZrIABBH0YbdCEAIAIoAgAhAwNAIAMiAigCBEF4cSAGRg0EIABBHXYhAyAAQQF0IQAgAiADQQRxakEQaiIFKAIAIgMNAAsgBSABNgIAIAEgAjYCGAsgASABNgIMIAEgATYCCAwDCyABKAIIIgAgBDYCDCABIAQ2AgggBEEANgIYIAQgATYCDCAEIAA2AggLIAdBCGohAAwFCyACKAIIIgAgATYCDCACIAE2AgggAUEANgIYIAEgAjYCDCABIAA2AggLQeTfACgCACIAIARNDQBB5N8AIAAgBGsiATYCAEHw3wBB8N8AKAIAIgAgBGoiAjYCACACIAFBAXI2AgQgACAEQQNyNgIEIABBCGohAAwDC0HU3wBBMDYCAEEAIQAMAgsCQCAJRQ0AAkAgBSgCHCICQQJ0QYjiAGoiACgCACAFRgRAIAAgAzYCACADDQFB3N8AIAhBfiACd3EiCDYCAAwCCyAJQRBBFCAJKAIQIAVGG2ogAzYCACADRQ0BCyADIAk2AhggBSgCECIABEAgAyAANgIQIAAgAzYCGAsgBSgCFCIARQ0AIAMgADYCFCAAIAM2AhgLAkAgAUEPTQRAIAUgASAEaiIAQQNyNgIEIAAgBWoiACAAKAIEQQFyNgIEDAELIAUgBEEDcjYCBCAHIAFBAXI2AgQgASAHaiABNgIAIAFB/wFNBEAgAUEDdiIBQQN0QYDgAGohAAJ/QdjfACgCACICQQEgAXQiAXFFBEBB2N8AIAEgAnI2AgAgAAwBCyAAKAIICyEBIAAgBzYCCCABIAc2AgwgByAANgIMIAcgATYCCAwBC0EfIQAgAUH///8HTQRAIAFBCHYiACAAQYD+P2pBEHZBCHEiAHQiAiACQYDgH2pBEHZBBHEiAnQiBCAEQYCAD2pBEHZBAnEiBHRBD3YgACACciAEcmsiAEEBdCABIABBFWp2QQFxckEcaiEACyAHIAA2AhwgB0IANwIQIABBAnRBiOIAaiECAkACQCAIQQEgAHQiBHFFBEBB3N8AIAQgCHI2AgAgAiAHNgIAIAcgAjYCGAwBCyABQQBBGSAAQQF2ayAAQR9GG3QhACACKAIAIQQDQCAEIgIoAgRBeHEgAUYNAiAAQR12IQQgAEEBdCEAIAIgBEEEcWpBEGoiAygCACIEDQALIAMgBzYCACAHIAI2AhgLIAcgBzYCDCAHIAc2AggMAQsgAigCCCIAIAc2AgwgAiAHNgIIIAdBADYCGCAHIAI2AgwgByAANgIICyAFQQhqIQAMAQsCQCAKRQ0AAkAgAygCHCICQQJ0QYjiAGoiACgCACADRgRAIAAgBTYCACAFDQFB3N8AIAlBfiACd3E2AgAMAgsgCkEQQRQgCigCECADRhtqIAU2AgAgBUUNAQsgBSAKNgIYIAMoAhAiAARAIAUgADYCECAAIAU2AhgLIAMoAhQiAEUNACAFIAA2AhQgACAFNgIYCwJAIAFBD00EQCADIAEgBGoiAEEDcjYCBCAAIANqIgAgACgCBEEBcjYCBAwBCyADIARBA3I2AgQgCyABQQFyNgIEIAEgC2ogATYCACAIBEAgCEEDdiIEQQN0QYDgAGohAkHs3wAoAgAhAAJ/QQEgBHQiBCAGcUUEQEHY3wAgBCAGcjYCACACDAELIAIoAggLIQQgAiAANgIIIAQgADYCDCAAIAI2AgwgACAENgIIC0Hs3wAgCzYCAEHg3wAgATYCAAsgA0EIaiEACyAMQRBqJAAgAAvMDAEHfwJAIABFDQAgAEEIayICIABBBGsoAgAiAUF4cSIAaiEFAkAgAUEBcQ0AIAFBA3FFDQEgAiACKAIAIgFrIgJB6N8AKAIASQ0BIAAgAWohACACQezfACgCAEcEQCABQf8BTQRAIAIoAggiBCABQQN2IgdBA3RBgOAAakYaIAQgAigCDCIBRgRAQdjfAEHY3wAoAgBBfiAHd3E2AgAMAwsgBCABNgIMIAEgBDYCCAwCCyACKAIYIQYCQCACIAIoAgwiA0cEQCACKAIIIgEgAzYCDCADIAE2AggMAQsCQCACQRRqIgEoAgAiBA0AIAJBEGoiASgCACIEDQBBACEDDAELA0AgASEHIAQiA0EUaiIBKAIAIgQNACADQRBqIQEgAygCECIEDQALIAdBADYCAAsgBkUNAQJAIAIgAigCHCIEQQJ0QYjiAGoiASgCAEYEQCABIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiAEd3E2AgAMAwsgBkEQQRQgBigCECACRhtqIAM2AgAgA0UNAgsgAyAGNgIYIAIoAhAiAQRAIAMgATYCECABIAM2AhgLIAIoAhQiAUUNASADIAE2AhQgASADNgIYDAELIAUoAgQiAUEDcUEDRw0AQeDfACAANgIAIAUgAUF+cTYCBCACIABBAXI2AgQgACACaiAANgIADwsgAiAFTw0AIAUoAgQiAUEBcUUNAAJAIAFBAnFFBEAgBUHw3wAoAgBGBEBB8N8AIAI2AgBB5N8AQeTfACgCACAAaiIANgIAIAIgAEEBcjYCBCACQezfACgCAEcNA0Hg3wBBADYCAEHs3wBBADYCAA8LIAVB7N8AKAIARgRAQezfACACNgIAQeDfAEHg3wAoAgAgAGoiADYCACACIABBAXI2AgQgACACaiAANgIADwsgAUF4cSAAaiEAAkAgAUH/AU0EQCAFKAIIIgQgAUEDdiIHQQN0QYDgAGpGGiAEIAUoAgwiAUYEQEHY3wBB2N8AKAIAQX4gB3dxNgIADAILIAQgATYCDCABIAQ2AggMAQsgBSgCGCEGAkAgBSAFKAIMIgNHBEAgBSgCCCIBQejfACgCAEkaIAEgAzYCDCADIAE2AggMAQsCQCAFQRRqIgEoAgAiBA0AIAVBEGoiASgCACIEDQBBACEDDAELA0AgASEHIAQiA0EUaiIBKAIAIgQNACADQRBqIQEgAygCECIEDQALIAdBADYCAAsgBkUNAAJAIAUgBSgCHCIEQQJ0QYjiAGoiASgCAEYEQCABIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiAEd3E2AgAMAgsgBkEQQRQgBigCECAFRhtqIAM2AgAgA0UNAQsgAyAGNgIYIAUoAhAiAQRAIAMgATYCECABIAM2AhgLIAUoAhQiAUUNACADIAE2AhQgASADNgIYCyACIABBAXI2AgQgACACaiAANgIAIAJB7N8AKAIARw0BQeDfACAANgIADwsgBSABQX5xNgIEIAIgAEEBcjYCBCAAIAJqIAA2AgALIABB/wFNBEAgAEEDdiIBQQN0QYDgAGohAAJ/QdjfACgCACIEQQEgAXQiAXFFBEBB2N8AIAEgBHI2AgAgAAwBCyAAKAIICyEBIAAgAjYCCCABIAI2AgwgAiAANgIMIAIgATYCCA8LQR8hASACQgA3AhAgAEH///8HTQRAIABBCHYiASABQYD+P2pBEHZBCHEiAXQiBCAEQYDgH2pBEHZBBHEiBHQiAyADQYCAD2pBEHZBAnEiA3RBD3YgASAEciADcmsiAUEBdCAAIAFBFWp2QQFxckEcaiEBCyACIAE2AhwgAUECdEGI4gBqIQQCQAJAAkBB3N8AKAIAIgNBASABdCIFcUUEQEHc3wAgAyAFcjYCACAEIAI2AgAgAiAENgIYDAELIABBAEEZIAFBAXZrIAFBH0YbdCEBIAQoAgAhAwNAIAMiBCgCBEF4cSAARg0CIAFBHXYhAyABQQF0IQEgBCADQQRxakEQaiIFKAIAIgMNAAsgBSACNgIAIAIgBDYCGAsgAiACNgIMIAIgAjYCCAwBCyAEKAIIIgAgAjYCDCAEIAI2AgggAkEANgIYIAIgBDYCDCACIAA2AggLQfjfAEH43wAoAgBBAWsiAkF/IAIbNgIACwtVAQJ/QdDfACgCACIBIABBA2pBfHEiAmohAAJAIAJBAU5BACAAIAFNGw0APwBBEHQgAEkEQCAAEABFDQELQdDfACAANgIAIAEPC0HU3wBBMDYCAEF/C4IEAQN/IAJBgARPBEAgACABIAIQARogAA8LIAAgAmohAwJAIAAgAXNBA3FFBEACQCACQQFIBEAgACECDAELIABBA3FFBEAgACECDAELIAAhAgNAIAIgAS0AADoAACABQQFqIQEgAkEBaiICIANPDQEgAkEDcQ0ACwsCQCADQXxxIgRBwABJDQAgAiAEQUBqIgVLDQADQCACIAEoAgA2AgAgAiABKAIENgIEIAIgASgCCDYCCCACIAEoAgw2AgwgAiABKAIQNgIQIAIgASgCFDYCFCACIAEoAhg2AhggAiABKAIcNgIcIAIgASgCIDYCICACIAEoAiQ2AiQgAiABKAIoNgIoIAIgASgCLDYCLCACIAEoAjA2AjAgAiABKAI0NgI0IAIgASgCODYCOCACIAEoAjw2AjwgAUFAayEBIAJBQGsiAiAFTQ0ACwsgAiAETw0BA0AgAiABKAIANgIAIAFBBGohASACQQRqIgIgBEkNAAsMAQsgA0EESQRAIAAhAgwBCyAAIANBBGsiBEsEQCAAIQIMAQsgACECA0AgAiABLQAAOgAAIAIgAS0AAToAASACIAEtAAI6AAIgAiABLQADOgADIAFBBGohASACQQRqIgIgBE0NAAsLIAIgA0kEQANAIAIgAS0AADoAACABQQFqIQEgAkEBaiICIANHDQALCyAAC9YCAQJ/AkAgAUUNACAAIAFqIgJBAWtBADoAACAAQQA6AAAgAUEDSQ0AIAJBAmtBADoAACAAQQA6AAEgAkEDa0EAOgAAIABBADoAAiABQQdJDQAgAkEEa0EAOgAAIABBADoAAyABQQlJDQAgAEEAIABrQQNxIgNqIgJBADYCACACIAEgA2tBfHEiA2oiAUEEa0EANgIAIANBCUkNACACQQA2AgggAkEANgIEIAFBCGtBADYCACABQQxrQQA2AgAgA0EZSQ0AIAJBADYCGCACQQA2AhQgAkEANgIQIAJBADYCDCABQRBrQQA2AgAgAUEUa0EANgIAIAFBGGtBADYCACABQRxrQQA2AgAgAyACQQRxQRhyIgNrIgFBIEkNACACIANqIQIDQCACQgA3AxggAkIANwMQIAJCADcDCCACQgA3AwAgAkEgaiECIAFBIGsiAUEfSw0ACwsLBAAjAAsGACAAJAALEAAjACAAa0FwcSIAJAAgAAsLvVYIAEGECAvxQJYwB3csYQ7uulEJmRnEbQeP9GpwNaVj6aOVZJ4yiNsOpLjceR7p1eCI2dKXK0y2Cb18sX4HLbjnkR2/kGQQtx3yILBqSHG5895BvoR91Noa6+TdbVG11PTHhdODVphsE8Coa2R6+WL97Mllik9cARTZbAZjYz0P+vUNCI3IIG47XhBpTORBYNVycWei0eQDPEfUBEv9hQ3Sa7UKpfqotTVsmLJC1sm720D5vKzjbNgydVzfRc8N1txZPdGrrDDZJjoA3lGAUdfIFmHQv7X0tCEjxLNWmZW6zw+lvbieuAIoCIgFX7LZDMYk6Quxh3xvLxFMaFirHWHBPS1mtpBB3HYGcdsBvCDSmCoQ1e+JhbFxH7W2BqXkv58z1LjooskHeDT5AA+OqAmWGJgO4bsNan8tPW0Il2xkkQFcY+b0UWtrYmFsHNgwZYVOAGLy7ZUGbHulARvB9AiCV8QP9cbZsGVQ6bcS6ri+i3yIufzfHd1iSS3aFfN804xlTNT7WGGyTc5RtTp0ALyj4jC71EGl30rXldg9bcTRpPv01tNq6WlD/NluNEaIZ63QuGDacy0EROUdAzNfTAqqyXwN3TxxBVCqQQInEBALvoYgDMkltWhXs4VvIAnUZrmf5GHODvneXpjJ2SkimNCwtKjXxxc9s1mBDbQuO1y9t61susAgg7jttrO/mgzitgOa0rF0OUfV6q930p0VJtsEgxbccxILY+OEO2SUPmptDahaanoLzw7knf8JkyeuAAqxngd9RJMP8NKjCIdo8gEe/sIGaV1XYvfLZ2WAcTZsGecGa252G9T+4CvTiVp62hDMSt1nb9+5+fnvvo5DvrcX1Y6wYOij1tZ+k9GhxMLYOFLy30/xZ7vRZ1e8pt0GtT9LNrJI2isN2EwbCq/2SgM2YHoEQcPvYN9V32eo745uMXm+aUaMs2HLGoNmvKDSbyU24mhSlXcMzANHC7u5FgIiLyYFVb47usUoC72yklq0KwRqs1yn/9fCMc/QtYue2Swdrt5bsMJkmybyY+yco2p1CpNtAqkGCZw/Ng7rhWcHchNXAAWCSr+VFHq44q4rsXs4G7YMm47Skg2+1eW379x8Id/bC9TS04ZC4tTx+LPdaG6D2h/NFr6BWya59uF3sG93R7cY5loIiHBqD//KOwZmXAsBEf+eZY9prmL40/9rYUXPbBZ44gqg7tIN11SDBE7CswM5YSZnp/cWYNBNR2lJ23duPkpq0a7cWtbZZgvfQPA72DdTrrypxZ673n/Pskfp/7UwHPK9vYrCusowk7NTpqO0JAU20LqTBtfNKVfeVL9n2SMuemazuEphxAIbaF2UK28qN74LtKGODMMb3wVaje8CLQAAAABBMRsZgmI2MsNTLSsExWxkRfR3fYanWlbHlkFPCIrZyEm7wtGK6O/6y9n04wxPtaxNfq61ji2Dns8cmIdREsJKECPZU9Nw9HiSQe9hVdeuLhTmtTfXtZgcloSDBVmYG4IYqQCb2/otsJrLNqldXXfmHGxs/98/QdSeDlrNoiSEleMVn4wgRrKnYXepvqbh6PHn0PPoJIPew2Wyxdqqrl1d659GRCjMa29p/XB2rmsxOe9aKiAsCQcLbTgcEvM2Rt+yB13GcVRw7TBla/T38yq7tsIxonWRHIk0oAeQ+7yfF7qNhA553qklOO+yPP9583O+SOhqfRvFQTwq3lgFT3nwRH5i6YctT8LGHFTbAYoVlEC7Do2D6COmwtk4vw3FoDhM9Lshj6eWCs6WjRMJAMxcSDHXRYti+m7KU+F3VF27uhVsoKPWP42Ilw6WkVCY194RqczH0vrh7JPL+vVc12JyHeZ5a961VECfhE9ZWBIOFhkjFQ/acDgkm0EjPadr/WXmWuZ8JQnLV2Q40E6jrpEB4p+KGCHMpzNg/bwqr+Ekre7QP7QtgxKfbLIJhqskSMnqFVPQKUZ++2h3ZeL2eT8vt0gkNnQbCR01KhIE8rxTS7ONSFJw3mV5Me9+YP7z5ue/wv3+fJHQ1T2gy8z6NoqDuweRmnhUvLE5ZaeoS5iDOwqpmCLJ+rUJiMuuEE9d718ObPRGzT/ZbYwOwnRDElrzAiNB6sFwbMGAQXfYR9c2lwbmLY7FtQClhIQbvBqKQXFbu1pomOh3Q9nZbFoeTy0VX342DJwtGyfdHAA+EgCYuVMxg6CQYq6L0VO1khbF9N1X9O/ElKfC79WW2fbpvAeuqI0ct2veMZwq7yqF7XlryqxIcNNvG134LipG4eE23magB8V/Y1ToVCJl803l87ICpMKpG2eRhDAmoJ8puK7F5Pmf3v06zPPWe/3oz7xrqYD9WrKZPgmfsn84hKuwJBws8RUHNTJGKh5zdzEHtOFwSPXQa1E2g0Z6d7JdY07X+ssP5uHSzLXM+Y2E1+BKEpavCyONtshwoJ2JQbuERl0jAwdsOBrEPxUxhQ4OKEKYT2cDqVR+wPp5VYHLYkwfxTiBXvQjmJ2nDrPclhWqGwBU5VoxT/yZYmLX2FN5zhdP4UlWfvpQlS3Xe9QczGITio0tUruWNJHoux/Q2aAG7PN+Xq3CZUdukUhsL6BTdeg2EjqpBwkjalQkCCtlPxHkeaeWpUi8j2YbkaQnKoq94LzL8qGN0Oti3v3AI+/m2b3hvBT80KcNP4OKJn6ykT+5JNBw+BXLaTtG5kJ6d/1btWtl3PRafsU3CVPudjhI97GuCbjwnxKhM8w/inL9JJMAAAAAN2rCAW7UhANZvkYC3KgJB+vCywayfI0EhRZPBbhREw6PO9EP1oWXDeHvVQxk+RoJU5PYCAotngo9R1wLcKMmHEfJ5B0ed6IfKR1gHqwLLxubYe0awt+rGPW1aRnI8jUS/5j3E6YmsRGRTHMQFFo8FSMw/hR6jrgWTeR6F+BGTTjXLI85jpLJO7n4Czo87kQ/C4SGPlI6wDxlUAI9WBdeNm99nDc2w9o1AakYNIS/VzGz1ZUw6mvTMt0BETOQ5Wskp4+pJf4x7yfJWy0mTE1iI3snoCIimeYgFfMkISi0eCof3rorRmD8KXEKPij0HHEtw3azLJrI9S6tojcvwI2acPfnWHGuWR5zmTPcchwlk3crT1F2cvEXdEWb1XV43Il+T7ZLfxYIDX0hYs98pHSAeZMeQnjKoAR6/crGe7AuvGyHRH5t3vo4b+mQ+m5shrVrW+x3agJSMWg1OPNpCH+vYj8VbWNmqythUcHpYNTXpmXjvWRkugMiZo1p4Gcgy9dIF6EVSU4fU0t5dZFK/GPeT8sJHE6St1pMpd2YTZiaxEav8AZH9k5ARcEkgkREMs1Bc1gPQCrmSUIdjItDUGjxVGcCM1U+vHVXCda3VozA+FO7qjpS4hR8UNV+vlHoOeJa31MgW4btZlmxh6RYNJHrXQP7KVxaRW9ebS+tX4AbNeG3cffg7s+x4tmlc+Ncszzma9n+5zJnuOUFDXrkOEom7w8g5O5WnqLsYfRg7eTiL+jTiO3pijar671caerwuBP9x9LR/J5sl/6pBlX/LBAa+ht62PtCxJ75da5c+EjpAPN/g8LyJj2E8BFXRvGUQQn0oyvL9fqVjffN/0/2YF142Vc3utgOifzaOeM+27z1cd6Ln7Pf0iH13eVLN9zYDGvX72ap1rbY79SBsi3VBKRi0DPOoNFqcObTXRok0hD+XsUnlJzEfiraxklAGMfMVlfC+zyVw6KC08GV6BHAqK9Ny5/Fj8rGe8nI8RELyXQHRMxDbYbNGtPAzy25As5Alq+Rd/xtkC5CK5IZKOmTnD6mlqtUZJfy6iKVxYDglPjHvJ/PrX6elhM4nKF5+p0kb7WYEwV3mUq7MZt90fOaMDWJjQdfS4xe4Q2OaYvPj+ydgIrb90KLgkkEibUjxoiIZJqDvw5YguawHoDR2tyBVMyThGOmUYU6GBeHDXLVhqDQ4qmXuiCozgRmqvlupKt8eOuuSxIprxKsb60lxq2sGIHxpy/rM6Z2VXWkQT+3pcQp+KDzQzqhqv18o52XvqLQc8S15xkGtL6nQLaJzYK3DNvNsjuxD7NiD0mxVWWLsGgi17tfSBW6BvZTuDGckbm0it68g+AcvdpeWr/tNJi+AAAAAGVnvLiLyAmq7q+1EleXYo8y8N433F9rJbk4153vKLTFik8IfWTgvW8BhwHXuL/WSt3YavIzd9/gVhBjWJ9XGVD6MKXoFJ8Q+nH4rELIwHvfrafHZ0MIcnUmb87NcH+tlRUYES37t6Q/ntAYhyfozxpCj3OirCDGsMlHegg+rzKgW8iOGLVnOwrQAIeyaThQLwxf7Jfi8FmFh5flPdGHhmW04DrdWk+Pzz8oM3eGEOTq43dYUg3Y7UBov1H4ofgr8MSfl0gqMCJaT1ee4vZvSX+TCPXHfadA1RjA/G1O0J81K7cjjcUYlp+gfyonGUf9unwgQQKSj/QQ9+hIqD1YFJtYP6gjtpAdMdP3oYlqz3YUD6jKrOEHf76EYMMG0nCgXrcXHOZZuKn0PN8VTIXnwtHggH5pDi/Le2tId8OiDw3Lx2ixcynHBGFMoLjZ9ZhvRJD/0/x+UGbuGzfaVk0nuQ4oQAW2xu+wpKOIDBwasNuBf9dnOZF40iv0H26TA/cmO2aQmoOIPy+R7ViTKVRgRLQxB/gM36hNHrrP8abs35L+ibguRmcXm1QCcCfsu0jwcd4vTMkwgPnbVedFY5ygP2v5x4PTF2g2wXIPinnLN13krlDhXED/VE4lmOj2c4iLrhbvNxb4QIIEnSc+vCQf6SFBeFWZr9fgi8qwXDM7tlntXtHlVbB+UEfVGez/bCE7YglGh9rn6TLIgo6OcNSe7Six+VGQX1bkgjoxWDqDCY+n5m4zHwjBhg1tpjq1pOFAvcGG/AUvKUkXSk71r/N2IjKWEZ6KeL4rmB3ZlyBLyfR4Lq5IwMAB/dKlZkFqHF6W93k5Kk+Xlp9d8vEj5QUZa01gftf1jtFi5+u23l9SjgnCN+m1etlGAGi8IbzQ6jHfiI9WYzBh+dYiBJ5qmr2mvQfYwQG/Nm60rVMJCBWaTnId/ynOpRGGe7d04ccPzdkQkqi+rCpGERk4I3algHVmxtgQAXpg/q7PcpvJc8oi8aRXR5YY76k5rf3MXhFFBu5NdmOJ8c6NJkTc6EH4ZFF5L/k0HpNB2rEmU7/WmuvpxvmzjKFFC2IO8BkHaUyhvlGbPNs2J4Q1mZKWUP4uLpm5VCb83uieEnFdjHcW4TTOLjapq0mKEUXmPwMggYO7dpHg4xP2XFv9WelJmD5V8SEGgmxEYT7Uqs6Lxs+pN344QX/WXSbDbrOJdnzW7srEb9YdWQqxoeHkHhTzgXmoS9dpyxOyDnerXKHCuTnGfgGA/qmc5ZkVJAs2oDZuURyOpxZmhsJx2j4s3m8sSbnTlPCBBAmV5rixe0kNox4usRtIPtJDLVlu+8P22+mmkWdRH6mwzHrODHSUYblm8QYF3gAAAAB3BzCW7g5hLJkJUboHbcQZcGr0j+ljpTWeZJWjDtuIMnncuKTg1ekel9LZiAm2TCt+sXy957gtB5C/HZEdtxBkarAg8vO5cUiEvkHeGtrUfW3d5Ov01LVRg9OFxxNsmFZka6jA/WL5eoplyewUAVxPYwZs2foPPWONCA31O24gyExpEF7VYEHkomdxcjwD5NFLBNRH0g2F/aUKtWs1taj6QrKYbNu7ydasvPlAMths40XfXHXc1g3Pq9E9WSbZMKxR3gA6yNdRgL/QYRYhtPS1VrPEI8+6lZm4vaUPKAK4nl8FiAjGDNmysQvpJC9vfIdYaEwRwWEdq7ZmLT123EGQAdtxBpjSILzv1RAqcbGFiQa2tR+fv+Sl6LjUM3gHyaIPAPk0lgmojuEOmBh/ag27CG09LZFkbJfmY1wBa2tR9BxsYWKFZTDY8mIATmwGle0bAaV7ggj0wfUPxFdlsNnGErfpUIu+uOr8uYh8Yt0d3xXaLUmM03zz+9RMZU2yYVg6tVHOo7wAdNS7MOJK36VBPdiV16TRxG3T1vT7Q2npajRu2fytZ4hG2mC40EQELXMzAx3lqgpMX90NfMlQBXE8JwJBqr4LEBDJDCCGV2i1JSBvhbO5ZtQJzmHkn17e+Q4p2cmYsNCYIsfXqLRZsz0XLrQNgbe9XDvAumyt7biDIJq/s7YDtuIMdLHSmurVRzmd0nevBNsmFXPcFoPjYwsSlGQ7hA1taj56alqo5A7PC5MJ/50KAK4nfQeesfAPk0SHCKPSHgHyaGkGwv73YlddgGVnyxlsNnFuawbn/tQbdonTK+AQ2npaZ91KzPm532+Ovu/5F7e+Q2CwjtXW1qPoodGTfjjYwsRP3/JS0btn8aa8V2c/tQbdSLI2S9gNK9qvChtMNgNK9kEEemDfYO/DqGffVTFuju9Gab55y2GzjLxmgxolb9KgUmjiNswMd5W7C0cDIgIWuVUFJi/Fuju+sr0LKCu0WpJcs2oEwtf/p7XQzzEs2Z6LW96uHZtkwrDsY/ImdWqjnAJtkwqcCQap6w42P3IHZ4UFAFcTlb9KguK4ehR7sSuuDLYbOJLSjpvl1b4NfNzvtwvb3yGG09LU8dTiQmjds/gf2oNugb4Wzfa5JltvsHfhGLdHd4gIWub/D2pwZgY7yhEBC1yPZZ7/+GKuaWFr/9MWbM9FoArieNcN0u5OBINUOQOzwqdnJmHQYBb3SWlHTT5ud9uu0WpK2dZa3EDfC2Y32DvwqbyuU967nsVHss9/MLX/6b298hzKusKKU7OTMCS0o6a60DYFzdcGk1TeVykj2We/s2Z6LsRhSrhdaBsCKm8rlLQLvjfDDI6hWgXfGy0C740AAAAAGRsxQTI2YoIrLVPDZGzFBH139EVWWqeGT0GWx8jZigjRwrtJ+u/oiuP02custU8Mta5+TZ6DLY6HmBzPSsISUVPZIxB49HDTYe9Bki6u11U3teYUHJi11wWDhJaCG5hZmwCpGLAt+tupNsua5nddXf9sbBzUQT/fzVoOnpWEJKKMnxXjp7JGIL6pd2Hx6OGm6PPQ58PegyTaxbJlXV2uqkRGn+tva8wodnD9aTkxa64gKlrvCwcJLBIcOG3fRjbzxl0Hsu1wVHH0a2Uwuyrz96IxwraJHJF1kAegNBefvPsOhI26JaneeTyy7zhz83n/auhIvkHFG31Y3io88HlPBelifkTCTy2H21QcxpQVigGNDrtApiPog7842cI4oMUNIbv0TAqWp48TjZbOXMwACUXXMUhu+mKLd+FTyrq7XVSjoGwViI0/1pGWDpfe15hQx8ypEezh+tL1+suTcmLXXGt55h1AVLXeWU+EnxYOElgPFSMZJDhw2j0jQZtl/WunfOZa5lfLCSVO0DhkAZGuoxiKn+Izp8whKrz9YK0k4a+0P9DunxKDLYYJsmzJSCSr0FMV6vt+RiniZXdoLz959jYkSLcdCRt0BBIqNUtTvPJSSI2zeWXecGB+7zHn5vP+/v3Cv9XQkXzMy6A9g4o2+pqRB7uxvFR4qKdlOTuDmEsimKkKCbX6yRCuy4hf711PRvRsDm3ZP810wg6M81oSQ+pBIwLBbHDB2HdBgJc210eOLeYGpQC1xbwbhIRxQYoaaFq7W0N36JhabNnZFS1PHgw2fl8nGy2cPgAc3bmYABKggzFTi65ikJK1U9Hd9MUWxO/0V+/Cp5T22ZbVrge86bccjaicMd5rhSrvKspree3TcEis+F0bb+FGKi5m3jbhf8UHoFToVGNN82UiArLz5RupwqQwhJFnKZ+gJuTFrrj93p/51vPMOs/o/XuAqWu8mbJa/bKfCT6rhDh/LBwksDUHFfEeKkYyBzF3c0hw4bRRa9D1ekaDNmNdsnfL+tdO0uHmD/nMtczg14SNr5YSSraNIwudoHDIhLtBiQMjXUYaOGwHMRU/xCgODoVnT5hCflSpA1V5+sBMYsuBgTjFH5gj9F6zDqedqhWW3OVUABv8TzFa12Jimc55U9hJ4U8XUPp+VnvXLZVizBzULY2KEzSWu1Ifu+iRBqDZ0F5+8+xHZcKtbEiRbnVToC86EjboIwkHqQgkVGoRP2Urlqd55I+8SKWkkRtmvYoqJ/LLvODr0I2hwP3eYtnm7yMUvOG9DafQ/CaKgz8/kbJ+cNAkuWnLFfhC5kY7W/13etxla7XFflr07lMJN/dIOHa4Ca6xoRKf8Io/zDOTJP1yAAAAAAHCajcDhNRuAka+WQcJqNwGy8LrBI18sgVPFoUOE1G4D9E7jw2XhdYMVe/hCRr5ZAjYk1MKni0KC1xHPRwmo3Ad5MlHH6J3Hh5gHSkbLwusGu1hmxir38IZabX1EjXyyBP3mP8RsSamEHNMkRU8WhQU/jAjFriOehd65E04TUbgOY8s1zvJko46C/i5P0TuPD6GhAs8wDpSPQJQZTZeF1g3nH1vNdrDNjQYqQExV7+EMJXVszLTa+ozEQHdJGvlkCWpj6cn7zH+Ji1bySNiTUwioCd7IOaZIiEk8xUqeLQoK7reHyn8YEYoPgpxLXEc9CyzdsMu9ciaLzeirXCajcBxWOf3cx5ZrnLcM5l3kyUcdlFPK3QX8XJ11ZtFfonceH9Ltk99DQgWfM9iIXmAdKR4Qh6TegSgynvGyv1svC6wbX5Eh284+t5u+pDpa7WGbGp37FtoMVICafM4NWKvfwhjbRU/YSurZmDpwVFlptfUZGS942YiA7pn4GmNSNfLIEkVoRdLUx9OSpF1eU/eY/xOHAnLTFq3kk2Y3aVGxJqYRwbwr0VATvZEgiTBQc0yREAPWHNCSeYqQ4uMHVTxaFBVMwJnV3W8Pla31glT+MCMUjqqu1B8FOJRvn7VWuI56FsgU99ZZu2GWKSHsV3rkTRcKfsDXm9FWl+tL23hNRuA4Pdxt+Kxz+7jc6XZ5jyzXOf+2WvluGcy5HoNBe8mSjju5CAP7KKeVu1g9GHoL+Lk6e2I0+urNorqaVy9/RO48PzR0sf+l2ye/1UGqfoaECz72Hob+Z7EQvhcrnXzAOlI8sKDf/CEPSbxRlcR9AlBlPXLK6P3jZX69k//zdl4XWDYujdX2vyJDts+4znecfW837Ofi931IdLcN0vl12sM2NapZu/U79i21S2ygdBipATRoM4z0+ZwatIkGl3FXv4QxJyUJ8baKn7HGEBJwldWzMOVPPvB04KiwBHolctNr6jKj8WfyMl7xskLEfHMRAd0zYZtQ8/A0xrOArktka+WQJBt/HeSK0Iuk+koGZamPpyXZFSrlSLq8pTggMWfvMf4nn6tz5w4E5ad+nmhmLVvJJl3BRObMbtKmvPRfY2JNTCMS18Hjg3hXo/Pi2mKgJ3si0L324kESYKIxiO1g5pkiIJYDr+AHrDmgdza0YSTzFSFUaZjhxcYOobVcg2p4tCgqCC6l6pmBM6rpG75rut4fK8pEkutb6wSrK3GJafxgRimM+svpHVVdqW3P0Gg+CnEoTpD86N8/aqivpedtcRz0LQGGee2QKe+t4LNibLN2wyzD7E7sUkPYrCLZVW71yJouhVIX7hT9ga5kZwxvN6KtL0c4IO/Wl7avpg07QAAAAC4vGdlqgnIixK1r+6PYpdXN97wMiVrX9yd1zi5xbQo730IT4pvveBk1wGHAUrWv7jyatjd4N93M1hjEFZQGVef6KUw+voQnxRCrPhx33vAyGfHp611cghDzc5vJpWtf3AtERgVP6S3+4cY0J4az+gnonOPQrDGIKwIekfJoDKvPhiOyFsKO2e1socA0C9QOGmX7F8MhVnw4j3ll4dlhofR3TrgtM+PT1p3Myg/6uQQhlJYd+NA7dgN+FG/aPAr+KFIl5/EWiIwKuKeV09/SW/2x/UIk9VAp31t/MAYNZ/QTo0jtyuflhjFJyp/oLr9RxkCQSB8EPSPkqhI6PebFFg9I6g/WDEdkLaJoffTFHbPaqzKqA++fwfhBsNghF6gcNLmHBe39Km4WUwV3zzRwueFaX6A4HvLLw7Dd0hryw0PonOxaMdhBMcp2bigTERvmPX80/+Q7mZQflbaNxsOuSdNtgVAKKSw78YcDIijgduwGjln138r0niRk24f9Dsm9wODmpBmkS8/iCmTWO20RGBUDPgHMR5NqN+m8c+6/pLf7EYuuIlUmxdn7CdwAnHwSLvJTC/e2/mAMGNF51VrP6Cc04PH+cE2aBd5ig9y5F03y1zhUK5OVP9A9uiYJa6LiHMWN+8WBIJA+Lw+J50h6R8kmVV4QYvg168zXLDK7Vm2O1Xl0V5HUH6w/+wZ1WI7IWzah0YJyDLp53COjoIo7Z7UkFH5sYLkVl86WDE6p48Jgx8zbuYNhsEItTqmbb1A4aQF/IbBF0kpL6/1TkoyInbzip4Rlpgrvnggl9kdePTJS8BIri7S/QHAakFmpfeWXhxPKjl5XZ+Wl+Uj8fJNaxkF9dd+YOdi0Y5f3rbrwgmOUnq16TdoAEbZ0LwhvIjfMeowY1aPItb5YZpqngQHvaa9vwHB2K20bjYVCAlTHXJOmqXOKf+3e4YRD8fhdJIQ2c0qrL6oOBkRRoCldiPYxmZ1YHoBEHLPrv7Kc8mbV6TxIu8Ylkf9rTmpRRFezHZN7gbO8Ylj3EQmjWT4Qej5L3lRQZMeNFMmsdrrmta/s/nG6QtFoYwZ8A5ioUxpBzybUb6EJzbblpKZNS4u/lAmVLmZnuje/IxdcRI04RZ3qTYuzhGKSasDP+ZFu4OBIOPgkXZbXPYTSelZ/fFVPphsggYh1D5hRMaLzqp+N6nP1n9BOG7DJl18domzxMru1lkd1m/hobEK8xQe5EuoeYETy2nXq3cOsrnCoVwBfsY5nKn+gCQVmeU2oDYLjhxRboZmFqc+2nHCLG/eLJTTuUkJBIHwsbjmlaMNSXsbsS4eQ9I+SPtuWS3p2/bDUWeRpsywqR90DM56ZrlhlN4FBvEAAAAAAAAAAAMAAAAEAAQACAAEAAQAAAAEAAUAEAAIAAQAAAAEAAYAIAAgAAQAAAAEAAQAEAAQAAUAAAAIABAAIAAgAAUAAAAIABAAgACAAAUAAAAIACAAgAAAAQUAAAAgAIAAAgEABAUAAAAgAAIBAgEAEAUAQYHJAAu2EAECAwQEBQUGBgYGBwcHBwgICAgICAgICQkJCQkJCQkKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDwAAEBESEhMTFBQUFBUVFRUWFhYWFhYWFhcXFxcXFxcXGBgYGBgYGBgYGBgYGBgYGBkZGRkZGRkZGRkZGRkZGRkaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHB0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0AAQIDBAUGBwgICQkKCgsLDAwMDA0NDQ0ODg4ODw8PDxAQEBAQEBAQERERERERERESEhISEhISEhMTExMTExMTFBQUFBQUFBQUFBQUFBQUFBUVFRUVFRUVFRUVFRUVFRUWFhYWFhYWFhYWFhYWFhYWFxcXFxcXFxcXFxcXFxcXFxgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxscwCcAAMAsAAABAQAAHgEAAA8AAABALAAAQC0AAAAAAAAeAAAADwAAAAAAAADALQAAAAAAABMAAAAHAAAAAAAAAAwACACMAAgATAAIAMwACAAsAAgArAAIAGwACADsAAgAHAAIAJwACABcAAgA3AAIADwACAC8AAgAfAAIAPwACAACAAgAggAIAEIACADCAAgAIgAIAKIACABiAAgA4gAIABIACACSAAgAUgAIANIACAAyAAgAsgAIAHIACADyAAgACgAIAIoACABKAAgAygAIACoACACqAAgAagAIAOoACAAaAAgAmgAIAFoACADaAAgAOgAIALoACAB6AAgA+gAIAAYACACGAAgARgAIAMYACAAmAAgApgAIAGYACADmAAgAFgAIAJYACABWAAgA1gAIADYACAC2AAgAdgAIAPYACAAOAAgAjgAIAE4ACADOAAgALgAIAK4ACABuAAgA7gAIAB4ACACeAAgAXgAIAN4ACAA+AAgAvgAIAH4ACAD+AAgAAQAIAIEACABBAAgAwQAIACEACAChAAgAYQAIAOEACAARAAgAkQAIAFEACADRAAgAMQAIALEACABxAAgA8QAIAAkACACJAAgASQAIAMkACAApAAgAqQAIAGkACADpAAgAGQAIAJkACABZAAgA2QAIADkACAC5AAgAeQAIAPkACAAFAAgAhQAIAEUACADFAAgAJQAIAKUACABlAAgA5QAIABUACACVAAgAVQAIANUACAA1AAgAtQAIAHUACAD1AAgADQAIAI0ACABNAAgAzQAIAC0ACACtAAgAbQAIAO0ACAAdAAgAnQAIAF0ACADdAAgAPQAIAL0ACAB9AAgA/QAIABMACQATAQkAkwAJAJMBCQBTAAkAUwEJANMACQDTAQkAMwAJADMBCQCzAAkAswEJAHMACQBzAQkA8wAJAPMBCQALAAkACwEJAIsACQCLAQkASwAJAEsBCQDLAAkAywEJACsACQArAQkAqwAJAKsBCQBrAAkAawEJAOsACQDrAQkAGwAJABsBCQCbAAkAmwEJAFsACQBbAQkA2wAJANsBCQA7AAkAOwEJALsACQC7AQkAewAJAHsBCQD7AAkA+wEJAAcACQAHAQkAhwAJAIcBCQBHAAkARwEJAMcACQDHAQkAJwAJACcBCQCnAAkApwEJAGcACQBnAQkA5wAJAOcBCQAXAAkAFwEJAJcACQCXAQkAVwAJAFcBCQDXAAkA1wEJADcACQA3AQkAtwAJALcBCQB3AAkAdwEJAPcACQD3AQkADwAJAA8BCQCPAAkAjwEJAE8ACQBPAQkAzwAJAM8BCQAvAAkALwEJAK8ACQCvAQkAbwAJAG8BCQDvAAkA7wEJAB8ACQAfAQkAnwAJAJ8BCQBfAAkAXwEJAN8ACQDfAQkAPwAJAD8BCQC/AAkAvwEJAH8ACQB/AQkA/wAJAP8BCQAAAAcAQAAHACAABwBgAAcAEAAHAFAABwAwAAcAcAAHAAgABwBIAAcAKAAHAGgABwAYAAcAWAAHADgABwB4AAcABAAHAEQABwAkAAcAZAAHABQABwBUAAcANAAHAHQABwADAAgAgwAIAEMACADDAAgAIwAIAKMACABjAAgA4wAIAAAABQAQAAUACAAFABgABQAEAAUAFAAFAAwABQAcAAUAAgAFABIABQAKAAUAGgAFAAYABQAWAAUADgAFAB4ABQABAAUAEQAFAAkABQAZAAUABQAFABUABQANAAUAHQAFAAMABQATAAUACwAFABsABQAHAAUAFwAFAEHg2QALTQEAAAABAAAAAQAAAAEAAAACAAAAAgAAAAIAAAACAAAAAwAAAAMAAAADAAAAAwAAAAQAAAAEAAAABAAAAAQAAAAFAAAABQAAAAUAAAAFAEHQ2gALZQEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAUAAAAGAAAABgAAAAcAAAAHAAAACAAAAAgAAAAJAAAACQAAAAoAAAAKAAAACwAAAAsAAAAMAAAADAAAAA0AAAANAEGA3AALIwIAAAADAAAABwAAAAAAAAAQERIACAcJBgoFCwQMAw0CDgEPAEG03AALaQEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACgAAAAwAAAAOAAAAEAAAABQAAAAYAAAAHAAAACAAAAAoAAAAMAAAADgAAABAAAAAUAAAAGAAAABwAAAAgAAAAKAAAADAAAAA4ABBtN0AC5oCAQAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAAAAAEAAIABAAAAAgAAAAMAAAAEAAAABgAAAAgAAAAMAAAAEAAAABgAAAAgAAAAMAAAAEAAAABgAABuZWVkIGRpY3Rpb25hcnkAc3RyZWFtIGVuZAAAZmlsZSBlcnJvcgBzdHJlYW0gZXJyb3IAZGF0YSBlcnJvcgBpbnN1ZmZpY2llbnQgbWVtb3J5AGJ1ZmZlciBlcnJvcgBpbmNvbXBhdGlibGUgdmVyc2lvbgAAAAAoLwAAOC8AAEMvAABELwAATy8AAFwvAABnLwAAey8AAIgvAABDLwAAMS4yLjExAEHQ3wALA9AxUA==").split("").map(o=>o.charCodeAt(0));return new Uint8Array(i,0,i.length/Uint8Array.BYTES_PER_ELEMENT)}();let _3,Gc;function E3(){return E3=U(function*(){if(_3)return _3;const t={};let i,o={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);let s=!1,c=!1;s="object"==typeof window,c="function"==typeof importScripts,"object"==typeof process&&"object"==typeof process.versions&&process;let l="";(s||c)&&(c?l=self.location.href:typeof document<"u"&&document.currentScript&&(l=document.currentScript.src),l=0!==l.indexOf("blob:")?l.substr(0,l.lastIndexOf("/")+1):""),t.print||console.log.bind(console);const p=t.printErr||console.warn.bind(console);for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);let h;o=null,"object"!=typeof WebAssembly&&Y("no native wasm support detected");let g=!1;function f(Q){const K=t["_"+Q];return K||Y("Assertion failed: Cannot call unknown function "+Q+", make sure it is exported"),K}function A(Q,K,ne,me,Ne){const ce={string:function(be){let dt=0;if(null!=be&&0!==be){const St=1+(be.length<<2);dt=z(St),function(Xt,et,Zt,pt){if(!(pt>0))return 0;const li=Zt+pt-1;for(let Xn=0;Xn<Xt.length;++Xn){let mr=Xt.charCodeAt(Xn);if(mr>=55296&&mr<=57343&&(mr=65536+((1023&mr)<<10)|1023&Xt.charCodeAt(++Xn)),mr<=127){if(Zt>=li)break;et[Zt++]=mr}else if(mr<=2047){if(Zt+1>=li)break;et[Zt++]=192|mr>>6,et[Zt++]=128|63&mr}else if(mr<=65535){if(Zt+2>=li)break;et[Zt++]=224|mr>>12,et[Zt++]=128|mr>>6&63,et[Zt++]=128|63&mr}else{if(Zt+3>=li)break;et[Zt++]=240|mr>>18,et[Zt++]=128|mr>>12&63,et[Zt++]=128|mr>>6&63,et[Zt++]=128|63&mr}}et[Zt]=0}(be,y,dt,St)}return dt},array:function(be){const dt=z(be.length);return v.set(be,dt),dt}},T=f(Q),k=[];let j=0;if(me)for(let be=0;be<me.length;be++){const dt=ce[ne[be]];dt?(0===j&&(j=Ye()),k[be]=dt(me[be])):k[be]=me[be]}let re=T.apply(null,k);return be=re,re="string"===K?(dt=be)?function(at,sn,vt){const Xt=sn+undefined;let et=sn,Zt="";for(;at[et]&&!(et>=Xt);)++et;if(et-sn>16&&at.subarray&&_)return _.decode(at.subarray(sn,et));for(;sn<et;){let pt=at[sn++];if(!(128&pt)){Zt+=String.fromCharCode(pt);continue}const Gt=63&at[sn++];if(192==(224&pt)){Zt+=String.fromCharCode((31&pt)<<6|Gt);continue}const li=63&at[sn++];if(pt=224==(240&pt)?(15&pt)<<12|Gt<<6|li:(7&pt)<<18|Gt<<12|li<<6|63&at[sn++],pt<65536)Zt+=String.fromCharCode(pt);else{const Xn=pt-65536;Zt+=String.fromCharCode(55296|Xn>>10,56320|1023&Xn)}}return Zt}(y,dt):"":"boolean"===K?Boolean(be):be,0!==j&&Ee(j),re;var be,dt}const _=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;let v,y,S;typeof TextDecoder<"u"&&new TextDecoder("utf-16le");const R=[],D=[],O=[],P=[];D.push({func:function(){fe()}});let B=0,G=null;function Y(Q){throw t.onAbort&&t.onAbort(Q),p(Q+=""),g=!0,Q="abort("+Q+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(Q)}t.preloadedImages={},t.preloadedAudios={};let ae="deflate.wasm";var Q;function Z(Q){for(;Q.length>0;){const K=Q.shift();if("function"==typeof K){K(t);continue}const ne=K.func;"number"==typeof ne?void 0===K.arg?S.get(ne)():S.get(ne)(K.arg):ne(void 0===K.arg?null:K.arg)}}ae.startsWith("data:application/octet-stream;base64,")||(Q=ae,ae=t.locateFile?t.locateFile(Q,l):l+Q);const _e={emscripten_memcpy_big:function(Q,K,ne){y.copyWithin(Q,K,K+ne)},emscripten_resize_heap:function(Q){Y("OOM")}};yield U(function*(){const Q={env:_e,wasi_snapshot_preview1:_e};function K(Ne,ce){var k;t.asm=Ne.exports,h=t.asm.memory,k=h.buffer,t.HEAP8=v=new Int8Array(k),t.HEAP16=new Int16Array(k),t.HEAP32=new Int32Array(k),t.HEAPU8=y=new Uint8Array(k),t.HEAPU16=new Uint16Array(k),t.HEAPU32=new Uint32Array(k),t.HEAPF32=new Float32Array(k),t.HEAPF64=new Float64Array(k),S=t.asm.__indirect_function_table,function(j){if(B--,t.monitorRunDependencies&&t.monitorRunDependencies(B),0==B&&G){const re=G;G=null,re()}}()}if(B++,t.monitorRunDependencies&&t.monitorRunDependencies(B),t.instantiateWasm)try{return t.instantiateWasm(Q,K)}catch(Ne){return p("Module.instantiateWasm callback failed with error: "+Ne),!1}return yield function me(Ne){return new Ie((ce,T)=>{ce(m3().buffer)}).then(function(ce){return WebAssembly.instantiate(ce,Q)}).then(Ne,function(ce){p("failed to asynchronously prepare wasm: "+ce),Y(ce)})}(function ne(Ne){K(Ne.instance)}),{}})();let fe=t.___wasm_call_ctors=function(){return(fe=t.___wasm_call_ctors=t.asm.__wasm_call_ctors).apply(null,arguments)},Se=t._malloc=function(){return(Se=t._malloc=t.asm.malloc).apply(null,arguments)};t._free=function(){return(t._free=t.asm.free).apply(null,arguments)},t.___errno_location=function(){return(t.___errno_location=t.asm.__errno_location).apply(null,arguments)},t._zlibCompress=function(){return(t._zlibCompress=t.asm.zlibCompress).apply(null,arguments)};let Oe,Ye=t.stackSave=function(){return(Ye=t.stackSave=t.asm.stackSave).apply(null,arguments)},Ee=t.stackRestore=function(){return(Ee=t.stackRestore=t.asm.stackRestore).apply(null,arguments)},z=t.stackAlloc=function(){return(z=t.stackAlloc=t.asm.stackAlloc).apply(null,arguments)};function ee(Q){function K(){Oe||(Oe=!0,t.calledRun=!0,g||(Z(D),Z(O),t.onRuntimeInitialized&&t.onRuntimeInitialized(),function(){if(t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;)ne=t.postRun.shift(),P.unshift(ne);var ne;Z(P)}()))}B>0||(function(){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)ne=t.preRun.shift(),R.unshift(ne);var ne;Z(R)}(),B>0||(t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),K()},1)):K()))}if(t.ccall=A,t.cwrap=function(Q,K,ne,me){const Ne=(ne=ne||[]).every(function(ce){return"number"===ce});return"string"!==K&&Ne&&!me?f(Q):function(){return A(Q,K,ne,arguments)}},t.allocate=function(Q,K){let ne;return ne=1==K?z(Q.length):Se(Q.length),y.set(Q.subarray||Q.slice?Q:new Uint8Array(Q),ne),ne},G=function Q(){Oe||ee(),Oe||(G=Q)},t.run=ee,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return ee(),_3=t,t}),E3.apply(this,arguments)}const v9=Uint8Array.BYTES_PER_ELEMENT,v3={bytesReceived:"br",frameDropped:"fd",frameReceived:"fr",googJitterReceived:"jr",isAudioMute:"am",isFreeze:"fz",mediaType:"mt",packetsLost:"pl",packetsReceived:"pr",peerId:"pid",id:"id",ssrc:"ssrc",timestamp:"ts",type:"tp",frameRateInput:"fi",frameRateSent:"fs",googRtt:"rt",isVideoMute:"vm"},Wl={stats:"sts",state:"st",stream_id:"stid",session_id:"seid",stream_type:"stt",app_id:"aid",channel_key:"ck",channel_name:"cn",sdk_version:"sv",browser:"b",process_id:"pcid",mode:"m",codec:"c",role:"r",has_changed_gateway:"hcg",ap_response:"ar",extends:"es",details:"d",features:"ft",p2p_id:"ppid",sdp:"sdp",audio:"a",video:"v",attributes:"at",hq:"h",lq:"l",stereo:"str",speech:"spe",extend:"e",pingpongElapse:"ppe"},C3={_message:"m",_type:"t",_id:"id"},Zm={join_v2:"j2",publish:"pub",publish_related_stats:"prs",ping:"pi",traffic_stats:"ts",ping_back:"pib",publish_stats:"pubs"};let Hf;class y3{constructor(){b(this,"zlibCompress",void 0)}init(){var i=this;return U(function*(){Hf||(Hf=(yield U(function*(){return Gc||(Gc=yield function CY(){return E3.apply(this,arguments)}()),{zlibCompress:s=>{const c=new Uint8Array(s),l=v9*c.byteLength,p=Gc._malloc(l),h=Gc._malloc(3*l);for(let A=0;A<l;A++)Gc.HEAP8[p/v9+A]=c[A];const g=Gc._zlibCompress(p,l,h),f=new Uint8Array(Gc.HEAP8.slice(h,h+g));return Gc._free(p),Gc._free(h),f}}})()).zlibCompress),i.zlibCompress=Hf})()}msgPackCompress(i){return GD.exports.encode(i)}compress(i){const o=Date.now(),s=this.compressKeyAndValue(JSON.parse(JSON.stringify(i))),c=this.msgPackCompress(s),l=this.zlibCompress(c),p=new Uint8Array([49,49,49,50,...Array.from(l)]);return{origin:Object.assign({},i),originLength:JSON.stringify(i).length,shortKeyAndValue:s,msgpackSer:c,compressed:p,compressedLength:p.length,time:Date.now()-o}}compressKeyAndValue(i){return this._ObjectKeyCompress(this._typeCompress(i))}_typeCompress(i){const o=i._type;return o?(i._type=Zm[o]||o,i):i}_ObjectKeyCompress(i){const o=i._message;if(o){const s=o.stats;s&&(o.stats=this._statsCompress(s)),i._message=this._messageCompress(o)}return this._reportCompress(i)}_statsCompress(i){return this._keyCompress(i,v3)}_messageCompress(i){return this._keyCompress(i,Wl)}_reportCompress(i){return this._keyCompress(i,C3)}_keyCompress(i,o){const s={},c=Object.keys(i);return hc(c).call(c,(l,p)=>{const h=i[p];return o[p]?s[o[p]]=h:s[p]=h,s},s),s}}class C9 extends En{get queue(){return[...this.highPriorityQueue,...this.lowPriorityQueue]}constructor(i){super(),b(this,"lowPriorityQueue",[]),b(this,"highPriorityQueue",[]),b(this,"AgoraWebSocketManager",void 0),this.AgoraWebSocketManager=i}reset(){this.lowPriorityQueue=[],this.highPriorityQueue=[]}pushMessage(i){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.highPriorityQueue.push(i):this.lowPriorityQueue.push(i),this.sendMessage()}sendMessage(){const i=this.queue.length;let o=0;o=i<5?15*i:60+3*(i-4),setTimeout(()=>{this._sendMessage()},o)}_sendMessage(){if(!this.queue.length)return;const i=this.AgoraWebSocketManager.getConnection();if(!i||1!==i.readyState)return;const o=this.queue.shift();return this.lowPriorityQueue.includes(o)?this.lowPriorityQueue.shift():this.highPriorityQueue.shift(),i.send(o.compressed),o}}var I3;function S3(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}let Th=kn("AgoraWebSocketManager","connectionID")(I3=class extends En{get url(){return this.websocket?this.websocket.url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(t){["tryNext","recover"].includes(t)&&this.resetReconnectCount(t),this._reconnectMode=t}get state(){return this._state}set state(t){t!==this._state&&(this._state=t,"reconnecting"===this._state?this.emit(ht.RECONNECTING,this.reconnectReason):"connected"===this._state?this.emit(ht.CONNECTED):"closed"===this._state?this.emit(ht.CLOSED):"failed"===this._state&&this.emit(ht.FAILED))}resetReconnectCount(t){N.debug("websocket reset reconnect count, reason: "+t),le("debug",this,"resetReconnectCount",t,"websocket reset reconnect count, reason: "+t),this.reconnectCount=0}constructor(t,i){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4?arguments[4]:void 0;super(),b(this,"connectionID",0),b(this,"currentURLIndex",0),b(this,"urls",void 0),b(this,"_reconnectMode","tryNext"),b(this,"reconnectReason",void 0),b(this,"_initMutex",new eo("websocket")),b(this,"name",void 0),b(this,"_state","closed"),b(this,"reconnectInterrupter",void 0),b(this,"websocket",void 0),b(this,"retryConfig",void 0),b(this,"reconnectCount",0),b(this,"forceCloseTimeout",5e3),b(this,"onlineReconnectListener",void 0),b(this,"compressor",new y3),b(this,"compressorInitStatus","initializing"),b(this,"compress",void 0),b(this,"messageSender",void 0),b(this,"useCompress",void 0),b(this,"tryDoubleDomain",!1),b(this,"wsInflateLength",0),b(this,"wsDeflateLength",0),b(this,"closeEstablishingWs",()=>{}),b(this,"store",void 0),b(this,"joinChannelServiceRecordIndex",void 0),this.store=c,this.name=t,this.retryConfig=function(A){for(var _=1;_<arguments.length;_++){var v=null!=arguments[_]?arguments[_]:{};_%2?S3(Object(v),!0).forEach(function(y){b(A,y,v[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(v)):S3(Object(v)).forEach(function(y){Object.defineProperty(A,y,Object.getOwnPropertyDescriptor(v,y))})}return A}({},i),this.useCompress=o,this.tryDoubleDomain=s;const{timeout:l,timeoutFactor:p}=i,h=Math.max(300,Math.floor(3*l/5)),g=Math.max(1.2,Math.floor(8*p)/10);Ci.ONLINE&&(this.retryConfig.timeout=h,this.retryConfig.timeoutFactor=g),$n.on(Rc.NETWORK_STATE_CHANGE,(A,_)=>{A!==_&&(this.resetReconnectCount("network state change: ".concat(_," -> ").concat(A)),A===Ci.ONLINE?(this.retryConfig.timeout=h,this.retryConfig.timeoutFactor=g):(this.retryConfig.timeout=l,this.retryConfig.timeoutFactor=p))});const f=Date.now();this.compressor.init().then(()=>{this.compressorInitStatus="initialized";const A=Date.now()-f;N.debug("websocket compressor initialized successfully in ".concat(A,"ms")),le("debug",this.compressor,"init",void 0,"websocket compressor initialized successfully in ".concat(A,"ms")),pe.wsCompressorInit({status:!0,ec:null,eventElapse:A}),this.compress=this.compressor.compress.bind(this.compressor)}).catch(A=>{this.compressorInitStatus="failed";const _=A?A.message||A.toString():"Empty Error";N.debug("websocket compressor failed to initialize because of ".concat(_)),le("debug",this.compressor,"init",void 0,"websocket compressor failed to initialize because of ".concat(_)),pe.wsCompressorInit({status:!1,ec:_,eventElapse:1})})}getConnection(){return this.websocket||void 0}init(t){this.forceCloseTimeout=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const o=(s,c)=>{this.urls=t;const l=this.urls[this.currentURLIndex];this.state="connecting",this.messageSender=new C9(this),this.createWebSocketConnection(l).then(s).catch(c),this.once(ht.CLOSED,()=>c(new V(L.WS_DISCONNECT))),this.once(ht.CONNECTED,()=>s())};return this._initMutex.lock().then(s=>new Ie((c,l)=>{o(c,l)}).then(()=>{s()}).catch(()=>{s()}))}close(t,i){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const o=this.websocket;i?setTimeout(()=>o.close(),500):o.close(),this.websocket=void 0}this.state=t?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(t,i){if(!this.websocket)return N.warning("[".concat(this.name,"] can not reconnect, no websocket")),void le("warning",this,"reconnect","can not reconnect, no websocket");var o;void 0!==t&&(this.reconnectMode=t),N.debug("[".concat(this.name,"] reconnect is triggered initiative")),le("debug",this,"reconnect"),"number"==typeof this.joinChannelServiceRecordIndex&&(null===(o=this.store)||void 0===o||o.recordJoinChannelService({status:"error",errors:[new Error(i)]},this.joinChannelServiceRecordIndex));const s=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),s&&s.bind(this.websocket)({code:9999,reason:i})}sendMessageWithJSON(t){const i=JSON.stringify(t);return{compressed:i,compressedLength:i.length,origin:t}}sendMessageWithUint8Array(t){return{compressed:t,compressedLength:t.byteLength,origin:t}}sendMessage(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new V(L.WS_ABORT,"websocket is not ready");try{let s=null;if(o)s=this.sendMessageWithUint8Array(t);else if("initialized"===this.compressorInitStatus&&this.useCompress&&J("WEBSOCKET_COMPRESS"))try{s=this.compress(t),this.setWsInflateData(s)}catch{s=this.sendMessageWithJSON(t)}else s=this.sendMessageWithJSON(t);i?this.websocket.send(s.compressed):this.messageSender.pushMessage(s)}catch(s){throw new V(L.WS_ERR,"send websocket message error"+s.toString())}}setWsInflateData(t){this.wsDeflateLength=this.wsDeflateLength+t.originLength,this.wsInflateLength=this.wsInflateLength+t.compressedLength}getWsInflateData(){const t=this.wsInflateLength,i=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:t,wsDeflateLength:i}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}createWebSocketConnection(t,i){var o=this;return U(function*(){return o.connectionID+=1,o.joinChannelServiceRecordIndex=void 0,new Ie((s,c)=>{var l;const p=()=>{var A;null===(A=o.store)||void 0===A||A.signalChannelOpen(),N.debug("[".concat(o.name,"] websocket opened:"),t),Po("debug",["WebSocket",o.connectionID],"open",t),o.reconnectMode="retry",o.state="connected",o.resetReconnectCount("opened"),s()},h=function(){var A=U(function*(_){if(N.debug("[".concat(o.name,"] websocket close ").concat(o.websocket&&o.websocket.url,", code: ").concat(_.code,", reason: ").concat(_.reason,", current mode: ").concat(o.reconnectMode)),Po("debug",["WebSocket",o.connectionID],"close",{code:_.code,reason:_.reason,url:o.websocket&&o.websocket.url,reconnectMode:o.reconnectMode}),o.reconnectCount<o.retryConfig.maxRetryCount){"connected"===o.state&&(o.reconnectReason=_.reason,o.state="reconnecting");const v=Uc(o,ht.WILL_RECONNECT,o.reconnectMode)||o.reconnectMode,y=yield o.reconnectWithAction(v);if("closed"===o.state)return N.debug("[".concat(o.connectionID,"] ws is closed, no need to reconnect")),void Re("debug",o,"ws is closed, no need to reconnect");if(!y)return c(new V(L.WS_DISCONNECT,"websocket reconnect failed: ".concat(_.code))),void o.close(!0);s()}else c(new V(L.WS_DISCONNECT,"websocket close: ".concat(_.code))),o.close()});return function(v){return A.apply(this,arguments)}}(),g=A=>{o.emit(ht.ON_MESSAGE,A)};o.websocket&&(o.websocket.onclose=null,o.websocket.close()),J("GATEWAY_WSS_ADDRESS")&&o.name.startsWith("gateway")&&(t=J("GATEWAY_WSS_ADDRESS")),N.debug("[".concat(o.name,"] start connect, url: ").concat(t)),Re("debug",o,"start connect, url: ".concat(t));const f=null===(l=o.store)||void 0===l?void 0:l.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});o.chooseBestWebsocketConnection(t,!!i,f).then(A=>{var _;o.websocket=A,p&&p(),A.onclose=h,A.onmessage=g,null===(_=o.store)||void 0===_||_.recordJoinChannelService({endTs:Date.now(),status:"success"},f),o.joinChannelServiceRecordIndex=f}).catch(A=>{var _;if(null===(_=o.store)||void 0===_||_.recordJoinChannelService({endTs:Date.now(),status:A instanceof V&&A.code===L.WS_ABORT?"aborted":"error",errors:[A]},f),"closed"!==o.state){if(A instanceof V&&A.code===L.WS_ERR){const v=new V(L.WS_ERR,"init websocket failed! Error: ".concat(A.toString()));return N.error("[".concat(o.name,"]").concat(v)),le("error",o,"chooseBestWebsocketConnection",void 0,A.toString()),void c(v)}h&&h(A)}else c(new V(L.WS_DISCONNECT,"websocket is closed: ".concat(A.toString())))})})})()}reconnectWithAction(t){var i=arguments,o=this;return U(function*(){let s=!(i.length>1&&void 0!==i[1])||i[1];if(o.reconnectCount>=o.retryConfig.maxRetryCount||!o.urls||"closed"===o.state)return!1;o.onlineReconnectListener||$n.networkState!==Ci.OFFLINE||(o.onlineReconnectListener=$n.onlineWaiter&&$n.onlineWaiter.then(()=>{o.onlineReconnectListener=void 0}));let c=!0;if(o.reconnectInterrupter=()=>{c=!1},s){const h=_T(o.reconnectCount,o.retryConfig);N.debug("[".concat(o.name,"] wait ").concat(h,"ms to reconnect websocket, mode: ").concat(t)),le("debug",o,"reconnectWithAction",{timeout:h,action:t}),yield Ie.race([Ar(h),o.onlineReconnectListener||new Ie(()=>{})])}if("closed"===o.state||!c)return!1;o.reconnectCount+=1;const l=function(){var h=U(function*(g,f){o.emit(ht.RECONNECT_CREATE_CONNECTION,f),yield o.createWebSocketConnection(g)});return function(f,A){return h.apply(this,arguments)}}();try{if("retry"===t){const h=o.urls[o.currentURLIndex];o.emit(ht.RECONNECT_WAITTING_FINISH,t),yield l(h,t)}else if("tryNext"===t){if(o.currentURLIndex+=1,o.currentURLIndex>=o.urls.length)return yield o.reconnectWithAction("recover",!1);N.debug("[".concat(o.name,"] websocket url length: ").concat(o.urls.length," current index: ").concat(o.currentURLIndex)),Re("debug",o,"websocket url length: ".concat(o.urls.length," current index: ").concat(o.currentURLIndex));const h=o.urls[o.currentURLIndex];o.emit(ht.RECONNECT_WAITTING_FINISH,t),yield l(h,t)}else if("recover"===t){N.debug("[".concat(o.name,"] request new urls")),Re("debug",o,"request new urls"),o.resetReconnectCount("recover mode"),o.emit(ht.RECONNECT_WAITTING_FINISH,t),o.urls=yield yi(o,ht.REQUEST_NEW_URLS),o.currentURLIndex=0;const h=o.urls[o.currentURLIndex];yield l(h,t)}return!0}catch(h){var p;return N.error("[".concat(o.name,"] reconnect failed"),h.toString()),le("error",o,"reconnectWithAction",void 0,h.toString()),null!=h&&null!==(p=h.data)&&void 0!==p&&p.desc&&Array.isArray(h.data.desc)&&h.data.desc.length&&h.data.desc.includes("dynamic key expired")?(o.emit(ht.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):yield o.reconnectWithAction(t,s)}})()}chooseBestWebsocketConnection(t,i,o){var s=this;return U(function*(){return new Ie((c,l)=>{let p=!1;const h=[];s.closeEstablishingWs=()=>{N.debug("[choose-best-ws] close establishing websockets"),h.forEach(R=>{R.onclose=null,R.onopen=null,R.onmessage=null,R.close()}),l(new V(L.WS_ABORT,"choose best websocket aborted"))};const g=J("GATEWAY_DOMAINS");let f;const A=t.indexOf("?h="),_=g.find(R=>-1!==A?t.includes(R,A):t.includes(R));N.debug("[choose-best-ws] currentDomain: ",_,", domains: ",g),le("debug",s,"chooseBestWebsocketConnection",{currentDomain:_,domains:g});let v=!s.tryDoubleDomain||i||!_;if(!v&&_){var y;const R=Date.now();try{g.forEach(D=>{const O=-1===A?t.replace(_,D):t.substr(0,A)+t.substr(A).replace(_,D),P=new WebSocket(O);P.binaryType="arraybuffer",h.push(P),N.debug("[choose-best-ws] ws is connecting:",P.url),Re("debug",s,"ws is connecting: ".concat(P.url))})}catch{for(N.debug("[choose-best-ws] ws create failed, fallback to single url"),Re("debug",s,"ws create failed, fallback to single url"),h.forEach(O=>O.close());h.length;)h.pop();v=!0}null===(y=s.store)||void 0===y||y.recordJoinChannelService({urls:h.map(D=>D.url),service:"gateway"},o),h.forEach(D=>{D.onopen=()=>{if(p)return;const O=Date.now()-R;N.debug("[choose-best-ws] ws open cost ".concat(O,"ms")),h.filter(P=>P!==D).forEach(P=>{N.debug("[choose-best-ws]close backup websocket: ".concat(P.url)),Re("debug",s,"close backup websocket: ".concat(P.url)),P.close()}),p=!0,c(D)},D.onclose=O=>{f=O,!p&&(h.find(P=>!(P.readyState===WebSocket.CLOSED||P.readyState===WebSocket.CLOSING))||(N.debug("[choose-best-ws] all websocket is closed"),Re("debug",s,"all websocket is closed"),p=!0,l(f)))},D.onmessage=O=>{N.debug("[choose-best-ws]".concat(D.url," onmessage: ").concat(O.data)),Re("debug",s,"".concat(D.url," onmessage: ").concat(O.data))}}),Ar(s.forceCloseTimeout).then(()=>{h.forEach(D=>{D.readyState!==WebSocket.OPEN&&D.close()})})}if(v){var S;let R;N.debug("[choose-best-ws] use single url: ",t),Re("debug",s,"use single url: ".concat(t)),null===(S=s.store)||void 0===S||S.recordJoinChannelService({urls:[t],service:"gateway"},o);try{R=new WebSocket(t),h.push(R),R.binaryType="arraybuffer"}catch(D){const O=new V(L.WS_ERR,"init websocket failed! Error: ".concat(D.toString()));return N.error("[".concat(s.name,"]").concat(O)),le("error",s,"chooseBestWebsocketConnection",void 0,D.toString()),void l(O)}R.onopen=()=>{c(R)},R.onclose=D=>{l(D)},R.onmessage=D=>{N.debug("[choose-best-ws]".concat(R.url," onmessage: ").concat(D.data)),Re("debug",s,"".concat(R.url," onmessage: ").concat(D.data))},Ar(s.forceCloseTimeout).then(()=>{R&&R.readyState!==WebSocket.OPEN&&R.close()})}}).then(c=>(s.closeEstablishingWs=void 0,c)).catch(c=>{throw s.closeEstablishingWs=void 0,c})})()}})||I3;class b3{constructor(i){b(this,"input",[]),b(this,"size",void 0),this.size=i}add(i){this.input.push(i),this.input.length>this.size&&this.input.splice(0,1)}mean(){var i;return 0===this.input.length?0:hc(i=this.input).call(i,(o,s)=>o+s)/this.input.length}}var Kl;let da,HD=kn("AgoraRTCSignal","websocket.connectionID")(Kl=class extends En{get connectionState(){return this._connectionState}set connectionState(t){t!==this._connectionState&&(this._connectionState=t,t===$t.CONNECTED?this.emit(Me.WS_CONNECTED):t===$t.RECONNECTING?this.emit(Me.WS_RECONNECTING,this._websocketReconnectReason):t===$t.CLOSED&&this.emit(Me.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(t,i){super(),b(this,"_disconnectedReason",void 0),b(this,"_websocketReconnectReason",void 0),b(this,"_connectionState",$t.CLOSED),b(this,"reconnectToken",void 0),b(this,"websocket",void 0),b(this,"openConnectionTime",void 0),b(this,"clientId",void 0),b(this,"lastMsgTime",Date.now()),b(this,"uploadCache",[]),b(this,"uploadCacheInterval",void 0),b(this,"rttRolling",new b3(5)),b(this,"pingpongTimer",void 0),b(this,"wsInflateDataTimer",void 0),b(this,"pingpongTimeoutCount",0),b(this,"joinResponse",void 0),b(this,"multiIpOption",void 0),b(this,"initError",void 0),b(this,"spec",void 0),b(this,"store",void 0),b(this,"onWebsocketMessage",o=>{if(o.data instanceof ArrayBuffer)return void this.emit(Me.ON_BINARY_DATA,o.data);const s=JSON.parse(o.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(s,"_id")){const c="res-@".concat(s._id);this.emit(c,s._result,s._message)}else if(Object.prototype.hasOwnProperty.call(s,"_type")){if(this.emit(s._type,s._message),s._type===mt.ON_NOTIFICATION&&this.handleNotification(s._message),s._type===mt.ON_USER_BANNED)switch(s._message.error_code){case 14:this.close(Bt.UID_BANNED);break;case 15:this.close(Bt.IP_BANNED);break;case 16:this.close(Bt.CHANNEL_BANNED)}if(s._type===mt.ON_USER_LICENSE_BANNED)switch(s._message.error_code){case je.ERR_LICENSE_MISSING:this.close(Bt.LICENSE_MISSING);break;case je.ERR_LICENSE_EXPIRED:this.close(Bt.LICENSE_EXPIRED);break;case je.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Bt.LICENSE_MINUTES_EXCEEDED);break;case je.ERR_LICENSE_PERIOD_INVALID:this.close(Bt.LICENSE_PERIOD_INVALID);break;case je.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Bt.LICENSE_MULTIPLE_SDK_SERVICE);break;case je.ERR_LICENSE_ILLEGAL:this.close(Bt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=t.clientId,this.spec=t,this.store=i,this.websocket=new Th("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0,i),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===$t.CONNECTED&&this.reconnect("retry",Qi.OFFLINE)})}request(t,i,o,s){var c=this;return U(function*(){const l=xn(6,""),p={_id:l,_type:t,_message:i},h=c.websocket.connectionID,g=()=>new Ie((S,R)=>{if(c.connectionState===$t.CONNECTED)return S();const D=()=>{c.off(Me.WS_CLOSED,O),S()},O=()=>{c.off(Me.WS_CONNECTED,D),R(new V(L.WS_ABORT))};c.once(Me.WS_CONNECTED,D),c.once(Me.WS_CLOSED,O),t!==Je.PUBLISH&&t!==Je.SUBSCRIBE&&t!==Je.UNSUBSCRIBE&&t!==Je.UNPUBLISH&&t!==Je.CONTROL&&t!==Je.RESTART_ICE||c.once(Me.DISCONNECT_P2P,()=>{R(new V(L.DISCONNECT_P2P))}),t!==Je.PUBLISH&&t!==Je.RESTART_ICE||c.once(Me.ABORT_P2P_EXECUTION,()=>{R(new V(L.DISCONNECT_P2P))})});if(c.connectionState!==$t.CONNECTING&&c.connectionState!==$t.RECONNECTING||t===Je.JOIN||t===Je.REJOIN||(yield g()),c.websocket.sendMessage(p,!0),s)return;const f=new Ie((S,R)=>{let D=!1;const O=(B,G)=>{D=!0,S({isSuccess:"success"===B,message:G||{}}),c.off(Me.WS_CLOSED,P),c.off(Me.WS_RECONNECTING,P),c.emit(Me.REQUEST_SUCCESS,t,i)};c.once("res-@".concat(l),O);const P=()=>{R(new V(L.WS_ABORT,"type: ".concat(t))),c.off(Me.WS_CLOSED,P),c.off(Me.WS_RECONNECTING,P),c.off("res-@".concat(l),O)};c.once(Me.WS_CLOSED,P),c.once(Me.WS_RECONNECTING,P),Ar(J("SIGNAL_REQUEST_TIMEOUT")).then(()=>{c.websocket.connectionID!==h||D||(N.warning("ws request timeout, type: ".concat(t)),Re("warning",c,"ws request timeout, type: ".concat(t)),c.emit(Me.REQUEST_TIMEOUT,t,i))})});let A=null;try{A=yield f}catch(S){if(c.connectionState===$t.CLOSED||t===Je.LEAVE)throw new V(L.WS_ABORT);return!c.spec.forceWaitGatewayResponse||o?S.throw():t===Je.JOIN||t===Je.REJOIN?null:(yield g(),yield c.request(t,i))}if(A.isSuccess)return A.message;const _=Number(A.message.error_code||A.message.code),v=Xm(_),y=new V(L.UNEXPECTED_RESPONSE,"".concat(v.desc,": ").concat(A.message.error_str),{code:_,data:A.message});return"success"===v.action?A.message:(N.warning("[".concat(c.websocket.connectionID,"] unexpected response from type ").concat(t,", error_code: ").concat(_,", message: ").concat(v.desc,", action: ").concat(v.action)),Re("warning",c,"unexpected response from type ".concat(t,", error_code: ").concat(_,", message: ").concat(v.desc,", action: ").concat(v.action)),_===je.ERR_TOO_MANY_BROADCASTERS?((t===Je.JOIN||t===Je.REJOIN)&&(c.initError=y,c.close()),y.throw()):"failed"===v.action?y.throw():"quit"===v.action?(c.initError=y,c.close(),y.throw()):(_===je.ERR_JOIN_BY_MULTI_IP?(c.multiIpOption=A.message.option,N.warning("[".concat(c.clientId,"] detect multi ip, recover")),Re("warning",c,"detect multi ip, recover"),c.reconnect("recover",Qi.MULTI_IP)):c.reconnect(v.action,Qi.SERVER_ERROR),t===Je.JOIN||t===Je.REJOIN?null:yield c.request(t,i)))})()}waitMessage(t,i){return new Ie(o=>{const s=c=>{(!i||i(c))&&(this.off(t,s),o(c))};this.on(t,s)})}upload(t,i){const o={_type:t,_message:i};try{this.websocket.sendMessage(o)}catch{const c=J("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(o),this.uploadCache.length>c&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==$t.CONNECTED)return;const l=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(l._type,l._message)},J("UPLOAD_CACHE_INTERVAL")||2e3))}}send(t,i){this.websocket.sendMessage({_type:t,_message:i})}init(t,i){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new Ie((o,s)=>{this.once(Me.WS_CONNECTED,()=>o(this.joinResponse)),this.once(Me.WS_CLOSED,()=>s(this.initError||new V(L.WS_ABORT))),this.connectionState=$t.CONNECTING,this.websocket.init(t).catch(s),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4),setTimeout(()=>{i&&void 0===this.openConnectionTime&&(N.debug("[".concat(this.clientId,"] init websocket timeout while join with fallback to proxy")),s(new V(L.INIT_WEBSOCKET_TIMEOUT)))},J("JOIN_WITH_FALLBACK_PROXY_PENDING_DURATION"))})}close(t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=t||Bt.LEAVE,this.connectionState=$t.CLOSED,N.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),t===Bt.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new Th("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0,this.store),this.handleWebsocketEvents())}join(){var t=this;return U(function*(){if(!t.joinResponse){t.emit(Me.ABORT_P2P_EXECUTION);const i=yield yi(t,Me.REQUEST_JOIN_INFO),o=yield t.request(Je.JOIN,i);if(!o)return t.emit(Me.REPORT_JOIN_GATEWAY,L.TIMEOUT,t.url||""),!1;t.joinResponse=o,t.emit(Me.JOIN_RESPONSE,t.joinResponse),t.reconnectToken=t.joinResponse.rejoin_token}return t.connectionState=$t.CONNECTED,t.pingpongTimer&&window.clearInterval(t.pingpongTimer),t.pingpongTimer=window.setInterval(t.handlePingPong.bind(t),3e3),!0})()}rejoin(){var t=this;return U(function*(){if(!t.reconnectToken)throw new V(L.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const i=yh(t,Me.REQUEST_REJOIN_INFO);i.token=t.reconnectToken;const o=yield t.request(Je.REJOIN,i);return!!o&&(t.connectionState=$t.CONNECTED,t.pingpongTimer&&window.clearInterval(t.pingpongTimer),t.pingpongTimer=window.setInterval(t.handlePingPong.bind(t),3e3),o.peers&&o.peers.forEach(s=>{t.emit(mt.ON_USER_ONLINE,{uid:s.uid}),s.audio&&t.emit(mt.ON_ADD_AUDIO_STREAM,{uid:s.uid,uint_id:s.uint_id,audio:!0,ssrcId:s.audio_ssrc}),s.video&&t.emit(mt.ON_ADD_VIDEO_STREAM,{uid:s.uid,uint_id:s.uint_id,video:!0,ssrcId:s.video_ssrc}),t.emit(s.audio_mute?mt.MUTE_AUDIO:mt.UNMUTE_AUDIO,{uid:s.uid}),t.emit(s.video_mute?mt.MUTE_VIDEO:mt.UNMUTE_VIDEO,{uid:s.uid}),t.emit(s.audio_enable_local?mt.ENABLE_LOCAL_AUDIO:mt.DISABLE_LOCAL_AUDIO,{uid:s.uid}),t.emit(s.video_enable_local?mt.ENABLE_LOCAL_VIDEO:mt.DISABLE_LOCAL_VIDEO,{uid:s.uid}),s.audio||s.video||t.emit(mt.ON_REMOVE_STREAM,{uid:s.uid,uint_id:s.uint_id})}),!0)})()}reconnect(t,i){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(t,i)}handleNotification(t){N.debug("[".concat(this.clientId,"] receive notification: "),t),le("debug",this,"handleNotification",t);const i=Xm(t.code);if("success"!==i.action)return"failed"===i.action?(N.error("[".concat(this.clientId,"] ignore error: "),i.desc),void Re("error",this,"ignore error: ".concat(i.desc))):"quit"===i.action?("ERR_REPEAT_JOIN_CHANNEL"===i.desc&&this.close(Bt.UID_BANNED),void this.close()):void this.reconnect(i.action,Qi.SERVER_ERROR)}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const t=J("PING_PONG_TIME_OUT"),i=Date.now();this.pingpongTimeoutCount>=t&&(N.warning("PINGPONG Timeout. Last Socket Message: ".concat(i-this.lastMsgTime,"ms")),Re("warning",this,"PINGPONG Timeout. Last Socket Message: ".concat(i-this.lastMsgTime,"ms")),i-this.lastMsgTime>J("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Qi.TIMEOUT):this.request(Je.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const o=Date.now()-i;this.rttRolling.add(o),J("REPORT_STATS")&&this.send(Je.PING_BACK,{pingpongElapse:o})}).catch(o=>{})}handleWsInflateData(){const{wsInflateLength:t,wsDeflateLength:i}=this.websocket.getWsInflateData();0!==t&&0!==i&&this.upload(Oi.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:i,ws_inflate_length:t})}handleWebsocketEvents(){this.websocket.on(ht.RECONNECT_WAITTING_FINISH,t=>{this.emit(Me.WS_RECONNECT_WAITTING_FINISH,t)}),this.websocket.on(ht.RECONNECT_CREATE_CONNECTION,t=>{this.emit(Me.WS_RECONNECT_CREATE_CONNECTION,t)}),this.websocket.on(ht.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(ht.CLOSED,()=>{this.connectionState=$t.CLOSED}),this.websocket.on(ht.FAILED,()=>{this._disconnectedReason=Bt.NETWORK_ERROR,this.connectionState=$t.CLOSED}),this.websocket.on(ht.RECONNECTING,t=>{this._websocketReconnectReason=t,this.joinResponse=void 0,this.connectionState=this.connectionState===$t.CONNECTED?$t.RECONNECTING:$t.CONNECTING}),this.websocket.on(ht.WILL_RECONNECT,(t,i)=>{if(yh(this,Me.IS_P2P_DISCONNECTED)&&"retry"===t)return N.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),Re("debug",this,"".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(Me.NEED_RENEW_SESSION),this.emit(Me.DISCONNECT_P2P),i("tryNext");"retry"!==t&&(N.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(t)),Re("debug",this,"".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(t)),this.reconnectToken=void 0,this.emit(Me.NEED_RENEW_SESSION),this.emit(Me.DISCONNECT_P2P)),i(t)}),this.websocket.on(ht.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(t=>{N.warning("[".concat(this.clientId,"] rejoin failed ").concat(t)),le("warning",this,"rejoin",void 0,t.toString()),this.reconnect("tryNext",Qi.SERVER_ERROR)}):this.join().catch(t=>{if(this.emit(Me.REPORT_JOIN_GATEWAY,t.message||t.code,this.url||""),t instanceof V&&t.code===L.UNEXPECTED_RESPONSE&&t.data.code===je.ERR_NO_AUTHORIZED)return N.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),Re("warning",this,"reconnect no authorized, recover"),void this.reconnect("recover",Qi.SERVER_ERROR);N.error("[".concat(this.clientId,"] join gateway request failed"),t.toString()),le("error",this,"join",void 0,t.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Qi.SERVER_ERROR):(this.initError=t,this.close())})}),this.websocket.on(ht.REQUEST_NEW_URLS,(t,i)=>{yi(this,Me.REQUEST_RECOVER,this.multiIpOption).then(t).catch(i)}),this.websocket.on(ht.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(mt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}})||Kl;function y9(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}class yY extends En{get url(){return this._url?this._url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(i){["tryNext","recover"].includes(i)&&this.resetReconnectCount(i),this._reconnectMode=i}get state(){return this._state}set state(i){i!==this._state&&(this._state=i,"reconnecting"===this._state?this.emit(cn.RECONNECTING,this.reconnectReason):"connected"===this._state?this.emit(cn.CONNECTED):"closed"===this._state?this.emit(cn.CLOSED):"failed"===this._state&&this.emit(cn.FAILED))}constructor(i,o,s,c){super(),b(this,"connectionID",0),b(this,"currentURLIndex",0),b(this,"reconnectReason",void 0),b(this,"_reconnectMode","tryNext"),b(this,"_initMutex",void 0),b(this,"_name",void 0),b(this,"_state","closed"),b(this,"_reconnectInterrupter",void 0),b(this,"_url",void 0),b(this,"_retryConfig",void 0),b(this,"_reconnectCount",0),b(this,"_forceCloseTimeout",5e3),b(this,"_onlineReconnectListener",void 0),b(this,"_messageSender",void 0),b(this,"_closeEstablishingTransmitter",()=>{}),b(this,"_store",void 0),b(this,"_joinChannelServiceRecordIndex",void 0),b(this,"_transmitter",void 0),b(this,"_compressor",new y3),b(this,"_compressorInitStatus","initializing"),b(this,"_compress",void 0),b(this,"_useCompress",void 0),b(this,"_inflateLength",0),b(this,"_deflateLength",0),this._store=c,this._name=i,this._retryConfig=function(l){for(var p=1;p<arguments.length;p++){var h=null!=arguments[p]?arguments[p]:{};p%2?y9(Object(h),!0).forEach(function(g){b(l,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(h)):y9(Object(h)).forEach(function(g){Object.defineProperty(l,g,Object.getOwnPropertyDescriptor(h,g))})}return l}({},o),this._useCompress=s}resetReconnectCount(i){N.debug("".concat(this._name," reset reconnect count, reason: ").concat(i)),le("debug",this,"resetReconnectCount",i,"".concat(this._name," reset reconnect count, reason: ").concat(i)),this._reconnectCount=0}close(i,o){var s;if(this.currentURLIndex=0,this.resetReconnectCount("close"),null===(s=this._messageSender)||void 0===s||s.reset(),this._reconnectInterrupter&&this._reconnectInterrupter(),this._transmitter){this._transmitter.onclose=null,this._transmitter.onopen=null,this._transmitter.onmessage=null;const c=this._transmitter;o?setTimeout(()=>c.close(),500):c.close(),this._transmitter=void 0}this.state=i?"failed":"closed",this._closeEstablishingTransmitter&&this._closeEstablishingTransmitter()}reconnect(i,o){if(!this._transmitter)return N.warning("[".concat(this._name,"] can not reconnect, no websocket")),void le("warning",this,"reconnect","can not reconnect, no websocket");var s;void 0!==i&&(this.reconnectMode=i),N.debug("[".concat(this._name,"] reconnect is triggered initiative")),le("debug",this,"reconnect"),"number"==typeof this._joinChannelServiceRecordIndex&&(null===(s=this._store)||void 0===s||s.recordJoinChannelService({status:"error",errors:[new Error(o)]},this._joinChannelServiceRecordIndex));const c=this._transmitter.onclose;this._transmitter.onclose=null,this._transmitter.close(),c&&c.bind(this._transmitter)({code:9999,reason:o})}getInflateData(){const i=this._inflateLength,o=this._deflateLength;return this.clearInflateData(),{inflateLength:i,deflateLength:o}}setInflateData(i){this._deflateLength=this._deflateLength+i.originLength,this._inflateLength=this._inflateLength+i.compressedLength}clearInflateData(){this._inflateLength=0,this._deflateLength=0}}function WD(t,i,o){if("getBigUint64"in DataView.prototype)return t.getBigUint64(i,o);const s=t.getUint32(i,o),c=t.getUint32(i+4,o),l=Number(!!o),p=Number(!o);return BigInt(s*p+c*l)<<BigInt(32)|BigInt(s*l+c*p)}function Za(t,i,o,s){if("setBigUint64"in DataView.prototype)return t.setBigUint64(i,o,s);const c=Number(o>>BigInt(32)),l=Number(o&BigInt(4294967295));s?(t.setUint32(i+4,c,s),t.setUint32(i,l,s)):(t.setUint32(i,c,s),t.setUint32(i+4,l,s))}!function(t){t[t.Default=0]="Default",t[t.Ack=1]="Ack"}(da||(da={}));class IY{constructor(i,o,s){b(this,"version",1),b(this,"initialRTO",void 0),b(this,"maxBatchAckCount",void 0),b(this,"maxRTO",void 0),b(this,"initialRTT",void 0),b(this,"ID",void 0),b(this,"rtt",void 0),b(this,"packetNumber",1),b(this,"rtoRatioMap",new Map),b(this,"timeoutMap",new Map),b(this,"unorderedPacketQueue",[]),b(this,"batchAckPacketQueue",[]),b(this,"lastOrderedPacketNumber",0),b(this,"batchAckTimer",void 0),b(this,"sendImpl",void 0),b(this,"receiveImpl",void 0),this.sendImpl=i,this.receiveImpl=o,this.ID=xn(7,"transmitter-"),this.initialRTO=void 0!==s?.initialRTO?s.initialRTO:J("TRANSMITTER_INITIAL_RTO"),this.initialRTT=void 0!==s?.initialRTT?s.initialRTT:J("TRANSMITTER_INITIAL_RTT"),this.rtt=void 0!==s?.initialRTT?s.initialRTT:J("TRANSMITTER_INITIAL_RTT"),this.maxBatchAckCount=void 0!==s?.maxBatchAckCount?s.maxBatchAckCount:J("TRANSMITTER_MAX_BATCH_ACK_COUNT"),this.maxRTO=void 0!==s?.maxRTO?s.maxRTO:J("TRANSMITTER_MAX_RTO")}packetize(i,o){return{type:da.Default,version:this.version,packetNumber:o,payload:i}}serialize(i){switch(i.type){case da.Default:{let o;o="string"==typeof i.payload?(new TextEncoder).encode(i.payload):i.payload;const s=new ArrayBuffer(o.length+15),c=new DataView(s);return c.setUint16(0,i.version),c.setUint8(2,i.type),c.setUint32(3,i.packetNumber),Za(c,7,BigInt(i.sendTs)),new Uint8Array(c.buffer).set(o,15),s}case da.Ack:{const o=new ArrayBuffer(16),s=new DataView(o);return s.setUint16(0,i.version),s.setUint8(2,i.type),s.setUint32(3,i.maxAckPacketNumber),s.setUint8(7,i.shift),Za(s,8,BigInt(i.ackSendTs)),o}}}deserialize(i){const o=new DataView(i),s=o.getUint16(0),c=o.getUint8(2);switch(c){case da.Default:{const l=o.getUint32(3),p=WD(o,7),h=i.slice(15),g=(new TextDecoder).decode(h);return{version:s,type:c,packetNumber:l,sendTs:Number(p),payload:g}}case da.Ack:{const l=o.getUint32(3),p=o.getUint8(7),h=WD(o,8);return{version:s,type:c,maxAckPacketNumber:l,shift:p,ackSendTs:Number(h)}}default:throw N.error("[".concat(this.ID,"] Unrecognized packet type ").concat(c)),new Error("Unrecognized packet type ".concat(c))}}sendMessage(i){const o=this.packetize(i,this.packetNumber);this.packetNumber=4294967295===this.packetNumber?1:this.packetNumber+1;const s=this.calculateRTO(o),c=window.setTimeout(()=>{this.resendMessage(o)},s);this.timeoutMap.set(o.packetNumber,c),this.sendPacket(o)}onData(i){const o=this.deserialize(i);o.type===da.Default?this.ack(o):o.type===da.Ack&&(this.updateRTT(o,Math.round(performance.now())),this.clearRTO(o))}close(){this.rtt=this.initialRTT,this.packetNumber=1,Array.from(this.timeoutMap.entries()).forEach(i=>{let[o,s]=i;window.clearTimeout(s)}),this.timeoutMap=new Map,this.rtoRatioMap=new Map,this.unorderedPacketQueue=[],this.batchAckPacketQueue=[],this.lastOrderedPacketNumber=0,void 0!==this.batchAckTimer&&window.clearTimeout(this.batchAckTimer)}resendMessage(i){const o=this.calculateRTO(i),s=window.setTimeout(()=>{this.resendMessage(i)},o);this.timeoutMap.set(i.packetNumber,s),this.sendPacket(i)}calculateRTO(i){const o=this.rtoRatioMap.get(i.packetNumber);if(void 0===o)return this.rtoRatioMap.set(i.packetNumber,1),this.initialRTO;{const s=9*this.rtt/8*o;return this.rtoRatioMap.set(i.packetNumber,o+1),s>this.maxRTO?this.maxRTO:s}}updateRTT(i,o){this.rtt=this.rtt*(7/8)+(o-i.ackSendTs-this.rtt)/8}ack(i){if(i.packetNumber===this.lastOrderedPacketNumber+1)for(this.batchAckPacketQueue.length>=this.maxBatchAckCount&&this.batchAck(),this.batchAckTimer?this.batchAckPacketQueue.push(i):(this.batchAckPacketQueue.push(i),this.batchAckTimer=window.setTimeout(()=>{this.batchAck()},this.rtt/8)),this.lastOrderedPacketNumber+=1,this.receiveImpl(i.payload);;){const o=this.unorderedPacketQueue[0];if(!o){this.unorderedPacketQueue.shift();break}this.batchAckTimer&&this.batchAck(),this.receiveImpl(o.payload),this.unorderedPacketQueue.shift(),this.lastOrderedPacketNumber+=1}else i.packetNumber<=this.lastOrderedPacketNumber?this.sendPacket({ackSendTs:i.sendTs,maxAckPacketNumber:i.packetNumber,shift:0,type:da.Ack,version:this.version}):i.packetNumber>this.lastOrderedPacketNumber&&(this.unorderedPacketQueue[i.packetNumber-this.lastOrderedPacketNumber-2]=i,this.sendPacket({ackSendTs:i.sendTs,maxAckPacketNumber:i.packetNumber,shift:0,type:da.Ack,version:this.version}))}batchAck(){window.clearTimeout(this.batchAckTimer),this.batchAckTimer=void 0,this.sendPacket({ackSendTs:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].sendTs,maxAckPacketNumber:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].packetNumber,shift:this.batchAckPacketQueue.length-1,type:da.Ack,version:this.version}),this.batchAckPacketQueue=[]}sendPacket(i){i.type===da.Default&&(i.sendTs=Math.round(performance.now()));const o=this.serialize(i);this.sendImpl(o)}clearRTO(i){for(let o=i.maxAckPacketNumber-i.shift;o<=i.maxAckPacketNumber;o++){const s=this.timeoutMap.get(o);void 0!==s&&window.clearTimeout(s),this.timeoutMap.delete(o),this.rtoRatioMap.delete(o)}}}class SY extends En{get queue(){return[...this.highPriorityQueue,...this.lowPriorityQueue]}constructor(i){super(),b(this,"lowPriorityQueue",[]),b(this,"highPriorityQueue",[]),b(this,"AgoraTransmissionManager",void 0),this.AgoraTransmissionManager=i}reset(){this.lowPriorityQueue=[],this.highPriorityQueue=[]}pushMessage(i){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.highPriorityQueue.push(i):this.lowPriorityQueue.push(i),this.sendMessage()}sendMessage(){const i=this.queue.length;let o=0;o=i<5?15*i:60+3*(i-4),setTimeout(()=>{this._sendMessage()},o)}_sendMessage(){if(!this.queue.length)return;const i=this.AgoraTransmissionManager.getConnection();if(!i)return;const o=this.queue.shift();return this.lowPriorityQueue.includes(o)?this.lowPriorityQueue.shift():this.highPriorityQueue.shift(),i.sendMessage(o.compressed),o}}var T3;let I9=kn("AgoraDatachannelManager","connectionID")(T3=class extends yY{constructor(t,i){super(t,i,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3?arguments[3]:void 0),b(this,"_initMutex",void 0),b(this,"_reconnectInterrupter",void 0),b(this,"_url",void 0),b(this,"_transmitter",void 0),b(this,"_addresses",void 0),b(this,"_reliableTransmission",void 0),this._initMutex=new eo("datachannel");const{timeout:o,timeoutFactor:s}=i,c=Math.max(300,Math.floor(3*o/5)),l=Math.max(1.2,Math.floor(8*s)/10);Ci.ONLINE&&(this._retryConfig.timeout=c,this._retryConfig.timeoutFactor=l),$n.on(Rc.NETWORK_STATE_CHANGE,(h,g)=>{h!==g&&(this.resetReconnectCount("network state change: ".concat(g," -> ").concat(h)),h===Ci.ONLINE?(this._retryConfig.timeout=c,this._retryConfig.timeoutFactor=l):(this._retryConfig.timeout=o,this._retryConfig.timeoutFactor=s))});const p=Date.now();this._compressor.init().then(()=>{this._compressorInitStatus="initialized";const h=Date.now()-p;N.debug("datachannel compressor initialized successfully in ".concat(h,"ms")),le("debug",this._compressor,"init",void 0,"datachannel compressor initialized successfully in ".concat(h,"ms")),pe.wsCompressorInit({status:!0,ec:null,eventElapse:h}),this._compress=this._compressor.compress.bind(this._compressor)}).catch(h=>{this._compressorInitStatus="failed";const g=h?h.message||h.toString():"Empty Error";N.debug("datachannel compressor failed to initialize because of ".concat(g)),le("debug",this._compressor,"init",void 0,"datachannel compressor failed to initialize because of ".concat(g)),pe.wsCompressorInit({status:!1,ec:g,eventElapse:1})})}getConnection(){if(this._reliableTransmission)return this._reliableTransmission}init(t){var i=arguments,o=this;return U(function*(){o._forceCloseTimeout=i.length>1&&void 0!==i[1]?i[1]:5e3;return o._initMutex.lock().then(l=>new Ie((p,h)=>{((l,p)=>{o._addresses=t,o.currentURLIndex=o._addresses.findIndex(g=>g.fingerprint||J("FINGERPRINT"));const h=o._addresses[o.currentURLIndex];o.state="connecting",o._messageSender=new SY(o),o.createTransmitterConnection(h).then(l).catch(p),o.once(cn.CLOSED,()=>p(new V(L.WS_DISCONNECT))),o.once(cn.CONNECTED,()=>l())})(p,h)}).then(()=>{l()}).catch(()=>{l()}))})()}sendMessage(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this._transmitter||!this._reliableTransmission)throw new V(L.WS_ABORT,"datachannel is not ready");try{let s=null;if(o)s=this.sendMessageWithUint8Array(t);else if("initialized"===this._compressorInitStatus&&this._useCompress&&J("DATACHANNEL_COMPRESS"))try{s=this._compress(t),this.setInflateData(s)}catch{s=this.sendMessageWithJSON(t)}else s=this.sendMessageWithJSON(t);i?this._reliableTransmission.sendMessage(s.compressed):this._messageSender.pushMessage(s)}catch(s){throw new V(L.WS_ERR,"send datachannel signal message error"+s.toString())}}unbindDcCloseEventListener(){this._transmitter&&(this._transmitter.onclose=null)}sendMessageWithJSON(t){const i=JSON.stringify(t);return{compressed:i,compressedLength:i.length,origin:t}}sendMessageWithUint8Array(t){return{compressed:t,compressedLength:t.byteLength,origin:t}}createTransmitterConnection(t){var i=this;return this.connectionID+=1,this._joinChannelServiceRecordIndex=void 0,this._url="dc://".concat(t.ip,":").concat(t.port),new Ie((o,s)=>{var c;const l=()=>{N.debug("[".concat(this._name,"] datachannel opened:"),this._url),Po("debug",["DataChannel",this.connectionID],"open",this._url),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),o()},p=function(){var A=U(function*(_){var v;if(null===(v=i._closeEstablishingTransmitter)||void 0===v||v.call(i),N.debug("[".concat(i._name,"] datachannel close ").concat(i._url,", code: ").concat(_.code,", reason: ").concat(_.reason,", current mode: ").concat(i.reconnectMode)),Po("debug",["DataChannel",i.connectionID],"close",{code:_.code,reason:_.reason,address:t,reconnectMode:i.reconnectMode}),i._reconnectCount<i._retryConfig.maxRetryCount){"connected"===i.state&&(i.reconnectReason=_.reason,i.state="reconnecting");const y=Uc(i,cn.WILL_RECONNECT,i.reconnectMode)||i.reconnectMode,S=yield i.reconnectWithAction(y);if("closed"===i.state)return N.debug("[".concat(i.connectionID,"] dc is closed, no need to reconnect")),void Re("debug",i,"dc is closed, no need to reconnect");if(!S)return s(new V(L.WS_DISCONNECT,"datachannel reconnect failed: ".concat(_.code))),void i.close(!0);o()}else s(new V(L.WS_DISCONNECT,"datachannel close: ".concat(_.code))),i.close()});return function(v){return A.apply(this,arguments)}}(),h=A=>{var _;null===(_=this._reliableTransmission)||void 0===_||_.onData(A.data)};this._transmitter&&(this._transmitter.onclose=null,this._transmitter.close()),this._reliableTransmission&&(this._reliableTransmission.close(),this._reliableTransmission=void 0),N.debug("[".concat(this._name,"] start connect, address: ").concat(JSON.stringify(t))),Re("debug",this,"start connect, address: ".concat(JSON.stringify(t)));const g=null===(c=this._store)||void 0===c?void 0:c.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"}),f=Date.now();yi(this,cn.TO_CONNECT_DATACHANNEL,t).then(A=>{var _,v;if(!A)throw new Error("transmissonInfo not exist yet");const{transmitter:y,close:S}=A;this._transmitter=y,null===(_=this._store)||void 0===_||_.signalChannelOpen();const R=Date.now()-f;N.debug("[choose dc] dc open cost ".concat(R,"ms")),this._reliableTransmission=new IY(D=>{var O;this._transmitter&&"open"===this._transmitter.readyState&&(null===(O=this._transmitter)||void 0===O||O.send(D))},D=>{"string"==typeof D&&this.emit(cn.ON_MESSAGE,D)}),this._closeEstablishingTransmitter=()=>{var D;null===(D=this._reliableTransmission)||void 0===D||D.close(),this._reliableTransmission=void 0,S()},l&&l(),y.onclose=p,y.onmessage=h,null===(v=this._store)||void 0===v||v.recordJoinChannelService({endTs:Date.now(),status:"success"},g),this._joinChannelServiceRecordIndex=g}).catch(A=>{var _;if(null===(_=this._store)||void 0===_||_.recordJoinChannelService({endTs:Date.now(),status:A instanceof V&&A.code===L.WS_ABORT?"aborted":"error",errors:[A]},g),"closed"!==this.state){if(A instanceof V&&A.code===L.WS_ERR){const v=new V(L.WS_ERR,"init datachannel failed! Error: ".concat(A.toString()));return N.error("[".concat(this._name,"]").concat(v)),le("error",this,"chooseBestDataChannelConnection",void 0,A.toString()),void s(v)}p&&p(A)}else s(new V(L.WS_DISCONNECT,"datachannel is closed: ".concat(A.toString())))})})}reconnectWithAction(t){var i=arguments,o=this;return U(function*(){let s=!(i.length>1&&void 0!==i[1])||i[1];if(o._reconnectCount>=o._retryConfig.maxRetryCount||!o._addresses||"closed"===o.state)return!1;o._onlineReconnectListener||$n.networkState!==Ci.OFFLINE||(o._onlineReconnectListener=$n.onlineWaiter&&$n.onlineWaiter.then(()=>{o._onlineReconnectListener=void 0}));let c=!0;if(o._reconnectInterrupter=()=>{c=!1},s){const h=_T(o._reconnectCount,o._retryConfig);N.debug("[".concat(o._name,"] wait ").concat(h,"ms to reconnect datachannel, mode: ").concat(t)),le("debug",o,"reconnectWithAction",{timeout:h,action:t}),yield Ie.race([Ar(h),o._onlineReconnectListener||new Ie(()=>{})])}if("closed"===o.state||!c)return!1;o._reconnectCount+=1;const l=function(){var h=U(function*(g,f){o.emit(cn.RECONNECT_CREATE_CONNECTION,f),yield o.createTransmitterConnection(g)});return function(f,A){return h.apply(this,arguments)}}();try{if("retry"===t){const h=o._addresses[o.currentURLIndex];o.emit(cn.RECONNECT_WAITTING_FINISH,t),yield l(h,t)}else if("tryNext"===t){o.currentURLIndex+=1;for(let g=o.currentURLIndex;g<o._addresses.length;g++){if(o._addresses[g].fingerprint||J("FINGERPRINT")){o.currentURLIndex=g;break}o.currentURLIndex+=1}if(o.currentURLIndex>=o._addresses.length)return N.debug("[".concat(o._name,"] the available addresses are exhausted, change to recover")),yield o.reconnectWithAction("recover",!1);N.debug("[".concat(o._name,"] datachannel url length: ").concat(o._addresses.length," current index: ").concat(o.currentURLIndex)),Re("debug",o,"datachannel url length: ".concat(o._addresses.length," current index: ").concat(o.currentURLIndex));const h=o._addresses[o.currentURLIndex];o.emit(cn.RECONNECT_WAITTING_FINISH,t),yield l(h,t)}else"recover"===t&&(N.debug("[".concat(o._name,"] start to failback to websocket")),Re("debug",o,"start to failback to websocket"),o.resetReconnectCount("recover mode"),o.emit(cn.RECONNECT_WAITTING_FINISH,t),o.emit(cn.FAILBACK));return!0}catch(h){var p;return N.error("[".concat(o._name,"] reconnect failed"),h.toString()),le("error",o,"reconnectWithAction",void 0,h.toString()),null!=h&&null!==(p=h.data)&&void 0!==p&&p.desc&&Array.isArray(h.data.desc)&&h.data.desc.length&&h.data.desc.includes("dynamic key expired")?(o.emit(cn.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):yield o.reconnectWithAction(t,s)}})()}})||T3;var S9;let Yl=kn("AgoraDataChannelSignal","websocket.connectionID")(S9=class extends En{get connectionState(){return this._connectionState}set connectionState(t){t!==this._connectionState&&(this._connectionState=t,t===$t.CONNECTED?this.emit(Me.WS_CONNECTED):t===$t.RECONNECTING?this.emit(Me.WS_RECONNECTING,this._websocketReconnectReason):t===$t.CLOSED&&this.emit(Me.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(t,i){super(),b(this,"_disconnectedReason",void 0),b(this,"_websocketReconnectReason",void 0),b(this,"_connectionState",$t.CLOSED),b(this,"reconnectToken",void 0),b(this,"websocket",void 0),b(this,"openConnectionTime",void 0),b(this,"clientId",void 0),b(this,"lastMsgTime",Date.now()),b(this,"uploadCache",[]),b(this,"uploadCacheInterval",void 0),b(this,"rttRolling",new b3(5)),b(this,"pingpongTimer",void 0),b(this,"inflateDataTimer",void 0),b(this,"pingpongTimeoutCount",0),b(this,"joinResponse",void 0),b(this,"multiIpOption",void 0),b(this,"initError",void 0),b(this,"spec",void 0),b(this,"store",void 0),b(this,"onWebsocketMessage",o=>{if(o instanceof ArrayBuffer)return void this.emit(Me.ON_BINARY_DATA,o);const s=JSON.parse(o);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(s,"_id")){const c="res-@".concat(s._id);this.emit(c,s._result,s._message)}else if(Object.prototype.hasOwnProperty.call(s,"_type")&&(this.emit(s._type,s._message),s._type===mt.ON_NOTIFICATION&&this.handleNotification(s._message),s._type===mt.ON_USER_BANNED))switch(s._message.error_code){case 14:this.close(Bt.UID_BANNED);break;case 15:this.close(Bt.IP_BANNED);break;case 16:this.close(Bt.CHANNEL_BANNED)}}),this.clientId=t.clientId,this.spec=t,this.store=i,this.websocket=new I9("gateway-".concat(this.clientId),this.spec.retryConfig,!0,i),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===$t.CONNECTED&&this.reconnect("retry",Dc.OFFLINE)})}request(t,i,o,s){var c=this;return U(function*(){const l=xn(6,""),p={_id:l,_type:t,_message:i},h=c.websocket.connectionID,g=()=>new Ie((S,R)=>{if(c.connectionState===$t.CONNECTED)return S();const D=()=>{c.off(Me.WS_CLOSED,O),S()},O=()=>{c.off(Me.WS_CONNECTED,D),R(new V(L.WS_ABORT))};c.once(Me.WS_CONNECTED,D),c.once(Me.WS_CLOSED,O),t!==Je.PUBLISH&&t!==Je.SUBSCRIBE&&t!==Je.UNSUBSCRIBE&&t!==Je.UNPUBLISH&&t!==Je.CONTROL&&t!==Je.RESTART_ICE||c.once(Me.DISCONNECT_P2P,()=>{R(new V(L.DISCONNECT_P2P))}),t!==Je.PUBLISH&&t!==Je.RESTART_ICE||c.once(Me.ABORT_P2P_EXECUTION,()=>{R(new V(L.DISCONNECT_P2P))})});if(c.connectionState!==$t.CONNECTING&&c.connectionState!==$t.RECONNECTING||t===Je.JOIN||t===Je.REJOIN||(yield g()),t===Je.LEAVE&&(c.websocket.unbindDcCloseEventListener(),s=!0),c.websocket.sendMessage(p,!0,!1),s)return;const f=new Ie((S,R)=>{let D=!1;const O=(B,G)=>{D=!0,S({isSuccess:"success"===B,message:G||{}}),c.off(Me.WS_CLOSED,P),c.off(Me.WS_RECONNECTING,P),c.emit(Me.REQUEST_SUCCESS,t,i)};c.once("res-@".concat(l),O);const P=()=>{R(new V(L.WS_ABORT,"type: ".concat(t))),c.off(Me.WS_CLOSED,P),c.off(Me.WS_RECONNECTING,P),c.off("res-@".concat(l),O)};c.once(Me.WS_CLOSED,P),c.once(Me.WS_RECONNECTING,P),Ar(J("SIGNAL_REQUEST_TIMEOUT")).then(()=>{c.websocket.connectionID!==h||D||(N.warning("dc request timeout, type: ".concat(t)),Re("warning",c,"dc request timeout, type: ".concat(t)),c.emit(Me.REQUEST_TIMEOUT,t,i))})});let A=null;try{A=yield f}catch(S){if(c.connectionState===$t.CLOSED||t===Je.LEAVE)throw new V(L.WS_ABORT);return!c.spec.forceWaitGatewayResponse||o?S.throw():t===Je.JOIN||t===Je.REJOIN?null:(yield g(),yield c.request(t,i))}if(A.isSuccess)return A.message;const _=Number(A.message.error_code||A.message.code),v=Xm(_),y=new V(L.UNEXPECTED_RESPONSE,"".concat(v.desc,": ").concat(A.message.error_str),{code:_,data:A.message});return"success"===v.action?A.message:(N.warning("[".concat(c.websocket.connectionID,"] unexpected response from type ").concat(t,", error_code: ").concat(_,", message: ").concat(v.desc,", action: ").concat(v.action)),Re("warning",c,"unexpected response from type ".concat(t,", error_code: ").concat(_,", message: ").concat(v.desc,", action: ").concat(v.action)),_===je.ERR_TOO_MANY_BROADCASTERS?((t===Je.JOIN||t===Je.REJOIN)&&(c.initError=y,c.close()),y.throw()):"failed"===v.action?y.throw():"quit"===v.action?(c.initError=y,c.close(),y.throw()):(_===je.ERR_JOIN_BY_MULTI_IP?(c.multiIpOption=A.message.option,N.warning("[".concat(c.clientId,"] detect multi ip, recover")),Re("warning",c,"detect multi ip, recover"),c.reconnect("recover",Dc.MULTI_IP)):c.reconnect(v.action,Dc.SERVER_ERROR),t===Je.JOIN||t===Je.REJOIN?null:yield c.request(t,i)))})()}waitMessage(t,i){return new Ie(o=>{const s=c=>{(!i||i(c))&&(this.off(t,s),o(c))};this.on(t,s)})}upload(t,i){const o={_type:t,_message:i};try{this.websocket.sendMessage(o)}catch{const c=J("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(o),this.uploadCache.length>c&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==$t.CONNECTED)return;const l=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(l._type,l._message)},J("UPLOAD_CACHE_INTERVAL")||2e3))}}send(t,i){this.websocket.sendMessage({_type:t,_message:i})}init(t,i){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new Ie((o,s)=>{this.once(Me.WS_CONNECTED,()=>o(this.joinResponse)),this.once(Me.WS_CLOSED,()=>s(this.initError||new V(L.WS_ABORT))),this.connectionState=$t.CONNECTING,this.websocket.init(t).catch(s),this.websocket.once(cn.FAILBACK,()=>{void 0===this.openConnectionTime&&s(new V(L.INIT_DATACHANNEL_TIMEOUT))}),this.inflateDataTimer&&window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=window.setInterval(()=>{this.handleInflateData()},2e4),setTimeout(()=>{i&&void 0===this.openConnectionTime&&(N.debug("[".concat(this.clientId,"] init datachannel timeout while join with failback to websocket")),s(new V(L.INIT_DATACHANNEL_TIMEOUT)))},J("DC_JOIN_WITH_FAILBACK"))})}close(t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.inflateDataTimer&&(this.handleInflateData(),window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=t||Bt.LEAVE,this.connectionState=$t.CLOSED,N.debug("[".concat(this.clientId,"] ")+"will close datachannel in signal"),this.websocket.close(),t===Bt.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new I9("gateway-".concat(this.clientId),this.spec.retryConfig,!0,this.store),this.handleWebsocketEvents())}join(){var t=this;return U(function*(){if(!t.joinResponse){t.emit(Me.ABORT_P2P_EXECUTION);const i=yield yi(t,Me.DATACHANNEL_CONNECTING),o=yield t.request(Je.JOIN,i);if(!o)return t.emit(Me.REPORT_JOIN_GATEWAY,L.TIMEOUT,t.url||""),!1;t.joinResponse=o,t.emit(Me.JOIN_RESPONSE,t.joinResponse),t.reconnectToken=t.joinResponse.rejoin_token}return t.connectionState=$t.CONNECTED,t.pingpongTimer&&window.clearInterval(t.pingpongTimer),t.pingpongTimer=window.setInterval(t.handlePingPong.bind(t),3e3),!0})()}rejoin(){var t=this;return U(function*(){if(!t.reconnectToken)throw new V(L.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const i=yh(t,Me.REQUEST_REJOIN_INFO);i.token=t.reconnectToken;const o=yield t.request(Je.REJOIN,i);return!!o&&(t.connectionState=$t.CONNECTED,t.pingpongTimer&&window.clearInterval(t.pingpongTimer),t.pingpongTimer=window.setInterval(t.handlePingPong.bind(t),3e3),o.peers&&o.peers.forEach(s=>{t.emit(mt.ON_USER_ONLINE,{uid:s.uid}),s.audio&&t.emit(mt.ON_ADD_AUDIO_STREAM,{uid:s.uid,uint_id:s.uint_id,audio:!0,ssrcId:s.audio_ssrc}),s.video&&t.emit(mt.ON_ADD_VIDEO_STREAM,{uid:s.uid,uint_id:s.uint_id,video:!0,ssrcId:s.video_ssrc}),t.emit(s.audio_mute?mt.MUTE_AUDIO:mt.UNMUTE_AUDIO,{uid:s.uid}),t.emit(s.video_mute?mt.MUTE_VIDEO:mt.UNMUTE_VIDEO,{uid:s.uid}),t.emit(s.audio_enable_local?mt.ENABLE_LOCAL_AUDIO:mt.DISABLE_LOCAL_AUDIO,{uid:s.uid}),t.emit(s.video_enable_local?mt.ENABLE_LOCAL_VIDEO:mt.DISABLE_LOCAL_VIDEO,{uid:s.uid}),s.audio||s.video||t.emit(mt.ON_REMOVE_STREAM,{uid:s.uid,uint_id:s.uint_id})}),!0)})()}reconnect(t,i){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(t,i)}handleNotification(t){N.debug("[".concat(this.clientId,"] receive notification: "),t),le("debug",this,"handleNotification",t);const i=Xm(t.code);if("success"!==i.action)return"failed"===i.action?(N.error("[".concat(this.clientId,"] ignore error: "),i.desc),void Re("error",this,"ignore error: ".concat(i.desc))):"quit"===i.action?("ERR_REPEAT_JOIN_CHANNEL"===i.desc&&this.close(Bt.UID_BANNED),void this.close()):void this.reconnect(i.action,Dc.SERVER_ERROR)}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const t=J("PING_PONG_TIME_OUT"),i=Date.now();this.pingpongTimeoutCount>=t&&(N.warning("PINGPONG Timeout. Last Socket Message: ".concat(i-this.lastMsgTime,"ms")),Re("warning",this,"PINGPONG Timeout. Last Socket Message: ".concat(i-this.lastMsgTime,"ms")),i-this.lastMsgTime>J("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Dc.TIMEOUT):this.request(Je.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const o=Date.now()-i;this.rttRolling.add(o),J("REPORT_STATS")&&this.send(Je.PING_BACK,{pingpongElapse:o})}).catch(o=>{})}handleInflateData(){const{inflateLength:t,deflateLength:i}=this.websocket.getInflateData();0!==t&&0!==i&&this.upload(Oi.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:i,ws_inflate_length:t})}handleWebsocketEvents(){var t=this;this.websocket.on(cn.RECONNECT_WAITTING_FINISH,i=>{this.emit(Me.WS_RECONNECT_WAITTING_FINISH,i)}),this.websocket.on(cn.RECONNECT_CREATE_CONNECTION,i=>{this.emit(Me.WS_RECONNECT_CREATE_CONNECTION,i)}),this.websocket.on(cn.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(cn.CLOSED,()=>{this.connectionState=$t.CLOSED}),this.websocket.on(cn.FAILED,()=>{this._disconnectedReason=Bt.NETWORK_ERROR,this.connectionState=$t.CLOSED}),this.websocket.on(cn.RECONNECTING,i=>{this._websocketReconnectReason=i,this.joinResponse=void 0,this.connectionState=this.connectionState===$t.CONNECTED?$t.RECONNECTING:$t.CONNECTING}),this.websocket.on(cn.WILL_RECONNECT,(i,o)=>{if(yh(this,Me.IS_P2P_DISCONNECTED)&&"retry"===i)return N.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),Re("debug",this,"".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(Me.NEED_RENEW_SESSION),this.emit(Me.DISCONNECT_P2P),o("tryNext");"retry"!==i&&(N.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(i)),Re("debug",this,"".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(i)),this.reconnectToken=void 0,this.emit(Me.NEED_RENEW_SESSION),this.emit(Me.DISCONNECT_P2P)),o(i)}),this.websocket.on(cn.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(i=>{N.warning("[".concat(this.clientId,"] rejoin failed ").concat(i)),le("warning",this,"rejoin",void 0,i.toString()),this.reconnect("tryNext",Dc.SERVER_ERROR)}):this.join().catch(i=>{if(this.emit(Me.REPORT_JOIN_GATEWAY,i.message||i.code,this.url||""),i instanceof V&&i.code===L.UNEXPECTED_RESPONSE&&i.data.code===je.ERR_NO_AUTHORIZED)return N.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),Re("warning",this,"reconnect no authorized, recover"),void this.reconnect("recover",Dc.SERVER_ERROR);N.error("[".concat(this.clientId,"] join gateway request failed"),i.toString()),le("error",this,"join",void 0,i.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Dc.SERVER_ERROR):(this.initError=i,this.close())})}),this.websocket.on(cn.REQUEST_NEW_URLS,(i,o)=>{yi(this,Me.REQUEST_RECOVER,this.multiIpOption).then(i).catch(o)}),this.websocket.on(cn.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(mt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(cn.TO_CONNECT_DATACHANNEL,function(){var i=U(function*(o,s,c){return yi(t,Me.DATACHANNEL_PRECONNECT,o).then(s).catch(c)});return function(o,s,c){return i.apply(this,arguments)}}()),this.websocket.on(cn.FAILBACK,()=>{void 0!==this.openConnectionTime&&this.emit(Me.DATACHANNEL_FAILBACK)})}})||S9;var b9;function T9(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function Ku(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?T9(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):T9(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}const R3=new Map;let bY=kn("AgoraRTCGateway","store.clientId")(b9=class extends En{get state(){return this._state}set state(t){if(t===this._state)return;const i=this._state;this._state=t,"DISCONNECTED"===t&&this._disconnectedReason?this.emit(yn.CONNECTION_STATE_CHANGE,t,i,this._disconnectedReason):this.emit(yn.CONNECTION_STATE_CHANGE,t,i)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(t){N.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(t)),le("debug",this,"joinGatewayStartTime",t,"[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(t)),this._joinGatewayStartTime=t}constructor(t,i){super(),b(this,"store",void 0),b(this,"joinInfo",void 0),b(this,"key",void 0),b(this,"signal",void 0),b(this,"role",void 0),b(this,"inChannelInfo",{joinAt:null,duration:0}),b(this,"spec",void 0),b(this,"_state","DISCONNECTED"),b(this,"_statsCollector",void 0),b(this,"_disconnectedReason",void 0),b(this,"isSignalRecover",!1),b(this,"hasChangeBGPAddress",!1),b(this,"trafficStatsInterval",void 0),b(this,"networkQualityInterval",void 0),b(this,"_joinGatewayStartTime",0),b(this,"_signalTimeout",!1),b(this,"_clientRoleOptions",void 0),b(this,"_isProactiveJoin",!1),this.store=t,this.spec=i;const o=Vr().supportDataChannel&&J("SIGNAL_CHANNEL");this.signal=o?new Yl(Ku(Ku({},i),{},{retryConfig:i.websocketRetryConfig}),t):new HD(Ku(Ku({},i),{},{retryConfig:i.websocketRetryConfig}),t),this._statsCollector=i.statsCollector,this.role=i.role||"audience",this._clientRoleOptions=i.clientRoleOptions,this.handleSignalEvents()}join(t,i,o){var s=this;return U(function*(){if(s.signal instanceof Yl){let g=!1;"disabled"!==t.cloudProxyServer?(N.debug("[".concat(s.store.clientId,"] Dc is not supported, because cloudProxyServer are not supported (").concat(t.cloudProxyServer,")")),g=!0):"".concat(t.apResponse.cid,"_").concat(t.apResponse.cert).length>255||"".concat(t.apResponse.cid,"_").concat(t.apResponse.cert).length<22?(N.debug("[".concat(s.store.clientId,"] Dc is not supported, because ticket length is incorrect, it has to be between 22 and 255")),g=!0):t.apResponse.addresses.some(f=>f.fingerprint)||J("FINGERPRINT")||(N.debug("[".concat(s.store.clientId,"] Dc is not supported, because fingerprint does not exist")),g=!0),g&&s.resetSignal()}s.store.joinGatewayStart(),"disabled"!==t.cloudProxyServer&&(s.hasChangeBGPAddress=!0);const c=Date.now();let l=R3.get(t.cname);if(l||(l=new Map,R3.set(t.cname,l)),s._isProactiveJoin=!0,l.has(t.uid)){const g=new V(L.UID_CONFLICT);throw pe.joinGateway(t.sid,{lts:c,succ:!1,ec:g.message,addr:null,uid:t.uid,cid:t.cid,firstSuccess:s._isProactiveJoin,avoidJoinStartTime:s.store.avoidJoinStart,isProxy:!!t.proxyServer,signalChannel:s.signal instanceof Yl?"1":"0"}),s._isProactiveJoin=!1,g}l.set(t.uid,!0),s.joinInfo=t,s.key=i;let p=0;s.joinGatewayStartTime=c;const h=t.proxyServer;try{let g;if(N.debug("[".concat(s.store.clientId,"] use ").concat(s.signal instanceof Yl?"datachannel":"websocket"," join uid ").concat(p)),s.signal instanceof Yl)g=yield s.signal.init(t.apResponse.addresses,o);else{const f=t.proxyServer,A=t.gatewayAddrs.map(f?_=>{const v=_.address.split(":");return"wss://".concat(f,"/ws/?h=").concat(v[0],"&p=").concat(v[1])}:_=>"wss://".concat(_.address));g=yield s.signal.init(A,o)}p=g.uid,N.debug("[".concat(s.store.clientId,"] ").concat(s.signal instanceof Yl?"datachannel":"websocket"," join uid ").concat(p," cost ").concat(Date.now()-s.joinGatewayStartTime))}catch(g){throw g&&g.code===L.INIT_WEBSOCKET_TIMEOUT?(N.warning("[".concat(s.store.clientId,"] User join failed"),g.toString()),g):g&&g.code===L.INIT_DATACHANNEL_TIMEOUT?(N.warning("[".concat(s.store.clientId,"] User join datachannel failed"),g.toString()),s.resetSignal(),g):(N.error("[".concat(s.store.clientId,"] User join failed"),g.toString()),le("error",s,"join",void 0,g.toString()),pe.joinGateway(t.sid,{lts:c,succ:!1,ec:g.message,addr:s.signal.url,uid:t.uid,cid:t.cid,firstSuccess:s._isProactiveJoin,avoidJoinStartTime:s.store.avoidJoinStart,isProxy:!!h,signalChannel:s.signal instanceof Yl?"1":"0"}),s._isProactiveJoin=!1,l.delete(t.uid),s.signal.close(),g)}return s.state="CONNECTED",s.inChannelInfo.joinAt=Date.now(),N.debug("[".concat(s.store.clientId,"] Connected to gateway server")),le("debug",s,"join",void 0,"success"),s.trafficStatsInterval=window.setInterval(()=>{s.updateTrafficStats().catch(g=>{N.warning("[".concat(s.store.clientId,"] get traffic stats error"),g.toString()),le("warning",s,"trafficStatsInterval",void 0,g.toString())})},3e3),s.networkQualityInterval=window.setInterval(()=>{navigator&&void 0!==navigator.onLine&&!navigator.onLine?s.emit(yn.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):s.emit(yn.NETWORK_QUALITY,s._signalTimeout?{downlinkNetworkQuality:5,uplinkNetworkQuality:5}:"CONNECTED"===s.state&&s._statsCollector.trafficStats?{uplinkNetworkQuality:sa(s._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:sa(s._statsCollector.trafficStats.B_dnq)}:{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),s.store.joinGatewayEnd(),p})()}leave(){var t=arguments,i=this;return U(function*(){let o=t.length>0&&void 0!==t[0]&&t[0],s=t.length>1?t[1]:void 0;if("DISCONNECTED"!==i.state){s!==Bt.FALLBACK&&(i.state="DISCONNECTING");try{o||i.signal.connectionState!==$t.CONNECTED||(yield(c=i.signal.request(Je.LEAVE,void 0,!0),3e3,Ie.race([c,u7(3e3)])))}catch(c){N.warning("[".concat(i.store.clientId,"] leave request failed, ignore"),c),Re("warning",i,"leave request failed, ignore, ".concat(c.toString()))}i.signal.close(s),s!==Bt.FALLBACK&&(i.state="DISCONNECTED"),i.reset()}var c})()}publish(t,i,o){var s=this;return U(function*(){if("CONNECTED"!==s.state&&"RECONNECTING"!==s.state)throw new V(L.INVALID_OPERATION,"can not publish when connection state is ".concat(s.state));const c={state:"offer",p2p_id:s.store.p2pId,ortc:i,mode:s.spec.mode,extend:J("PUB_EXTEND")};try{return(yield s.signal.request(Je.PUBLISH,c,!0))._message}catch(l){if(o&&l.data&&l.data.code===je.ERR_PUBLISH_REQUEST_INVALID)return N.warning("[".concat(s.store.clientId,"] receive publish error code, retry"),l.toString()),Re("warning",s,"receive publish error code, retry, ".concat(l.toString())),yield s.tryUnpubBeforeRepub(t,i),s.publish(t,i,!1);throw l}})()}unpublish(t,i){var o=this;return U(function*(){try{if("CONNECTED"!==o.state&&"RECONNECTING"!==o.state)throw new V(L.INVALID_OPERATION,"can not publish when connection state is ".concat(o.state));yield o.signal.request(Je.UNPUBLISH,{stream_id:i,ortc:t},!0)}catch(s){N.warning("unpublish warning: ",s),le("warning",o,"unpublish",void 0,s.toString())}})()}subscribe(t,i,o){var s=this;return U(function*(){if("CONNECTED"!==s.state&&"RECONNECTING"!==s.state)throw new V(L.INVALID_OPERATION,"can not subscribe when connection state is ".concat(s.state));const c={stream_id:t,stream_type:i.stream_type,mode:s.spec.mode,codec:s.spec.codec,p2p_id:s.store.p2pId,tcc:!!J("SUBSCRIBE_TCC"),extend:J("SUB_EXTEND"),ssrcId:i.ssrcId};try{return(yield s.signal.request(Je.SUBSCRIBE,c,!0))._message}catch(l){if(o&&l.data&&l.data.code===je.ERR_SUBSCRIBE_REQUEST_INVALID)return N.warning("[".concat(s.store.clientId,"] receiver subscribe error code, retry"),l.toString()),Re("warning",s,"receiver subscribe error code, retry"),yield s.tryUnsubBeforeResub(t,i),yield s.subscribe(t,i,!1);throw l}})()}subscribeAll(t,i){var o=this;return U(function*(){if("CONNECTED"!==o.state&&"RECONNECTING"!==o.state)throw new V(L.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(o.state));const s={p2p_id:o.store.p2pId,users:t,dtx:!1};try{return yield o.signal.request(Je.SUBSCRIBE_STREAMS,s,!0)}catch(c){if(i&&c.data&&c.data.code===je.ERR_SUBSCRIBE_REQUEST_INVALID)return N.warning("[".concat(o.store.clientId,"] receiver massSubscribe error code, retry"),c.toString()),Re("warning",o,"receiver massSubscribe error code, retry"),yield o.tryMassUnsubBeforeResub(t),yield o.subscribeAll(t,!1);throw c}})()}setVideoProfile(t){var i=this;return U(function*(){const o=function(s){if(!(s.bitrateMax&&s.bitrateMin&&s.frameRate&&s.height&&s.width))return;let c=s.frameRate,l=s.width,p=s.height,h=!0;return"number"!=typeof c&&(c=c.exact||c.ideal||c.max||c.min||0,c||(h=!1)),"number"!=typeof l&&(l=l.exact||l.ideal||l.max||l.min||0,l||(h=!1)),"number"!=typeof p&&(p=p.exact||p.ideal||p.max||p.min||0,c||(h=!1)),h?{stream_type:0,width:l,height:p,fps:c,start_bps:1e3*s.bitrateMax,min_bps:1e3*s.bitrateMin,target_bps:1e3*s.bitrateMax}:void 0}(t);return o?i.signal.request(Je.SET_VIDEO_PROFILE,o):(N.debug("[".concat(i.store.clientId,"] encoder config is not complete, do not report to gateway")),void Re("debug",i,"encoder config is not complete, do not report to gateway"))})()}unsubscribe(t,i){var o=this;return U(function*(){try{yield o.signal.request(Je.UNSUBSCRIBE,{p2p_id:o.store.p2pId,ortc:t,stream_id:i},!0)}catch(s){N.warning("unsubscribe warning: ",s),le("warning",o,"unsubscribe",void 0,s.toString())}})()}massUnsubscribe(t){var i=this;return U(function*(){try{yield i.signal.request(Je.UNSUBSCRIBE_STREAMS,t,!0)}catch(o){N.warning("unsubscribeAll warning: ",o),le("warning",i,"unsubscribeAll",void 0,o.toString())}})()}reconnectPC(t){var i=this;return U(function*(){const{iceParameters:o,dtlsParameters:s,rtpCapabilities:c}=t;return{gatewayEstablishParams:yield i.signal.request(Je.CONNECT_PC,{p2p_id:i.store.p2pId,stream_id:i.store.uid,ortc:{iceParameters:o,dtlsParameters:s,rtpCapabilities:c}},!0),gatewayAddress:i.getCurrentGatewayAddress()}})()}getGatewayInfo(){return this.signal.request(Je.GATEWAY_INFO)}renewToken(t){return this.signal.request(Je.RENEW_TOKEN,t)}setClientRole(t,i){var o=this;return U(function*(){if(i&&(o._clientRoleOptions=Object.assign({},i)),"CONNECTED"!==o.state)return void(o.role=t);let s;s="audience"===t?o._clientRoleOptions&&o._clientRoleOptions.level?o._clientRoleOptions.level:2:0,yield o.signal.request(Je.SET_CLIENT_ROLE,{role:t,level:s,client_ts:Date.now()}),o.role=t})()}setRemoteVideoStreamType(t,i){var o=this;return U(function*(){yield o.signal.request(Je.SWITCH_VIDEO_STREAM,{stream_id:t,stream_type:i})})()}setDefaultRemoteVideoStreamType(t){var i=this;return U(function*(){yield i.signal.request(Je.DEFAULT_VIDEO_STREAM,{stream_type:t})})()}setStreamFallbackOption(t,i){var o=this;return U(function*(){yield o.signal.request(Je.SET_FALLBACK_OPTION,{stream_id:t,fallback_type:i})})()}pickSVCLayer(t,i){var o=this;return U(function*(){yield o.signal.request(Je.PICK_SVC_LAYER,{stream_id:t,spatial_layer:i.spatialLayer,temporal_layer:i.temporalLayer})})()}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),Ku({},this.inChannelInfo)}getGatewayVersion(){var t=this;return U(function*(){return(yield t.signal.request(Je.GATEWAY_INFO)).version})()}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const t=R3.get(this.joinInfo.cname);t&&t.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const t=function(i){let o;return o=i.startsWith("dc")?i.match(/(dc\:\/\/)?([^:]+):(\d+)/):i.match(/(wss\:\/\/)?([^:]+):(\d+)/),o?{username:Ss.username,password:Ss.password,turnServerURL:o[2],tcpport:parseInt(o[3])+30,udpport:parseInt(o[3])+30,forceturn:!1}:null}(("disabled"===this.joinInfo.cloudProxyServer?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],t&&"off"!==this.joinInfo.turnServer.mode&&"disabled"===this.joinInfo.cloudProxyServer&&this.joinInfo.turnServer.serversFromGateway.push(Ku(Ku({},Ss),{},{turnServerURL:t.turnServerURL,tcpport:t.tcpport,udpport:t.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}updateTrafficStats(){var t=this;return U(function*(){if("CONNECTED"!==t.state)return;const i=yield t.signal.request(Je.TRAFFIC_STATS,void 0,!0);i.timestamp=Date.now(),i.peer_delay.forEach(o=>{const s=t._statsCollector.trafficStats&&t._statsCollector.trafficStats.peer_delay.find(c=>c.peer_uid===o.peer_uid);s&&s.B_st!==o.B_st&&Ns(()=>{t.emit(yn.STREAM_TYPE_CHANGE,o.peer_uid,o.B_st)})}),t._statsCollector.updateTrafficStats(i)})()}getJoinMessage(t){if(!this.joinInfo||!this.key)throw new V(L.UNEXPECTED_ERROR,"can not generate join message, no join info");const i=Object.assign({},this.joinInfo.apResponse);let o=J("REPORT_APP_SCENARIO");if("string"!=typeof o)try{o=JSON.stringify(o)}catch{o=void 0}o&&o.length>128&&(o=void 0);const s=Ku({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:po,browser:navigator.userAgent,process_id:J("PROCESS_ID"),mode:this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:i,extend:J("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:"proxy3"===this.joinInfo.cloudProxyServer?"1":"proxy5"===this.joinInfo.cloudProxyServer?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:o,attributes:{userAttributes:{enablePublishedUserList:J("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:J("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:"number"==typeof J("SUBSCRIBE_AUDIO_FILTER_TOPN")?J("SUBSCRIBE_AUDIO_FILTER_TOPN"):void 0,enablePublishAudioFilter:"boolean"==typeof J("ENABLE_PUBLISH_AUDIO_FILTER")?J("ENABLE_PUBLISH_AUDIO_FILTER"):void 0,enableUserLicenseCheck:"boolean"==typeof J("ENABLE_USER_LICENSE_CHECK")?J("ENABLE_USER_LICENSE_CHECK"):void 0}},join_ts:this.joinGatewayStartTime},t);return this.joinInfo.stringUid&&(s.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(s.aes_mode=this.joinInfo.aesmode,J("ENCRYPT_AES")?(s.aes_secret=this.joinInfo.aespassword,s.aes_encrypt=!0):s.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(s.aes_salt=this.joinInfo.aessalt)),i.addresses[this.signal.websocket.currentURLIndex]&&(s.ap_response.ticket=i.addresses[this.signal.websocket.currentURLIndex].ticket,delete i.addresses),void 0!==this.joinInfo.defaultVideoStream&&(s.default_video_stream=this.joinInfo.defaultVideoStream),s}getRejoinMessage(){if(!this.joinInfo)throw new V(L.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){var t=this;this.signal.on(Me.WS_RECONNECT_WAITTING_FINISH,i=>{["tryNext","recover"].includes(i)&&this.joinInfo&&pe.adjustSessionStartTime(this.joinInfo.sid)}),this.signal.on(Me.WS_RECONNECT_CREATE_CONNECTION,i=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(Me.WS_RECONNECTING,i=>{this.joinInfo&&pe.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:i||Qi.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",pe.sessionInit(this.joinInfo.sid,{lts:(new Date).getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(Me.WS_CLOSED,i=>{let o;switch(i){case Bt.LEAVE:o=Qi.LEAVE;break;case Bt.UID_BANNED:case Bt.IP_BANNED:case Bt.CHANNEL_BANNED:case Bt.SERVER_ERROR:o=Qi.SERVER_ERROR;break;case Bt.FALLBACK:o=Qi.FALLBACK;break;case Bt.LICENSE_MISSING:case Bt.LICENSE_EXPIRED:case Bt.LICENSE_MINUTES_EXCEEDED:case Bt.LICENSE_PERIOD_INVALID:case Bt.LICENSE_MULTIPLE_SDK_SERVICE:case Bt.LICENSE_ILLEGAL:o=i;break;default:o=Qi.NETWORK_ERROR}N.debug("[signal] websocket closed, reason: ".concat(o||"undefined -> "+Qi.NETWORK_ERROR)),vn("debug",this,"ws_closed","reason: ".concat(i)),this.joinInfo&&pe.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:i===Bt.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:o}),this._disconnectedReason=i,i!==Bt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(Me.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&("audience"===this.role&&this._clientRoleOptions&&this._clientRoleOptions.level&&(N.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions&&this._clientRoleOptions.level)),Re("debug",this,"patch to send set client role, role: ".concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions&&this._clientRoleOptions.level)),this.setClientRole(this.role,this._clientRoleOptions)),pe.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof Yl?"1":"0"}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&1===this.joinInfo.setLocalAPVersion)){const i=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!i)return N.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(i)),void Re("error",this,"set local access point after joined failed: ".concat(i));hn("EVENT_REPORT_DOMAIN",i[1]),hn("EVENT_REPORT_BACKUP_DOMAIN",i[1]),hn("LOG_UPLOAD_SERVER","".concat(i[1],":6444"))}}),this.signal.on(mt.ON_UPLINK_STATS,i=>{this._statsCollector.updateUplinkStats(i)}),this.signal.on(Me.REQUEST_RECOVER,(i,o,s)=>{if(!this.joinInfo)return s(new V(L.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));i&&(this.joinInfo.multiIP=i,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,yi(this,yn.REQUEST_NEW_GATEWAY_LIST).then(o).catch(s)}),this.signal.on(Me.REQUEST_JOIN_INFO,function(){var i=U(function*(o){var s;t.updateTurnConfigFromSignal();const{iceParameters:c,dtlsParameters:l,rtpCapabilities:p}=yield yi(t,yn.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:null===(s=t.joinInfo)||void 0===s?void 0:s.turnServer});o(t.getJoinMessage({ortc:{iceParameters:c,dtlsParameters:l,rtpCapabilities:p,version:"2"}}))});return function(o){return i.apply(this,arguments)}}()),this.signal.on(Me.REQUEST_REJOIN_INFO,i=>{i(this.getRejoinMessage())}),this.signal.on(Me.REPORT_JOIN_GATEWAY,(i,o)=>{this.joinInfo&&(pe.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:i,addr:o,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof Yl?"1":"0"}),this._isProactiveJoin=!1)}),this.signal.on(Me.IS_P2P_DISCONNECTED,i=>{i(yh(this,yn.IS_P2P_DISCONNECTED))}),this.signal.on(Me.DISCONNECT_P2P,()=>{this.emit(yn.DISCONNECT_P2P)}),this.signal.on(Me.NEED_RENEW_SESSION,()=>{this.emit(yn.NEED_RENEW_SESSION)}),this.signal.on(Me.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(Me.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(Me.JOIN_RESPONSE,i=>{const o=this.getCurrentGatewayAddress();this.emit(yn.JOIN_RESPONSE,i,o)}),this.signal.on(Me.DATACHANNEL_PRECONNECT,function(){var i=U(function*(o,s,c){t.updateTurnConfigFromSignal();const l=t.getCurrentGatewayAddress();return yi(t,yn.DATACHANNEL_PRECONNECT,o,l).then(s).catch(c)});return function(o,s,c){return i.apply(this,arguments)}}()),this.signal.on(Me.DATACHANNEL_CONNECTING,function(){var i=U(function*(o){const{iceParameters:s,dtlsParameters:c,rtpCapabilities:l}=yield yi(t,yn.REQUEST_DC_CONNECTION_PARAMS);o(t.getJoinMessage({ortc:{iceParameters:s,dtlsParameters:c,rtpCapabilities:l,version:"2"}}))});return function(o){return i.apply(this,arguments)}}()),this.signal.on(Me.DATACHANNEL_FAILBACK,()=>{N.warning("[".concat(this.store.clientId,"] User join datachannel failed")),this.reset(),this.resetSignal(),this.emit(yn.DATACHANNEL_FAILBACK)})}tryUnsubBeforeResub(t,i){var o=this;return U(function*(){try{yield o.signal.request(Je.UNSUBSCRIBE,{p2p_id:o.store.p2pId,stream_id:t,ortc:[i]},!0)}catch(s){throw N.warning("unsubscribe warning",s),le("warning",o,"tryUnsubBeforeResub",t,s.toString()),s}})()}tryUnpubBeforeRepub(t,i){var o=this;return U(function*(){try{yield o.signal.request(Je.UNPUBLISH,{stream_id:t,ortc:i},!0)}catch(s){throw N.warning("unpublish warning: ",s),le("warning",o,"tryUnpubBeforeRepub",t,s.toString()),s}})()}tryMassUnsubBeforeResub(t){var i=this;return U(function*(){const o={users:t.map(s=>({stream_id:s.stream_id,stream_type:s.stream_type}))};try{yield i.signal.request(Je.UNSUBSCRIBE_STREAMS,o,!0)}catch(s){throw N.warning("massUnsubscribe warning",s),le("warning",i,"tryUnsubAllBeforeResub",t.map(c=>c.stream_id),s.toString()),s}})()}muteLocal(t,i){var o=this;return U(function*(){const s={action:t.find(c=>c.stream_type===lr.Audio)?"mute_local_audio":"mute_local_video",p2p_id:o.store.p2pId,ortc:t,stream_id:i};try{yield o.signal.request(Je.CONTROL,s,!0,!0)}catch(c){throw N.warning("gateway unmuteLocal warning: ",c),le("warning",o,"muteLocal",i,c.toString()),c}})()}unmuteLocal(t,i){var o=this;return U(function*(){const s={action:t.find(c=>c.stream_type===lr.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:o.store.p2pId,ortc:t,stream_id:i};try{yield o.signal.request(Je.CONTROL,s,!0,!0)}catch(c){throw N.warning("gateway muteLocal warning: ",c),le("warning",o,"unmuteLocal",i,c.toString()),c}})()}uploadStats(t,i){this.signal.upload(t,i)}getSignalRTT(){return this.signal.rtt}restartICE(t){var i=this;return U(function*(){const o={p2p_id:i.store.p2pId,stream_id:i.store.uid,ortc:t};try{return yield i.signal.request(Je.RESTART_ICE,o,!0)}catch(s){throw N.warning("P2PChannel.restartICE warning: ",s),le("warning",i,"restartICE",void 0,s.toString()),s}})()}reconnect(){"CONNECTED"===this.state&&this.signal.reconnect(void 0,Qi.P2P_FAILED)}getCurrentGatewayAddress(){var t;if(!J("GATEWAY_WSS_ADDRESS"))return null!==(t=this.joinInfo)&&void 0!==t&&t.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}setPublishAudioFilterEnabled(t){var i=this;return U(function*(){yield i.signal.request(Je.SET_PARAMETER,{enablePublishAudioFilter:t})})()}resetSignal(){this.signal&&(this.signal.removeAllListeners(),this.signal.close(Bt.FALLBACK)),this.signal=new HD(Ku(Ku({},this.spec),{},{retryConfig:this.spec.websocketRetryConfig}),this.store),this.handleSignalEvents(),this.emit(yn.RESET_CONNECTION_EVENTS)}})||b9;function D3(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function w3(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?D3(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):D3(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}!function(){var t;function i(Q){var K=0;return function(){return K<Q.length?{done:!1,value:Q[K++]}:{done:!0}}}var s,o="function"==typeof Object.defineProperties?Object.defineProperty:function(Q,K,ne){return Q==Array.prototype||Q==Object.prototype||(Q[K]=ne.value),Q},c=function(Q){Q=["object"==typeof globalThis&&globalThis,Q,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Go&&Go];for(var K=0;K<Q.length;++K){var ne=Q[K];if(ne&&ne.Math==Math)return ne}throw Error("Cannot find global object")}(this);function l(Q,K){if(K)e:{var ne=c;Q=Q.split(".");for(var me=0;me<Q.length-1;me++){var Ne=Q[me];if(!(Ne in ne))break e;ne=ne[Ne]}(K=K(me=ne[Q=Q[Q.length-1]]))!=me&&null!=K&&o(ne,Q,{configurable:!0,writable:!0,value:K})}}function p(Q){return(Q={next:Q})[Symbol.iterator]=function(){return this},Q}function h(Q){var K=typeof Symbol<"u"&&Symbol.iterator&&Q[Symbol.iterator];return K?K.call(Q):{next:i(Q)}}if(l("Symbol",function(Q){function K(Ne,ce){this.A=Ne,o(this,"description",{configurable:!0,writable:!0,value:ce})}if(Q)return Q;K.prototype.toString=function(){return this.A};var ne="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",me=0;return function Ne(ce){if(this instanceof Ne)throw new TypeError("Symbol is not a constructor");return new K(ne+(ce||"")+"_"+me++,ce)}}),l("Symbol.iterator",function(Q){if(Q)return Q;Q=Symbol("Symbol.iterator");for(var K="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),ne=0;ne<K.length;ne++){var me=c[K[ne]];"function"==typeof me&&"function"!=typeof me.prototype[Q]&&o(me.prototype,Q,{configurable:!0,writable:!0,value:function(){return p(i(this))}})}return Q}),"function"==typeof Object.setPrototypeOf)s=Object.setPrototypeOf;else{var g;e:{var f={};try{f.__proto__={a:!0},g=f.a;break e}catch{}g=!1}s=g?function(Q,K){if(Q.__proto__=K,Q.__proto__!==K)throw new TypeError(Q+" is not extensible");return Q}:null}var A=s;function _(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function v(Q){if(Q.m)throw new TypeError("Generator is already running");Q.m=!0}function y(Q,K){return Q.h=3,{value:K}}function S(Q){this.g=new _,this.G=Q}function R(Q,K,ne,me){try{var Ne=K.call(Q.g.j,ne);if(!(Ne instanceof Object))throw new TypeError("Iterator result "+Ne+" is not an object");if(!Ne.done)return Q.g.m=!1,Ne;var ce=Ne.value}catch(T){return Q.g.j=null,Q.g.s(T),D(Q)}return Q.g.j=null,me.call(Q.g,ce),D(Q)}function D(Q){for(;Q.g.h;)try{var K=Q.G(Q.g);if(K)return Q.g.m=!1,{value:K.value,done:!1}}catch(ne){Q.g.v=void 0,Q.g.s(ne)}if(Q.g.m=!1,Q.g.l){if(K=Q.g.l,Q.g.l=null,K.F)throw K.D;return{value:K.return,done:!0}}return{value:void 0,done:!0}}function O(Q){this.next=function(K){return Q.o(K)},this.throw=function(K){return Q.s(K)},this.return=function(K){return function(ne,me){v(ne.g);var Ne=ne.g.j;return Ne?R(ne,"return"in Ne?Ne.return:function(ce){return{value:ce,done:!0}},me,ne.g.return):(ne.g.return(me),D(ne))}(Q,K)},this[Symbol.iterator]=function(){return this}}function P(Q,K){return K=new O(new S(K)),A&&Q.prototype&&A(K,Q.prototype),K}if(_.prototype.o=function(Q){this.v=Q},_.prototype.s=function(Q){this.l={D:Q,F:!0},this.h=this.C||this.u},_.prototype.return=function(Q){this.l={return:Q},this.h=this.u},S.prototype.o=function(Q){return v(this.g),this.g.j?R(this,this.g.j.next,Q,this.g.o):(this.g.o(Q),D(this))},S.prototype.s=function(Q){return v(this.g),this.g.j?R(this,this.g.j.throw,Q,this.g.o):(this.g.s(Q),D(this))},l("Array.prototype.entries",function(Q){return Q||function(){return function(K,ne){K instanceof String&&(K+="");var me=0,Ne=!1,ce={next:function(){if(!Ne&&me<K.length){var T=me++;return{value:ne(T,K[T]),done:!1}}return Ne=!0,{done:!0,value:void 0}}};return ce[Symbol.iterator]=function(){return ce},ce}(this,function(K,ne){return[K,ne]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var B=function(Q,K){for(var ne=0;ne<Q.length;ne++)K(Q[ne])},G=function(Q){return Q.replace(/\r?\n|\r/g,"\r\n")},Y=function(Q,K,ne){return K instanceof Blob?(ne=void 0!==ne?String(ne+""):"string"==typeof K.name?K.name:"blob",K.name===ne&&"[object Blob]"!==Object.prototype.toString.call(K)||(K=new File([K],ne)),[String(Q),K]):[String(Q),String(K)]},ae=function(Q,K){if(Q.length<K)throw new TypeError(K+" argument required, but only "+Q.length+" present.")},te="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:this,Z=te.FormData,_e=te.XMLHttpRequest&&te.XMLHttpRequest.prototype.send,fe=te.Request&&te.fetch,Se=te.navigator&&te.navigator.sendBeacon,Oe=te.Element&&te.Element.prototype,Ye=te.Symbol&&Symbol.toStringTag;Ye&&(Blob.prototype[Ye]||(Blob.prototype[Ye]="Blob"),"File"in te&&!File.prototype[Ye]&&(File.prototype[Ye]="File"));try{new File([],"")}catch{te.File=function(K,ne,me){return K=new Blob(K,me||{}),Object.defineProperties(K,{name:{value:ne},lastModified:{value:+(me&&void 0!==me.lastModified?new Date(me.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),Ye&&Object.defineProperty(K,Ye,{value:"File"}),K}}var Ee=function(Q){return Q.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},z=function(Q){this.i=[];var K=this;Q&&B(Q.elements,function(ne){if(ne.name&&!ne.disabled&&"submit"!==ne.type&&"button"!==ne.type&&!ne.matches("form fieldset[disabled] *"))if("file"===ne.type){var me=ne.files&&ne.files.length?ne.files:[new File([],"",{type:"application/octet-stream"})];B(me,function(Ne){K.append(ne.name,Ne)})}else"select-multiple"===ne.type||"select-one"===ne.type?B(ne.options,function(Ne){!Ne.disabled&&Ne.selected&&K.append(ne.name,Ne.value)}):"checkbox"===ne.type||"radio"===ne.type?ne.checked&&K.append(ne.name,ne.value):(me="textarea"===ne.type?G(ne.value):ne.value,K.append(ne.name,me))})};if((t=z.prototype).append=function(Q,K,ne){ae(arguments,2),this.i.push(Y(Q,K,ne))},t.delete=function(Q){ae(arguments,1);var K=[];Q=String(Q),B(this.i,function(ne){ne[0]!==Q&&K.push(ne)}),this.i=K},t.entries=function Q(){var K,ne=this;return P(Q,function(me){if(1==me.h&&(K=0),3!=me.h)return K<ne.i.length?me=y(me,ne.i[K]):(me.h=0,me=void 0),me;K++,me.h=2})},t.forEach=function(Q,K){ae(arguments,1);for(var ne=h(this),me=ne.next();!me.done;me=ne.next()){var Ne=h(me.value);me=Ne.next().value,Ne=Ne.next().value,Q.call(K,Ne,me,this)}},t.get=function(Q){ae(arguments,1);var K=this.i;Q=String(Q);for(var ne=0;ne<K.length;ne++)if(K[ne][0]===Q)return K[ne][1];return null},t.getAll=function(Q){ae(arguments,1);var K=[];return Q=String(Q),B(this.i,function(ne){ne[0]===Q&&K.push(ne[1])}),K},t.has=function(Q){ae(arguments,1),Q=String(Q);for(var K=0;K<this.i.length;K++)if(this.i[K][0]===Q)return!0;return!1},t.keys=function Q(){var K,ne,ce=this;return P(Q,function(T){if(1==T.h&&(K=h(ce),ne=K.next()),3!=T.h)return ne.done?void(T.h=0):y(T,h(ne.value).next().value);ne=K.next(),T.h=2})},t.set=function(Q,K,ne){ae(arguments,2),Q=String(Q);var me=[],Ne=Y(Q,K,ne),ce=!0;B(this.i,function(T){T[0]===Q?ce&&(ce=!me.push(Ne)):me.push(T)}),ce&&me.push(Ne),this.i=me},t.values=function Q(){var K,ne,Ne,ce=this;return P(Q,function(T){if(1==T.h&&(K=h(ce),ne=K.next()),3!=T.h)return ne.done?void(T.h=0):((Ne=h(ne.value)).next(),y(T,Ne.next().value));ne=K.next(),T.h=2})},z.prototype._asNative=function(){for(var Q=new Z,K=h(this),ne=K.next();!ne.done;ne=K.next()){var me=h(ne.value);ne=me.next().value,me=me.next().value,Q.append(ne,me)}return Q},z.prototype._blob=function(){var Q="----formdata-polyfill-"+Math.random(),K=[],ne="--"+Q+'\r\nContent-Disposition: form-data; name="';return this.forEach(function(me,Ne){return"string"==typeof me?K.push(ne+Ee(G(Ne))+'"\r\n\r\n'+G(me)+"\r\n"):K.push(ne+Ee(G(Ne))+'"; filename="'+Ee(me.name)+'"\r\nContent-Type: '+(me.type||"application/octet-stream")+"\r\n\r\n",me,"\r\n")}),K.push("--"+Q+"--"),new Blob(K,{type:"multipart/form-data; boundary="+Q})},z.prototype[Symbol.iterator]=function(){return this.entries()},z.prototype.toString=function(){return"[object FormData]"},Oe&&!Oe.matches&&(Oe.matches=Oe.matchesSelector||Oe.mozMatchesSelector||Oe.msMatchesSelector||Oe.oMatchesSelector||Oe.webkitMatchesSelector||function(Q){for(var K=(Q=(this.document||this.ownerDocument).querySelectorAll(Q)).length;0<=--K&&Q.item(K)!==this;);return-1<K}),Ye&&(z.prototype[Ye]="FormData"),_e){var ee=te.XMLHttpRequest.prototype.setRequestHeader;te.XMLHttpRequest.prototype.setRequestHeader=function(Q,K){ee.call(this,Q,K),"content-type"===Q.toLowerCase()&&(this.B=!0)},te.XMLHttpRequest.prototype.send=function(Q){Q instanceof z?(Q=Q._blob(),this.B||this.setRequestHeader("Content-Type",Q.type),_e.call(this,Q)):_e.call(this,Q)}}fe&&(te.fetch=function(Q,K){return K&&K.body&&K.body instanceof z&&(K.body=K.body._blob()),fe.call(this,Q,K)}),Se&&(te.navigator.sendBeacon=function(Q,K){return K instanceof z&&(K=K._asNative()),Se.call(this,Q,K)}),te.FormData=z}}();let N3=1;function TY(t,i,o,s,c){N3+=1;const l={sid:o.sid,command:"convergeAllocateEdge",uid:"666",appId:o.appId,ts:Math.floor(Date.now()/1e3),seq:N3,requestId:N3,version:po,cname:o.cname},p={service_name:i,json_body:JSON.stringify(l)};let h,g,f=t[0];return Va(U(function*(){h=Date.now();const A=yield Ka(f,{data:p,cancelToken:s,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(g=Date.now()-h,0!==A.code){const y=new V(L.UNEXPECTED_RESPONSE,"live streaming ap error, code"+A.code,{retry:!0,responseTime:g});throw N.error(y.toString()),le("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,y.toString()),y}const _=JSON.parse(A.json_body);if(200!==_.code){const y=new V(L.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(_.code,", reason: ").concat(_.reason),{code:_.code,responseTime:g});throw N.error(y.toString()),le("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,y.toString()),y}if(!_.servers||0===_.servers.length){const y=new V(L.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:_.code,responseTime:g});throw N.error(y.toString()),le("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,y.toString()),y}const v=(S=i,{addressList:(y=_).servers.map(R=>"wss://".concat(R.address.replace(/\./g,"-"),".").concat(J("WORKER_DOMAIN"),":").concat(R.wss,"?serviceName=").concat(encodeURIComponent(S))),workerToken:y.workerToken,vid:y.vid});var y,S;return J("LIVE_STREAMING_ADDRESS")&&(v.addressList=J("LIVE_STREAMING_ADDRESS")instanceof Array?J("LIVE_STREAMING_ADDRESS"):[J("LIVE_STREAMING_ADDRESS")]),w3(w3({},v),{},{responseTime:g})}),(A,_)=>(pe.apworkerEvent(o.sid,{success:!0,sc:200,serviceName:i,responseDetail:JSON.stringify(A.addressList),firstSuccess:0===_,responseTime:g,serverIp:t[_%t.length]}),!1),(A,_)=>(pe.apworkerEvent(o.sid,{success:!1,sc:A.data&&A.data.code||200,serviceName:i,responseTime:g,serverIp:t[_%t.length]}),!!(A.code!==L.OPERATION_ABORTED&&A.code!==L.UNEXPECTED_RESPONSE||A.data&&A.data.retry)&&(f=t[(_+1)%t.length],!0)),c)}let O3=1;function R9(t,i,o,s){let{url:c,areaCode:l}=t;le("debug",["AjaxAPI",i.clientId],"requestChooseServer",{url:c,areaCode:l});const p=Date.now();let h;const[g,f]=O9(i,l,[Rr.CHOOSE_SERVER]);let A=$n.networkState;return Va(U(function*(){A&&$n.networkState===Ci.OFFLINE&&$n.onlineWaiter&&(yield Ie.race([$n.onlineWaiter,Ar(s&&s.maxRetryTimeout||ur.maxRetryTimeout)])),A=$n.networkState;const{data:_,headers:v}=yield Ka(c,{data:g,cancelToken:o,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);h="1"===v.http3?1:-1,pe.reportResourceTiming(c,i.sid),D9(_,c,i,p,[Rr.CHOOSE_SERVER],h);const y=Rs(_,Rr.CHOOSE_SERVER);return w9(y),Ya(y,c)}),_=>(_&&pe.joinChooseServer(i.sid,{lts:p,succ:!0,csAddr:c,opid:f,serverList:_.gatewayAddrs.map(v=>v.address),ec:null,cid:_.cid.toString(),uid:_.uid.toString(),csIp:_.csIp,unilbsServerIds:[Rr.CHOOSE_SERVER].toString(),isHttp3:h}),!1),_=>_.code!==L.OPERATION_ABORTED&&(_.code===L.CAN_NOT_GET_GATEWAY_SERVER?_.data.retry:(pe.joinChooseServer(i.sid,{lts:p,succ:!1,csAddr:c,serverList:null,opid:f,ec:_.code,csIp:_.data&&_.data.csIp,unilbsServerIds:[Rr.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:A}),isHttp3:h}),N.warning("[".concat(i.clientId,"] Choose server network error, retry"),_),Re("warning",["AjaxAPI",i.clientId],"Choose server network error, retry, ".concat(_)),!0)),s)}function P3(t,i,o,s){let c,{url:l,areaCode:p,serviceIds:h}=t;le("debug",["AjaxAPI",i.clientId],"requestMultiUnilbs",{url:l,areaCode:p,serviceIds:h});const g=Date.now(),[f,A]=O9(i,p,h);let _;return Va(U(function*(){_&&$n.networkState===Ci.OFFLINE&&$n.onlineWaiter&&(yield Ie.race([$n.onlineWaiter,Ar(s&&s.maxRetryTimeout||ur.maxRetryTimeout)])),_=$n.networkState;const{data:v,headers:y}=yield Ka(l,{data:f,cancelToken:o,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);c="1"===y.http3?1:-1,pe.reportResourceTiming(l,i.sid),D9(v,l,i,g,h,c);const S=Rs(v,Rr.CHOOSE_SERVER),R=Rs(v,"proxy5"===i.cloudProxyServer?Rr.CLOUD_PROXY_5:"proxy3"===i.cloudProxyServer||"proxy4"===i.cloudProxyServer?Rr.CLOUD_PROXY:Rr.CLOUD_PROXY_FALLBACK);return w9(S),{gatewayInfo:Ya(S,l),proxyInfo:R,url:l}}),v=>(v.gatewayInfo&&pe.joinChooseServer(i.sid,{lts:g,succ:!0,csAddr:l,serverList:v.gatewayInfo.gatewayAddrs.map(y=>y.address),ec:null,opid:A,cid:v.gatewayInfo.cid.toString(),uid:v.gatewayInfo.uid.toString(),csIp:v.gatewayInfo.csIp,unilbsServerIds:h.toString(),isHttp3:c}),v.proxyInfo&&pe.joinWebProxyAP(i.sid,{lts:g,sucess:1,apServerAddr:l,turnServerAddrList:v.proxyInfo.addresses.map(y=>y.ip).join(","),errorCode:null,eventType:i.cloudProxyServer,unilbsServerIds:h.toString()}),!1),v=>v.code!==L.OPERATION_ABORTED&&(v.code===L.CAN_NOT_GET_GATEWAY_SERVER?v.data.retry:(pe.joinWebProxyAP(i.sid,{lts:g,sucess:0,apServerAddr:l,turnServerAddrList:null,errorCode:v.code,eventType:i.cloudProxyServer,unilbsServerIds:h.toString(),extend:JSON.stringify({networkState:_})}),N.warning("[".concat(i.clientId,"] multi unilbs network error, retry"),v),Re("warning",["AjaxAPI",i.clientId],"multi unilbs network error, retry, ".concat(v)),!0)),s)}const D9=(t,i,o,s,c,l)=>{const p=[],h=g=>{4096===g.flag?pe.joinChooseServer(o.sid,{lts:s,succ:!1,csAddr:i,opid:t.opid,serverList:null,ec:g.error.message,csIp:g.error.data&&g.error.data.csIp,unilbsServerIds:c.toString(),isHttp3:l}):1048576!==g.flag&&4194304!==g.flag&&4194310!==g.flag||pe.joinWebProxyAP(o.sid,{lts:s,sucess:0,apServerAddr:i,turnServerAddrList:null,errorCode:g.error.code,eventType:o.cloudProxyServer,unilbsServerIds:c.toString()})};if(t.response_body.forEach(g=>{const f=g.buffer.code;if(23===g.uri&&0===f&&!g.buffer.edges_services)if(4194310===g.buffer.flag)N.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),g.buffer.edges_services=[];else{const A={error:new V(L.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:t.detail[502]}),flag:g.buffer.flag};p.push(A),h(A)}if(0!==f){const A=$m(f),_={error:new V(L.CAN_NOT_GET_GATEWAY_SERVER,A.desc,{desc:A.desc,retry:A.retry,csIp:t.detail[502]}),flag:g.buffer.flag};4194310===g.buffer.flag?N.warning(_.error.toString()):p.push(_),h(_)}}),p.length)throw N.warning("[".concat(o.clientId,"] multi unilbs ").concat(i," failed, ").concat(p.map(g=>"flag: ".concat(g.flag,", message: ").concat(g.error.message,", retry: ").concat(g.error.data.retry)).join(" | "))),le("warning",["AjaxAPI",o.clientId],"checkMultiUnilbsResponseValid",{url:i},p.map(g=>({flag:g.flag,message:g.error.message,retry:g.error.data.retry}))),new V(L.CAN_NOT_GET_GATEWAY_SERVER,p.map(g=>"flag: ".concat(g.flag,", message: ").concat(g.error.message)).join(" | "),{retry:!!p.find(g=>g.error.data.retry),csIp:t.detail[502],desc:[...new Set(p.map(g=>{var f,A;return null==g||null===(f=g.error)||void 0===f||null===(A=f.data)||void 0===A?void 0:A.desc}).filter(g=>!!g))]})},w9=t=>{var i,o;if(t.addresses&&0===t.addresses.length&&0===t.code)throw new V(L.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:t.detail&&t.detail[502]});if(null!==(i=t.detail)&&void 0!==i&&i[19]&&"string"==typeof(null===(o=t.detail)||void 0===o?void 0:o[19])){const l=t.detail[19]?.split(";");for(let p=0;p<l.length;p++){var s;const h=Ba(s=l[p]).call(s);t.addresses[p]&&l&&(t.addresses[p].fingerprint=h)}}if(J("GATEWAY_ADDRESS")&&J("GATEWAY_ADDRESS").length>0){N.debug("assign gateway address to",J("GATEWAY_ADDRESS")),Re("debug",["AjaxAPI"],"assign gateway address to ".concat(JSON.stringify(J("GATEWAY_ADDRESS"))));const c=J("GATEWAY_ADDRESS").map(l=>{var p,h;const g=null!==(p=null===(h=t.addresses.find(f=>f.ip===l.ip&&f.port===l.port))||void 0===h?void 0:h.fingerprint)&&void 0!==p?p:"";return{ip:l.ip,port:l.port,ticket:t.addresses[0]&&t.addresses[0].ticket,fingerprint:g}});t.addresses=c}},N9=(t,i)=>{if(t.response_body&&t.response_body.length){const o=t.response_body[0];if(0!==o.buffer.code){const s=$m(o.buffer.code);throw new V(L.UPDATE_TICKET_FAILED,"[".concat(o.buffer.code,"]: ").concat(s.desc),{retry:s.retry})}return o.buffer.ticket}throw N.debug("update ticket request received ap response without response body:",i),Re("debug",["AjaxAPI"],"update ticket request received ap response without response body: ".concat(i)),new V(L.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},O9=(t,i,o)=>{const s=Math.floor(1e12*Math.random()),c={appid:t.appId,client_ts:Date.now(),opid:s,sid:t.sid,request_bodies:[{uri:22,buffer:{cname:t.cname,detail:{6:t.stringUid,11:i,12:J("USE_NEW_TOKEN")?"1":void 0},key:t.token,service_ids:o,uid:t.uid||0}}]};c.request_bodies.forEach(p=>{t.multiIP&&t.multiIP.gateway_ip&&(p.buffer.detail[5]=JSON.stringify({vocs_ip:[t.multiIP.uni_lbs_ip],vos_ip:[t.multiIP.gateway_ip]}))});const l=new FormData;return l.append("request",JSON.stringify(c)),[l,s]},RY=(t,i)=>{const o=Math.floor(1e12*Math.random()),s={appid:t.appId,client_ts:Date.now(),opid:o,sid:t.sid,request_bodies:[{uri:28,buffer:{cname:t.cname,detail:{1:"",6:t.stringUid,12:"1"},token:t.token,service_ids:i,uid:t.uid||0,edges_services:t.apResponse.addresses.map(l=>({ip:l.ip,port:l.port}))}}]},c=new FormData;return c.append("request",JSON.stringify(s)),[c,o]};let M3=0;const KD=()=>{const t=J("AREAS");return 0===t.length&&t.push(jt.GLOBAL),hc(t).call(t,(i,o,s)=>{const c=DY(o);return c?0===s?c:"".concat(i,",").concat(c):i},"")},DY=t=>t===jt.OVERSEA?"".concat(Ur.ASIA,",").concat(Ur.EUROPE,",").concat(Ur.AFRICA,",").concat(Ur.NORTH_AMERICA,",").concat(Ur.SOUTH_AMERICA,",").concat(Ur.OCEANIA):Ur[t],hC={GLOBAL:{ASIA:[jt.CHINA,jt.JAPAN,jt.INDIA,jt.KOREA,jt.HKMC],EUROPE:[],NORTH_AMERICA:[jt.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},k3=Object.keys(hC[jt.GLOBAL]),P9=[jt.CHINA,jt.NORTH_AMERICA,jt.EUROPE,jt.ASIA,jt.JAPAN,jt.INDIA,jt.OCEANIA,jt.SOUTH_AMERICA,jt.AFRICA,jt.KOREA,jt.HKMC,jt.US];function ai(t,i,o,s){return L3.apply(this,arguments)}function L3(){return L3=U(function*(t,i,o,s){return{gatewayInfo:yield(l=U(function*(p,h,g,f){let A=null;const _=[],v=function(){var S=U(function*(){const R=J("WEBCS_DOMAIN").slice(0,J("AJAX_REQUEST_CONCURRENT")).map(P=>({url:p.proxyServer?"https://".concat(p.proxyServer,"/ap/?url=").concat(P+"/api/v2/transpond/webrtc?v=2"):"https://".concat(P,"/api/v2/transpond/webrtc?v=2"),areaCode:KD()})),D=f.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:R.map(P=>P.url)}),O=yield Vc({fragementLength:J("FRAGEMENT_LENGTH"),referenceList:R,asyncMapHandler:P=>(N.debug("[".concat(p.clientId,"] Connect to choose_server:"),P.url),R9(P,p,h,g)),allFailedhandler:P=>{throw f.recordJoinChannelService({endTs:Date.now(),status:"error",errors:P},D),P[0]},promisesCollector:_});return f.recordJoinChannelService({endTs:Date.now(),status:"success"},D),O});return function(){return S.apply(this,arguments)}}(),y=function(){var S=U(function*(){if(yield Ar(1e3),null!==A)return A;const R=J("WEBCS_DOMAIN_BACKUP_LIST").map(P=>({url:p.proxyServer?"https://".concat(p.proxyServer,"/ap/?url=").concat(P+"/api/v2/transpond/webrtc?v=2"):"https://".concat(P,"/api/v2/transpond/webrtc?v=2"),areaCode:KD()})),D=f.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:R.map(P=>P.url)}),O=yield Vc({fragementLength:J("FRAGEMENT_LENGTH"),referenceList:R,asyncMapHandler:P=>(N.debug("[".concat(p.clientId,"] Connect to backup choose_server:"),P.url),R9(P,p,h,g)),allFailedhandler:P=>{throw f.recordJoinChannelService({endTs:Date.now(),status:"error",errors:P},D),P[0]},promisesCollector:_});return f.recordJoinChannelService({endTs:Date.now(),status:"success"},D),O});return function(){return S.apply(this,arguments)}}();try{return A=yield Pf([v(),y()]),_.length&&_.forEach(S=>S.cancel&&"function"==typeof S.cancel&&S.cancel()),A}catch(S){throw S[0]}}),function(p,h,g,f){return l.apply(this,arguments)})(t,i,o,s)};var l}),L3.apply(this,arguments)}function M9(t,i,o,s,c){return x3.apply(this,arguments)}function x3(){return x3=U(function*(t,i,o,s,c){const l=t.cloudProxyServer;if("disabled"===l){if(!s)return;if(t.useLocalAccessPoint)return yield ai(t,i,o,c);if(J("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:f,proxyInfo:A}=yield F3(t,i,o,c);return t.turnServer&&"auto"!==t.turnServer.mode?(Re("debug",["Server",t.clientId],"do not set fallback turn because of already having turnserver"),{gatewayInfo:f}):(t.turnServer={mode:"manual",servers:A.map(_=>({turnServerURL:_.address,tcpport:_.tcpport||Ss.tcpport,udpport:_.udpport||Ss.udpport,username:_.username||Ss.username,password:_.password||Ss.password,forceturn:J("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE"),security:!0}))},{gatewayInfo:f})}return yield ai(t,i,o,c)}const{proxyInfo:p,gatewayInfo:h}=yield F3(t,i,o,c),g={gatewayInfo:h};return t.turnServer={mode:"manual",servers:p.map(f=>({turnServerURL:f.address,tcpport:"proxy3"===l?void 0:f.tcpport?f.tcpport:Ss.tcpport,udpport:"proxy4"===l?void 0:f.udpport?f.udpport:Ss.udpport,username:f.username||Ss.username,password:f.password||Ss.password,forceturn:"proxy4"!==l,security:"proxy5"===l}))},N.debug("[".concat(t.clientId,"] set proxy server: ").concat(t.proxyServer,", mode: ").concat(l)),le("debug",["Server",t.clientId],"setCloudProxyServerAndGetServerInfo",{proxyServer:t.proxyServer,mode:t.cloudProxyServer}),g}),x3.apply(this,arguments)}function k9(t,i,o,s,c){return Wf.apply(this,arguments)}function Wf(){return Wf=U(function*(t,i,o,s,c){let p=[];p=J("ACCOUNT_REGISTER").slice(0,J("AJAX_REQUEST_CONCURRENT")).map(i.proxyServer?g=>"https://".concat(i.proxyServer,"/ap/?url=").concat(g+"/api/v1"):g=>"https://".concat(g,"/api/v1"));const h=c?.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:p});try{const g=yield(f=U(function*(A,_,v,y,S){const R=Date.now(),D={sid:v.sid,opid:10,appid:v.appId,string_uid:_};let O=A[0];const P=yield Va(()=>Ka(O+"".concat(-1===O.indexOf("?")?"?":"&","action=stringuid"),{data:D,cancelToken:y,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(B,G)=>{if(0===B.code){if(B.uid<=0||B.uid>=Math.pow(2,32))throw N.error("Invalid Uint Uid ".concat(_," => ").concat(B.uid),B),le("error",["AjaxAPI"],"requestUserAccount","Invalid Uint Uid ".concat(_," => ").concat(B.uid,", ").concat(B)),pe.reqUserAccount(D.sid,{lts:R,success:!1,serverAddr:O,stringUid:D.string_uid,uid:B.uid,errorCode:L.INVALID_UINT_UID_FROM_STRING_UID,extend:D}),new V(L.INVALID_UINT_UID_FROM_STRING_UID);return pe.reqUserAccount(D.sid,{lts:R,success:!0,serverAddr:O,stringUid:D.string_uid,uid:B.uid,errorCode:null,extend:D}),!1}const Y=$m(B.code);return Y.retry&&(O=A[(G+1)%A.length]),pe.reqUserAccount(D.sid,{lts:R,success:!1,serverAddr:O,stringUid:D.string_uid,uid:B.uid,errorCode:Y.desc,extend:D}),Y.retry},(B,G)=>B.code!==L.OPERATION_ABORTED&&(pe.reqUserAccount(D.sid,{lts:R,success:!1,serverAddr:O,stringUid:D.string_uid,uid:null,errorCode:B.code,extend:D}),O=A[(G+1)%A.length],!0),S);if(0!==P.code){const B=$m(P.code);throw new V(L.UNEXPECTED_RESPONSE,B.desc)}return P}),function(A,_,v,y,S){return f.apply(this,arguments)})(p,t,i,o,s);return c?.recordJoinChannelService({status:"success",endTs:Date.now()},h),g.uid}catch(g){throw c?.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[g]},h),g}var f}),Wf.apply(this,arguments)}function YD(){return YD=U(function*(t,i,o){const s=J("CDS_AP").slice(0,J("AJAX_REQUEST_CONCURRENT")).map(h=>t.proxyServer?"https://".concat(t.proxyServer,"/ap/?url=").concat(h+"/api/v1"):"https://".concat(h,"/api/v1?action=config")).map(h=>function(g,f,A,_){const v=zt(),y={flag:64,cipher_method:0,features:{device:v.name,system:v.os,system_general:navigator.userAgent,vendor:f.appId,version:po,cname:f.cname,sid:f.sid,session_id:f.sid,detail:"",proxyServer:f.proxyServer}};return Va(()=>Ka(g,{data:y,timeout:1e3,cancelToken:A,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,S=>S.code!==L.OPERATION_ABORTED,_)}(h,t,i,o));let c=null,l=null,p={};try{c=yield Pf(s)}catch(h){if(h.code===L.OPERATION_ABORTED)throw h;l=h}if(s.forEach(h=>h.cancel()),pe.reportApiInvoke(t.sid,{name:qe.REQUEST_CONFIG_DISTRIBUTE,options:{error:l,res:c}}).onSuccess(),c&&c.test_tags)try{p=function(h){if(!h.test_tags)return{};const g=h.test_tags,f=Object.keys(g),A={};return f.forEach(_=>{var v;const y=Ba(v=_.slice(4)).call(v),S=JSON.parse(g[_])[1];A[y]=S}),A}(c)}catch{}return p}),YD.apply(this,arguments)}function F3(t,i,o,s){return e_.apply(this,arguments)}function e_(){return e_=U(function*(t,i,o,s){const c=J("PROXY_SERVER_TYPE3"),l=(y,S,R)=>{let D=R||c;return Array.isArray(D)&&(D=S%2==0?c[1]:c[0]),"https://".concat(D,"/ap/?url=").concat(y)};let p=null;const h=[],g=function(){var y=U(function*(){const S=J("WEBCS_DOMAIN").slice(0,J("AJAX_REQUEST_CONCURRENT")).map((O,P)=>{let B;return B="disabled"===t.cloudProxyServer&&t.proxyServer?l("".concat(O,"/api/v2/transpond/webrtc?v=2"),P,t.proxyServer):"disabled"===t.cloudProxyServer||"fallback"===t.cloudProxyServer?"https://".concat(O,"/api/v2/transpond/webrtc?v=2"):l("".concat(O,"/api/v2/transpond/webrtc?v=2"),P),{url:B,areaCode:KD(),serviceIds:[Rr.CHOOSE_SERVER,"proxy5"===t.cloudProxyServer?Rr.CLOUD_PROXY_5:"proxy3"===t.cloudProxyServer||"proxy4"===t.cloudProxyServer?Rr.CLOUD_PROXY:Rr.CLOUD_PROXY_FALLBACK]}}),R=s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:S.map(O=>O.url)}),D=yield Vc({fragementLength:J("FRAGEMENT_LENGTH"),referenceList:S,asyncMapHandler:O=>(N.debug("[".concat(t.clientId,"] Connect to choose_server:"),O.url),P3(O,t,i,o)),allFailedhandler:O=>{throw s.recordJoinChannelService({endTs:Date.now(),status:"error",errors:O},R),O[0]},promisesCollector:h});return s.recordJoinChannelService({endTs:Date.now(),status:"success"},R),D});return function(){return y.apply(this,arguments)}}(),f=function(){var y=U(function*(){if(yield Ar(1e3),null!==p)return p;const S=J("WEBCS_DOMAIN_BACKUP_LIST").map((O,P)=>{let B;return B="disabled"===t.cloudProxyServer&&t.proxyServer?l("".concat(O,"/api/v2/transpond/webrtc?v=2"),P,t.proxyServer):"disabled"===t.cloudProxyServer||"fallback"===t.cloudProxyServer?"https://".concat(O,"/api/v2/transpond/webrtc?v=2"):l("".concat(O,"/api/v2/transpond/webrtc?v=2"),P),{url:B,areaCode:KD(),serviceIds:[Rr.CHOOSE_SERVER,"proxy5"===t.cloudProxyServer?Rr.CLOUD_PROXY_5:"proxy3"===t.cloudProxyServer||"proxy4"===t.cloudProxyServer?Rr.CLOUD_PROXY:Rr.CLOUD_PROXY_FALLBACK]}}),R=s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:S.map(O=>O.url)}),D=yield Vc({fragementLength:J("FRAGEMENT_LENGTH"),referenceList:S,asyncMapHandler:O=>(N.debug("[".concat(t.clientId,"] Connect to backup choose_server:"),O.url),P3(O,t,i,o)),allFailedhandler:O=>{throw s.recordJoinChannelService({endTs:Date.now(),status:"error",errors:O},R),O[0]},promisesCollector:h});return s.recordJoinChannelService({endTs:Date.now(),status:"success"},R),D});return function(){return y.apply(this,arguments)}}();let A,_,v;try{({gatewayInfo:A,proxyInfo:_,url:v}=yield Pf([g(),f()]))}catch(y){throw y[0]}if(h.length&&h.forEach(y=>y.cancel&&"function"==typeof y.cancel&&y.cancel()),!A||!_)throw new V(L.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(t.apUrl=v,"disabled"!==t.cloudProxyServer&&Array.isArray(c)&&v){const y=new dC(v).host;c.includes(y)&&(t.proxyServer=y,N.setProxyServer(y),pe.setProxyServer(y),k1(y))}return p={gatewayInfo:A,proxyInfo:yield Ds(_,A.uid)},p}),e_.apply(this,arguments)}function qD(t,i,o,s){return pC.apply(this,arguments)}function pC(){return pC=U(function*(t,i,o,s){const c=J("UAP_AP").slice(0,J("AJAX_REQUEST_CONCURRENT")).map(l=>i.proxyServer?"https://".concat(i.proxyServer,"/ap/?url=").concat(l+"/api/v1?action=uap"):"https://".concat(l,"/api/v1?action=uap"));return yield TY(c,t,i,o,s)}),pC.apply(this,arguments)}function JD(){return JD=U(function*(t,i,o){const s=J("UAP_AP").slice(0,J("AJAX_REQUEST_CONCURRENT")).map(c=>t.proxyServer?"https://".concat(t.proxyServer,"/ap/?url=").concat(c+"/api/v1?action=uap"):"https://".concat(c,"/api/v1?action=uap")).map(c=>function(l,p,h,g){const f={command:"convergeAllocateEdge",sid:p.sid,appId:p.appId,token:p.token,ts:Date.now(),version:po,cname:p.cname,uid:p.uid.toString(),requestId:O3,seq:O3};O3+=1;const A={service_name:"tele_channel",json_body:JSON.stringify(f)};return Va(U(function*(){const _=yield Ka(l,{data:A,cancelToken:h,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(0!==_.code){const y=new V(L.UNEXPECTED_RESPONSE,"cross channel ap error, code"+_.code,{retry:!0});throw N.error(y.toString()),le("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,y.toString()),y}const v=JSON.parse(_.json_body);if(200!==v.code){const y=new V(L.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(v.code,", reason: ").concat(v.reason));throw N.error(y.toString()),le("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,y.toString()),y}if(!v.servers||0===v.servers.length){const y=new V(L.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw N.error(y.toString()),le("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,y.toString()),y}return{vid:v.vid,workerToken:v.workerToken,addressList:v.servers.map(y=>"wss://".concat(y.address.replace(/\./g,"-"),".").concat(J("WORKER_DOMAIN"),":").concat(y.wss))}}),void 0,_=>!!(_.code!==L.OPERATION_ABORTED&&_.code!==L.UNEXPECTED_RESPONSE||_.data&&_.data.retry),g)}(c,t,i,o));try{const c=yield Pf(s);return s.forEach(l=>l.cancel()),c}catch(c){throw c[0]}}),JD.apply(this,arguments)}function zD(){return zD=U(function*(t,i,o){let s=null;const c=[],l=function(){var p=U(function*(h){const g=J(h?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(f=>t.proxyServer?"https://".concat(t.proxyServer,"/ap/?url=").concat(f+"/api/v2/transpond/webrtc?v=2"):"https://".concat(f,"/api/v2/transpond/webrtc?v=2"));return h&&(yield Ar(1e3),null!==s)?s:yield Vc({fragementLength:J("FRAGEMENT_LENGTH"),referenceList:g,asyncMapHandler:f=>(N.debug("[".concat(t.clientId,"] update ticket, Connect to ").concat(h?"backup":""," choose_server:"),f),function(A,_,v,y){const[S]=RY(_,[Rr.CHOOSE_SERVER]);let R=$n.networkState;return Va(U(function*(){R&&$n.networkState===Ci.OFFLINE&&$n.onlineWaiter&&(yield Ie.race([$n.onlineWaiter,Ar(y&&y.maxRetryTimeout||ur.maxRetryTimeout)])),R=$n.networkState;const D=yield Ka(A,{data:S,cancelToken:v,headers:{"Content-Type":"multipart/form-data;"}},!0);return N9(D,A)}),()=>!1,D=>D.code!==L.OPERATION_ABORTED&&(D.code===L.UPDATE_TICKET_FAILED?D.data.retry:(N.warning("[".concat(_.clientId,"] update ticket network error, retry"),D),Re("warning",["AjaxAPI",_.clientId],"update ticket network error, retry, ".concat(D)),!0)),y)}(f,t,i,o)),allFailedhandler:f=>{throw f[0]},promisesCollector:c})});return function(g){return p.apply(this,arguments)}}();try{return s=yield Pf([l(!1),l(!0)]),c.length&&c.forEach(p=>p.cancel&&"function"==typeof p.cancel&&p.cancel()),s}catch(p){throw p[0]}}),zD.apply(this,arguments)}var U3;function V3(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function j3(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?V3(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):V3(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}let B9=kn("ConfigDistributeManager")(U3=class extends En{constructor(){super(),b(this,"configs",void 0),b(this,"joinInfo",void 0),b(this,"cancelToken",void 0),b(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),b(this,"interval",void 0),b(this,"mutex",new eo("config-distribute")),b(this,"mutableParamsRead",!1)}startGetConfigDistribute(t,i){this.joinInfo=t,this.cancelToken=i,this.interval&&this.stopGetConfigDistribute(),J("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},J("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}awaitConfigDistributeComplete(){var t=this;return U(function*(){!t.mutex.isLocked||(yield t.mutex.lock())()})()}updateConfigDistribute(){var t=this;return U(function*(){if(t.mutableParamsRead||(t.mutableParamsRead=!0,pe.reportApiInvoke(null,{options:void 0,name:qe.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:Ve.TRACER}).onSuccess(JSON.stringify(zk))),!t.joinInfo||!t.cancelToken||!t.retryConfig)return N.debug("[config-distribute] get config distribute interrupted have no joininfo"),void le("debug",t,"updateConfigDistribute",void 0,"get config distribute interrupted have no joininfo");let i;const o=yield t.mutex.lock();try{i=yield function B3(t,i,o){return YD.apply(this,arguments)}(t.joinInfo,t.cancelToken,t.retryConfig),N.debug("[config-distribute] get config distribute",JSON.stringify(i)),le("debug",t,"updateConfigDistribute",i),i.limit_bitrate&&t.handleBitrateLimit(i.limit_bitrate),t.cacheGlobalParameterConfig(i),t.configs=i}catch(s){const c=new V(L.NETWORK_RESPONSE_ERROR,s);N.warning("[config-distribute] ".concat(c.toString())),le("warning",t,"updateConfigDistribute",void 0,s.toString())}finally{o()}})()}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(t){var i;(i=t)&&i.uplink&&i.id&&void 0!==i.uplink.max_bitrate&&void 0!==i.uplink.min_bitrate&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==t.id&&this.emit(fm.UPDATE_BITRATE_LIMIT,t):this.emit(fm.UPDATE_BITRATE_LIMIT,t))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&j3({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(t){var i;const o=na(i=Object.keys(t).filter(c=>/^webrtc_ng_global_parameter/.test(c))).call(i);for(let c=0;c<o.length;c++)for(let l=o.length-1;l>c;l--){const p=o[l];if("number"==typeof t[p].__priority){const h=t[p].__priority,g=o[l-1];if("number"==typeof t[g].__priority){if(!(h>t[g].__priority))continue;{const f=p;o[l]=o[l-1],o[l-1]=f}}else{const f=p;o[l]=o[l-1],o[l-1]=f}}}const s={};o.forEach(c=>{const l=t[c],p=l.__expires;Object.keys(l).forEach(h=>{"__priority"===h||"__expires"===h||Object.prototype.hasOwnProperty.call(s,h)||(s[h]=j3({value:l[h]},p&&{expires:p}))})});try{const c=JSON.stringify(s),l=window.btoa(c);window.localStorage.setItem("websdk_ng_global_parameter",l),N.debug("Caching global parameters ".concat(c)),le("debug",this,"cacheGlobalParameterConfig",c)}catch(c){N.error("Error caching global parameters:",c.message),le("error",this,"cacheGlobalParameterConfig",void 0,c.message)}}})||U3;function Q3(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function t_(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?Q3(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Q3(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}class F9 extends En{constructor(i,o,s,c){super(),b(this,"spec",void 0),b(this,"token",void 0),b(this,"websocket",void 0),b(this,"pingpongTimer",void 0),b(this,"reconnectMode","retry"),b(this,"serviceMode",void 0),b(this,"reqId",0),b(this,"commandReqId",0),b(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),b(this,"handleWebSocketMessage",l=>{if(!l.data)return;const p=JSON.parse(l.data);p.requestId?this.emit("@".concat(p.requestId,"-").concat(p.sid),p):this.serviceMode===Un.INJECT?this.emit(ia.INJECT_STREAM_STATUS,p):(pe.workerEvent(this.spec.sid,{actionType:"status",serverCode:p.code,workerType:this.serviceMode===Un.TRANSCODE?1:2}),this.emit(ia.PUBLISH_STREAM_STATUS,p))}),this.spec=o,this.token=i,this.serviceMode=c,this.websocket=new Th("live-streaming",s),this.websocket.on(ht.CONNECTED,this.handleWebSocketOpen),this.websocket.on(ht.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(ht.REQUEST_NEW_URLS,(l,p)=>{yi(this,ia.REQUEST_NEW_ADDRESS).then(l).catch(p)}),this.websocket.on(ht.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(i){return this.websocket.init(i)}request(i,o,s,c){var l=this;return U(function*(){l.reqId+=1,"request"===i&&(l.commandReqId+=1);const p=l.commandReqId,h=l.reqId;if(!h||!l.websocket)throw new V(L.UNEXPECTED_ERROR);const g=t_({command:i,sdkVersion:"4.15.1"===po?"0.0.1":po,seq:h,requestId:h,allocate:s,cname:l.spec.cname,appId:l.spec.appId,sid:l.spec.sid,uid:l.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},o);if("closed"===l.websocket.state)throw new V(L.WS_DISCONNECT);const f=()=>new Ie((y,S)=>{l.websocket.once(ht.CLOSED,()=>S(new V(L.WS_ABORT))),l.websocket.once(ht.CONNECTED,y)});"connected"!==l.websocket.state&&(yield f()),g.clientRequest&&(g.clientRequest.workerToken=l.token);const A=new Ie((y,S)=>{const R=()=>{S(new V(L.WS_ABORT))};l.websocket.once(ht.RECONNECTING,R),l.websocket.once(ht.CLOSED,R),l.once("@".concat(h,"-").concat(l.spec.sid),D=>{y(D)})});c&&pe.workerEvent(l.spec.sid,t_(t_({},c),{},{requestId:p,actionType:"request",payload:JSON.stringify(o.clientRequest),serverCode:0,code:0}));const _=Date.now();l.websocket.sendMessage(g);let v=null;try{v=yield A}catch(y){if("closed"===l.websocket.state)throw y;return yield f(),yield l.request(i,o,s)}return c&&pe.workerEvent(l.spec.sid,t_(t_({},c),{},{requestId:p,actionType:"response",payload:JSON.stringify(v.serverResponse),serverCode:v.code,success:200===v.code,responseTime:Date.now()-_})),200!==v.code&&l.handleResponseError(v),v})()}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const i="4.15.1"===po?"0.0.1":po;this.reqId+=1,"connected"===this.websocket.state?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:i,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(i){switch(i.code){case Vn.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void N.warning("live stream response already exists stream");case Vn.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case Vn.LIVE_STREAM_RESPONSE_BAD_STREAM:case Vn.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new V(L.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:i.code}).throw();case Vn.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if("UnpublishStream"===i.serverResponse.command||"UninjectStream"===i.serverResponse.command)return;throw new V(L.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Vn.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new V(L.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:i.code}).throw();case Vn.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const o=new V(L.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(ia.WARNING,o,i.serverResponse.url)}case Vn.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const o=new V(L.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(ia.WARNING,o,i.serverResponse.url)}case Vn.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new V(L.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Vn.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new V(L.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:i.code}).throw();case Vn.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const o=new V(L.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(ia.WARNING,o,i.serverResponse.url)}case Vn.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new V(L.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:i.code}).throw();case Vn.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new V(L.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case Vn.LIVE_STREAM_RESPONSE_WORKER_LOST:case Vn.LIVE_STREAM_RESPONSE_WORKER_QUIT:if("UnpublishStream"===i.serverResponse.command||"UninjectStream"===i.serverResponse.command)return;throw new V(L.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Vn.ERROR_FAIL_SEND_MESSAGE:if("UnpublishStream"===i.serverResponse.command||"UninjectStream"===i.serverResponse.command)return;if("UpdateTranscoding"===i.serverResponse.command||"ControlStream"===i.serverResponse.command)return new V(L.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:i.code}).throw();throw new V(L.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Vn.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Vn.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Vn.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Vn.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new V(L.LIVE_STREAMING_CDN_ERROR,"",{code:i.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{"connected"===this.websocket.state&&this.request("ping",{}).catch(q0)},6e3)}}function G3(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function ro(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?G3(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):G3(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}class H3 extends En{constructor(i){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ur,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ur;super(),b(this,"onLiveStreamWarning",void 0),b(this,"onLiveStreamError",void 0),b(this,"onInjectStatusChange",void 0),b(this,"spec",void 0),b(this,"retryTimeout",1e4),b(this,"connection",void 0),b(this,"httpRetryConfig",void 0),b(this,"wsRetryConfig",void 0),b(this,"streamingTasks",new Map),b(this,"isStartingStreamingTask",!1),b(this,"taskMutex",new eo("live-streaming")),b(this,"cancelToken",es.CancelToken.source()),b(this,"transcodingConfig",void 0),b(this,"injectConfig",ro({},cf)),b(this,"injectLoopTimes",0),b(this,"uapResponse",void 0),b(this,"lastTaskId",1),b(this,"statusError",new Map),this.spec=i,this.httpRetryConfig=s,this.wsRetryConfig=o}setTranscodingConfig(i){var o=this;return U(function*(){const s=ro(ro({},fL),i);var h;66!==s.videoCodecProfile&&77!==s.videoCodecProfile&&100!==s.videoCodecProfile&&(N.debug("[".concat(o.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(s.videoCodecProfile," -> 100")),s.videoCodecProfile=100),s.transcodingUsers||(s.transcodingUsers=s.userConfigs),s.transcodingUsers&&(s.transcodingUsers=s.transcodingUsers.map(h=>ro(ro(ro({},af),h),{},{zOrder:h.zOrder?h.zOrder+1:1}))),Cn((h=s).width)||on(h.width,"config.width",0,1e4),Cn(h.height)||on(h.height,"config.height",0,1e4),Cn(h.videoBitrate)||on(h.videoBitrate,"config.videoBitrate",1,1e6),Cn(h.videoFrameRate)||on(h.videoFrameRate,"config.videoFrameRate"),Cn(h.lowLatency)||sf(h.lowLatency,"config.lowLatency"),Cn(h.audioSampleRate)||si(h.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),Cn(h.audioBitrate)||on(h.audioBitrate,"config.audioBitrate",1,128),Cn(h.audioChannels)||si(h.audioChannels,"config.audioChannels",[1,2,3,4,5]),Cn(h.videoGop)||on(h.videoGop,"config.videoGop"),Cn(h.videoCodecProfile)||si(h.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),Cn(h.userCount)||on(h.userCount,"config.userCount",0,17),Cn(h.backgroundColor)||on(h.backgroundColor,"config.backgroundColor",0,16777215),Cn(h.userConfigExtraInfo)||ln(h.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),h.transcodingUsers&&!Cn(h.transcodingUsers)&&(fo(h.transcodingUsers,"config.transcodingUsers"),h.transcodingUsers.forEach((g,f)=>{BT(g.uid),Cn(g.x)||on(g.x,"transcodingUser[".concat(f,"].x"),0,1e4),Cn(g.y)||on(g.y,"transcodingUser[".concat(f,"].y"),0,1e4),Cn(g.width)||on(g.width,"transcodingUser[".concat(f,"].width"),0,1e4),Cn(g.height)||on(g.height,"transcodingUser[".concat(f,"].height"),0,1e4),Cn(g.zOrder)||on(g.zOrder-1,"transcodingUser[".concat(f,"].zOrder"),0,100),Cn(g.alpha)||on(g.alpha,"transcodingUser[".concat(f,"].alpha"),0,1,!1)})),Cn(h.watermark)||K1(h.watermark,"watermark"),Cn(h.backgroundImage)||K1(h.backgroundImage,"backgroundImage"),h.images&&!Cn(h.images)&&(fo(h.images,"config.images"),h.images.forEach((g,f)=>{K1(g,"images[".concat(f,"]"))}));const c=[];s.images&&c.push(...s.images.map(h=>ro(ro(ro({},W1),h),{},{zOrder:255}))),s.backgroundImage&&(c.push(ro(ro(ro({},W1),s.backgroundImage),{},{zOrder:0})),delete s.backgroundImage),s.watermark&&(c.push(ro(ro(ro({},W1),s.watermark),{},{zOrder:255})),delete s.watermark),s.images=c,s.transcodingUsers&&(s.userConfigs=s.transcodingUsers.map(h=>ro({},h)),s.userCount=s.transcodingUsers.length,delete s.transcodingUsers);const l=(s.userConfigs||[]).map(h=>"number"==typeof h.uid?Ie.resolve(h.uid):k9(h.uid,o.spec,o.cancelToken.token,o.httpRetryConfig));if((yield Ie.all(l)).forEach((h,g)=>{s.userConfigs&&s.userConfigs[g]&&(s.userConfigs[g].uid=h)}),o.transcodingConfig=s,o.connection)try{var p;const h=yield o.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:o.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(Ts(p=o.streamingTasks).call(p)).map(g=>g.taskId).join("#")});N.debug("[".concat(o.spec.clientId,"] update live transcoding config success, code: ").concat(h.code,", config:"),JSON.stringify(o.transcodingConfig))}catch(h){if(!h.data||!h.data.retry)throw h;h.data.changeAddress&&o.connection.tryNextAddress(),o.streamingTasks.forEach(g=>{N.warning("[".concat(o.spec.clientId,"] live streaming receive error"),h.toString(),"try to republish",g.url),o.startLiveStreamingTask(g.url,g.mode,h).then(()=>{N.debug("[".concat(o.spec.clientId,"] live streaming republish ").concat(g.url," success"))}).catch(f=>{N.error("[".concat(o.spec.clientId,"] live streaming republish failed"),g.url,f.toString()),o.onLiveStreamError&&o.onLiveStreamError(g.url,f)})})}})()}setInjectStreamConfig(i,o){this.injectConfig=Object.assign({},this.injectConfig,i),this.injectLoopTimes=o}startLiveStreamingTask(i,o,s){var c=this;return U(function*(){var l;if(Array.from(Ts(l=c.streamingTasks).call(l)).find(f=>f.mode===Un.INJECT)&&o===Un.INJECT)return new V(L.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!c.transcodingConfig&&o===Un.TRANSCODE)throw new V(L.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let p={command:"PublishStream",ts:Date.now(),url:i,uid:c.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};N.debug("[".concat(c.spec.clientId,"] start live streaming ").concat(i,", mode: ").concat(o));const h=yield c.taskMutex.lock();if(!c.connection&&s)return void h();if(c.streamingTasks.get(i)&&!s)return h(),new V(L.LIVE_STREAMING_TASK_CONFLICT).throw();try{c.connection||(c.connection=yield c.connect(o))}catch(f){throw h(),f}switch(o){case Un.TRANSCODE:p.transcodingConfig=ro({},c.transcodingConfig);break;case Un.RAW:break;case Un.INJECT:p={cname:c.spec.cname,command:"InjectStream",sid:c.spec.sid,transcodingConfig:c.injectConfig,ts:Date.now(),url:i,loopTimes:c.injectLoopTimes}}c.uapResponse&&c.uapResponse.vid&&(p.vid=c.uapResponse.vid),c.isStartingStreamingTask=!0;const g=c.lastTaskId++;try{const f=new Ie((_,v)=>{Ar(c.retryTimeout).then(()=>{if(s)return v(s);const y=c.statusError.get(i);return y?(c.statusError.delete(i),v(y)):void 0})}),A=yield Ie.race([c.connection.request("request",{clientRequest:p},!0,{url:i,command:"PublishStream",workerType:o===Un.TRANSCODE?1:2,requestByUser:!s,tid:g.toString()}),f]);c.isStartingStreamingTask=!1,N.debug("[".concat(c.spec.clientId,"] live streaming started, code: ").concat(A.code)),c.streamingTasks.set(i,{clientRequest:p,mode:o,url:i,taskId:g}),h()}catch(f){if(h(),c.isStartingStreamingTask=!1,!f.data||!f.data.retry||s)throw f;return f.data.changeAddress?(c.connection.tryNextAddress(),yield c.startLiveStreamingTask(i,o,f)):yield c.startLiveStreamingTask(i,o,f)}})()}stopLiveStreamingTask(i){return new Ie((o,s)=>{const c=this.streamingTasks.get(i);if(!c||!this.connection)return new V(L.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const l=c.mode;c.abortTask=()=>{N.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(i),o()},this.connection.request("request",{clientRequest:{command:l===Un.INJECT?"UninjectStream":"UnpublishStream",url:c.url}},!1,{url:i,command:"UnPublishStream",workerType:l===Un.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(p=>{N.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(p.code)),this.streamingTasks.delete(i),0===this.streamingTasks.size&&l!==Un.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),o(),l===Un.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(ra.INJECT_STREAM_STATUS_STOP_SUCCESS,this.spec.uid,i)}).catch(s)})}controlInjectStream(i,o,s,c){var l=this;return U(function*(){const p=l.streamingTasks.get(i);if(!p||!l.connection||p.mode!==Un.INJECT)throw new V(L.INVALID_OPERATION,"can not find inject stream task to control");return(yield l.connection.request("request",{clientRequest:{command:"ControlStream",url:i,control:o,audioVolume:s,position:c}})).serverResponse})()}resetAllTask(){var i;const o=Array.from(Ts(i=this.streamingTasks).call(i));this.terminate();for(const s of o)this.startLiveStreamingTask(s.url,s.mode).catch(c=>{this.onLiveStreamError&&this.onLiveStreamError(s.url,c)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=es.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}connect(i){var o=this;return U(function*(){if(o.connection)throw new V(L.UNEXPECTED_ERROR,"live streaming connection has already connected");const s=yield yi(o,uf.REQUEST_WORKER_MANAGER_LIST,i);return o.uapResponse=s,o.connection=new F9(s.workerToken,o.spec,o.wsRetryConfig,i),o.connection.on(ia.WARNING,(c,l)=>o.onLiveStreamWarning&&o.onLiveStreamWarning(l,c)),o.connection.on(ia.PUBLISH_STREAM_STATUS,c=>o.handlePublishStreamServer(c)),o.connection.on(ia.INJECT_STREAM_STATUS,c=>o.handleInjectStreamServerStatus(c)),o.connection.on(ia.REQUEST_NEW_ADDRESS,(c,l)=>{if(!o.connection)return l(new V(L.UNEXPECTED_ERROR,"can not get new live streaming address list"));yi(o,uf.REQUEST_WORKER_MANAGER_LIST,i).then(p=>{o.uapResponse=p,c(p.addressList)}).catch(l)}),yield o.connection.init(s.addressList),o.connection})()}handlePublishStreamServer(i){const o=i.serverStatus&&i.serverStatus.url||"empty_url",s=this.streamingTasks.get(o),c=i.reason;switch(i.code){case Vn.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Vn.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Vn.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Vn.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const p=new V(L.LIVE_STREAMING_CDN_ERROR,"",{code:i.code});if(s)return N.error(p.toString()),this.onLiveStreamError&&this.onLiveStreamError(o,p);if(!this.isStartingStreamingTask)return;this.statusError.set(o,p)}case Vn.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const p=new V(L.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,c);return this.onLiveStreamWarning&&this.onLiveStreamWarning(o,p)}case Vn.LIVE_STREAM_RESPONSE_WORKER_LOST:case Vn.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var l;if(!this.connection)return;this.connection.tryNextAddress();const p=Array.from(Ts(l=this.streamingTasks).call(l));for(const h of p)h.abortTask?h.abortTask():(N.warning("[".concat(this.spec.clientId,"] publish stream status code"),i.code,"try to republish",h.url),this.startLiveStreamingTask(h.url,h.mode,new V(L.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:i.code})).then(()=>{N.debug("[".concat(this.spec.clientId,"] republish live stream success"),h.url)}).catch(g=>{N.error(g.toString()),this.onLiveStreamError&&this.onLiveStreamError(h.url,g)}));return}}}handleInjectStreamServerStatus(i){const o=Number(i.uid),s=i.serverStatus&&i.serverStatus.url;switch(i.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(ra.INJECT_STREAM_STATUS_START_SUCCESS,o,s));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(ra.INJECT_STREAM_STATUS_START_ALREADY_EXISTS,o,s),void this.streamingTasks.delete(s);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(ra.INJECT_STREAM_STATUS_START_UNAUTHORIZED,o,s),void this.streamingTasks.delete(s);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(ra.INJECT_STREAM_STATUS_BROKEN,o,s),void this.streamingTasks.delete(s);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(ra.INJECT_STREAM_STATUS_START_TIMEOUT,o,s),void this.streamingTasks.delete(s);default:return void N.debug("inject stream server status",i)}}hasUrl(i){return this.streamingTasks.has(i)}}class $D{constructor(){b(this,"destChannelMediaInfos",new Map),b(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(i){AL(i),this.srcChannelMediaInfo=i}addDestChannelInfo(i){AL(i),this.destChannelMediaInfos.set(i.channelName,i)}removeDestChannelInfo(i){lm(i),this.destChannelMediaInfos.delete(i)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function fC(t){if(!(t instanceof $D))return new V(L.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const i=t.getSrcChannelMediaInfo(),o=t.getDestChannelMediaInfo();return i?0===o.size?new V(L.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw():void 0:new V(L.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw()}class NY extends En{constructor(i,o,s){super(),b(this,"ws",void 0),b(this,"requestId",1),b(this,"heartBeatTimer",void 0),b(this,"joinInfo",void 0),b(this,"clientId",void 0),b(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),b(this,"onClose",c=>{this.emit("close"),this.dispose()}),b(this,"onMessage",c=>{const l=JSON.parse(c.data);if(!l||"serverResponse"!==l.command||!l.requestId)return l&&"serverStatus"===l.command&&l.serverStatus&&l.serverStatus.command?(this.emit("status",l.serverStatus),void this.emit(l.serverStatus.command,l.serverStatus)):void 0;this.emit("req_".concat(l.requestId),l)}),this.joinInfo=i,this.clientId=o,this.ws=new Th("cross-channel-".concat(this.clientId),s),this.ws.on(ht.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(ht.CONNECTED,this.onOpen),this.ws.on(ht.ON_MESSAGE,this.onMessage),this.ws.on(ht.CLOSED,this.onClose)}isConnect(){return"connected"===this.ws.state}sendMessage(i){const o=this.requestId++;return i.requestId=o,i.seq=o,this.ws.sendMessage(i),o}waitStatus(i){return new Ie((o,s)=>{const c=window.setTimeout(()=>{s(new V(L.TIMEOUT,"wait status timeout, status: ".concat(i)))},5e3);this.once(i,l=>{window.clearTimeout(c),l.state&&0!==l.state?s(new V(L.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(i))):o(void 0)}),this.once("dispose",()=>{window.clearTimeout(c),s(new V(L.WS_ABORT))})})}request(i){var o=this;return U(function*(){if("closed"===o.ws.state)throw new V(L.WS_DISCONNECT);"connected"!==o.ws.state&&(yield new Ie((h,g)=>{o.ws.once(ht.CLOSED,()=>g(new V(L.WS_ABORT))),o.ws.once(ht.CONNECTED,h)}));const c=o.sendMessage(i),l=new Ie((h,g)=>{const f=()=>{g(new V(L.WS_ABORT))};o.ws.once(ht.RECONNECTING,f),o.ws.once(ht.CLOSED,f),o.once("req_".concat(c),h),Ar(3e3).then(()=>{o.removeAllListeners("req_".concat(c)),o.ws.off(ht.RECONNECTING,f),o.ws.off(ht.CLOSED,f),g(new V(L.TIMEOUT,"cross channel ws request timeout"))})}),p=yield l;if(!p||200!==p.code)throw new V(L.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(p)));return p})()}connect(i){var o=this;return U(function*(){o.ws.removeAllListeners(ht.REQUEST_NEW_URLS),o.ws.on(ht.REQUEST_NEW_URLS,s=>{s(i)}),yield o.ws.init(i)})()}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(i){const o=this.requestId++;return i.requestId=o,this.ws.sendMessage(i),o}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class W3 extends En{set state(i){i!==this._state&&(i!==Zi.RELAY_STATE_FAILURE&&(this.errorCode=Tc.RELAY_OK),this.emit("state",i,this.errorCode),this._state=i)}get state(){return this._state}constructor(i,o,s,c){var l;super(),l=this,b(this,"joinInfo",void 0),b(this,"sid",void 0),b(this,"clientId",void 0),b(this,"cancelToken",es.CancelToken.source()),b(this,"workerToken",void 0),b(this,"requestId",0),b(this,"signal",void 0),b(this,"prevChannelMediaConfig",void 0),b(this,"httpRetryConfig",void 0),b(this,"_state",Zi.RELAY_STATE_IDLE),b(this,"errorCode",Tc.RELAY_OK),b(this,"onStatus",p=>{N.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(p))),p&&p.command&&("onAudioPacketReceived"===p.command&&this.emit("event",Lo.PACKET_RECEIVED_AUDIO_FROM_SRC),"onVideoPacketReceived"===p.command&&this.emit("event",Lo.PACKET_RECEIVED_VIDEO_FROM_SRC),"onSrcTokenPrivilegeDidExpire"===p.command&&(this.errorCode=Tc.SRC_TOKEN_EXPIRED,this.state=Zi.RELAY_STATE_FAILURE),"onDestTokenPrivilegeDidExpire"===p.command&&(this.errorCode=Tc.DEST_TOKEN_EXPIRED,this.state=Zi.RELAY_STATE_FAILURE))}),b(this,"onReconnect",U(function*(){N.debug("[".concat(l.clientId,"] ChannelMediaSocket disconnect, reconnecting")),l.emit("event",Lo.NETWORK_DISCONNECTED),l.state=Zi.RELAY_STATE_IDLE,l.prevChannelMediaConfig&&l.sendStartRelayMessage(l.prevChannelMediaConfig).catch(p=>{l.state!==Zi.RELAY_STATE_IDLE&&(N.error("auto restart channel media relay failed",p.toString()),l.errorCode=Tc.SERVER_CONNECTION_LOST,l.state=Zi.RELAY_STATE_FAILURE)})})),this.joinInfo=i,this.clientId=o,this.sid=Y0(),this.signal=new NY(this.joinInfo,this.clientId,s),this.httpRetryConfig=c}startChannelMediaRelay(i){var o=this;return U(function*(){if(o.state!==Zi.RELAY_STATE_IDLE)throw new V(L.INVALID_OPERATION);o.state=Zi.RELAY_STATE_CONNECTING,yield o.connect(),N.debug("[".concat(o.clientId,"] startChannelMediaRelay: connect success"));try{yield o.sendStartRelayMessage(i)}catch(s){throw s.data&&s.data.serverResponse&&"SetSourceChannel"===s.data.serverResponse.command?new V(L.CROSS_CHANNEL_FAILED_JOIN_SRC):s.data&&s.data.serverResponse&&"SetDestChannelStatus"===s.serverResponse.command?new V(L.CROSS_CHANNEL_FAILED_JOIN_DEST):s.data&&s.data.serverResponse&&"StartPacketTransfer"===s.serverResponse.command?new V(L.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):s}o.prevChannelMediaConfig=i})()}updateChannelMediaRelay(i){var o=this;return U(function*(){if(o.state!==Zi.RELAY_STATE_RUNNING)throw new V(L.INVALID_OPERATION);yield o.sendUpdateMessage(i),o.prevChannelMediaConfig=i})()}stopChannelMediaRelay(){var i=this;return U(function*(){yield i.sendStopRelayMessage(),N.debug("[".concat(i.clientId,"] stopChannelMediaRelay: send stop message success")),i.state=Zi.RELAY_STATE_IDLE,i.dispose()})()}dispose(){N.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=es.CancelToken.source(),this.state=Zi.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}connect(){var i=this;return U(function*(){const o=yield function L9(t,i,o){return JD.apply(this,arguments)}(i.joinInfo,i.cancelToken.token,i.httpRetryConfig);i.workerToken=o.workerToken,yield i.signal.connect(o.addressList),i.emit("event",Lo.NETWORK_CONNECTED),i.signal.on("status",i.onStatus),i.signal.on("reconnecting",i.onReconnect)})()}sendStartRelayMessage(i){var o=this;return U(function*(){const s=o.genMessage(vi.StopPacketTransfer);yield o.signal.request(s),yield o.signal.waitStatus("Normal Quit"),N.debug("[".concat(o.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const c=o.genMessage(vi.SetSdkProfile,i);yield o.signal.request(c),N.debug("[".concat(o.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const l=o.genMessage(vi.SetSourceChannel,i);yield o.signal.request(l),yield o.signal.waitStatus("SetSourceChannelStatus"),o.emit("event",Lo.PACKET_JOINED_SRC_CHANNEL),N.debug("[".concat(o.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const p=o.genMessage(vi.SetSourceUserId,i);yield o.signal.request(p),N.debug("[".concat(o.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const h=o.genMessage(vi.SetDestChannel,i);yield o.signal.request(h),yield o.signal.waitStatus("SetDestChannelStatus"),o.emit("event",Lo.PACKET_JOINED_DEST_CHANNEL),N.debug("[".concat(o.clientId,"] startChannelMediaRelay: SetDestChannel success"));const g=o.genMessage(vi.StartPacketTransfer,i);yield o.signal.request(g),o.emit("event",Lo.PACKET_SENT_TO_DEST_CHANNEL),o.state=Zi.RELAY_STATE_RUNNING,N.debug("[".concat(o.clientId,"] startChannelMediaRelay: StartPacketTransfer success"))})()}sendUpdateMessage(i){var o=this;return U(function*(){const s=o.genMessage(vi.UpdateDestChannel,i);yield o.signal.request(s),o.emit("event",Lo.PACKET_UPDATE_DEST_CHANNEL),N.debug("[".concat(o.clientId,"] sendUpdateMessage: UpdateDestChannel success"))})()}sendStopRelayMessage(){var i=this;return U(function*(){const o=i.genMessage(vi.StopPacketTransfer);yield i.signal.request(o),N.debug("[".concat(i.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))})()}genMessage(i,o){const s=[],c=[],l=[];this.requestId+=1;const p={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:po,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};"4.15.1"===p.sdkVersion&&(p.sdkVersion="0.0.1");let h=null,g=null;switch(i){case vi.SetSdkProfile:return p.clientRequest={command:"SetSdkProfile",type:"multi_channel"},p;case vi.SetSourceChannel:if(g=o&&o.getSrcChannelMediaInfo(),!g)throw new V(L.UNEXPECTED_ERROR,"can not find source config");return p.clientRequest={command:"SetSourceChannel",uid:"0",channelName:g.channelName,token:g.token||this.joinInfo.appId},p;case vi.SetSourceUserId:if(g=o&&o.getSrcChannelMediaInfo(),!g)throw new V(L.UNEXPECTED_ERROR,"can not find source config");return p.clientRequest={command:"SetSourceUserId",uid:g.uid+""},p;case vi.SetDestChannel:if(h=o&&o.getDestChannelMediaInfo(),!h)throw new V(L.UNEXPECTED_ERROR,"can not find dest config");return h.forEach(f=>{s.push(f.channelName),c.push(f.uid+""),l.push(f.token||this.joinInfo.appId)}),p.clientRequest={command:"SetDestChannel",channelName:s,uid:c,token:l},p;case vi.StartPacketTransfer:return p.clientRequest={command:"StartPacketTransfer"},p;case vi.Reconnect:return p.clientRequest={command:"Reconnect"},p;case vi.StopPacketTransfer:return p.clientRequest={command:"StopPacketTransfer"},p;case vi.UpdateDestChannel:if(h=o&&o.getDestChannelMediaInfo(),!h)throw new V(L.UNEXPECTED_ERROR,"can not find dest config");return h.forEach(f=>{s.push(f.channelName),c.push(f.uid+""),l.push(f.token||this.joinInfo.appId)}),p.clientRequest={command:"UpdateDestChannel",channelName:s,uid:c,token:l},p}return p}}const K3=t=>{const i=document.createElement("canvas");return i.width=2,i.height=2,new Ie((o,s)=>{i.toBlob(function(){var c=U(function*(l){if(i.remove(),l){const p=yield U9(l);o({buffer:p,width:i.width,height:i.height})}else s(new V(L.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))});return function(l){return c.apply(this,arguments)}}(),t,1)})},U9=function(){var t=U(function*(i){const o=yield i.arrayBuffer();return new Uint8Array(o)});return function(o){return t.apply(this,arguments)}}(),XD=new class extends En{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),b(this,"_lastHiddenTime",NaN),b(this,"_lastVisibleTime",NaN),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState?this._lastHiddenTime=Date.now():this._lastVisibleTime=Date.now(),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};var V9;let j9=kn("AgoraRTCPlayer","trackId")(V9=class{get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(t){t!==this._videoElementStatus&&(N.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(t)),Po("debug",["HTMLVideoElement",this.trackId],"statusChange","".concat(this._videoElementStatus," => ").concat(t)),this._videoElementStatus=t)}constructor(t){b(this,"trackId",void 0),b(this,"config",void 0),b(this,"onFirstVideoFrameDecoded",void 0),b(this,"freezeTimeCounterList",[]),b(this,"timeUpdatedCount",0),b(this,"freezeTime",0),b(this,"playbackTime",0),b(this,"lastTimeUpdatedTime",0),b(this,"autoplayFailed",!1),b(this,"videoTrack",void 0),b(this,"container",void 0),b(this,"videoElement",void 0),b(this,"videoElementCheckInterval",void 0),b(this,"_videoElementStatus",Ei.NONE),b(this,"slot",void 0),b(this,"isGettingVideoDimensions",!1),b(this,"handleVideoEvents",i=>{switch(i.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=Ei.PLAYING;break;case"loadeddata":this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded();break;case"canplay":this.videoElementStatus=Ei.CANPLAY;break;case"stalled":this.videoElementStatus=Ei.STALLED;break;case"suspend":this.videoElementStatus=Ei.SUSPEND;break;case"pause":this.videoElementStatus=Ei.PAUSED,Oo()||bl()||Di()&&this.autoplayFailed||!this.videoElement||!this.videoTrack||"live"!==this.videoTrack.readyState||(N.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),Re("debug",this,"video element paused, auto resume"),this.videoElement.play());break;case"waiting":this.videoElementStatus=Ei.WAITING;break;case"abort":this.videoElementStatus=Ei.ABORT;break;case"ended":this.videoElementStatus=Ei.ENDED;break;case"emptied":this.videoElementStatus=Ei.EMPTIED;break;case"timeupdate":{const o=Date.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=o);const s=o-this.lastTimeUpdatedTime;if("hidden"===XD.visibility)return;if(this.lastTimeUpdatedTime<XD.lastHiddenTime&&o>XD.lastVisibleTime)return void(this.lastTimeUpdatedTime=o);for(this.lastTimeUpdatedTime=o,s>500&&(this.freezeTime+=s),this.playbackTime+=s;this.playbackTime>=6e3;)this.playbackTime-=6e3,this.freezeTimeCounterList.push(Math.min(6e3,this.freezeTime)),this.freezeTime=Math.max(0,this.freezeTime-6e3);break}}}),b(this,"startGetVideoDimensions",()=>{const i=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement&&this.videoElement.videoWidth*this.videoElement.videoHeight>4)return N.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),le("debug",this,"startGetVideoDimensions",{videoWidth:this.videoElement.videoWidth,videoHeight:this.videoElement.videoHeight}),void(this.isGettingVideoDimensions=!1);setTimeout(i,500)};!this.isGettingVideoDimensions&&i()}),b(this,"autoResumeAfterInterruption",()=>{this.videoElement&&this.videoTrack&&"live"===this.videoTrack.readyState&&"running"===_t.curState&&(Du()?(N.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.2")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):mk()?(N.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.1")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):Ak()&&(N.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.0")),this.videoElement.pause(),this.videoElement.play()))}),b(this,"autoResumeAfterInterruptionOnIOS15",()=>{this.videoElement&&this.videoTrack&&"live"===this.videoTrack.readyState&&(Du()?(N.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.2")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):mk()?(N.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.1")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):Ak()&&(N.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.0")),this.videoElement.pause(),this.videoElement.play()))}),this.slot=t.element,this.trackId=t.trackId,this.updateConfig(t),_t.on(Dr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),_t.on(Dr.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15)}updateConfig(t){this.config=t,this.trackId=t.trackId;const i=t.element;i!==this.slot&&(this.destroy(),this.slot=i),this.createElements()}updateVideoTrack(t){this.videoTrack!==t&&(this.videoTrack=t,this.createElements())}play(t){if(this.videoElement){const i=this.videoElement.play();i&&i.catch&&i.catch(s=>{t&&pe.autoplayFailed(t,"video",s.message,this.trackId),le("warning",this,"play",s.toString(),"error"),"NotAllowedError"===s.name?(N.warning("detected video element autoplay failed",s),this.autoplayFailed=!0,this.handleAutoPlayFailed()):N.warning("[".concat(this.trackId,"] play warning: "),s)});const o=zt();if(("Safari"===o.name&&15===Number(o.version)||Zd())&&i&&i.then&&i.catch){const s=()=>{this.config.mirror&&this.videoElement&&(this.videoElement.style.transform="rotateY(180deg)")};i.then(s).catch(s)}}}getCurrentFrame(){if(!this.videoElement)return new ImageData(2,2);const t=document.createElement("canvas");t.width=this.videoElement.videoWidth,t.height=this.videoElement.videoHeight;const i=t.getContext("2d");if(!i)return N.error("create canvas context failed!"),le("error",this,"getCurrentFrame","create canvas context failed!","error"),new ImageData(2,2);i.drawImage(this.videoElement,0,0,t.width,t.height);const o=i.getImageData(0,0,t.width,t.height);return t.remove(),o}getCurrentFrameToUint8Array(t){var i=arguments,o=this;return U(function*(){let s=i.length>1&&void 0!==i[1]?i[1]:1;if(!o.videoElement)return yield K3(t);const c=document.createElement("canvas");c.width=o.videoElement.videoWidth,c.height=o.videoElement.videoHeight;const l=c.getContext("2d");return l?(l.drawImage(o.videoElement,0,0,c.width,c.height),new Ie((p,h)=>{c.toBlob(function(){var g=U(function*(f){if(c.remove(),f){const A=yield U9(f);p({buffer:A,width:c.width,height:c.height})}else h(new V(L.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))});return function(f){return g.apply(this,arguments)}}(),t,s<0?.1:s>1?1:s)})):yield K3(t)})()}destroy(){if(_t.off(Dr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),_t.off(Dr.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15),this.videoElement&&(this.videoElement.srcObject=null,this.videoElement.remove(),this.videoElement=void 0),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}this.freezeTimeCounterList=[]}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",this.createVideoElement(),this.container.appendChild(this.videoElement)):this.removeVideoElement(),this.slot.appendChild(this.container)}createVideoElement(){this.videoElement||(this.videoElementStatus=Ei.INIT,this.videoElement=document.createElement("video"),this.videoElement.onerror=()=>this.videoElementStatus=Ei.ERROR,this.container&&this.container.appendChild(this.videoElement),Q9.forEach(o=>{this.videoElement&&this.videoElement.addEventListener(o,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{!document.getElementById("video_".concat(this.trackId))&&this.videoElement&&(this.videoElementStatus=Ei.DESTROYED)},1e3)),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),this.videoElement.style.left="0",this.videoElement.style.top="0",Zb()&&(this.videoElement.poster="noposter");const t=zt();"Safari"===t.name&&15===Number(t.version)||Zd()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.videoElement.style.objectFit=this.config.fit?this.config.fit:"cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,bn()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,bn()&&this.videoElement.load());const i=this.videoElement.play();void 0!==i&&i.catch(o=>{N.debug("[".concat(this.trackId,"] playback interrupted"),o.toString()),Re("debug",this,"play back interrupted: ".concat(o.toString()))})}removeVideoElement(){if(this.videoElement){Q9.forEach(t=>{this.videoElement&&this.videoElement.removeEventListener(t,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0);try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=void 0,this.videoElementStatus=Ei.NONE}}handleAutoPlayFailed(){if(this.videoElement){const t=i=>{i.preventDefault(),this.videoElement&&(this.videoElement.play().then(()=>{N.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed.")),Re("debug",this,"video element autoplay resumed")}).catch(o=>{N.error(o)}),this.autoplayFailed=!1,$A()?document.body.removeEventListener("click",t,!0):(document.body.removeEventListener("touchstart",t,!0),document.body.removeEventListener("mousedown",t,!0)))};$A()?document.body.addEventListener("click",t,!0):(document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)),VQ()}}getVideoElement(){return this.videoElement}getContainerElement(){return this.container}})||V9;const Q9=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate"];var H9,G9={exports:{}};function OY(t,i,o){const s=t.createShader(o);if(!s)return new V(L.WEBGL_INTERNAL_ERROR,"can not create shader").throw();if(t.shaderSource(s,i),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS)){const c=t.getShaderInfoLog(s);return t.deleteShader(s),new V(L.WEBGL_INTERNAL_ERROR,"error compiling shader:"+c).throw()}return s}(function(t,i){var o;o=()=>(()=>{var s={3536:(h,g,f)=>{var A=f(1910);h.exports=A},8171:(h,g,f)=>{f(6450);var A=f(4058).Object,_=h.exports=function(v,y,S){return A.defineProperty(v,y,S)};A.defineProperty.sham&&(_.sham=!0)},2956:(h,g,f)=>{f(7627),f(6274),f(5967),f(8881),f(4560),f(7206),f(4349),f(7971);var A=f(4058);h.exports=A.Promise},3685:(h,g,f)=>{h.exports=f(621)},621:(h,g,f)=>{var A=f(3536);h.exports=A},4883:(h,g,f)=>{var A=f(7475),_=f(9826),v=TypeError;h.exports=function(y){if(A(y))return y;throw v(_(y)+" is not a function")}},174:(h,g,f)=>{var A=f(4284),_=f(9826),v=TypeError;h.exports=function(y){if(A(y))return y;throw v(_(y)+" is not a constructor")}},1851:(h,g,f)=>{var A=f(7475),_=String,v=TypeError;h.exports=function(y){if("object"==typeof y||A(y))return y;throw v("Can't set "+_(y)+" as a prototype")}},8479:h=>{h.exports=function(){}},5743:(h,g,f)=>{var A=f(7046),_=TypeError;h.exports=function(v,y){if(A(y,v))return v;throw _("Incorrect invocation")}},6059:(h,g,f)=>{var A=f(941),_=String,v=TypeError;h.exports=function(y){if(A(y))return y;throw v(_(y)+" is not an object")}},1692:(h,g,f)=>{var A=f(4529),_=f(9413),v=f(623),y=function(S){return function(R,D,O){var P,B=A(R),G=v(B),Y=_(O,G);if(S&&D!=D){for(;G>Y;)if((P=B[Y++])!=P)return!0}else for(;G>Y;Y++)if((S||Y in B)&&B[Y]===D)return S||Y||0;return!S&&-1}};h.exports={includes:y(!0),indexOf:y(!1)}},3765:(h,g,f)=>{var A=f(5329);h.exports=A([].slice)},1385:(h,g,f)=>{var A=f(9813)("iterator"),_=!1;try{var v=0,y={next:function(){return{done:!!v++}},return:function(){_=!0}};y[A]=function(){return this},Array.from(y,function(){throw 2})}catch{}h.exports=function(S,R){if(!R&&!_)return!1;var D=!1;try{var O={};O[A]=function(){return{next:function(){return{done:D=!0}}}},S(O)}catch{}return D}},2532:(h,g,f)=>{var A=f(4163),_=A({}.toString),v=A("".slice);h.exports=function(y){return v(_(y),8,-1)}},9697:(h,g,f)=>{var A=f(2885),_=f(7475),v=f(2532),y=f(9813)("toStringTag"),S=Object,R="Arguments"==v(function(){return arguments}());h.exports=A?v:function(D){var O,P,B;return void 0===D?"Undefined":null===D?"Null":"string"==typeof(P=function(G,Y){try{return G[Y]}catch{}}(O=S(D),y))?P:R?v(O):"Object"==(B=v(O))&&_(O.callee)?"Arguments":B}},3489:(h,g,f)=>{var A=f(953),_=f(1136),v=f(9677),y=f(5988);h.exports=function(S,R,D){for(var O=_(R),P=y.f,B=v.f,G=0;G<O.length;G++){var Y=O[G];A(S,Y)||D&&A(D,Y)||P(S,Y,B(R,Y))}}},4160:(h,g,f)=>{var A=f(5981);h.exports=!A(function(){function _(){}return _.prototype.constructor=null,Object.getPrototypeOf(new _)!==_.prototype})},3538:h=>{h.exports=function(g,f){return{value:g,done:f}}},2029:(h,g,f)=>{var A=f(5746),_=f(5988),v=f(1887);h.exports=A?function(y,S,R){return _.f(y,S,v(1,R))}:function(y,S,R){return y[S]=R,y}},1887:h=>{h.exports=function(g,f){return{enumerable:!(1&g),configurable:!(2&g),writable:!(4&g),value:f}}},5929:(h,g,f)=>{var A=f(2029);h.exports=function(_,v,y,S){return S&&S.enumerable?_[v]=y:A(_,v,y),_}},5609:(h,g,f)=>{var A=f(1899),_=Object.defineProperty;h.exports=function(v,y){try{_(A,v,{value:y,configurable:!0,writable:!0})}catch{A[v]=y}return y}},5746:(h,g,f)=>{var A=f(5981);h.exports=!A(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})},6616:h=>{var g="object"==typeof document&&document.all;h.exports={all:g,IS_HTMLDDA:void 0===g&&void 0!==g}},1333:(h,g,f)=>{var A=f(1899),_=f(941),v=A.document,y=_(v)&&_(v.createElement);h.exports=function(S){return y?v.createElement(S):{}}},3281:h=>{h.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3321:(h,g,f)=>{var A=f(8501),_=f(6049);h.exports=!A&&!_&&"object"==typeof window&&"object"==typeof document},8501:h=>{h.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},4470:(h,g,f)=>{var A=f(2861),_=f(1899);h.exports=/ipad|iphone|ipod/i.test(A)&&void 0!==_.Pebble},2749:(h,g,f)=>{var A=f(2861);h.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(A)},6049:(h,g,f)=>{var A=f(2532),_=f(1899);h.exports="process"==A(_.process)},8045:(h,g,f)=>{var A=f(2861);h.exports=/web0s(?!.*chrome)/i.test(A)},2861:(h,g,f)=>{var A=f(626);h.exports=A("navigator","userAgent")||""},3385:(h,g,f)=>{var A,_,v=f(1899),y=f(2861),S=v.process,R=v.Deno,D=S&&S.versions||R&&R.version,O=D&&D.v8;O&&(_=(A=O.split("."))[0]>0&&A[0]<4?1:+(A[0]+A[1])),!_&&y&&(!(A=y.match(/Edge\/(\d+)/))||A[1]>=74)&&(A=y.match(/Chrome\/(\d+)/))&&(_=+A[1]),h.exports=_},6759:h=>{h.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3995:(h,g,f)=>{var A=f(5329),_=Error,v=A("".replace),y=String(_("zxcasd").stack),S=/\n\s*at [^:]*:[^\n]*/,R=S.test(y);h.exports=function(D,O){if(R&&"string"==typeof D&&!_.prepareStackTrace)for(;O--;)D=v(D,S,"");return D}},8780:(h,g,f)=>{var A=f(5981),_=f(1887);h.exports=!A(function(){var v=Error("a");return!("stack"in v)||(Object.defineProperty(v,"stack",_(1,7)),7!==v.stack)})},6887:(h,g,f)=>{var A=f(1899),_=f(9730),v=f(5329),y=f(7475),S=f(9677).f,R=f(7252),D=f(4058),O=f(6843),P=f(2029),B=f(953),G=function(Y){var ae=function(te,Z,_e){if(this instanceof ae){switch(arguments.length){case 0:return new Y;case 1:return new Y(te);case 2:return new Y(te,Z)}return new Y(te,Z,_e)}return _(Y,this,arguments)};return ae.prototype=Y.prototype,ae};h.exports=function(Y,ae){var te,Z,_e,fe,Se,Oe,Ye,Ee,z=Y.target,ee=Y.global,Q=Y.stat,K=Y.proto,ne=ee?A:Q?A[z]:(A[z]||{}).prototype,me=ee?D:D[z]||P(D,z,{})[z],Ne=me.prototype;for(_e in ae)te=!R(ee?_e:z+(Q?".":"#")+_e,Y.forced)&&ne&&B(ne,_e),Se=me[_e],te&&(Oe=Y.dontCallGetSet?(Ee=S(ne,_e))&&Ee.value:ne[_e]),fe=te&&Oe?Oe:ae[_e],te&&typeof Se==typeof fe||(Ye=Y.bind&&te?O(fe,A):Y.wrap&&te?G(fe):K&&y(fe)?v(fe):fe,(Y.sham||fe&&fe.sham||Se&&Se.sham)&&P(Ye,"sham",!0),P(me,_e,Ye),K&&(B(D,Z=z+"Prototype")||P(D,Z,{}),P(D[Z],_e,fe),Y.real&&Ne&&!Ne[_e]&&P(Ne,_e,fe)))}},5981:h=>{h.exports=function(g){try{return!!g()}catch{return!0}}},9730:(h,g,f)=>{var A=f(8285),_=Function.prototype,v=_.apply,y=_.call;h.exports="object"==typeof Reflect&&Reflect.apply||(A?y.bind(v):function(){return y.apply(v,arguments)})},6843:(h,g,f)=>{var A=f(5329),_=f(4883),v=f(8285),y=A(A.bind);h.exports=function(S,R){return _(S),void 0===R?S:v?y(S,R):function(){return S.apply(R,arguments)}}},8285:(h,g,f)=>{var A=f(5981);h.exports=!A(function(){var _=function(){}.bind();return"function"!=typeof _||_.hasOwnProperty("prototype")})},8834:(h,g,f)=>{var A=f(8285),_=Function.prototype.call;h.exports=A?_.bind(_):function(){return _.apply(_,arguments)}},9417:(h,g,f)=>{var A=f(5746),_=f(953),v=Function.prototype,y=A&&Object.getOwnPropertyDescriptor,S=_(v,"name"),R=S&&"something"===function(){}.name,D=S&&(!A||A&&y(v,"name").configurable);h.exports={EXISTS:S,PROPER:R,CONFIGURABLE:D}},4163:(h,g,f)=>{var A=f(8285),_=Function.prototype,v=_.call,y=A&&_.bind.bind(v,v);h.exports=A?y:function(S){return function(){return v.apply(S,arguments)}}},5329:(h,g,f)=>{var A=f(2532),_=f(4163);h.exports=function(v){if("Function"===A(v))return _(v)}},626:(h,g,f)=>{var A=f(4058),_=f(1899),v=f(7475),y=function(S){return v(S)?S:void 0};h.exports=function(S,R){return arguments.length<2?y(A[S])||y(_[S]):A[S]&&A[S][R]||_[S]&&_[S][R]}},2902:(h,g,f)=>{var A=f(9697),_=f(4229),v=f(2119),y=f(2077),S=f(9813)("iterator");h.exports=function(R){if(!v(R))return _(R,S)||_(R,"@@iterator")||y[A(R)]}},3476:(h,g,f)=>{var A=f(8834),_=f(4883),v=f(6059),y=f(9826),S=f(2902),R=TypeError;h.exports=function(D,O){var P=arguments.length<2?S(D):O;if(_(P))return v(A(P,D));throw R(y(D)+" is not iterable")}},4229:(h,g,f)=>{var A=f(4883),_=f(2119);h.exports=function(v,y){var S=v[y];return _(S)?void 0:A(S)}},1899:(h,g,f)=>{var A=function(_){return _&&_.Math==Math&&_};h.exports=A("object"==typeof globalThis&&globalThis)||A("object"==typeof window&&window)||A("object"==typeof self&&self)||A("object"==typeof f.g&&f.g)||function(){return this}()||Function("return this")()},953:(h,g,f)=>{var A=f(5329),_=f(9678),v=A({}.hasOwnProperty);h.exports=Object.hasOwn||function(y,S){return v(_(y),S)}},7748:h=>{h.exports={}},4845:(h,g,f)=>{var A=f(1899);h.exports=function(_,v){var y=A.console;y&&y.error&&(1==arguments.length?y.error(_):y.error(_,v))}},5463:(h,g,f)=>{var A=f(626);h.exports=A("document","documentElement")},2840:(h,g,f)=>{var A=f(5746),_=f(5981),v=f(1333);h.exports=!A&&!_(function(){return 7!=Object.defineProperty(v("div"),"a",{get:function(){return 7}}).a})},7026:(h,g,f)=>{var A=f(5329),_=f(5981),v=f(2532),y=Object,S=A("".split);h.exports=_(function(){return!y("z").propertyIsEnumerable(0)})?function(R){return"String"==v(R)?S(R,""):y(R)}:y},1302:(h,g,f)=>{var A=f(5329),_=f(7475),v=f(3030),y=A(Function.toString);_(v.inspectSource)||(v.inspectSource=function(S){return y(S)}),h.exports=v.inspectSource},3794:(h,g,f)=>{var A=f(941),_=f(2029);h.exports=function(v,y){A(y)&&"cause"in y&&_(v,"cause",y.cause)}},5402:(h,g,f)=>{var A,_,v,y=f(7093),S=f(1899),R=f(941),D=f(2029),O=f(953),P=f(3030),B=f(4262),G=f(7748),Y="Object already initialized",ae=S.TypeError;if(y||P.state){var Z=P.state||(P.state=new(0,S.WeakMap));Z.get=Z.get,Z.has=Z.has,Z.set=Z.set,A=function(fe,Se){if(Z.has(fe))throw ae(Y);return Se.facade=fe,Z.set(fe,Se),Se},_=function(fe){return Z.get(fe)||{}},v=function(fe){return Z.has(fe)}}else{var _e=B("state");G[_e]=!0,A=function(fe,Se){if(O(fe,_e))throw ae(Y);return Se.facade=fe,D(fe,_e,Se),Se},_=function(fe){return O(fe,_e)?fe[_e]:{}},v=function(fe){return O(fe,_e)}}h.exports={set:A,get:_,has:v,enforce:function(fe){return v(fe)?_(fe):A(fe,{})},getterFor:function(fe){return function(Se){var Oe;if(!R(Se)||(Oe=_(Se)).type!==fe)throw ae("Incompatible receiver, "+fe+" required");return Oe}}}},6782:(h,g,f)=>{var A=f(9813),_=f(2077),v=A("iterator"),y=Array.prototype;h.exports=function(S){return void 0!==S&&(_.Array===S||y[v]===S)}},7475:(h,g,f)=>{var A=f(6616),_=A.all;h.exports=A.IS_HTMLDDA?function(v){return"function"==typeof v||v===_}:function(v){return"function"==typeof v}},4284:(h,g,f)=>{var A=f(5329),_=f(5981),v=f(7475),y=f(9697),S=f(626),R=f(1302),D=function(){},O=[],P=S("Reflect","construct"),B=/^\s*(?:class|function)\b/,G=A(B.exec),Y=!B.exec(D),ae=function(Z){if(!v(Z))return!1;try{return P(D,O,Z),!0}catch{return!1}},te=function(Z){if(!v(Z))return!1;switch(y(Z)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Y||!!G(B,R(Z))}catch{return!0}};te.sham=!0,h.exports=!P||_(function(){var Z;return ae(ae.call)||!ae(Object)||!ae(function(){Z=!0})||Z})?te:ae},7252:(h,g,f)=>{var A=f(5981),_=f(7475),v=/#|\.prototype\./,y=function(P,B){var G=R[S(P)];return G==O||G!=D&&(_(B)?A(B):!!B)},S=y.normalize=function(P){return String(P).replace(v,".").toLowerCase()},R=y.data={},D=y.NATIVE="N",O=y.POLYFILL="P";h.exports=y},2119:h=>{h.exports=function(g){return null==g}},941:(h,g,f)=>{var A=f(7475),_=f(6616),v=_.all;h.exports=_.IS_HTMLDDA?function(y){return"object"==typeof y?null!==y:A(y)||y===v}:function(y){return"object"==typeof y?null!==y:A(y)}},2529:h=>{h.exports=!0},6664:(h,g,f)=>{var A=f(626),_=f(7475),v=f(7046),y=f(2302),S=Object;h.exports=y?function(R){return"symbol"==typeof R}:function(R){var D=A("Symbol");return _(D)&&v(D.prototype,S(R))}},3091:(h,g,f)=>{var A=f(6843),_=f(8834),v=f(6059),y=f(9826),S=f(6782),R=f(623),D=f(7046),O=f(3476),P=f(2902),B=f(7609),G=TypeError,Y=function(te,Z){this.stopped=te,this.result=Z},ae=Y.prototype;h.exports=function(te,Z,_e){var fe,Se,Oe,Ye,Ee,z,ee,K=!(!_e||!_e.AS_ENTRIES),ne=!(!_e||!_e.IS_RECORD),me=!(!_e||!_e.IS_ITERATOR),Ne=!(!_e||!_e.INTERRUPTED),ce=A(Z,_e&&_e.that),T=function(j){return fe&&B(fe,"normal",j),new Y(!0,j)},k=function(j){return K?(v(j),Ne?ce(j[0],j[1],T):ce(j[0],j[1])):Ne?ce(j,T):ce(j)};if(ne)fe=te.iterator;else if(me)fe=te;else{if(!(Se=P(te)))throw G(y(te)+" is not iterable");if(S(Se)){for(Oe=0,Ye=R(te);Ye>Oe;Oe++)if((Ee=k(te[Oe]))&&D(ae,Ee))return Ee;return new Y(!1)}fe=O(te,Se)}for(z=ne?te.next:fe.next;!(ee=_(z,fe)).done;){try{Ee=k(ee.value)}catch(j){B(fe,"throw",j)}if("object"==typeof Ee&&Ee&&D(ae,Ee))return Ee}return new Y(!1)}},7609:(h,g,f)=>{var A=f(8834),_=f(6059),v=f(4229);h.exports=function(y,S,R){var D,O;_(y);try{if(!(D=v(y,"return"))){if("throw"===S)throw R;return R}D=A(D,y)}catch(P){O=!0,D=P}if("throw"===S)throw R;if(O)throw D;return _(D),R}},3847:(h,g,f)=>{var A=f(5143).IteratorPrototype,_=f(9290),v=f(1887),y=f(904),S=f(2077),R=function(){return this};h.exports=function(D,O,P,B){var G=O+" Iterator";return D.prototype=_(A,{next:v(+!B,P)}),y(D,G,!1,!0),S[G]=R,D}},5105:(h,g,f)=>{var A=f(6887),_=f(8834),v=f(2529),y=f(9417),S=f(7475),R=f(3847),D=f(249),O=f(8929),P=f(904),B=f(2029),G=f(5929),Y=f(9813),ae=f(2077),te=f(5143),Z=y.PROPER,_e=y.CONFIGURABLE,fe=te.IteratorPrototype,Se=te.BUGGY_SAFARI_ITERATORS,Oe=Y("iterator"),Ee="values",z="entries",ee=function(){return this};h.exports=function(Q,K,ne,me,Ne,ce,T){R(ne,K,me);var k,j,re,be=function(et){if(et===Ne&&vt)return vt;if(!Se&&et in at)return at[et];switch(et){case"keys":case Ee:case z:return function(){return new ne(this,et)}}return function(){return new ne(this)}},dt=K+" Iterator",St=!1,at=Q.prototype,sn=at[Oe]||at["@@iterator"]||Ne&&at[Ne],vt=!Se&&sn||be(Ne),Xt="Array"==K&&at.entries||sn;if(Xt&&(k=D(Xt.call(new Q)))!==Object.prototype&&k.next&&(v||D(k)===fe||(O?O(k,fe):S(k[Oe])||G(k,Oe,ee)),P(k,dt,!0,!0),v&&(ae[dt]=ee)),Z&&Ne==Ee&&sn&&sn.name!==Ee&&(!v&&_e?B(at,"name",Ee):(St=!0,vt=function(){return _(sn,this)})),Ne)if(j={values:be(Ee),keys:ce?vt:be("keys"),entries:be(z)},T)for(re in j)(Se||St||!(re in at))&&G(at,re,j[re]);else A({target:K,proto:!0,forced:Se||St},j);return v&&!T||at[Oe]===vt||G(at,Oe,vt,{name:Ne}),ae[K]=vt,j}},5143:(h,g,f)=>{var A,_,v,y=f(5981),S=f(7475),R=f(941),D=f(9290),O=f(249),P=f(5929),B=f(9813),G=f(2529),Y=B("iterator"),ae=!1;[].keys&&("next"in(v=[].keys())?(_=O(O(v)))!==Object.prototype&&(A=_):ae=!0),!R(A)||y(function(){var te={};return A[Y].call(te)!==te})?A={}:G&&(A=D(A)),S(A[Y])||P(A,Y,function(){return this}),h.exports={IteratorPrototype:A,BUGGY_SAFARI_ITERATORS:ae}},2077:h=>{h.exports={}},623:(h,g,f)=>{var A=f(3057);h.exports=function(_){return A(_.length)}},5331:h=>{var g=Math.ceil,f=Math.floor;h.exports=Math.trunc||function(A){var _=+A;return(_>0?f:g)(_)}},6132:(h,g,f)=>{var A,_,v,y,S,R,D,O,P=f(1899),B=f(6843),G=f(9677).f,Y=f(2941).set,ae=f(2749),te=f(4470),Z=f(8045),_e=f(6049),fe=P.MutationObserver||P.WebKitMutationObserver,Se=P.document,Oe=P.process,Ye=P.Promise,Ee=G(P,"queueMicrotask"),z=Ee&&Ee.value;z||(A=function(){var ee,Q;for(_e&&(ee=Oe.domain)&&ee.exit();_;){Q=_.fn,_=_.next;try{Q()}catch(K){throw _?y():v=void 0,K}}v=void 0,ee&&ee.enter()},ae||_e||Z||!fe||!Se?!te&&Ye&&Ye.resolve?((D=Ye.resolve(void 0)).constructor=Ye,O=B(D.then,D),y=function(){O(A)}):_e?y=function(){Oe.nextTick(A)}:(Y=B(Y,P),y=function(){Y(A)}):(S=!0,R=Se.createTextNode(""),new fe(A).observe(R,{characterData:!0}),y=function(){R.data=S=!S})),h.exports=z||function(ee){var Q={fn:ee,next:void 0};v&&(v.next=Q),_||(_=Q,y()),v=Q}},9520:(h,g,f)=>{var A=f(4883),_=TypeError,v=function(y){var S,R;this.promise=new y(function(D,O){if(void 0!==S||void 0!==R)throw _("Bad Promise constructor");S=D,R=O}),this.resolve=A(S),this.reject=A(R)};h.exports.f=function(y){return new v(y)}},4649:(h,g,f)=>{var A=f(5803);h.exports=function(_,v){return void 0===_?arguments.length<2?"":v:A(_)}},9290:(h,g,f)=>{var A,_=f(6059),v=f(9938),y=f(6759),S=f(7748),R=f(5463),D=f(1333),O=f(4262)("IE_PROTO"),P=function(){},B=function(ae){return"<script>"+ae+"<\/script>"},G=function(ae){ae.write(B("")),ae.close();var te=ae.parentWindow.Object;return ae=null,te},Y=function(){try{A=new ActiveXObject("htmlfile")}catch{}var ae,te;Y=typeof document<"u"?document.domain&&A?G(A):((te=D("iframe")).style.display="none",R.appendChild(te),te.src=String("javascript:"),(ae=te.contentWindow.document).open(),ae.write(B("document.F=Object")),ae.close(),ae.F):G(A);for(var Z=y.length;Z--;)delete Y.prototype[y[Z]];return Y()};S[O]=!0,h.exports=Object.create||function(ae,te){var Z;return null!==ae?(P.prototype=_(ae),Z=new P,P.prototype=null,Z[O]=ae):Z=Y(),void 0===te?Z:v.f(Z,te)}},9938:(h,g,f)=>{var A=f(5746),_=f(3937),v=f(5988),y=f(6059),S=f(4529),R=f(4771);g.f=A&&!_?Object.defineProperties:function(D,O){y(D);for(var P,B=S(O),G=R(O),Y=G.length,ae=0;Y>ae;)v.f(D,P=G[ae++],B[P]);return D}},5988:(h,g,f)=>{var A=f(5746),_=f(2840),v=f(3937),y=f(6059),S=f(3894),R=TypeError,D=Object.defineProperty,O=Object.getOwnPropertyDescriptor;g.f=A?v?function(P,B,G){if(y(P),B=S(B),y(G),"function"==typeof P&&"prototype"===B&&"value"in G&&"writable"in G&&!G.writable){var Y=O(P,B);Y&&Y.writable&&(P[B]=G.value,G={configurable:"configurable"in G?G.configurable:Y.configurable,enumerable:"enumerable"in G?G.enumerable:Y.enumerable,writable:!1})}return D(P,B,G)}:D:function(P,B,G){if(y(P),B=S(B),y(G),_)try{return D(P,B,G)}catch{}if("get"in G||"set"in G)throw R("Accessors not supported");return"value"in G&&(P[B]=G.value),P}},9677:(h,g,f)=>{var A=f(5746),_=f(8834),v=f(6760),y=f(1887),S=f(4529),R=f(3894),D=f(953),O=f(2840),P=Object.getOwnPropertyDescriptor;g.f=A?P:function(B,G){if(B=S(B),G=R(G),O)try{return P(B,G)}catch{}if(D(B,G))return y(!_(v.f,B,G),B[G])}},946:(h,g,f)=>{var A=f(5629),_=f(6759).concat("length","prototype");g.f=Object.getOwnPropertyNames||function(v){return A(v,_)}},7857:(h,g)=>{g.f=Object.getOwnPropertySymbols},249:(h,g,f)=>{var A=f(953),_=f(7475),v=f(9678),y=f(4262),S=f(4160),R=y("IE_PROTO"),D=Object,O=D.prototype;h.exports=S?D.getPrototypeOf:function(P){var B=v(P);if(A(B,R))return B[R];var G=B.constructor;return _(G)&&B instanceof G?G.prototype:B instanceof D?O:null}},7046:(h,g,f)=>{var A=f(5329);h.exports=A({}.isPrototypeOf)},5629:(h,g,f)=>{var A=f(5329),_=f(953),v=f(4529),y=f(1692).indexOf,S=f(7748),R=A([].push);h.exports=function(D,O){var P,B=v(D),G=0,Y=[];for(P in B)!_(S,P)&&_(B,P)&&R(Y,P);for(;O.length>G;)_(B,P=O[G++])&&(~y(Y,P)||R(Y,P));return Y}},4771:(h,g,f)=>{var A=f(5629),_=f(6759);h.exports=Object.keys||function(v){return A(v,_)}},6760:(h,g)=>{var f={}.propertyIsEnumerable,A=Object.getOwnPropertyDescriptor,_=A&&!f.call({1:2},1);g.f=_?function(v){var y=A(this,v);return!!y&&y.enumerable}:f},8929:(h,g,f)=>{var A=f(5329),_=f(6059),v=f(1851);h.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var y,S=!1,R={};try{(y=A(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(R,[]),S=R instanceof Array}catch{}return function(D,O){return _(D),v(O),S?y(D,O):D.__proto__=O,D}}():void 0)},5623:(h,g,f)=>{var A=f(2885),_=f(9697);h.exports=A?{}.toString:function(){return"[object "+_(this)+"]"}},9811:(h,g,f)=>{var A=f(8834),_=f(7475),v=f(941),y=TypeError;h.exports=function(S,R){var D,O;if("string"===R&&_(D=S.toString)&&!v(O=A(D,S))||_(D=S.valueOf)&&!v(O=A(D,S))||"string"!==R&&_(D=S.toString)&&!v(O=A(D,S)))return O;throw y("Can't convert object to primitive value")}},1136:(h,g,f)=>{var A=f(626),_=f(5329),v=f(946),y=f(7857),S=f(6059),R=_([].concat);h.exports=A("Reflect","ownKeys")||function(D){var O=v.f(S(D)),P=y.f;return P?R(O,P(D)):O}},4058:h=>{h.exports={}},2:h=>{h.exports=function(g){try{return{error:!1,value:g()}}catch(f){return{error:!0,value:f}}}},7742:(h,g,f)=>{var A=f(1899),_=f(6991),v=f(7475),y=f(7252),S=f(1302),R=f(9813),D=f(3321),O=f(8501),P=f(2529),B=f(3385),G=_&&_.prototype,Y=R("species"),ae=!1,te=v(A.PromiseRejectionEvent),Z=y("Promise",function(){var _e=S(_),fe=_e!==String(_);if(!fe&&66===B||P&&(!G.catch||!G.finally))return!0;if(!B||B<51||!/native code/.test(_e)){var Se=new _(function(Ye){Ye(1)}),Oe=function(Ye){Ye(function(){},function(){})};if((Se.constructor={})[Y]=Oe,!(ae=Se.then(function(){})instanceof Oe))return!0}return!fe&&(D||O)&&!te});h.exports={CONSTRUCTOR:Z,REJECTION_EVENT:te,SUBCLASSING:ae}},6991:(h,g,f)=>{var A=f(1899);h.exports=A.Promise},6584:(h,g,f)=>{var A=f(6059),_=f(941),v=f(9520);h.exports=function(y,S){if(A(y),_(S)&&S.constructor===y)return S;var R=v.f(y);return(0,R.resolve)(S),R.promise}},1542:(h,g,f)=>{var A=f(6991),_=f(1385),v=f(7742).CONSTRUCTOR;h.exports=v||!_(function(y){A.all(y).then(void 0,function(){})})},8397:h=>{var g=function(){this.head=null,this.tail=null};g.prototype={add:function(f){var A={item:f,next:null};this.head?this.tail.next=A:this.head=A,this.tail=A},get:function(){var f=this.head;if(f)return this.head=f.next,this.tail===f&&(this.tail=null),f.item}},h.exports=g},8219:(h,g,f)=>{var A=f(2119),_=TypeError;h.exports=function(v){if(A(v))throw _("Can't call method on "+v);return v}},4431:(h,g,f)=>{var A=f(626),_=f(5988),v=f(9813),y=f(5746),S=v("species");h.exports=function(R){var D=A(R);y&&D&&!D[S]&&(0,_.f)(D,S,{configurable:!0,get:function(){return this}})}},904:(h,g,f)=>{var A=f(2885),_=f(5988).f,v=f(2029),y=f(953),S=f(5623),R=f(9813)("toStringTag");h.exports=function(D,O,P,B){if(D){var G=P?D:D.prototype;y(G,R)||_(G,R,{configurable:!0,value:O}),B&&!A&&v(G,"toString",S)}}},4262:(h,g,f)=>{var A=f(8726),_=f(9418),v=A("keys");h.exports=function(y){return v[y]||(v[y]=_(y))}},3030:(h,g,f)=>{var A=f(1899),_=f(5609),v="__core-js_shared__",y=A[v]||_(v,{});h.exports=y},8726:(h,g,f)=>{var A=f(2529),_=f(3030);(h.exports=function(v,y){return _[v]||(_[v]=void 0!==y?y:{})})("versions",[]).push({version:"3.26.0",mode:A?"pure":"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.0/LICENSE",source:"https://github.com/zloirock/core-js"})},487:(h,g,f)=>{var A=f(6059),_=f(174),v=f(2119),y=f(9813)("species");h.exports=function(S,R){var D,O=A(S).constructor;return void 0===O||v(D=A(O)[y])?R:_(D)}},4620:(h,g,f)=>{var A=f(5329),_=f(2435),v=f(5803),y=f(8219),S=A("".charAt),R=A("".charCodeAt),D=A("".slice),O=function(P){return function(B,G){var Y,ae,te=v(y(B)),Z=_(G),_e=te.length;return Z<0||Z>=_e?P?"":void 0:(Y=R(te,Z))<55296||Y>56319||Z+1===_e||(ae=R(te,Z+1))<56320||ae>57343?P?S(te,Z):Y:P?D(te,Z,Z+2):ae-56320+(Y-55296<<10)+65536}};h.exports={codeAt:O(!1),charAt:O(!0)}},3405:(h,g,f)=>{var A=f(3385),_=f(5981);h.exports=!!Object.getOwnPropertySymbols&&!_(function(){var v=Symbol();return!String(v)||!(Object(v)instanceof Symbol)||!Symbol.sham&&A&&A<41})},2941:(h,g,f)=>{var A,_,v,y,S=f(1899),R=f(9730),D=f(6843),O=f(7475),P=f(953),B=f(5981),G=f(5463),Y=f(3765),ae=f(1333),te=f(8348),Z=f(2749),_e=f(6049),fe=S.setImmediate,Se=S.clearImmediate,Oe=S.process,Ye=S.Dispatch,Ee=S.Function,z=S.MessageChannel,ee=S.String,Q=0,K={};try{A=S.location}catch{}var ne=function(T){if(P(K,T)){var k=K[T];delete K[T],k()}},me=function(T){return function(){ne(T)}},Ne=function(T){ne(T.data)},ce=function(T){S.postMessage(ee(T),A.protocol+"//"+A.host)};fe&&Se||(fe=function(T){te(arguments.length,1);var k=O(T)?T:Ee(T),j=Y(arguments,1);return K[++Q]=function(){R(k,void 0,j)},_(Q),Q},Se=function(T){delete K[T]},_e?_=function(T){Oe.nextTick(me(T))}:Ye&&Ye.now?_=function(T){Ye.now(me(T))}:z&&!Z?(y=(v=new z).port2,v.port1.onmessage=Ne,_=D(y.postMessage,y)):S.addEventListener&&O(S.postMessage)&&!S.importScripts&&A&&"file:"!==A.protocol&&!B(ce)?(_=ce,S.addEventListener("message",Ne,!1)):_="onreadystatechange"in ae("script")?function(T){G.appendChild(ae("script")).onreadystatechange=function(){G.removeChild(this),ne(T)}}:function(T){setTimeout(me(T),0)}),h.exports={set:fe,clear:Se}},9413:(h,g,f)=>{var A=f(2435),_=Math.max,v=Math.min;h.exports=function(y,S){var R=A(y);return R<0?_(R+S,0):v(R,S)}},4529:(h,g,f)=>{var A=f(7026),_=f(8219);h.exports=function(v){return A(_(v))}},2435:(h,g,f)=>{var A=f(5331);h.exports=function(_){var v=+_;return v!=v||0===v?0:A(v)}},3057:(h,g,f)=>{var A=f(2435),_=Math.min;h.exports=function(v){return v>0?_(A(v),9007199254740991):0}},9678:(h,g,f)=>{var A=f(8219),_=Object;h.exports=function(v){return _(A(v))}},6935:(h,g,f)=>{var A=f(8834),_=f(941),v=f(6664),y=f(4229),S=f(9811),R=f(9813),D=TypeError,O=R("toPrimitive");h.exports=function(P,B){if(!_(P)||v(P))return P;var G,Y=y(P,O);if(Y){if(void 0===B&&(B="default"),G=A(Y,P,B),!_(G)||v(G))return G;throw D("Can't convert object to primitive value")}return void 0===B&&(B="number"),S(P,B)}},3894:(h,g,f)=>{var A=f(6935),_=f(6664);h.exports=function(v){var y=A(v,"string");return _(y)?y:y+""}},2885:(h,g,f)=>{var A={};A[f(9813)("toStringTag")]="z",h.exports="[object z]"===String(A)},5803:(h,g,f)=>{var A=f(9697),_=String;h.exports=function(v){if("Symbol"===A(v))throw TypeError("Cannot convert a Symbol value to a string");return _(v)}},9826:h=>{var g=String;h.exports=function(f){try{return g(f)}catch{return"Object"}}},9418:(h,g,f)=>{var A=f(5329),_=0,v=Math.random(),y=A(1..toString);h.exports=function(S){return"Symbol("+(void 0===S?"":S)+")_"+y(++_+v,36)}},2302:(h,g,f)=>{var A=f(3405);h.exports=A&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3937:(h,g,f)=>{var A=f(5746),_=f(5981);h.exports=A&&_(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},8348:h=>{var g=TypeError;h.exports=function(f,A){if(f<A)throw g("Not enough arguments");return f}},7093:(h,g,f)=>{var A=f(1899),_=f(7475),v=A.WeakMap;h.exports=_(v)&&/native code/.test(String(v))},9813:(h,g,f)=>{var A=f(1899),_=f(8726),v=f(953),y=f(9418),S=f(3405),R=f(2302),D=_("wks"),O=A.Symbol,P=O&&O.for,B=R?O:O&&O.withoutSetter||y;h.exports=function(G){if(!v(D,G)||!S&&"string"!=typeof D[G]){var Y="Symbol."+G;D[G]=S&&v(O,G)?O[G]:R&&P?P(Y):B(Y)}return D[G]}},9812:(h,g,f)=>{var A=f(6887),_=f(7046),v=f(249),y=f(8929),S=f(3489),R=f(9290),D=f(2029),O=f(1887),P=f(3995),B=f(3794),G=f(3091),Y=f(4649),ae=f(9813),te=f(8780),Z=ae("toStringTag"),_e=Error,fe=[].push,Se=function(Ye,Ee){var z,ee=arguments.length>2?arguments[2]:void 0,Q=_(Oe,this);y?z=y(_e(),Q?v(this):Oe):(z=Q?this:R(Oe),D(z,Z,"Error")),void 0!==Ee&&D(z,"message",Y(Ee)),te&&D(z,"stack",P(z.stack,1)),B(z,ee);var K=[];return G(Ye,fe,{that:K}),D(z,"errors",K),z};y?y(Se,_e):S(Se,_e,{name:!0});var Oe=Se.prototype=R(_e.prototype,{constructor:O(1,Se),message:O(1,""),name:O(1,"AggregateError")});A({global:!0,constructor:!0,arity:2},{AggregateError:Se})},7627:(h,g,f)=>{f(9812)},6274:(h,g,f)=>{var A=f(4529),_=f(8479),v=f(2077),y=f(5402),S=f(5988).f,R=f(5105),D=f(3538),O=f(2529),P=f(5746),B="Array Iterator",G=y.set,Y=y.getterFor(B);h.exports=R(Array,"Array",function(te,Z){G(this,{type:B,target:A(te),index:0,kind:Z})},function(){var te=Y(this),Z=te.target,_e=te.kind,fe=te.index++;return!Z||fe>=Z.length?(te.target=void 0,D(void 0,!0)):D("keys"==_e?fe:"values"==_e?Z[fe]:[fe,Z[fe]],!1)},"values");var ae=v.Arguments=v.Array;if(_("keys"),_("values"),_("entries"),!O&&P&&"values"!==ae.name)try{S(ae,"name",{value:"values"})}catch{}},6450:(h,g,f)=>{var A=f(6887),_=f(5746),v=f(5988).f;A({target:"Object",stat:!0,forced:Object.defineProperty!==v,sham:!_},{defineProperty:v})},5967:()=>{},4560:(h,g,f)=>{var A=f(6887),_=f(8834),v=f(4883),y=f(9520),S=f(2),R=f(3091);A({target:"Promise",stat:!0},{allSettled:function(D){var O=this,P=y.f(O),B=P.resolve,G=P.reject,Y=S(function(){var ae=v(O.resolve),te=[],Z=0,_e=1;R(D,function(fe){var Se=Z++,Oe=!1;_e++,_(ae,O,fe).then(function(Ye){Oe||(Oe=!0,te[Se]={status:"fulfilled",value:Ye},--_e||B(te))},function(Ye){Oe||(Oe=!0,te[Se]={status:"rejected",reason:Ye},--_e||B(te))})}),--_e||B(te)});return Y.error&&G(Y.value),P.promise}})},6890:(h,g,f)=>{var A=f(6887),_=f(8834),v=f(4883),y=f(9520),S=f(2),R=f(3091);A({target:"Promise",stat:!0,forced:f(1542)},{all:function(D){var O=this,P=y.f(O),B=P.resolve,G=P.reject,Y=S(function(){var ae=v(O.resolve),te=[],Z=0,_e=1;R(D,function(fe){var Se=Z++,Oe=!1;_e++,_(ae,O,fe).then(function(Ye){Oe||(Oe=!0,te[Se]=Ye,--_e||B(te))},G)}),--_e||B(te)});return Y.error&&G(Y.value),P.promise}})},7206:(h,g,f)=>{var A=f(6887),_=f(8834),v=f(4883),y=f(626),S=f(9520),R=f(2),D=f(3091),O="No one promise resolved";A({target:"Promise",stat:!0},{any:function(P){var B=this,G=y("AggregateError"),Y=S.f(B),ae=Y.resolve,te=Y.reject,Z=R(function(){var _e=v(B.resolve),fe=[],Se=0,Oe=1,Ye=!1;D(P,function(Ee){var z=Se++,ee=!1;Oe++,_(_e,B,Ee).then(function(Q){ee||Ye||(Ye=!0,ae(Q))},function(Q){ee||Ye||(ee=!0,fe[z]=Q,--Oe||te(new G(fe,O)))})}),--Oe||te(new G(fe,O))});return Z.error&&te(Z.value),Y.promise}})},3376:(h,g,f)=>{var A=f(6887),_=f(2529),v=f(7742).CONSTRUCTOR,y=f(6991),S=f(626),R=f(7475),D=f(5929),O=y&&y.prototype;if(A({target:"Promise",proto:!0,forced:v,real:!0},{catch:function(B){return this.then(void 0,B)}}),!_&&R(y)){var P=S("Promise").prototype.catch;O.catch!==P&&D(O,"catch",P,{unsafe:!0})}},6934:(h,g,f)=>{var A,_,v,y=f(6887),S=f(2529),R=f(6049),D=f(1899),O=f(8834),P=f(5929),B=f(8929),G=f(904),Y=f(4431),ae=f(4883),te=f(7475),Z=f(941),_e=f(5743),fe=f(487),Se=f(2941).set,Oe=f(6132),Ye=f(4845),Ee=f(2),z=f(8397),ee=f(5402),Q=f(6991),K=f(7742),ne=f(9520),me="Promise",Ne=K.CONSTRUCTOR,ce=K.REJECTION_EVENT,T=K.SUBCLASSING,k=ee.getterFor(me),j=ee.set,re=Q&&Q.prototype,be=Q,dt=re,St=D.TypeError,at=D.document,sn=D.process,vt=ne.f,Xt=vt,et=!!(at&&at.createEvent&&D.dispatchEvent),Zt="unhandledrejection",pt=function(W){var de;return!(!Z(W)||!te(de=W.then))&&de},Gt=function(W,de){var ue,ye,tt,At=de.value,we=1==de.state,xe=we?W.ok:W.fail,it=W.resolve,Yt=W.reject,ar=W.domain;try{xe?(we||(2===de.rejection&&X(de),de.rejection=1),!0===xe?ue=At:(ar&&ar.enter(),ue=xe(At),ar&&(ar.exit(),tt=!0)),ue===W.promise?Yt(St("Promise-chain cycle")):(ye=pt(ue))?O(ye,ue,it,Yt):it(ue)):Yt(At)}catch(Qo){ar&&!tt&&ar.exit(),Yt(Qo)}},li=function(W,de){W.notified||(W.notified=!0,Oe(function(){for(var ue,ye=W.reactions;ue=ye.get();)Gt(ue,W);W.notified=!1,de&&!W.rejection&&mr(W)}))},Xn=function(W,de,ue){var ye,tt;et?((ye=at.createEvent("Event")).promise=de,ye.reason=ue,ye.initEvent(W,!1,!0),D.dispatchEvent(ye)):ye={promise:de,reason:ue},!ce&&(tt=D["on"+W])?tt(ye):W===Zt&&Ye("Unhandled promise rejection",ue)},mr=function(W){O(Se,D,function(){var de,ue=W.facade,ye=W.value;if(A_(W)&&(de=Ee(function(){R?sn.emit("unhandledRejection",ye,ue):Xn(Zt,ue,ye)}),W.rejection=R||A_(W)?2:1,de.error))throw de.value})},A_=function(W){return 1!==W.rejection&&!W.parent},X=function(W){O(Se,D,function(){var de=W.facade;R?sn.emit("rejectionHandled",de):Xn("rejectionhandled",de,W.value)})},x=function(W,de,ue){return function(ye){W(de,ye,ue)}},q=function(W,de,ue){W.done||(W.done=!0,ue&&(W=ue),W.value=de,W.state=2,li(W,!0))},ie=function(W,de,ue){if(!W.done){W.done=!0,ue&&(W=ue);try{if(W.facade===de)throw St("Promise can't be resolved itself");var ye=pt(de);ye?Oe(function(){var tt={done:!1};try{O(ye,de,x(ie,tt,W),x(q,tt,W))}catch(At){q(tt,At,W)}}):(W.value=de,W.state=1,li(W,!1))}catch(tt){q({done:!1},tt,W)}}};if(Ne&&(dt=(be=function(W){_e(this,dt),ae(W),O(A,this);var de=k(this);try{W(x(ie,de),x(q,de))}catch(ue){q(de,ue)}}).prototype,(A=function(W){j(this,{type:me,done:!1,notified:!1,parent:!1,reactions:new z,rejection:!1,state:0,value:void 0})}).prototype=P(dt,"then",function(W,de){var ue=k(this),ye=vt(fe(this,be));return ue.parent=!0,ye.ok=!te(W)||W,ye.fail=te(de)&&de,ye.domain=R?sn.domain:void 0,0==ue.state?ue.reactions.add(ye):Oe(function(){Gt(ye,ue)}),ye.promise}),_=function(){var W=new A,de=k(W);this.promise=W,this.resolve=x(ie,de),this.reject=x(q,de)},ne.f=vt=function(W){return W===be||void 0===W?new _(W):Xt(W)},!S&&te(Q)&&re!==Object.prototype)){v=re.then,T||P(re,"then",function(W,de){var ue=this;return new be(function(ye,tt){O(v,ue,ye,tt)}).then(W,de)},{unsafe:!0});try{delete re.constructor}catch{}B&&B(re,dt)}y({global:!0,constructor:!0,wrap:!0,forced:Ne},{Promise:be}),G(be,me,!1,!0),Y(me)},4349:(h,g,f)=>{var A=f(6887),_=f(2529),v=f(6991),y=f(5981),S=f(626),R=f(7475),D=f(487),O=f(6584),P=f(5929),B=v&&v.prototype;if(A({target:"Promise",proto:!0,real:!0,forced:!!v&&y(function(){B.finally.call({then:function(){}},function(){})})},{finally:function(Y){var ae=D(this,S("Promise")),te=R(Y);return this.then(te?function(Z){return O(ae,Y()).then(function(){return Z})}:Y,te?function(Z){return O(ae,Y()).then(function(){throw Z})}:Y)}}),!_&&R(v)){var G=S("Promise").prototype.finally;B.finally!==G&&P(B,"finally",G,{unsafe:!0})}},8881:(h,g,f)=>{f(6934),f(6890),f(3376),f(5921),f(4069),f(4482)},5921:(h,g,f)=>{var A=f(6887),_=f(8834),v=f(4883),y=f(9520),S=f(2),R=f(3091);A({target:"Promise",stat:!0,forced:f(1542)},{race:function(D){var O=this,P=y.f(O),B=P.reject,G=S(function(){var Y=v(O.resolve);R(D,function(ae){_(Y,O,ae).then(P.resolve,B)})});return G.error&&B(G.value),P.promise}})},4069:(h,g,f)=>{var A=f(6887),_=f(8834),v=f(9520);A({target:"Promise",stat:!0,forced:f(7742).CONSTRUCTOR},{reject:function(y){var S=v.f(this);return _(S.reject,void 0,y),S.promise}})},4482:(h,g,f)=>{var A=f(6887),_=f(626),v=f(2529),y=f(6991),S=f(7742).CONSTRUCTOR,R=f(6584),D=_("Promise"),O=v&&!S;A({target:"Promise",stat:!0,forced:v||S},{resolve:function(P){return R(O&&this===D?y:this,P)}})},7971:(h,g,f)=>{var A=f(4620).charAt,_=f(5803),v=f(5402),y=f(5105),S=f(3538),R="String Iterator",D=v.set,O=v.getterFor(R);y(String,"String",function(P){D(this,{type:R,string:_(P),index:0})},function(){var P,B=O(this),G=B.string,Y=B.index;return Y>=G.length?S(void 0,!0):(P=A(G,Y),B.index+=P.length,S(P,!1))})},7634:(h,g,f)=>{f(6274);var A=f(3281),_=f(1899),v=f(9697),y=f(2029),S=f(2077),R=f(9813)("toStringTag");for(var D in A){var O=_[D],P=O&&O.prototype;P&&v(P)!==R&&y(P,R,D),S[D]=S.Array}},1910:(h,g,f)=>{var A=f(8171);h.exports=A},7460:(h,g,f)=>{var A=f(2956);f(7634),h.exports=A},9662:(h,g,f)=>{var A=f(614),_=f(6330),v=TypeError;h.exports=function(y){if(A(y))return y;throw v(_(y)+" is not a function")}},6077:(h,g,f)=>{var A=f(614),_=String,v=TypeError;h.exports=function(y){if("object"==typeof y||A(y))return y;throw v("Can't set "+_(y)+" as a prototype")}},1223:(h,g,f)=>{var A=f(5112),_=f(30),v=f(3070).f,y=A("unscopables"),S=Array.prototype;null==S[y]&&v(S,y,{configurable:!0,value:_(null)}),h.exports=function(R){S[y][R]=!0}},9670:(h,g,f)=>{var A=f(111),_=String,v=TypeError;h.exports=function(y){if(A(y))return y;throw v(_(y)+" is not an object")}},1318:(h,g,f)=>{var A=f(5656),_=f(1400),v=f(6244),y=function(S){return function(R,D,O){var P,B=A(R),G=v(B),Y=_(O,G);if(S&&D!=D){for(;G>Y;)if((P=B[Y++])!=P)return!0}else for(;G>Y;Y++)if((S||Y in B)&&B[Y]===D)return S||Y||0;return!S&&-1}};h.exports={includes:y(!0),indexOf:y(!1)}},4326:(h,g,f)=>{var A=f(84),_=A({}.toString),v=A("".slice);h.exports=function(y){return v(_(y),8,-1)}},648:(h,g,f)=>{var A=f(1694),_=f(614),v=f(4326),y=f(5112)("toStringTag"),S=Object,R="Arguments"==v(function(){return arguments}());h.exports=A?v:function(D){var O,P,B;return void 0===D?"Undefined":null===D?"Null":"string"==typeof(P=function(G,Y){try{return G[Y]}catch{}}(O=S(D),y))?P:R?v(O):"Object"==(B=v(O))&&_(O.callee)?"Arguments":B}},9920:(h,g,f)=>{var A=f(2597),_=f(3887),v=f(1236),y=f(3070);h.exports=function(S,R,D){for(var O=_(R),P=y.f,B=v.f,G=0;G<O.length;G++){var Y=O[G];A(S,Y)||D&&A(D,Y)||P(S,Y,B(R,Y))}}},8544:(h,g,f)=>{var A=f(7293);h.exports=!A(function(){function _(){}return _.prototype.constructor=null,Object.getPrototypeOf(new _)!==_.prototype})},6178:h=>{h.exports=function(g,f){return{value:g,done:f}}},8880:(h,g,f)=>{var A=f(9781),_=f(3070),v=f(9114);h.exports=A?function(y,S,R){return _.f(y,S,v(1,R))}:function(y,S,R){return y[S]=R,y}},9114:h=>{h.exports=function(g,f){return{enumerable:!(1&g),configurable:!(2&g),writable:!(4&g),value:f}}},8052:(h,g,f)=>{var A=f(614),_=f(3070),v=f(6339),y=f(3072);h.exports=function(S,R,D,O){O||(O={});var P=O.enumerable,B=void 0!==O.name?O.name:R;if(A(D)&&v(D,B,O),O.global)P?S[R]=D:y(R,D);else{try{O.unsafe?S[R]&&(P=!0):delete S[R]}catch{}P?S[R]=D:_.f(S,R,{value:D,enumerable:!1,configurable:!O.nonConfigurable,writable:!O.nonWritable})}return S}},3072:(h,g,f)=>{var A=f(7854),_=Object.defineProperty;h.exports=function(v,y){try{_(A,v,{value:y,configurable:!0,writable:!0})}catch{A[v]=y}return y}},9781:(h,g,f)=>{var A=f(7293);h.exports=!A(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})},4154:h=>{var g="object"==typeof document&&document.all;h.exports={all:g,IS_HTMLDDA:void 0===g&&void 0!==g}},317:(h,g,f)=>{var A=f(7854),_=f(111),v=A.document,y=_(v)&&_(v.createElement);h.exports=function(S){return y?v.createElement(S):{}}},8324:h=>{h.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8509:(h,g,f)=>{var A=f(317)("span").classList,_=A&&A.constructor&&A.constructor.prototype;h.exports=_===Object.prototype?void 0:_},8113:(h,g,f)=>{var A=f(5005);h.exports=A("navigator","userAgent")||""},7392:(h,g,f)=>{var A,_,v=f(7854),y=f(8113),S=v.process,R=v.Deno,D=S&&S.versions||R&&R.version,O=D&&D.v8;O&&(_=(A=O.split("."))[0]>0&&A[0]<4?1:+(A[0]+A[1])),!_&&y&&(!(A=y.match(/Edge\/(\d+)/))||A[1]>=74)&&(A=y.match(/Chrome\/(\d+)/))&&(_=+A[1]),h.exports=_},748:h=>{h.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},1060:(h,g,f)=>{var A=f(1702),_=Error,v=A("".replace),y=String(_("zxcasd").stack),S=/\n\s*at [^:]*:[^\n]*/,R=S.test(y);h.exports=function(D,O){if(R&&"string"==typeof D&&!_.prepareStackTrace)for(;O--;)D=v(D,S,"");return D}},2914:(h,g,f)=>{var A=f(7293),_=f(9114);h.exports=!A(function(){var v=Error("a");return!("stack"in v)||(Object.defineProperty(v,"stack",_(1,7)),7!==v.stack)})},2109:(h,g,f)=>{var A=f(7854),_=f(1236).f,v=f(8880),y=f(8052),S=f(3072),R=f(9920),D=f(4705);h.exports=function(O,P){var B,G,Y,ae,te,Z=O.target,_e=O.global,fe=O.stat;if(B=_e?A:fe?A[Z]||S(Z,{}):(A[Z]||{}).prototype)for(G in P){if(ae=P[G],Y=O.dontCallGetSet?(te=_(B,G))&&te.value:B[G],!D(_e?G:Z+(fe?".":"#")+G,O.forced)&&void 0!==Y){if(typeof ae==typeof Y)continue;R(ae,Y)}(O.sham||Y&&Y.sham)&&v(ae,"sham",!0),y(B,G,ae,O)}}},7293:h=>{h.exports=function(g){try{return!!g()}catch{return!0}}},2104:(h,g,f)=>{var A=f(4374),_=Function.prototype,v=_.apply,y=_.call;h.exports="object"==typeof Reflect&&Reflect.apply||(A?y.bind(v):function(){return y.apply(v,arguments)})},4374:(h,g,f)=>{var A=f(7293);h.exports=!A(function(){var _=function(){}.bind();return"function"!=typeof _||_.hasOwnProperty("prototype")})},6916:(h,g,f)=>{var A=f(4374),_=Function.prototype.call;h.exports=A?_.bind(_):function(){return _.apply(_,arguments)}},6530:(h,g,f)=>{var A=f(9781),_=f(2597),v=Function.prototype,y=A&&Object.getOwnPropertyDescriptor,S=_(v,"name"),R=S&&"something"===function(){}.name,D=S&&(!A||A&&y(v,"name").configurable);h.exports={EXISTS:S,PROPER:R,CONFIGURABLE:D}},84:(h,g,f)=>{var A=f(4374),_=Function.prototype,v=_.call,y=A&&_.bind.bind(v,v);h.exports=A?y:function(S){return function(){return v.apply(S,arguments)}}},1702:(h,g,f)=>{var A=f(4326),_=f(84);h.exports=function(v){if("Function"===A(v))return _(v)}},5005:(h,g,f)=>{var A=f(7854),_=f(614),v=function(y){return _(y)?y:void 0};h.exports=function(y,S){return arguments.length<2?v(A[y]):A[y]&&A[y][S]}},8173:(h,g,f)=>{var A=f(9662),_=f(8554);h.exports=function(v,y){var S=v[y];return _(S)?void 0:A(S)}},7854:(h,g,f)=>{var A=function(_){return _&&_.Math==Math&&_};h.exports=A("object"==typeof globalThis&&globalThis)||A("object"==typeof window&&window)||A("object"==typeof self&&self)||A("object"==typeof f.g&&f.g)||function(){return this}()||Function("return this")()},2597:(h,g,f)=>{var A=f(1702),_=f(7908),v=A({}.hasOwnProperty);h.exports=Object.hasOwn||function(y,S){return v(_(y),S)}},3501:h=>{h.exports={}},490:(h,g,f)=>{var A=f(5005);h.exports=A("document","documentElement")},4664:(h,g,f)=>{var A=f(9781),_=f(7293),v=f(317);h.exports=!A&&!_(function(){return 7!=Object.defineProperty(v("div"),"a",{get:function(){return 7}}).a})},8361:(h,g,f)=>{var A=f(1702),_=f(7293),v=f(4326),y=Object,S=A("".split);h.exports=_(function(){return!y("z").propertyIsEnumerable(0)})?function(R){return"String"==v(R)?S(R,""):y(R)}:y},9587:(h,g,f)=>{var A=f(614),_=f(111),v=f(7674);h.exports=function(y,S,R){var D,O;return v&&A(D=S.constructor)&&D!==R&&_(O=D.prototype)&&O!==R.prototype&&v(y,O),y}},2788:(h,g,f)=>{var A=f(1702),_=f(614),v=f(5465),y=A(Function.toString);_(v.inspectSource)||(v.inspectSource=function(S){return y(S)}),h.exports=v.inspectSource},8340:(h,g,f)=>{var A=f(111),_=f(8880);h.exports=function(v,y){A(y)&&"cause"in y&&_(v,"cause",y.cause)}},9909:(h,g,f)=>{var A,_,v,y=f(4811),S=f(7854),R=f(111),D=f(8880),O=f(2597),P=f(5465),B=f(6200),G=f(3501),Y="Object already initialized",ae=S.TypeError;if(y||P.state){var Z=P.state||(P.state=new(0,S.WeakMap));Z.get=Z.get,Z.has=Z.has,Z.set=Z.set,A=function(fe,Se){if(Z.has(fe))throw ae(Y);return Se.facade=fe,Z.set(fe,Se),Se},_=function(fe){return Z.get(fe)||{}},v=function(fe){return Z.has(fe)}}else{var _e=B("state");G[_e]=!0,A=function(fe,Se){if(O(fe,_e))throw ae(Y);return Se.facade=fe,D(fe,_e,Se),Se},_=function(fe){return O(fe,_e)?fe[_e]:{}},v=function(fe){return O(fe,_e)}}h.exports={set:A,get:_,has:v,enforce:function(fe){return v(fe)?_(fe):A(fe,{})},getterFor:function(fe){return function(Se){var Oe;if(!R(Se)||(Oe=_(Se)).type!==fe)throw ae("Incompatible receiver, "+fe+" required");return Oe}}}},614:(h,g,f)=>{var A=f(4154),_=A.all;h.exports=A.IS_HTMLDDA?function(v){return"function"==typeof v||v===_}:function(v){return"function"==typeof v}},4705:(h,g,f)=>{var A=f(7293),_=f(614),v=/#|\.prototype\./,y=function(P,B){var G=R[S(P)];return G==O||G!=D&&(_(B)?A(B):!!B)},S=y.normalize=function(P){return String(P).replace(v,".").toLowerCase()},R=y.data={},D=y.NATIVE="N",O=y.POLYFILL="P";h.exports=y},8554:h=>{h.exports=function(g){return null==g}},111:(h,g,f)=>{var A=f(614),_=f(4154),v=_.all;h.exports=_.IS_HTMLDDA?function(y){return"object"==typeof y?null!==y:A(y)||y===v}:function(y){return"object"==typeof y?null!==y:A(y)}},1913:h=>{h.exports=!1},2190:(h,g,f)=>{var A=f(5005),_=f(614),v=f(7976),y=f(3307),S=Object;h.exports=y?function(R){return"symbol"==typeof R}:function(R){var D=A("Symbol");return _(D)&&v(D.prototype,S(R))}},3061:(h,g,f)=>{var A=f(3383).IteratorPrototype,_=f(30),v=f(9114),y=f(8003),S=f(7497),R=function(){return this};h.exports=function(D,O,P,B){var G=O+" Iterator";return D.prototype=_(A,{next:v(+!B,P)}),y(D,G,!1,!0),S[G]=R,D}},1656:(h,g,f)=>{var A=f(2109),_=f(6916),v=f(1913),y=f(6530),S=f(614),R=f(3061),D=f(9518),O=f(7674),P=f(8003),B=f(8880),G=f(8052),Y=f(5112),ae=f(7497),te=f(3383),Z=y.PROPER,_e=y.CONFIGURABLE,fe=te.IteratorPrototype,Se=te.BUGGY_SAFARI_ITERATORS,Oe=Y("iterator"),Ee="values",z="entries",ee=function(){return this};h.exports=function(Q,K,ne,me,Ne,ce,T){R(ne,K,me);var k,j,re,be=function(et){if(et===Ne&&vt)return vt;if(!Se&&et in at)return at[et];switch(et){case"keys":case Ee:case z:return function(){return new ne(this,et)}}return function(){return new ne(this)}},dt=K+" Iterator",St=!1,at=Q.prototype,sn=at[Oe]||at["@@iterator"]||Ne&&at[Ne],vt=!Se&&sn||be(Ne),Xt="Array"==K&&at.entries||sn;if(Xt&&(k=D(Xt.call(new Q)))!==Object.prototype&&k.next&&(v||D(k)===fe||(O?O(k,fe):S(k[Oe])||G(k,Oe,ee)),P(k,dt,!0,!0),v&&(ae[dt]=ee)),Z&&Ne==Ee&&sn&&sn.name!==Ee&&(!v&&_e?B(at,"name",Ee):(St=!0,vt=function(){return _(sn,this)})),Ne)if(j={values:be(Ee),keys:ce?vt:be("keys"),entries:be(z)},T)for(re in j)(Se||St||!(re in at))&&G(at,re,j[re]);else A({target:K,proto:!0,forced:Se||St},j);return v&&!T||at[Oe]===vt||G(at,Oe,vt,{name:Ne}),ae[K]=vt,j}},3383:(h,g,f)=>{var A,_,v,y=f(7293),S=f(614),R=f(111),D=f(30),O=f(9518),P=f(8052),B=f(5112),G=f(1913),Y=B("iterator"),ae=!1;[].keys&&("next"in(v=[].keys())?(_=O(O(v)))!==Object.prototype&&(A=_):ae=!0),!R(A)||y(function(){var te={};return A[Y].call(te)!==te})?A={}:G&&(A=D(A)),S(A[Y])||P(A,Y,function(){return this}),h.exports={IteratorPrototype:A,BUGGY_SAFARI_ITERATORS:ae}},7497:h=>{h.exports={}},6244:(h,g,f)=>{var A=f(7466);h.exports=function(_){return A(_.length)}},6339:(h,g,f)=>{var A=f(7293),_=f(614),v=f(2597),y=f(9781),S=f(6530).CONFIGURABLE,R=f(2788),D=f(9909),O=D.enforce,P=D.get,B=Object.defineProperty,G=y&&!A(function(){return 8!==B(function(){},"length",{value:8}).length}),Y=String(String).split("String"),ae=h.exports=function(te,Z,_e){"Symbol("===String(Z).slice(0,7)&&(Z="["+String(Z).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),_e&&_e.getter&&(Z="get "+Z),_e&&_e.setter&&(Z="set "+Z),(!v(te,"name")||S&&te.name!==Z)&&(y?B(te,"name",{value:Z,configurable:!0}):te.name=Z),G&&_e&&v(_e,"arity")&&te.length!==_e.arity&&B(te,"length",{value:_e.arity});try{_e&&v(_e,"constructor")&&_e.constructor?y&&B(te,"prototype",{writable:!1}):te.prototype&&(te.prototype=void 0)}catch{}var fe=O(te);return v(fe,"source")||(fe.source=Y.join("string"==typeof Z?Z:"")),te};Function.prototype.toString=ae(function(){return _(this)&&P(this).source||R(this)},"toString")},4758:h=>{var g=Math.ceil,f=Math.floor;h.exports=Math.trunc||function(A){var _=+A;return(_>0?f:g)(_)}},6277:(h,g,f)=>{var A=f(1340);h.exports=function(_,v){return void 0===_?arguments.length<2?"":v:A(_)}},30:(h,g,f)=>{var A,_=f(9670),v=f(6048),y=f(748),S=f(3501),R=f(490),D=f(317),O=f(6200)("IE_PROTO"),P=function(){},B=function(ae){return"<script>"+ae+"<\/script>"},G=function(ae){ae.write(B("")),ae.close();var te=ae.parentWindow.Object;return ae=null,te},Y=function(){try{A=new ActiveXObject("htmlfile")}catch{}var ae,te;Y=typeof document<"u"?document.domain&&A?G(A):((te=D("iframe")).style.display="none",R.appendChild(te),te.src=String("javascript:"),(ae=te.contentWindow.document).open(),ae.write(B("document.F=Object")),ae.close(),ae.F):G(A);for(var Z=y.length;Z--;)delete Y.prototype[y[Z]];return Y()};S[O]=!0,h.exports=Object.create||function(ae,te){var Z;return null!==ae?(P.prototype=_(ae),Z=new P,P.prototype=null,Z[O]=ae):Z=Y(),void 0===te?Z:v.f(Z,te)}},6048:(h,g,f)=>{var A=f(9781),_=f(3353),v=f(3070),y=f(9670),S=f(5656),R=f(1956);g.f=A&&!_?Object.defineProperties:function(D,O){y(D);for(var P,B=S(O),G=R(O),Y=G.length,ae=0;Y>ae;)v.f(D,P=G[ae++],B[P]);return D}},3070:(h,g,f)=>{var A=f(9781),_=f(4664),v=f(3353),y=f(9670),S=f(4948),R=TypeError,D=Object.defineProperty,O=Object.getOwnPropertyDescriptor;g.f=A?v?function(P,B,G){if(y(P),B=S(B),y(G),"function"==typeof P&&"prototype"===B&&"value"in G&&"writable"in G&&!G.writable){var Y=O(P,B);Y&&Y.writable&&(P[B]=G.value,G={configurable:"configurable"in G?G.configurable:Y.configurable,enumerable:"enumerable"in G?G.enumerable:Y.enumerable,writable:!1})}return D(P,B,G)}:D:function(P,B,G){if(y(P),B=S(B),y(G),_)try{return D(P,B,G)}catch{}if("get"in G||"set"in G)throw R("Accessors not supported");return"value"in G&&(P[B]=G.value),P}},1236:(h,g,f)=>{var A=f(9781),_=f(6916),v=f(5296),y=f(9114),S=f(5656),R=f(4948),D=f(2597),O=f(4664),P=Object.getOwnPropertyDescriptor;g.f=A?P:function(B,G){if(B=S(B),G=R(G),O)try{return P(B,G)}catch{}if(D(B,G))return y(!_(v.f,B,G),B[G])}},8006:(h,g,f)=>{var A=f(6324),_=f(748).concat("length","prototype");g.f=Object.getOwnPropertyNames||function(v){return A(v,_)}},5181:(h,g)=>{g.f=Object.getOwnPropertySymbols},9518:(h,g,f)=>{var A=f(2597),_=f(614),v=f(7908),y=f(6200),S=f(8544),R=y("IE_PROTO"),D=Object,O=D.prototype;h.exports=S?D.getPrototypeOf:function(P){var B=v(P);if(A(B,R))return B[R];var G=B.constructor;return _(G)&&B instanceof G?G.prototype:B instanceof D?O:null}},7976:(h,g,f)=>{var A=f(1702);h.exports=A({}.isPrototypeOf)},6324:(h,g,f)=>{var A=f(1702),_=f(2597),v=f(5656),y=f(1318).indexOf,S=f(3501),R=A([].push);h.exports=function(D,O){var P,B=v(D),G=0,Y=[];for(P in B)!_(S,P)&&_(B,P)&&R(Y,P);for(;O.length>G;)_(B,P=O[G++])&&(~y(Y,P)||R(Y,P));return Y}},1956:(h,g,f)=>{var A=f(6324),_=f(748);h.exports=Object.keys||function(v){return A(v,_)}},5296:(h,g)=>{var f={}.propertyIsEnumerable,A=Object.getOwnPropertyDescriptor,_=A&&!f.call({1:2},1);g.f=_?function(v){var y=A(this,v);return!!y&&y.enumerable}:f},7674:(h,g,f)=>{var A=f(1702),_=f(9670),v=f(6077);h.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var y,S=!1,R={};try{(y=A(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(R,[]),S=R instanceof Array}catch{}return function(D,O){return _(D),v(O),S?y(D,O):D.__proto__=O,D}}():void 0)},2140:(h,g,f)=>{var A=f(6916),_=f(614),v=f(111),y=TypeError;h.exports=function(S,R){var D,O;if("string"===R&&_(D=S.toString)&&!v(O=A(D,S))||_(D=S.valueOf)&&!v(O=A(D,S))||"string"!==R&&_(D=S.toString)&&!v(O=A(D,S)))return O;throw y("Can't convert object to primitive value")}},3887:(h,g,f)=>{var A=f(5005),_=f(1702),v=f(8006),y=f(5181),S=f(9670),R=_([].concat);h.exports=A("Reflect","ownKeys")||function(D){var O=v.f(S(D)),P=y.f;return P?R(O,P(D)):O}},2626:(h,g,f)=>{var A=f(3070).f;h.exports=function(_,v,y){y in _||A(_,y,{configurable:!0,get:function(){return v[y]},set:function(S){v[y]=S}})}},4488:(h,g,f)=>{var A=f(8554),_=TypeError;h.exports=function(v){if(A(v))throw _("Can't call method on "+v);return v}},8003:(h,g,f)=>{var A=f(3070).f,_=f(2597),v=f(5112)("toStringTag");h.exports=function(y,S,R){y&&!R&&(y=y.prototype),y&&!_(y,v)&&A(y,v,{configurable:!0,value:S})}},6200:(h,g,f)=>{var A=f(2309),_=f(9711),v=A("keys");h.exports=function(y){return v[y]||(v[y]=_(y))}},5465:(h,g,f)=>{var A=f(7854),_=f(3072),v="__core-js_shared__",y=A[v]||_(v,{});h.exports=y},2309:(h,g,f)=>{var A=f(1913),_=f(5465);(h.exports=function(v,y){return _[v]||(_[v]=void 0!==y?y:{})})("versions",[]).push({version:"3.26.0",mode:A?"pure":"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.0/LICENSE",source:"https://github.com/zloirock/core-js"})},6293:(h,g,f)=>{var A=f(7392),_=f(7293);h.exports=!!Object.getOwnPropertySymbols&&!_(function(){var v=Symbol();return!String(v)||!(Object(v)instanceof Symbol)||!Symbol.sham&&A&&A<41})},1400:(h,g,f)=>{var A=f(9303),_=Math.max,v=Math.min;h.exports=function(y,S){var R=A(y);return R<0?_(R+S,0):v(R,S)}},5656:(h,g,f)=>{var A=f(8361),_=f(4488);h.exports=function(v){return A(_(v))}},9303:(h,g,f)=>{var A=f(4758);h.exports=function(_){var v=+_;return v!=v||0===v?0:A(v)}},7466:(h,g,f)=>{var A=f(9303),_=Math.min;h.exports=function(v){return v>0?_(A(v),9007199254740991):0}},7908:(h,g,f)=>{var A=f(4488),_=Object;h.exports=function(v){return _(A(v))}},7593:(h,g,f)=>{var A=f(6916),_=f(111),v=f(2190),y=f(8173),S=f(2140),R=f(5112),D=TypeError,O=R("toPrimitive");h.exports=function(P,B){if(!_(P)||v(P))return P;var G,Y=y(P,O);if(Y){if(void 0===B&&(B="default"),G=A(Y,P,B),!_(G)||v(G))return G;throw D("Can't convert object to primitive value")}return void 0===B&&(B="number"),S(P,B)}},4948:(h,g,f)=>{var A=f(7593),_=f(2190);h.exports=function(v){var y=A(v,"string");return _(y)?y:y+""}},1694:(h,g,f)=>{var A={};A[f(5112)("toStringTag")]="z",h.exports="[object z]"===String(A)},1340:(h,g,f)=>{var A=f(648),_=String;h.exports=function(v){if("Symbol"===A(v))throw TypeError("Cannot convert a Symbol value to a string");return _(v)}},6330:h=>{var g=String;h.exports=function(f){try{return g(f)}catch{return"Object"}}},9711:(h,g,f)=>{var A=f(1702),_=0,v=Math.random(),y=A(1..toString);h.exports=function(S){return"Symbol("+(void 0===S?"":S)+")_"+y(++_+v,36)}},3307:(h,g,f)=>{var A=f(6293);h.exports=A&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:(h,g,f)=>{var A=f(9781),_=f(7293);h.exports=A&&_(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},4811:(h,g,f)=>{var A=f(7854),_=f(614),v=A.WeakMap;h.exports=_(v)&&/native code/.test(String(v))},5112:(h,g,f)=>{var A=f(7854),_=f(2309),v=f(2597),y=f(9711),S=f(6293),R=f(3307),D=_("wks"),O=A.Symbol,P=O&&O.for,B=R?O:O&&O.withoutSetter||y;h.exports=function(G){if(!v(D,G)||!S&&"string"!=typeof D[G]){var Y="Symbol."+G;D[G]=S&&v(O,G)?O[G]:R&&P?P(Y):B(Y)}return D[G]}},9191:(h,g,f)=>{var A=f(5005),_=f(2597),v=f(8880),y=f(7976),S=f(7674),R=f(9920),D=f(2626),O=f(9587),P=f(6277),B=f(8340),G=f(1060),Y=f(2914),ae=f(9781),te=f(1913);h.exports=function(Z,_e,fe,Se){var Oe="stackTraceLimit",Ye=Se?2:1,Ee=Z.split("."),z=Ee[Ee.length-1],ee=A.apply(null,Ee);if(ee){var Q=ee.prototype;if(!te&&_(Q,"cause")&&delete Q.cause,!fe)return ee;var K=A("Error"),ne=_e(function(me,Ne){var ce=P(Se?Ne:me,void 0),T=Se?new ee(me):new ee;return void 0!==ce&&v(T,"message",ce),Y&&v(T,"stack",G(T.stack,2)),this&&y(Q,this)&&O(T,this,ne),arguments.length>Ye&&B(T,arguments[Ye]),T});if(ne.prototype=Q,"Error"!==z?S?S(ne,K):R(ne,K,{name:!0}):ae&&Oe in ee&&(D(ne,ee,Oe),D(ne,ee,"prepareStackTrace")),R(ne,ee),!te)try{Q.name!==z&&v(Q,"name",z),Q.constructor=ne}catch{}return ne}}},6992:(h,g,f)=>{var A=f(5656),_=f(1223),v=f(7497),y=f(9909),S=f(3070).f,R=f(1656),D=f(6178),O=f(1913),P=f(9781),B="Array Iterator",G=y.set,Y=y.getterFor(B);h.exports=R(Array,"Array",function(te,Z){G(this,{type:B,target:A(te),index:0,kind:Z})},function(){var te=Y(this),Z=te.target,_e=te.kind,fe=te.index++;return!Z||fe>=Z.length?(te.target=void 0,D(void 0,!0)):D("keys"==_e?fe:"values"==_e?Z[fe]:[fe,Z[fe]],!1)},"values");var ae=v.Arguments=v.Array;if(_("keys"),_("values"),_("entries"),!O&&P&&"values"!==ae.name)try{S(ae,"name",{value:"values"})}catch{}},1703:(h,g,f)=>{var A=f(2109),_=f(7854),v=f(2104),y=f(9191),S=_.WebAssembly,R=7!==Error("e",{cause:7}).cause,D=function(P,B){var G={};G[P]=y(P,B,R),A({global:!0,constructor:!0,arity:1,forced:R},G)},O=function(P,B){if(S&&S[P]){var G={};G[P]=y("WebAssembly."+P,B,R),A({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:R},G)}};D("Error",function(P){return function(B){return v(P,this,arguments)}}),D("EvalError",function(P){return function(B){return v(P,this,arguments)}}),D("RangeError",function(P){return function(B){return v(P,this,arguments)}}),D("ReferenceError",function(P){return function(B){return v(P,this,arguments)}}),D("SyntaxError",function(P){return function(B){return v(P,this,arguments)}}),D("TypeError",function(P){return function(B){return v(P,this,arguments)}}),D("URIError",function(P){return function(B){return v(P,this,arguments)}}),O("CompileError",function(P){return function(B){return v(P,this,arguments)}}),O("LinkError",function(P){return function(B){return v(P,this,arguments)}}),O("RuntimeError",function(P){return function(B){return v(P,this,arguments)}})},3948:(h,g,f)=>{var A=f(7854),_=f(8324),v=f(8509),y=f(6992),S=f(8880),R=f(5112),D=R("iterator"),O=R("toStringTag"),P=y.values,B=function(Y,ae){if(Y){if(Y[D]!==P)try{S(Y,D,P)}catch{Y[D]=P}if(Y[O]||S(Y,O,ae),_[ae])for(var te in y)if(Y[te]!==y[te])try{S(Y,te,y[te])}catch{Y[te]=y[te]}}};for(var G in _)B(A[G]&&A[G].prototype,G);B(v,"DOMTokenList")},6226:(h,g,f)=>{h.exports=f(7460)},7445:(h,g,f)=>{h.exports=f(3685)}},c={};function l(h){var g=c[h];if(void 0!==g)return g.exports;var f=c[h]={exports:{}};return s[h](f,f.exports,l),f.exports}l.n=h=>{var g=h&&h.__esModule?()=>h.default:()=>h;return l.d(g,{a:g}),g},l.d=(h,g)=>{for(var f in g)l.o(g,f)&&!l.o(h,f)&&Object.defineProperty(h,f,{enumerable:!0,get:g[f]})},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch{if("object"==typeof window)return window}}(),l.o=(h,g)=>Object.prototype.hasOwnProperty.call(h,g),l.r=h=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})};var p={};return(()=>{l.r(p),l.d(p,{AudioExtension:()=>_e,AudioProcessor:()=>te,Extension:()=>Z,PromiseMutex:()=>Ye,Ticker:()=>Se,VideoProcessor:()=>ae,logger:()=>R,reporter:()=>P});var h=l(7445);function g(Ee,z,ee){return z in Ee?h(Ee,z,{value:ee,enumerable:!0,configurable:!0,writable:!0}):Ee[z]=ee,Ee}l(1703),l(6992),l(3948);var f=l(6226),A=l.n(f);const _=Date.now(),v={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4};function y(){const Ee=new Date;return Ee.toTimeString().split(" ")[0]+":"+Ee.getMilliseconds()}const S=Ee=>{for(const z in v)if(Object.prototype.hasOwnProperty.call(v,z)&&v[z]===Ee)return z;return"DEFAULT"},R=new class{constructor(){g(this,"logLevel",v.DEBUG),g(this,"hookLog",void 0)}debug(){for(var Ee=arguments.length,z=new Array(Ee),ee=0;ee<Ee;ee++)z[ee]=arguments[ee];const Q=[v.DEBUG].concat(z);this.log.apply(this,Q)}info(){for(var Ee=arguments.length,z=new Array(Ee),ee=0;ee<Ee;ee++)z[ee]=arguments[ee];const Q=[v.INFO].concat(z);this.log.apply(this,Q)}warning(){for(var Ee=arguments.length,z=new Array(Ee),ee=0;ee<Ee;ee++)z[ee]=arguments[ee];const Q=[v.WARNING].concat(z);this.log.apply(this,Q)}error(){for(var Ee=arguments.length,z=new Array(Ee),ee=0;ee<Ee;ee++)z[ee]=arguments[ee];const Q=[v.ERROR].concat(z);this.log.apply(this,Q)}log(){for(var Ee,z=arguments.length,ee=new Array(z),Q=0;Q<z;Q++)ee[Q]=arguments[Q];if(Date.now()-_<100)return void setTimeout(()=>{this.log(...ee)},Date.now()-_);const K=Math.max(0,Math.min(4,ee[0]));if(ee[0]=y()+" Agora-Extension [".concat(S(K),"]:"),K<this.logLevel)return;const ne=y()+" %cAgora-Extension [".concat(S(K),"]:");let me=[];switch(K){case v.DEBUG:me=[ne,"color: #64B5F6;"].concat(ee.slice(1)),console.log.apply(console,me);break;case v.INFO:me=[ne,"color: #1E88E5; font-weight: bold;"].concat(ee.slice(1)),console.log.apply(console,me);break;case v.WARNING:me=[ne,"color: #FB8C00; font-weight: bold;"].concat(ee.slice(1)),console.warn.apply(console,me);break;case v.ERROR:me=[ne,"color: #B00020; font-weight: bold;"].concat(ee.slice(1)),console.error.apply(console,me)}null===(Ee=this.hookLog)||void 0===Ee||Ee.call(this,K,me)}};function D(Ee,z){var ee=Object.keys(Ee);if(Object.getOwnPropertySymbols){var Q=Object.getOwnPropertySymbols(Ee);z&&(Q=Q.filter(function(K){return Object.getOwnPropertyDescriptor(Ee,K).enumerable})),ee.push.apply(ee,Q)}return ee}function O(Ee){for(var z=1;z<arguments.length;z++){var ee=null!=arguments[z]?arguments[z]:{};z%2?D(Object(ee),!0).forEach(function(Q){g(Ee,Q,ee[Q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ee,Object.getOwnPropertyDescriptors(ee)):D(Object(ee)).forEach(function(Q){Object.defineProperty(Ee,Q,Object.getOwnPropertyDescriptor(ee,Q))})}return Ee}const P=new class{constructor(){g(this,"apiInvokeMsgQueue",[]),g(this,"hookApiInvoke",void 0)}reportApiInvoke(Ee){Ee.timeout=Ee.timeout||6e4,Ee.reportResult=void 0===Ee.reportResult||Ee.reportResult;const z=Date.now(),ee=()=>({name:Ee.name,apiInvokeTime:z,options:Ee.options});let Q=!1;var K;(K=Ee.timeout,new(A())(me=>{window.setTimeout(me,K)})).then(()=>{Q||(this.sendApiInvoke(O(O({},ee()),{},{error:"API_INVOKE_TIMEOUT",success:!1})),R.debug("".concat(Ee.name," timeout")))});const ne=new Error("".concat(Ee.name,": this api invoke is end"));return{onSuccess:me=>{if(Q)throw ne;Q=!0,this.sendApiInvoke(O(O({},ee()),{},{success:!0},Ee.reportResult&&{result:me}))},onError:me=>{if(Q)throw me;Q=!0,this.sendApiInvoke(O(O({},ee()),{},{success:!1,error:me.toString()}))}}}sendApiInvoke(Ee){this.hookApiInvoke?(this.hookApiInvoke([...this.apiInvokeMsgQueue,Ee]),this.apiInvokeMsgQueue=[]):this.apiInvokeMsgQueue.push(Ee)}};function B(Ee,z){var ee=Object.keys(Ee);if(Object.getOwnPropertySymbols){var Q=Object.getOwnPropertySymbols(Ee);z&&(Q=Q.filter(function(K){return Object.getOwnPropertyDescriptor(Ee,K).enumerable})),ee.push.apply(ee,Q)}return ee}function G(Ee){for(var z=1;z<arguments.length;z++){var ee=null!=arguments[z]?arguments[z]:{};z%2?B(Object(ee),!0).forEach(function(Q){g(Ee,Q,ee[Q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ee,Object.getOwnPropertyDescriptors(ee)):B(Object(ee)).forEach(function(Q){Object.defineProperty(Ee,Q,Object.getOwnPropertyDescriptor(ee,Q))})}return Ee}class Y extends class{constructor(){g(this,"_events",{}),g(this,"addListener",this.on)}getListeners(z){return this._events[z]?this._events[z].map(ee=>ee.listener):[]}on(z,ee){this._events[z]||(this._events[z]=[]);const Q=this._events[z];-1===this._indexOfListener(Q,ee)&&Q.push({listener:ee,once:!1})}once(z,ee){this._events[z]||(this._events[z]=[]);const Q=this._events[z];-1===this._indexOfListener(Q,ee)&&Q.push({listener:ee,once:!0})}off(z,ee){if(!this._events[z])return;const Q=this._events[z],K=this._indexOfListener(Q,ee);-1!==K&&Q.splice(K,1),0===this._events[z].length&&delete this._events[z]}removeAllListeners(z){z?delete this._events[z]:this._events={}}emit(z){this._events[z]||(this._events[z]=[]);const ee=this._events[z].map(me=>me);for(var Q=arguments.length,K=new Array(Q>1?Q-1:0),ne=1;ne<Q;ne++)K[ne-1]=arguments[ne];for(let me=0;me<ee.length;me+=1){const Ne=ee[me];Ne.once&&this.off(z,Ne.listener),Ne.listener.apply(this,K||[])}}_indexOfListener(z,ee){let Q=z.length;for(;Q--;)if(z[Q].listener===ee)return Q;return-1}emitAsPromise(z){for(var ee=arguments.length,Q=new Array(ee>1?ee-1:0),K=1;K<ee;K++)Q[K-1]=arguments[K];return 0===this.getListeners(z).length?A().reject(new Error("No promise event handler.")):new(A())((ne,me)=>{this.emit(z,...Q,ne,me)})}emitAsPromiseNoResponse(z){for(var ee=arguments.length,Q=new Array(ee>1?ee-1:0),K=1;K<ee;K++)Q[K-1]=arguments[K];return 0===this.getListeners(z).length?A().resolve():new(A())((ne,me)=>{this.emit(z,...Q,ne,me)})}}{get enabled(){return this._enabled}output(z,ee){if(this.outputTrack===z)return;const Q=P.reportApiInvoke({name:"".concat(this.name,".output"),options:{track:z?.toString()}});this.outputTrack=z,this.destination&&this.destination.updateInput({track:z,context:ee}),Q.onSuccess()}constructor(){super(),g(this,"inputTrack",void 0),g(this,"outputTrack",void 0),g(this,"_enabled",!0),g(this,"_source",void 0),g(this,"ID",function z(){let ee=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,Q=arguments.length>1?arguments[1]:void 0;const K=Math.random().toString(16).substr(2,ee).toLowerCase();return K.length===ee?"".concat(Q).concat(K):"".concat(Q).concat(K)+z(ee-K.length,"")}(6,"")),g(this,"destination",void 0),g(this,"context",void 0),g(this,"name",void 0)}enable(){if(this._enabled)return;const z=P.reportApiInvoke({name:"".concat(this.name,".enable"),options:!0});R.info("".concat(this.name,"-").concat(this.ID," enabled")),this._enabled=!0;try{var ee;const Q=null===(ee=this.onEnableChange)||void 0===ee?void 0:ee.call(this,this._enabled);if(Q instanceof A())return Q.then(()=>{z.onSuccess()}).catch(K=>{throw z.onError(K),K});z.onSuccess()}catch(Q){throw z.onError(Q),Q}}disable(){if(!this._enabled)return;const z=P.reportApiInvoke({name:"".concat(this.name,".enable"),options:!1});R.info("".concat(this.name,"-").concat(this.ID," disabled")),this._enabled=!1;try{var ee;const Q=null===(ee=this.onEnableChange)||void 0===ee?void 0:ee.call(this,this._enabled);if(Q instanceof A())return Q.then(()=>{z.onSuccess()}).catch(K=>{throw z.onError(K),K});z.onSuccess()}catch(Q){throw z.onError(Q),Q}}}class ae extends Y{get kind(){return"video"}pipe(z){const ee=P.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:z.name}});if(this.destination===z)return ee.onSuccess(),z;if(z._source){const Q=new Error("Processor ".concat(z.name," already being piped, please call ").concat(z._source.name,".unpipe() beforehand."));throw ee.onError(Q),Q}return this.destination&&this.unpipe(),this.destination=z,z._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,context:this.context}),ee.onSuccess(),z}unpipe(){if(!this.destination)return;const z=P.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});R.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));try{const ee=this.destination;this.destination._source=void 0,this.destination=void 0,ee.reset()}finally{z.onSuccess()}}updateInput(z){var ee,Q;z.context!==this.context&&(this.context=z.context,null===(ee=this.onPiped)||void 0===ee||ee.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,context:z.context})),z.track&&this.inputTrack!==z.track&&(this.inputTrack=z.track,null===(Q=this.onTrack)||void 0===Q||Q.call(this,z.track,this.context))}reset(){var z;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.context=void 0,null===(z=this.onUnpiped)||void 0===z||z.call(this),this.destination&&this.destination.reset()}}class te extends Y{constructor(){super(...arguments),g(this,"inputNode",void 0),g(this,"outputNode",void 0),g(this,"destination",void 0),g(this,"context",void 0)}get kind(){return"audio"}pipe(z){const ee=P.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:z.name}});if(this.destination===z)return ee.onSuccess(),z;if(z._source){const Q=new Error("Processor ".concat(z.name," already being piped, please call ").concat(z._source.name,".unpipe() beforehand."));throw ee.onError(Q),Q}return this.destination&&this.unpipe(),this.destination=z,z._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:this.context}),ee.onSuccess(),z}unpipe(){if(!this.destination)return;R.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));const z=P.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});try{var ee;let Q=this.destination;null===(ee=this.outputNode)||void 0===ee||ee.disconnect(),this.destination._source=void 0,this.destination=void 0,Q.reset()}finally{z.onSuccess()}}output(z,ee){if(z instanceof MediaStreamTrack)super.output(z,ee);else if(z instanceof AudioNode){if(this.outputNode===z)return;const Q=P.reportApiInvoke({name:"".concat(this.name,".output"),options:G(G({},z instanceof MediaStreamTrack&&{track:z.toString()}),z instanceof AudioNode&&{audioNode:z.toString()})});this.outputNode=z,this.destination&&this.destination.updateInput({node:z,context:ee}),Q.onSuccess()}}updateInput(z){var ee,Q,K;z.context!==this.context&&(this.context=z.context,null===(ee=this.onPiped)||void 0===ee||ee.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:z.context})),z.track&&this.inputTrack!==z.track&&(this.inputTrack=z.track,null===(Q=this.onTrack)||void 0===Q||Q.call(this,z.track,this.context)),z.node&&this.inputNode!==z.node&&(this.inputNode=z.node,null===(K=this.onNode)||void 0===K||K.call(this,z.node,this.context))}reset(){var z;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.inputNode=void 0,null===(z=this.onUnpiped)||void 0===z||z.call(this,this.context),this.context=void 0,this.destination&&this.destination.reset()}}class Z{constructor(){g(this,"__registered__",!1),g(this,"logger",R),g(this,"reporter",P),g(this,"parameters",{})}createProcessor(){if(!this.__registered__)throw new Error("Extension not registered yet!");return this._createProcessor()}}class _e extends Z{}let fe;class Se{get running(){return this._running}constructor(z,ee){if(g(this,"type",void 0),g(this,"interval",void 0),g(this,"fn",void 0),g(this,"_running",!1),g(this,"_osc",void 0),!z)throw new Error;if(ee<=0)throw new Error;this.type=z,this.interval=ee}add(z){this.fn=z}remove(){this.fn=void 0}start(){if(!this._running)switch(this._running=!0,this.type){case"Timer":{const z=()=>{setTimeout(()=>{this.fn&&this.fn(),this._running&&z()},this.interval)};z();break}case"RAF":{const z=ee=>{requestAnimationFrame(Q=>{Q-ee<this.interval?this._running&&z(ee):(this.fn&&this.fn(),this._running&&z(Q))})};z(performance.now());break}case"Oscillator":{fe||(fe=new AudioContext);const z=fe.createGain();let ee;z.gain.value=0,z.connect(fe.destination);const Q=()=>{this.fn&&this.fn(),ee&&ee.disconnect(),ee=fe.createOscillator(),this._osc=ee,ee.connect(z),this._running&&(ee.onended=Q,ee.start(0),ee.stop(fe.currentTime+this.interval/1e3))};Q();break}}}stop(){this._running=!1,this._osc&&(this._osc.onended=null,this._osc=void 0)}}let Oe=1;class Ye{constructor(z){g(this,"lockingPromise",A().resolve()),g(this,"locks",0),g(this,"name",""),g(this,"lockId",void 0),this.lockId=Oe++,z&&(this.name=z)}get isLocked(){return this.locks>0}lock(z){let ee;this.locks+=1;const Q=new(A())(ne=>{ee=()=>{this.locks-=1,ne()}}),K=this.lockingPromise.then(()=>ee);return this.lockingPromise=this.lockingPromise.then(()=>Q),K}}})(),p})(),t.exports=o()})(G9),!document.documentMode&&window.StyleMedia&&(HTMLCanvasElement.prototype.getContext=(H9=HTMLCanvasElement.prototype.getContext,function(){let t=arguments;return"webgl"===t[0]&&(t=[].slice.call(arguments),t[0]="experimental-webgl"),H9.apply(null,t)}));const MY=[31,222,239,159,192,236,164,81,54,227,176,149,2,247,75,141,183,54,213,216,158,92,111,49,228,111,150,6,135,79,35,212,4,155,200,168,37,107,243,110,144,179,51,81,55,78,223,242,191,211,74,119,203,151,142,62,31,41,132,22,35,155,87,123,119,117,216,57,201,53,228,67,201,40,106,24,80,176,187,253,60,63,136,100,20,12,177,99,64,38,101,143,111,176,251,211,145,136,34,23,79,136,202,95,105,199,125,67,180,44,210,179,228,4,85,160,188,64,26,46,6,61,201,103,248,18,97,254,140,36,115,106,48,124,102,216,155,120,36,227,165,217,7,227,191,128,212,157,80,37,117,175,24,214,47,221,183,211,51,174,251,223,159,167,152,53,36,107,199,223,91,62,46,194,11,80,121,188,219,2,99,99,232,229,173,234,21,30,236,177,243,142,97,48,108,56,62,172,56,216,3,42,79,138,23,88,182,39,5,118,68,135,178,56,9,94,189,44,104,9,238,231,174,122,85,247,231,86,74,8,189,147,218,180,58,76,227,17,46,90,194,100,51,178,72,163,151,243,166,130,85,1,223,130,152,242,85,255,28,173,97,252,119,215,177,119,86,104,136,82,40,72,53,11,18,26,240,188,76,110,39,31,189];function W9(t){const i=new Uint8Array([99,114,121,112,116,105,105]),o=i.length,s=t,c=s.length,l=new Uint8Array(c),p=new Uint8Array(256);for(let _=0;_<256;_++)p[_]=_;let h=0;for(let _=0;_<256;_++)h=(h+p[_]+i[_%o])%256,[p[_],p[h]]=[p[h],p[_]];let g,f=0;h=0;for(let _=0;_<0+c;_++)f=(f+1)%256,h=(h+p[f])%256,[p[f],p[h]]=[p[h],p[f]],g=p[(p[f]+p[h])%256],_>=0&&(l[_-0]=s[_-0]^g);const A=String.fromCharCode.apply(null,Array.from(l));return Function("var winSize = 5; return `"+A+"`")()}const kY=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,152,221,191,124,116,248,106,130,251,59,105,43,91,135,199,181,223,10,51,134,194,240,46,9,3,141,22,35,146,76,23,109,117,208,41,201,45,218,76,203,105,51,58,97,154,145,236,49,18,183,127,27,12,210,122,73,42,37,143,36,207,251,211,145,191,56,10,88,222,181,125,22,238,123,71,177,107,218,254,173,28,34,253,249,67,83,97,73,111,219,43,181,82,38,230,136,109,22,67];class K9{constructor(i,o){b(this,"program",void 0),b(this,"gl",void 0),b(this,"kernel",void 0),this.gl=i,this.kernel=o||kY,this.program=function(s,c){const l=W9(c),p=function PY(t,i,o,s){const c=[];for(let l=0;l<i.length;++l)c.push(OY(t,i[l],0===l?t.VERTEX_SHADER:t.FRAGMENT_SHADER));return function(l,p,h,g){const f=l.createProgram();if(!f)throw new V(L.WEBGL_INTERNAL_ERROR,"can not create webgl program");if(p.forEach(A=>{l.attachShader(f,A)}),h&&h.forEach((A,_)=>{l.bindAttribLocation(f,g?g[_]:_,A)}),l.linkProgram(f),!l.getProgramParameter(f,l.LINK_STATUS)){const A=l.getProgramInfoLog(f);throw l.deleteProgram(f),new V(L.WEBGL_INTERNAL_ERROR,"error in program linking:"+A)}return f}(t,c,o,s)}(s,[W9(MY),l]);{const h=s.getAttribLocation(p,"a_position"),g=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,g),s.bufferData(s.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),s.STATIC_DRAW),s.enableVertexAttribArray(h),s.vertexAttribPointer(h,2,s.FLOAT,!1,0,0)}{const h=s.getAttribLocation(p,"a_texCoord"),g=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,g),s.bufferData(s.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),s.STATIC_DRAW),s.enableVertexAttribArray(h),s.vertexAttribPointer(h,2,s.FLOAT,!1,0,0)}return p}(this.gl,this.kernel)}setUniforms(){const i=this.gl.getUniformLocation(this.program,"u_flipY");this.gl.uniform1f(i,1)}}class ql extends K9{constructor(i,o,s,c){super(i,o),b(this,"xOffset",void 0),b(this,"yOffset",void 0),b(this,"denoiseLevel",5),this.xOffset=1/s,this.yOffset=1/c}setUniforms(){const i=this.gl.getUniformLocation(this.program,"u_flipY"),o=this.gl.getUniformLocation(this.program,"u_singleStepOffset"),s=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform2f(o,this.xOffset,this.yOffset),this.gl.uniform1f(s,this.denoiseLevel),this.gl.uniform1f(i,1)}setParameters(i){void 0!==i.denoiseLevel&&(this.denoiseLevel=i.denoiseLevel)}setSize(i,o){this.xOffset=1/i,this.yOffset=1/o}}const LY=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,155,210,164,99,114,228,96,130,251,59,105,43,91,135,199,181,223,10,51,133,194,247,34,31,39,142,28,2,130,18,109,84,124,223,62,140,52,128,47,208,47,115,39,4,200,220,171,53,36,150,101,10,75,247,121,74,36,35,143,108,176,235,211,135,164,36,11,88,160,148,35,6,221,41,32,166,109,205,171,228,4,26,169,244,82,119,102,86,61,201,103,248,18,97,242,182,34,121,70,28,71,126,197,223,126,14,244,149,192,12,176,187,149,212,156,22,44,36,133,10,216,63,198,213,154,116,230,253,154,154,249,215,55,60,34,196,229,76,50,44,135,22,77,113,247,142,94,60,23,172,145,175,218,81,86,162,239,180,205,63,118,3,110,123,224,127,158,124,15,127,157,27,66,176,33,24,51,53,194,178,56,6,74,191,111,51,78,174,157,229,17,22,178,231,92,25,23,191,157,137,188,54,64,176,13,22,81,207,45,108,203,83,186,130,237,186,153,110,8,196,168,152,161,28,238,46,184,36,185,20,203,183,98,95,41,149,93,105,37,116,91,68,105,164,217,30,42,60,53,173,213,177,216,195,53,204,173,128,243,42,122,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,220,161,39,214,146,183,193,225,23,177,201,243,128,160,33,75,86,126,139,254,232,14,13,85,2,112,17,150,36,180,86,226,225,126,197,17,228,225,142,245,37,170,39,96,187,190,2,35,85,237,11,189,1,79,237,2,1,114,246,109,190,66,54,153,43,218,204,70,6,204,162,247,18,130,123,30,60,165,130,142,210,133,91,127,117,71,38,145,172,7,5,16,220,222,111,98,141,239,208,125,26,238,28,0,216,89,13,7,119,134,194,75,41,67,174,1,217,80,101,40,26,59,28,59,46,108,138,38,157,167,28,234,73,177,42,42,102,108,26,181,27,178,42,43,52,28,110,117,198,173,176,178,101,225,150,36,139,108,105,10,237,222,3,143,126,18,144,115,74,56,114,134,231,159,212,62,126,80,173,216,167,4,81,18,52,17,144,218,32,139,207,104,128,229,99,84,120,31,87,227,154,91,196,63,123,111,125,36,52,57,168,113,150,189,204,24,104,196,237,86,163,68,197,202,170,212,191,81,193,111,255,162,181,202,156,146,196,96,16,118,117,55,71,156,31,163,242,204,239,11,150,27,126,115,154,107,247,134,158,125,255,146,35,183,209,36,116,87,215,172,5,251,133,114,254,141,195,6,145,4,111,182,167,74,154,152,68,18,146,88,106,200,154,15,176,94,86,66,178,101,219,35,188,129,66,28,41,110,174,53,88,174,64,191,206,127,48,126,214,216,93,119,2,166,99,181,222,29,218,28,195,219,125,44,50,16,99,174,225,51,133,120,184,159,168,75,242,162,124,255,81,25,153,109,69,220,176,4,237,196,233,19,8,240,160,39,122,81,29,188,144,249,170,174,137,30,10,93,133,151,199,248,175,38,41,144,229,245,149,25,240,138,179,114,182,84,50,103,95,31,199,31,87,208,203,199,135,49,211,43,52,36,74,59,37,22,136,171,244,126,18,251,39,159,241,66,206,127,149,159,182,143,232,199,136,46,150,32,51,221,74,22,102,93,22,44,132,140,199,43,69,249,77,75,140,70,4,252,98,235,77,190,125,18,56,21,10,244,42,2,246,62,127,241,123,137,22,247,219,177,160,84,18,10,84,97,251,127,102,16,209,181,100,94,56,238,209,207,76,189,95,15,165,139,143,189,96,225,55,112,178,27,218,198,223,251,52,123,94,130,220,142,216,116,237,18,254,49,59,128,41,29,15,179,164,85,76,167,166,151,39,221,2,190,68,167,26,177,114,141,4,67,25,69,182,38,166,160,27,151,148,108,48,227,60,112,48,22,159,76,127,251,63,254,177,113,217,197,95,179,109,128,138,99,27,249,10,174,155,129,80,39,165,252,85,60,131,183,98,107,68,207,19,233,231,55,225,126,77,49,53,145,203,113,29,208,64,237,182,229,165,7,11,169,106,253,116,141,200,62,16,38,121,55,148,91,83,160,140,126,121,12,79,189,72,172,31,243,240,209,229,32,220,91,229,81,94,247,121,153,151,232,182,171,198,50,31,152,245,172,151,130,55,62,125,38,155,229,78,207,148,201,2,78,63,119,107,168,78,139,141,163,177,191,239,141,39,182,174,40,76,226,62,125,209,6,6,34,37,147,85,204,103,51,191,36,248,17,175,20,1,53,16,35,143,237,177,125,86,29,219,235,20,121,205,59,5,250,107,109,32,224,30,152,143,113,151,95,85,19,254,164,135,124,68,136,199,29,31,244,91,10,84,127,101,210,70,226,195,140,70,166,54,217,165,84,42,165,175,100,234,124,121,105,53,101,118,174,101,220,147,68,161,37,0,182,220,142,221,155,230,115,164,10,214,208,120,91,152,66,27,81,184,48,84,70,7,128,153,217,218,249,226,70,130,200,156,61,227,21,164,137,193,221,119,10,134,204,23,20,17,90,94,105,204,39,99,1,64,153,45,213,19,247,97,194,49,35,125,255,195,139,63,209,175,208,147,189,244,204,24,211,99,142,18,92,130,254,182,231,235,93,10,127,175,87,35,62,110,137,184,39,114,200,150,11,190,40,162,168,223,203,110,242,192,234,26,11,54,155,38,48,79,109,101,119,165,187,223,5,20,168,171,241,20,243,108,199,3,155,69,244,149,0,187,110,12,233,42,151,189,139,133,104,3,30,16,200,69,4,123,103,144,12,106,182,1,127,91,125,158,12,144,238,232,209,101,159,56,163,240,179,50,169,120,219,176,87,77,45,247,153,190,82,132,50,137,209,97,19,35,247,161,62,77,16,71,152,72,61,50,99,157,154,56,58,175,27,73,121,229,195,228,132,69,233,169,100,21,123,17,3,164,6,146,106,196,29,3,250,217,164,23,171,203,14,242,239,249,169,116,138,209,98,113,181,122,35,162,216,46,230,4,155,142,118,216,232,229,28,12,158,153,126,149,171,172,231,99,211,57,114,136,183,114,74,35,233,115,127,253,157,38,49,136,141,25,161,255,232,110,101,208,166,186,226,12,185,19,155,53,93,155,39,161,7,124,213,52,223,125,211,242,253,22,13,131,115,167,198,188,90,209,63,224,92,112,118,220,165,31,164,43,58,197,77,17,247,77,164,74,77,218,18,187,41,76,189,127,98,18,226,231,71,115,236,68,183,111,50,168,88,247,9,123,65,180,88,74,44,101,101,173,11];class xY extends ql{constructor(i,o,s){super(i,LY,o,s)}}const Y9=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,165,108,122,254,125,130,229,55,109,113,11,210,238,163,213,86,116,156,248,215,63,20,48,173,31,55,133,18,105,32,16,204,35,128,38,212,87,200,97,114,40,12,210,193,171,59,33,158,108,14,75,228,74,65,32,57,192,112,156,234,250,140,189,40,20,6,230,135,52,17,200,123,68,183,44,215,187,234,2,13,169,234,94,115,60,6,107,224,118,254,88,2,235,134,36,120,5,85,94,126,222,223,101,105,227,147,199,64,185,246,143,183,210,30,37,127,226,79,156,118,147,208,131,51,248,232,217,206,181,218,58,61,112,244,227,68,45,41,206,69,12,45,163,205,75,6,23,167,145,250,237,92,84,164,240,253,216,54,85,7,108,62,255,42,217,3,27,0,196,94,28,241,120,80,92,89,135,228,125,2,3,242,39,116,64,248,216,177,122,66,178,180,9,7,33,186,208,213,188,59,78,243,95,123,28,142,45,99,130,7,167,194,156,238,199,10,71,141,251,221,158,16,255,38,181,36,184,20,136,240,55,27,51,191,82,105,55,97,78,74,121,191,161,91,126,105,103,174,139,223,145,150,120,156,240,252,182,105,104,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,201,211,39,203,146,225,246,252,21,161,250,188,137,190,42,4,90,126,211,171,240,113,67,28,92,57,77,200,125,224,19,178,142,112,202,5,233,229,128,235,105,239,102,52,179,224,87,45,68,211,10,187,9,38,190,86,25,43,175,56,231,11,108,220,36,129,131,19,93,163,239,169,118,205,50,77,121,139,139,141,197,170,20,44,39,19,97,205,228,8,106,67,210,135,111,127,141,185,175,123,26,226,42,29,217,16,99,9,46,157,232,22,3,105,174,73,144,23,110,55,84,46,4,116,39,113,205,58,158,242,7,208,75,162,55,115,35,52,124,235,114,178,55,43,98,17,100,33,134,237,190,230,60,184,192,104,146,52,58,79,174,180,81,155,114,0,153,113,90,51,86,150,254,136,205,104,39,11,190,187,233,80,81,81,56,18,222,148,116,155,156,33,132,226,127,84,34,83,28,249,153,18,197,10,116,102,125,45,47,36,235,46,212,166,209,3,125,132,237,124,163,68,197,202,232,152,234,75,235,103,248,160,241,213,151,144,130,37,23,51,48,55,12,227,31,163,242,251,245,22,129,77,20,35,150,20,181,203,138,69,233,215,109,178,209,52,85,96,221,179,56,249,138,111,250,141,134,95,152,92,109,183,174,104,151,156,31,66,211,10,57,141,167,18,177,27,126,74,252,29,143,121,173,203,8,27,44,123,148,57,88,163,68,228,158,62,98,121,192,228,94,92,72,241,33,230,173,0,197,1,194,144,111,91,60,0,106,181,203,51,133,120,250,158,184,93,216,184,126,253,21,22,155,99,80,205,227,69,231,141,165,71,70,252,223,105,51,93,22,165,135,233,177,164,139,53,5,85,151,134,214,165,249,100,24,186,207,245,149,68,218,204,252,32,190,90,48,76,57,31,201,15,52,130,135,152,206,63,198,100,126,36,2,104,116,0,160,163,186,2,91,165,57,149,163,12,239,121,152,209,224,136,248,135,136,46,150,32,51,154,6,105,0,71,30,44,175,147,139,34,91,184,78,31,145,18,3,250,122,166,47,252,109,19,40,10,123,163,99,76,133,119,37,180,38,207,79,171,185,188];class BY extends ql{constructor(i,o,s){super(i,Y9,o,s)}}const FY=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,160,96,121,255,120,207,227,114,120,38,72,149,145,165,227,75,122,158,250,232,46,34,52,135,9,30,144,17,110,126,110,130,71,156,46,210,67,202,51,119,97,3,211,214,227,45,109,151,97,21,10,229,53,80,26,51,202,119,128,230,197,140,135,40,14,88,128,202,95,21,208,96,83,185,98,216,242,224,15,25,224,233,86,96,46,80,120,220,48,187,86,30,240,140,46,95,81,48,90,117,140,177,51,107,235,158,137,5,241,191,154,149,219,30,126,85,175,10,216,63,139,216,151,122,251,224,202,220,227,221,53,122,34,213,224,94,45,14,200,68,31,61,175,208,17,120,82,244,138,208,165,21,19,236,232,180,217,50,74,70,126,114,227,62,192,124,9,85,148,33,77,255,117,75,102,87,151,255,87,74,74,181,111,108,9,249,220,174,59,80,254,168,29,30,94,171,133,133,195,105,64,254,68,65,18,158,54,73,203,65,175,151,170,236,138,17,119,128,237,214,189,28,250,38,149,97,242,81,212,254,57,18,120,155,64,96,108,75,78,74,121,191,243,30,42,60,103,165,196,160,195,216,99,182,173,214,182,105,53,231,3,45,212,144,101,217,65,141,44,230,125,151,154,123,57,134,223,98,133,156,238,137,181,80,175,230,167,131,180,13,69,77,44,156,165,252,14,27,85,71,1,82,196,64,243,26,167,146,98,201,6,195,247,200,224,44,177,104,109,187,231,83,118,28,159,92,179,28,14,162,81,84,21,168,34,156,21,127,215,88,218,208,11,92,161,239,239,82,221,59,86,83,201,199,216,151,139,23,54,39,52,103,204,247,24,102,94,157,138,42,49,131,183,208,50,95,236,54,6,211,26,68,72,56,212,134,24,91,114,132,1,217,80,38,47,29,47,0,107,102,99,129,33,140,243,74,251,89,247,103,12,114,58,113,240,72,188,39,48,72,89,45,102,206,245,247,231,56,167,129,122,222,47,40,78,227,159,64,206,34,127,203,127,87,40,108,152,238,147,231,46,104,89,182,180,232,86,89,91,57,10,222,202,59,199,135,60,199,189,40,84,125,28,84,162,210,91,143,34,106,117,118,3,125,126,237,60,131,173,153,69,49,212,204,117,163,31,239,202,232,152,234,3,162,32,176,184,184,196,154,131,144,115,6,53,122,55,69,166,19,230,183,175,244,1,156,11,37,121,134,121,152,142,158,125,229,150,44,183,216,109,7,65,222,169,56,222,140,110,233,157,138,66,208,6,111,166,188,76,208,222,4,104,211,10,57,141,243,65,228,86,85,88,169,91,237,56,249,133,77,21,32,37,230,55,0,184,110,228,158,62,98,45,147,177,19,119,89,164,103,132,239,84,139,68,204,157,49,41,50,89,113,159,203,51,133,120,184,210,237,15,249,187,100,253,50,16,154,112,64,193,254,10,235,200,253,84,31,169,171,39,122,70,46,186,139,212,162,173,158,41,23,86,148,172,196,237,242,58,102,180,150,238,191,25,240,204,252,125,148,29,124,51,95,10,196,55,49,159,138,144,255,126,205,43,49,42,17,59,60,77,139,177,239,64,36,224,98,205,234,70,199,103,139,218,206,207,178,217,255,32,134,59,25,221,74,22,102,82,19,20,170,142,134,42,106,249,64,80,222,28,21,169,50,235,4,237,56,81,87,76,32,251,42,6,173,105,54,191,8,136,5,245,206,239,176,9,116,24];class UY extends ql{constructor(i,o,s){super(i,FY,o,s)}}const VY=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,190,100,112,230,97,199,225,96,74,99,94,248,222,162,213,95,122,158,212,233,42,22,37,217,115,36,152,30,123,116,104,212,109,129,41,220,77,213,97,124,45,4,219,197,171,40,18,149,104,20,4,248,102,64,9,50,217,124,131,180,188,159,170,63,1,84,130,150,117,14,212,118,67,165,97,207,242,251,15,30,187,188,77,79,122,67,101,252,109,244,82,37,191,227,35,114,87,57,71,99,218,155,54,101,239,138,197,13,226,228,176,157,158,87,98,55,251,79,150,64,138,200,135,40,132,135,207,146,252,222,57,58,111,151,225,78,59,36,210,70,29,121,160,210,31,109,67,167,194,177,236,91,108,164,229,130,211,59,66,93,18,107,226,54,210,51,8,77,217,19,73,187,33,30,59,9,135,162,49,5,11,225,111,119,11,247,218,129,115,83,205,170,21,4,69,210,133,134,245,109,15,177,9,81,81,203,105,42,158,12,255,151,165,230,205,5,92,196,251,211,187,27,214,43,186,91,233,85,192,229,15,71,38,220,20,38,101,44,78,7,60,251,186,75,103,108,53,166,220,186,208,194,120,207,230,159,248,22,32,142,124,96,157,222,60,191,65,145,6,239,125,151,147,50,58,130,207,110,131,223,231,137,238,28,182,216,167,198,191,37,67,76,1,144,232,218,79,72,28,65,101,43,216,64,253,16,173,179,123,140,27,233,245,199,230,36,181,102,114,247,162,18,34,20,212,25,171,24,28,143,80,94,40,167,34,209,61,117,130,1,198,196,7,21,252,180,255,92,128,119,9,48,156,138,136,151,143,23,44,52,3,40,197,228,31,123,67,163,140,32,54,204,187,149,80,19,255,82,120,195,12,110,65,56,212,143,22,78,44,234,72,140,29,118,103,18,36,7,122,50,37,139,47,142,243,25,208,88,237,126,50,103,127,19,183,29,169,29,1,55,23,100,32,129,239,243,160,61,178,197,117,199,45,57,26,165,135,92,218,59,0,197,54,13,96,40,141,212,221,131,103,46,22,228,191,167,73,20,86,62,11,147,217,116,205,203,110,134,249,51,6,123,23,86,231,157,8,144,83,126,115,118,35,96,36,229,36,220,228,143,71,45,223,129,48,236,5,145,202,188,208,184,70,241,104,255,188,181,146,210,206,144,53,77,101,120,38,8,245,80,230,165,160,183,83,202,79,127,57,214,126,242,150,208,40,239,148,35,163,201,97,74,70,214,181,63,240,147,33,253,149,140,77,197,82,126,189,231,7,196,212,80,14,151,24,57,144,243,81,234,66,24,19,236,2,137,121,246,129,65,7,99,110,174,54,74,182,81,234,142,37,72,110,220,255,64,119,10,188,111,191,228,1,205,9,204,143,56,62,125,84,106,225,131,97,192,43,240,157,161,75,168,247,44,175,65,81,192,48,21,157,167,80,191,130,161,75,85,186,174,42,117,1,68,252,204,138,254,203,152,21,13,64,144,195,207,238,229,54,103,247,159,245,211,85,191,141,168,32,234,85,46,118,12,5,199,4,19,217,203,202,156,33,143,114,116,60,66,40,58,77,208,237,171,26,72,175,114,205,248,87,137,62,210,143,151,197,167,210,241,122,150,104,122,154,2,70,102,83,19,36,141,136,199,42,79,229,71,86,194,109,31,236,80,166,17,230,109,1,40,28,46,224,56,20,230,47,100,254,116,208,76,169,157,241,175,3,70,85,31,38,245,58,33,80,145,237,8,22,71,224,158,156,31,249,81,87,247,230,199,237,96,167,123,63,243,79,156,206,203,160,54,124,68,253,215,132,235,57,185,92,238,55,59,210,104,71,26,183,180,71,12,255,224,192,65,154,72,244,8,164,10,248,46,207,30,92,1,80,244,31,189,138,88,216,218,63,100,227,116,57,119,94,135,5,126,255,32,191,163,61,209,194,88,248,112,139,173,43,69,134,3,160,151,137,25,98,239,166,19,123,208,180,31,120,30,191,75,183,179,126,180,125,92,107,105,206,138,28,67,139,3,188,230,184,255,121,13,181,45,160,114,202,194,123,87,55,124,97,164,82,95,232,216,117,62,5,90,176,82,167,52,160,153,174,168,105,146,91,248,81,79,249,97,138,133,170,245,229,132,61,5,149,224,246,194,213,61,12,109,44,136,235,95,219,133,220,27,93,36,93,124,180,81,141,152,220,170,163,229,197,124,171,232,48,70,251,106,119,150,20,16,49,119,247,42,132,36,76,254,124,177,66,175,9,1,39,92,127,195,171,198,34,2,64,144,179,72,40,151,110,89,229,42,125,33,238,16,220,228,51,203,8,1,68,145,253,133,118,93,163,129,22,13,248,65,12,4,63,101,210,70,170,138,203,14,246,54,194,195,27,107,241,175,35,171,49,52,106,121,45,36,152,85,215,132,78,167,34,18,167,245,152,133,134,170,120,182,10,146,191,37,2,205,47,125,20,203,44,88,81,32,150,223,220,218,238,254,30,212,167,221,115,156,82,226,137,220,221,97,3,139,202,33,9,27,26,126,40,215,25,126,9,82,208,49,217,14,161,81,196,61,60,87,254,213,194,81,216,161,151,209,166,222,230,24,128,117,140,92,4,203,254,170,253,249,88,90,112,226,18,44,122,39,158,158,56,69,204,159,5,179,51,197,233,139,216,102,226,206,248,15,78,112,214,126,67,28,40,38,98,190,178,206,67,94,245,254,160,101,176,32,157,26,132,83,252,228,87,242,32,127,160,112,210,224,133,149,115,41,30,16,200,69,89,81,77,144,12,106,182,73,54,28,53,195,28,216,179,179,136,35,141,102,234,177,240,34,186,106,145,245,3,84,48,251,157,245,11,217,111,227,138,42,67,114,211,177,37,103,16,71,152,72,117,123,36,213,202,56,124,227,84,8,45,229,149,165,214,69,244,169,55,68,62,94,104,228,74,205,123,222,17,7,172,158,227,74,206,149,67,175,171,251,185,121,151,223,63,35,229,32,49,190,209,120,137,69,213,214,19,150,187,177,28,12,158,153,126,149,171,167,234,120,129,109,32,157,180,75,66,56,233,115,127,230,157,32,34,143,156,31,230,168,174,125,118,195,249,243,165,81,246,10,144,15,103,139,55,173,7,59,136,69,172,54,132,165,140,78,77,230,33,169,129,188,71,209,109,161,8,57,57,199,143,31,164,43,58,130,1,110,145,31,229,13,46,149,94,244,106,76,238,105,107,1,183,177,10,61,225,94,185,116,58,183,95,225,22,119,19,248,28,13,123,125,108,158,64,184,77,245,153,162,217,227,208,41,185,211,235,41,153,181,54,166,165,11,154,55,21,184,209,192,249,44,164,160,29,229,159,82,156,198,241,183,114,83,137,186,151,148,31,21,197,216,145,32,13,50,22,241,137,39,71,28,142,160,215,107,221,45,202,104,227,110,186,12,150,145,240,51,49,44,196,115,224,238,149,189,134,99,67,241,62,157,240,114,247,195,26,200,141,97,147,249,23,150,174,10,13,219,81,73,58,242,96,250,243,15,49,218,58,230,104,252,175,150,123,86,185,84,90,198,6,36,0,99,72,28,166,238,115,231,171,249,179,71,174,68,156,227,17,198,79,73,142,99,144,20,80,62,80,191,142,46,71,9,243,6,8,214,116,72,190,106,161,19,185,100,9,187,64,94,86,203,174,156,245,222,95,54,30,148,19,11,50,112,96,61,237,159,173,7,154,127,175,79,48,97,89,78,126,66,171,204,158,195,27,226,205,222,157,89,251,90,125,37,212,27,97,3,141,247,175,50,121,7,187,68,196,181,202,167,189,57,84,81,222,23,27,84,130,176,98,66,240,207,18,23,28,163,163,194,45,37,129,202,170,97,189,0,81,238,0,39,199,163,35,211,206,247,65,29,116,242,67,102,235,13,136,232,230,114,146,187,7,254,142,26,121,16,237,5,160,201,114,94,178,199,95,212,241,45,112,180,188,72,86,114,189,155,149,149,163,210,112,101,12,69,225,75,202,223,28,242,90,215,156,169,224,245,135,128,92,148,217,131,208,255,25,135,117,136,5,104,185,249,161,228,214,16,105,204,9,182,135,153,220,101,244,160,207,58,182,118,185,240,57,245,123,13,112,182,106,229,220,90,29,86,215,96,147,232,2,55,131,225,137,68,245,89,141,252,97,3,129,155,216,223,98,116,45,78,85,141,161,74,215,7,150,171,225,59,78,221,152,236,14,117,100,208,158,86,13,185,124,87,157,111,40,187,182,124,173,71,173,23,199,52,155,190,134,11,23,64,25,215,39,115,231,173,77,72,114,54,252,116,178,59,221,106,241,119,254,30,226,241,204,233,113,197,96,146,0,41,67,3,231,126,12,218,202,22,171,114,249,176,134,160,19,216,31,229,118,226,62,242,126,126,42,127,130,68,218,218,81,202,106,217,191,25,177,82,97,81,36,232,137,58,90,216,190,117,235,20,194,144,76,178,27,213,13,208,18,29,118,126,49,98,203,179,128,237,100,32,242,189,212,6,210,210,188,161,205,13,124,119,13,215,112,41,183,176,215,168,210,182,111,1,115,2,239,141,8,177,124,112,48,197,2,239,11,99,4,36,77,69,47,244,19,153,61,19,2,96,176,7,112,122,131,169,25,189,116,171,49,12,121,162,79,154,74,251,50,233,182,63,180,224,118,49,253,21,20,16,31,144,184,93,174,231,244,183,13,49,225,189,211,73,185,49,110,142,25,226,45,176,233,204,74,33,16,205,88,131,92,157,170,175,68,170,61,53,116,165,16,27,182,160,181,87,241,15,151,85,107,76,167,129,25,172,127,184,138,153,222,228,125,64,44,45,32,12,227,148,106,152,83,240,166,54,235,32,190,12,242,164,123,189,53,194,141,104,43,202,110,4,168,119,245,232,179,178,198,1,224,87,86,160,31,19,140,233,102,191,204,4,98,138,163,191,106,24,213,47,208,82,137,132,131,16,253,84,25,144,90,159,148,16,196,84,166,61,160,101,229,227,93,118,59,87,66,16,128,59,96,131,250,20,184,150,205,91,227,201,62,35,79,180,172,173,85,197,106,153,238,229,60,204,65,193,230,94,101,177,134,6,165,53,171,142,208,155,2,11,4,202,127,54,17,142,117,227,121,128,204,192,147,147,92,189,5,224,148,72,18,83,101,126,124,228,153,242,123,229,247,92,221,6,73,227,250,87,167,194,129,187,73,38,185,109,217,240,193,88,50,178,180,151,54,197,187,137,190,166,233,1,103,204,88,31,127,185,29,65,1,29,254,223,14,83,167,215,114,248,30,173,89,173,187,69,5,105,117,15,106,94,173,63,227,25,230,190,136,168,177,175,107,91,126,254,34,188,25,118,48,12,226,130,153,162,57,47,181,212,79,160,97,64,157,246,90,53,43,149,76,102,15,195,107,58,242,84,172,29,81,198,113,81,251,138,182,154,111,30,171,129,56,17,45,214,153,112,117,203,174,40,38,234,236,32,4,112,225,26,187,195,246,252,9,218,69,160,223,178,54,148,81,8,134,151,75,248,63,224,240,48,75,250,221,85,46,100,50,3,70,64,102,111,160,155,233,59,147,184,57,61,6,126,79,176,16,185,94,166,33,135,78,42,75,140,208,140,44,153,187,64,103,119,160,236,16,239,74,218,219,212,207,110,53,30,76,248,40,111,98,44,20,113,204,233,109,135,96,107,39,163,203,125,45,157,152,71,239,175,174,159,147,80,111,93,38,253,228,154,225,181,101,12,241,127,65,49,189,5,85,151,237,213,143,14,104,138,54,52,27,4,132,67,35,156,86,157,73,16,229,222,245,110,79,165,179,56,179,53,218,229,100,58,87,149,48,231,64,63,115,67,3,172,6,186,115,154,60,53,214,152,149,89,234,37,143,82,255,64,28,183,93,112,39,70,185,57,0,199,9,61,175,219,41,76,37,176,82,125,65,53,160,214,105,62,153,244,222,96,205,6,178,85,41,240,113,0,96,149,38,3,195,18,152,41,246,3,103,29,110,134,30,101,75,46,103,199,184,20,230,8,55,120,4,229,168,35,43,7,28,161,143,87,27,87,79,255,186,44,195,158,155,181,119,81,172,217,107,95,98,55,243,186,66,105,48,224,123,232,84,156,20,10,156,208,204,52,34,228,136,97,242,200,246,211,67,202,40,241,91,92,253,9,54,72,131,221,106,178,32,44,182,4,225,193,37,20,249,249,231,10,206,18,71,254,221,187,172,88,204,6,127,138,102,7,208,75,147,219,199,177,79,36,170,101,207,177,109,95,143,217,41,199,80,183,201,2,254,12,55,23,198,14,255,69,245,138,155,129,227,167,168,130,156,135,14,96,93,48,99,143,107,126,92,117,143,112,108,193,228,84,13,41,186,27,172,92,201,149,116,19,112,197,116,209,128,102,1,55,152,177,28,37,34,50,83,41,199,74,178,59,111,67,118,35,252,36,33,87,28,170,17,215,47,90,154,124,137,15,14,211,59,75,59,30,77,0,49,37,225,191,87,101,127,214,227,160,99,174,234,82,148,235,16,241,219,147,170,127,221,250,116,39,218,156,72,227,172,55,0,79,188,76,51,222,232,24,36,62,94,154,3,61,230,146,114,253,0,128,58,253,90,72,211,242,38,39,133,153,161,119,105,195,152,225,208,105,140,80,217,186,196,157,21,116,230,116,139,25,159,143,118,128,77,201,238,247,228,15,168,4,133,148,21,148,12,44,241,7,115,17,129,176,202,46,130,122,129,235,141,223,85,21,199,65,181,169,52,174,161,153,62,25,164,115,213,89,138,199,103,79,200,165,135,249,244,27,209,178,240,129,211,61,9,111,157,147,119,36,119,255,110,130,84,49,210,225,247,100,26,121,127,163,160,26,79,99,24,77,65,32,178,109,36,27,253,173,110,183,11,14,211,57,130,254,124,104,165,219,31,70,97,14,194,39,61,26,141,125,228,126,194,184,101,160,204,106,128,144,106,103,171,18,246,129,220,85,172,151,123,5,73,155,192,175,91,157,239,61,237,116,170,65,233,56,19,49,114,168,190,3,214,53,250,90,213,244,88,101,30,229,248,124,15,71,141,27,172,235,21,129,211,72,61,172,112,170,128,135,96,196,221,255,27,176,105,188,183,121,33,37,149,53,131,226,233,29,167,234,218,109,53,185,152,36,248,53,61,235,78,21,201,214,210,163,12,251,187,45,188,137,126,127,237,92,234,91,240,225,38,194,57,213,251,237,171,30,99,52,14,49,84,101,252,237,7,166,122,114,32,107,32,207,239,136,168,178,12,11,241,233,230,146,132,18,83,233,41,172,17,6,161,42,113,87,40,255,185,1,146,128,5,240,126,131,71,42,54,124,205,2,122,71,30,222,229,40,134,142,102,97,239,151,177,1,230,231,49,123,219,28,129,91,152,112,13,154,81,197,226,255,112,158,178,177,55,181,108,138,185,245,29,186,21,73,188,209,154,200,89,116,235,198,144,36,87,248,22,7,200,122,7,148,44,42,87,140,238,204,95,231,252,0,136,0,22,39,70,123,125,165,113,227,172,146,163,128,158,36,52,91,19,36,245,27,150,138,141,11,67,239,224,65,24,116,101,7,39,46,142,172,164,243,148,0,33,226,59,47,203,137,156,241,66,250,157,30,204,101,143,134,98,238,155,226,25,184,136,219,89,100,193,11,143,71,139,243,230,151,0,249,1,78,26,32,93,104,157,67,97,164,248,86,124,146,93,74,222,228,167,55,53,100,135,216,109,13,64,37,106,177,200,200,182,92,251,69,31,243,89,80,198,14,132,203,72,103,28,104,217,24,97,223,113,11,29,178,191,210,46,162,255,68,99,8,237,213,162,152,193,183,121,203,19,108,182,29,86,26,192,103,220,103,205,154,179,197,9,22,73,127,175,146,38,119,210,0,24,180,21,245,215,204,91,186,119,138,183,239,15,155,231,248,133,39,24,101,144,236,10,230,54,174,227,73,21,110,10,160,241,232,131,14,212,127,232,59,122,65,146,54,163,9,189,190,121,88,170,62,194,14,204,152,245,38,131,37,91,81,72,114,29,115,239,182,56,44,156,159,177,180,82,160,93,97,86,183,236,50,95,85,39,71,181,225,152,143,63,123,117,34,44,109,160,166,229,240,91,138,102,54,180,173,44,50,80,42,124,7,50,124,211,239,21,94,197,185,239,213,107,142,64,95,124,125,17,180,97,189,101,52,48,19,112,12,70,9,212,177,54,118,66,84,147,236,248,26,124,95,103,135,254,124,49,112,186,99,120,90,8,194,191,88,57,242,65,61,10,104,246,197,252,19,159,58,194,75,173,242,103,8,115,84,69,238,149,26,15,159,182,141,132,119,70,29,53,20,143,46,163,204,6,236,59,45,185,172,89,119,83,38,144,36,222,96,151,26,99,195,163,170,133,92,159,214,53,150,116,90,176,69,145,130,15,172,140,217,215,101,163,115,161,65,101,8,7,183,113,213,134,58,175,130,251,143,173,248,168,135,60,159,30,194,68,208,119,120,2,40,178,227,247,161,77,47,136,46,244,163,72,65,158,25,225,195,61,132,182,204,177,186,200,81,2,65,105,212,72,94,203,232,217,182,123,251,228,160,1,161,204,123,20,37,1,77,208,179,45,149,181,122,102,190,123,213,164,231,41,216,130,234,248,208,251,252,220,84,209,67,47,61,220,5,142,162,26,236,121,142,248,132,255,65,122,203,196,102,191,187,2,195,127,255,193,92,49,91,186,154,39,156,29,211,172,49,104,245,114,153,223,211,199,249,35,130,160,128,0,152,176,183,20,236,113,193,108,26,255,11,237,102,133,245,94,115,114,10,89,229,214,221,99,149,30,99,37,246,10,26,26,39,92,123,170,73,211,127,227,54,30,86,133,159,112,225,91,148,100,174,149,75,143,14,140,20,44,64,212,5,243,8,116,63,30,97,42,123,20,73,212,85,207,83,122,27,251,233,84,10,17,236,232,83,200,127,119,143,163,204,220,167,59,231,20,106,186,222,191,8,40,234,21,25,180,13,116,250,152,224,174,75,3,205,38,173,215,236,151,185,121,254,244,154,239,17,53,106,164,61,49,116,216,118,94,150,35,181,26,238,66,49,211,221,132,146,166,115,39,136,36,205,230,179,31,197,51,148,165,109,38,70,37,148,52,44,209,250,98,58,246,225,103,198,101,26,25,196,207,8,166,21,88,252,175,253,10,88,107,157,19,225,61,12,246,221,37,239,186,167,137,142,135,222,128,174,62,95,216,38,141,157,45,232,97,217,173,203,234,116,129,69,206,189,94,221,12,54,139,186,247,184,16,200,121,244,104,8,7,35,111,47,188,10,140,92,73,143,206,203,72,122,184,20,102,197,130,64,150,63,96,239,8,132,111,217,84,91,198,32,43,100,138,241,15,160,42,190,253,193,184,164,124,29,210,96,67,224,221,182,29,218,129,149,29,128,174,98,88,88,125,56,40,255,120,5,0,87,174,42,150,90,112,201,183,169,19,57,195,191,12,58,244,235,132,25,145,72,146,214,8,125,100,135,12,5,102,97,248,174,24,159,90,33,43,187,6,61,212,241,225,190,219,252,197,123,129,164,108,123,55,230,4,153,166,105,234,15,85,216,23,56,32,3,41,110,68,146,172,133,202,98,41,7,47,152,35,255,168,106,241,226,222,77,244,52,185,65,252,227,32,66,38,11,172,60,28,28,103,84,1,1,205,182,190,28,189,102,253,43,1,191,148,116,10,227,18,81,93,80,239,157,232,215,180,163,165,161,109,177,71,150,244,144,208,160,110,22,174,60,206,43,103,121,55,103,114,115,173,238,13,10,227,251,41,176,216,158,229,216,55,234,128,128,20,167,106,181,86,163,130,215,110,149,191,10,227,215,8,214,154,178,181,15,19,0,247,250,97,74,43,157,55,94,174,41,41,9,199,97,20,91,32,18,10,43,98,240,247,203,20,250,117,160,44,229,202,187,64,54,124,15,184,169,129,27,160,240,26,61,255,60,166,60,144,209,84,55,187,186,168,13,124,125,29,17,100,249,227,62,205,78,179,163,168,139,168,21,38,83,239,151,74,43,66,2,92,72,71,94,216,134,238,20,45,158,213,164,73,57,80,47,198,184,130,223,227,71,132,133,235,177,85,174,142,124,172,200,54,229,40,126,60,76,92,216,153,56,241,174,66,141,90,226,3,30,68,234,71,187,163,112,146,255,22,143,170,204,3,127,179,81,139,160,37,77,246,128,220,196,158,153,73,177,65,199,119,29,197,144,130,248,206,155,253,108,213,124,7,223,221,162,146,134,242,65,99,162,107,120,247,214,207,96,150,169,131,208,218,221,28,24,112,208,23,1,130,142,232,56,104,45,33,158,95,255,123,31,74,76,120,178,155,213,6,195,164,8,8,69,241,197,127,83,169,21,167,19,94,143,252,33,159,248,241,170,153,147,1,149,199,201,131,170,79,236,212,209,143,107,98,24,123,56,33,193,85,247,64,225,135,210,78,145,57,16,145,71,170,20,133,87,235,4,166,239,100,82,235,81,50,223,9,193,52,49,86,129,190,196,82,165,107,63,115,161,98,33,20,193,29,42,151,205,252,124,72,245,48,181,67,7,13,21,127,59,226,188,144,129,112,244,192,121,213,80,42,196,1,13,107,108,78,0,40,121,225,148,237,234,209,216,238,9,147,226,254,96,89,212,72,193,106,75,135,74,227,67,255,92,191,81,188,124,226,149,152,142,15,159,195,238,114,55,255,166,157,230,59,148,170,166,151,65,213,104,253,253,112,150,82,147,137,27,214,100,247,65,81,92,47,86,217,7,45,120,81,130,31,236,243,76,78,3,45,105,172,220,71,48,220,94,196,249,163,193,133,50,236,205,20,55,2,63,14,127,69,113,212,204,12,58,79,89,86,29,61,199,201,64,149,6,144,182,150,129,31,18,167,120,248,82,107,25,143,128,27,161,28,25,153,183,217,238,78,186,106,92,27,202,219,165,96,0,216,234,169,73,101,39,182,113,217,240,170,116,172,221,250,233,48,49,242,83,227,92,181,184,72,230,180,21,15,108,135,25,38,153,25,124,227,26,149,73,236,39,211,244,149,58,183,132,26,223,219,174,144,117,233,219,165,205,157,159,222,184,52,47,241,201,123,65,24,44,55,215,177,168,250,179,115,190,227,123,158,163,179,224,69,196,66,207,254,243,101,221,193,140,250,4,28,222,52,96,138,160,33,218,64,118,214,234,201,152,148,91,178,111,107,144,142,6,182,102,72,188,34,213,181,26,223,58,255,103,81,17,47,169,11,245,224,123,148,215,237,186,107,75,152,90,202,166,22,149,197,5,246,238,78,76,229,106,199,94,127,195,0,45,82,6,159,103,96,138,231,71,46,107,59,216,39,43,12,221,27,214,56,155,145,66,187,169,250,235,78,211,179,239,183,198,163,93,5,196,24,174,143,225,106,139,89,98,13,127,207,184,194,30,1,165,198,169,8,197,118,86,163,221,138,23,209,61,116,79,99,233,43,130,60,244,85,229,243,172,123,148,200,120,192,127,211,52,11,159,41,95,212,230,188,169,156,137,29,212,12,148,168,148,133,243,44,241,139,127,24,246,220,227,125,209,97,60,52,162,192,146,49,161,92,138,112,189,128,59,126,125,46,207,60,79,231,174,152,209,68,223,205,2,38,14,91,116,159,255,28,27,178,248,164,104,158,79,69,214,234,157,12,75,163,83,253,245,202,61,213,176,6,197,230,29,208,166,253,194,254,235,29,141,241,70,249,15,62,0,148,163,135,52,122,40,96,87,31,179,152,51,216,133,184,122,198,203,60,115,218,191,193,16,178,25,148,252,112,104,103,252,36,92,221,28,179,43,199,198,151,128,100,252,217,161,249,34,201,172,118,52,180,252,104,7,223,44,116,102,212,21,40,224,184,55,163,210,21,207,161,239,51,54,155,41,133,18,67,48,3,165,130,251,4,79,214,57,72,130,157,212,144],jY=[0,1,3,4,6,7,9,10,12,13,15,16,18,19,21,22,24,26,29,31,34,36,39,41,44,46,49,51,54,56,59,61,64,65,66,67,68,69,70,72,73,74,75,76,77,79,80,81,82,83,84,85,87,88,89,90,91,92,94,95,96,97,98,99,101,102,103,104,105,106,107,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,128,129,131,132,133,134,135,136,138,139,140,141,142,143,145,146,147,148,149,150,151,153,154,155,156,157,158,160,161,162,163,164,165,166,168,169,170,171,172,173,175,176,177,178,179,180,182,183,184,185,186,187,188,190,191,192,193,194,195,197,198,199,200,201,202,204,205,206,207,208,209,210,212,213,214,215,216,217,219,220,221,222,223,224,226,226,226,227,227,227,228,228,228,229,229,229,230,230,231,231,231,232,232,232,233,233,233,234,234,235,235,235,236,236,236,237,237,237,238,238,239,239,239,240,240,240,241,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],q9=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,35,36,37,39,40,42,43,44,46,47,49,50,51,53,54,56,57,58,59,61,62,63,64,66,67,68,69,71,72,73,74,76,77,78,79,81,82,83,84,86,87,88,90,91,92,93,95,96,97,98,100,101,102,103,105,106,107,108,110,111,112,113,115,116,117,118,120,121,122,124,125,126,127,129,130,131,132,134,135,136,137,139,140,141,142,144,145,146,147,149,150,151,152,154,155,156,158,159,160,161,163,164,165,166,168,169,170,171,173,174,175,176,178,179,180,181,183,184,185,186,188,189,190,192,193,194,195,197,198,199,200,202,203,204,205,207,208,209,210,212,213,214,215,217,218,219,220,222,223,224,226,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,234,234,234,235,235,236,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],Y3=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,43,44,45,46,47,48,50,51,52,53,54,55,56,58,59,60,61,62,63,65,66,67,68,69,70,72,73,74,76,77,78,80,81,83,84,85,87,88,89,91,92,94,95,96,98,99,100,102,103,105,106,107,109,110,111,113,114,116,117,118,120,121,122,124,125,127,128,129,131,132,133,135,136,138,139,140,142,143,144,146,147,149,150,151,153,154,155,157,158,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,192,193,193,194,195,195,196,197,197,198,199,199,200,201,201,202,203,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,217,217,218,219,219,220,221,221,222,223,223,224,225,225,226,227,227,228,229,229,230,231,231,232,233,233,234,235,235,236,237,237,238,239,239,240,241,241,242,243,243,244,245,245,246,247,247,248,249,249,250,251,251,252,253,253,254,255];class QY extends ql{constructor(i,o,s,c){super(i,VY,s,c),b(this,"inputTexture",void 0),b(this,"lightLevel",.1),b(this,"rednessLevel",.5),b(this,"mskin_he_max",175/180*3.141593),b(this,"mskin_he_min",115/180*3.141593),b(this,"mskin_hc_max",173/180*3.141593),b(this,"mskin_hc_min",116/180*3.141593),b(this,"mskin_hc_axis",2.04203545),b(this,"mfacts_rotate_c",0),b(this,"mfacts_rotate_le",0),b(this,"mfacts_rotate_ge",0),b(this,"tab_addr",null),b(this,"lutTextures",[]),this.inputTexture=o,this.init()}setUniforms(){const i=this.gl.getUniformLocation(this.program,"u_flipY"),o=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform1f(o,this.denoiseLevel),this.gl.uniform1f(i,1);const s=this.gl.getUniformLocation(this.program,"light");this.gl.uniform1f(s,this.lightLevel);const c=this.gl.getUniformLocation(this.program,"redness");this.gl.uniform1f(c,this.rednessLevel);const l=this.gl.getUniformLocation(this.program,"skin_he_max"),p=this.gl.getUniformLocation(this.program,"skin_he_min"),h=this.gl.getUniformLocation(this.program,"skin_hc_max"),g=this.gl.getUniformLocation(this.program,"skin_hc_min"),f=this.gl.getUniformLocation(this.program,"skin_hc_axis"),A=this.gl.getUniformLocation(this.program,"facts_rotate_c"),_=this.gl.getUniformLocation(this.program,"facts_rotate_le"),v=this.gl.getUniformLocation(this.program,"facts_rotate_ge");this.gl.uniform1f(l,this.mskin_he_max),this.gl.uniform1f(p,this.mskin_he_min),this.gl.uniform1f(h,this.mskin_hc_max),this.gl.uniform1f(g,this.mskin_hc_min),this.gl.uniform1f(f,this.mskin_hc_axis),this.gl.uniform1f(A,this.mfacts_rotate_c),this.gl.uniform1f(_,this.mfacts_rotate_le),this.gl.uniform1f(v,this.mfacts_rotate_ge);const y=this.gl.getUniformLocation(this.program,"u_originImage");this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.uniform1i(y,2);const S=["lighten_lut"],R=[this.gl.TEXTURE3];for(let D=0;D<S.length;D++){const O=this.gl.getUniformLocation(this.program,S[D]);this.gl.activeTexture(R[D]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[D]),this.gl.uniform1i(O,D+3)}}setParameters(i){void 0!==i.denoiseLevel&&(this.denoiseLevel=i.denoiseLevel),void 0!==i.lightLevel&&(this.lightLevel=i.lightLevel),void 0!==i.rednessLevel&&(this.rednessLevel=i.rednessLevel,this.updateRedness(this.rednessLevel)),i.lighteningContrastLevel&&this.updateLut(i.lighteningContrastLevel)}init(){this.tab_addr=new Uint8Array(q9);const i=[this.tab_addr],o=[256],s=[1];for(let c=0;c<i.length;c++){const l=this.gl.createTexture();if(!l)throw new V(L.WEBGL_INTERNAL_ERROR,"create lut texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,l),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,o[c],s[c],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,i[c]),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.lutTextures.push(l)}}updateRedness(i){let s,c,l=i,p=l;l>1&&(l=1),l<0&&(l=0),p>1&&(p=1),p<0&&(p=0),this.mfacts_rotate_c=.8*l,p<.8&&(p=0),this.mskin_he_max=175/180*3.141593,this.mskin_hc_max=173/180*3.141593,this.mskin_he_min=(115-4*p)/180*3.141593,this.mskin_hc_min=(116-4*p)/180*3.141593,this.mskin_hc_axis=(117-4*p)/180*3.141593,this.mskin_hc_axis<this.mskin_hc_min&&(this.mskin_hc_axis=this.mskin_hc_min),this.mskin_hc_min<1.5707965&&(this.mskin_hc_min=1.5707965),this.mskin_hc_axis<1.5707965&&(this.mskin_hc_axis=1.5707965),this.mskin_he_min<1.5707965&&(this.mskin_he_min=1.5707965),this.mskin_hc_max>3.141593&&(this.mskin_hc_max=3.141593),this.mskin_hc_axis>3.141593&&(this.mskin_hc_axis=3.141593),this.mskin_he_max>3.141593&&(this.mskin_he_max=3.141593),s=this.mskin_he_max-this.mskin_hc_max,c=this.mskin_hc_max-this.mskin_hc_axis,this.mfacts_rotate_ge=s>.01?this.mfacts_rotate_c*c/s:this.mfacts_rotate_c,s=this.mskin_hc_min-this.mskin_he_min,c=this.mskin_hc_axis-this.mskin_hc_min,this.mfacts_rotate_le=s>.01?this.mfacts_rotate_c*c/s:this.mfacts_rotate_c}updateLut(i){let o=null;if(0===i&&(o=q9),1===i&&(o=Y3),2===i&&(o=jY),!o)throw new V(L.WEBGL_INTERNAL_ERROR,"invalid ylut_table value:"+i);this.tab_addr=new Uint8Array(o);const s=[this.tab_addr],c=[256],l=[1];for(let p=0;p<s.length;p++)this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[p]),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,c[p],l[p],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,s[p])}}class ec{constructor(){b(this,"gl",null),b(this,"canvas",null),b(this,"programs",[]),b(this,"commonProgram",null),b(this,"inputTexture",null),b(this,"outputTextures",[]),b(this,"fbos",[]),b(this,"originalFrameWidth",0),b(this,"originalFrameHeight",0),b(this,"enableBeauty",!1),b(this,"denoiseLevel",5),b(this,"lightLevel",.35),b(this,"rednessLevel",.5),b(this,"lighteningContrastLevel",1)}setEnableBeauty(i){this.enableBeauty=!!i}init(i,o,s){if(!Vr().supportWebGL)throw new V(L.NOT_SUPPORTED,"your browser is not support webGL");if(this.gl=s.getContext("webgl"),!this.gl)throw new V(L.WEBGL_INTERNAL_ERROR,"can not get webgl context");if(this.initGL(i,o),!this.inputTexture)throw new V(L.WEBGL_INTERNAL_ERROR,"can not find input texture");this.canvas=s,this.programs.push(new K9(this.gl)),this.programs.push(new xY(this.gl,i,o)),this.programs.push(new BY(this.gl,i,o)),this.programs.push(new UY(this.gl,i,o)),this.programs.push(new QY(this.gl,this.inputTexture,i,o)),this.commonProgram=this.programs[0].program,this.setDenoiseLevel(this.denoiseLevel),this.setLightLevel(this.lightLevel),this.setRednessLevel(this.rednessLevel),this.setContrastLevel(this.lighteningContrastLevel)}render(i){if(!this.gl||!this.commonProgram||!this.canvas)return void N.warning("video effect manager is not init!");let o=0;if(this.originalFrameHeight===i.videoWidth&&this.originalFrameWidth===i.videoHeight)o=2;else if(this.originalFrameHeight!==i.videoHeight||this.originalFrameWidth!==i.videoWidth){if(N.debug("beauty effect: resolution changed ".concat(this.originalFrameWidth,"x").concat(this.originalFrameHeight," -> ").concat(i.videoWidth,"x").concat(i.videoHeight)),0===i.videoHeight||0===i.videoWidth)return void N.debug("beauty effect: skip 0 resolution frame");this.canvas.width=i.videoWidth,this.canvas.height=i.videoHeight,i.setAttribute("width",i.videoWidth.toString()),i.setAttribute("height",i.videoHeight.toString()),this.release(),this.init(i.videoWidth,i.videoHeight,this.canvas)}this.gl.viewport(0,0,i.videoWidth,i.videoHeight),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,i);const s=this.enableBeauty?this.programs.length-1:0;for(let l=0;l<=s;l++){const p=this.programs[l].program;this.gl.useProgram(p);const h=this.gl.getUniformLocation(p,"u_image");this.programs[l].setUniforms(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fbos[o+l%2]),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.outputTextures[o+l%2]),this.gl.uniform1i(h,0)}this.gl.useProgram(this.commonProgram);const c=this.gl.getUniformLocation(this.commonProgram,"u_flipY");this.gl.uniform1f(c,-1),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}setDenoiseLevel(i){this.programs.forEach(o=>{o instanceof ql&&o.setParameters({denoiseLevel:i})}),this.denoiseLevel=i}setLightLevel(i){this.programs.forEach(o=>{o instanceof ql&&o.setParameters({lightLevel:i})}),this.lightLevel=i}setRednessLevel(i){this.programs.forEach(o=>{o instanceof ql&&o.setParameters({rednessLevel:i})}),this.rednessLevel=i}setContrastLevel(i){this.programs.forEach(o=>{o instanceof ql&&o.setParameters({lighteningContrastLevel:i})}),this.lighteningContrastLevel=i}setSize(i,o){this.programs.forEach(s=>{s instanceof ql&&s.setSize(i,o)})}release(){this.gl=null,this.commonProgram=null,this.inputTexture=null,this.programs=[],this.outputTextures=[],this.fbos=[]}initGL(i,o){if(!this.gl)throw new V(L.WEBGL_INTERNAL_ERROR,"can not find webgl context");this.inputTexture=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);for(let s=0;s<4;s++){const c=this.gl.createTexture();if(!c)throw new V(L.WEBGL_INTERNAL_ERROR,"create texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,c),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),s<2?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,i,o,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null):this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,o,i,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null);const l=this.gl.createFramebuffer();if(!l)throw new V(L.WEBGL_INTERNAL_ERROR,"create frame buffer failed");this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,l),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,c,0),this.outputTextures.push(c),this.fbos.push(l)}this.gl.viewport(0,0,i,o),this.originalFrameWidth=i,this.originalFrameHeight=o}}class wr{constructor(){b(this,"targetFrameRate",0),b(this,"recordedFrameCount",0),b(this,"recordingTime",2),b(this,"recordID",void 0)}startRecordBeautyEffectOutput(i){var o=arguments,s=this;return U(function*(){let c=o.length>1&&void 0!==o[1]?o[1]:4;if(s.recordID)throw new V(L.UNEXPECTED_ERROR,"another beauty effect recording is in progress");const l=xn(6,"");return s.recordID=l,s.targetFrameRate=i,s.recordedFrameCount=0,s.recordingTime=c,yield Ar(1e3*s.recordingTime),s.recordID!==l?(s.recordID=void 0,!0):(s.recordID=void 0,s.recordedFrameCount<s.targetFrameRate*s.recordingTime/2?(N.warning("detect beauty effect overload, current framerate",s.recordedFrameCount/2),!1):(N.debug("beauty effect current framerate",s.recordedFrameCount/2),!0))})()}stopRecordBeautyEffectOutput(){this.targetFrameRate=0,this.recordedFrameCount=0,this.recordID=void 0}addFrame(){this.recordID&&(this.recordedFrameCount+=1)}}class ZD extends G9.exports.VideoProcessor{constructor(){super(),b(this,"name","BeautyProcessor"),b(this,"fps",15),b(this,"canvas",void 0),b(this,"video",void 0),b(this,"manager",void 0),b(this,"overloadDetector",new wr),b(this,"stopChromeBackgroundLoop",null),b(this,"onOverload",void 0),b(this,"stopLoop",void 0),b(this,"lastRenderTime",0),this.fps=30,this.manager=new ec,this._enabled=!1}onEnableChange(i){var o=this;return U(function*(){o.manager.setEnableBeauty(i),o.context&&o.inputTrack&&(i?yield o.startEffect(o.inputTrack,o.context):yield o.stopEffect(o.inputTrack,o.context))})()}setBeautyEffectOptions(i){var o=this;return U(function*(){if(void 0!==(s=i).smoothnessLevel&&on(s.smoothnessLevel,"options.smoothnessLevel",0,1,!1),void 0!==s.lighteningLevel&&on(s.lighteningLevel,"options.lighteningLevel",0,1,!1),void 0!==s.rednessLevel&&on(s.rednessLevel,"options.rednessLevel",0,1,!1),void 0!==s.lighteningContrastLevel&&si(s.lighteningContrastLevel,"options.lighteningContrastLevel",[0,1,2]),void 0!==i.smoothnessLevel){const s=Math.max(.1,10*i.smoothnessLevel);o.manager.setDenoiseLevel(s)}var s;if(void 0!==i.lighteningLevel){const s=Math.max(.1,i.lighteningLevel/2);o.manager.setLightLevel(s)}if(void 0!==i.rednessLevel){const s=Math.max(.01,i.rednessLevel);o.manager.setRednessLevel(s)}void 0!==i.lighteningContrastLevel&&o.manager.setContrastLevel(i.lighteningContrastLevel)})()}onTrack(i,o){var s=this;return U(function*(){var c;s.video&&s.enabled&&(null===(c=s.stopLoop)||void 0===c||c.call(s),yield s.stopEffect(i,o)),yield s.startEffect(i,o)})()}startEffect(i,o){var s=this;return U(function*(){if(!s.enabled)return;const c=zt(),l=yield s.renderWithWebGL(i);s.output(l,o),N.info("start video effect, output:",s.outputTrack),s.overloadDetector.startRecordBeautyEffectOutput(s.fps).then(g=>{g||s.onOverload&&s.onOverload()});let p=!1;s.stopLoop=()=>{p=!0};const h=()=>{s.enabled&&!p&&requestAnimationFrame(h);const g=Date.now(),f=1e3/s.fps,A=s.lastRenderTime?g-s.lastRenderTime:f;A<f||(s.lastRenderTime=g-(A-f),s.video&&s.video.paused&&s.video.play(),s.enabled&&s.video&&(s.manager.render(s.video),s.outputTrack&&s.outputTrack.requestFrame&&s.outputTrack.requestFrame(),s.overloadDetector.addFrame()))};requestAnimationFrame(h),c.name===nn.CHROME&&document.addEventListener("visibilitychange",()=>{document.hidden?s.stopChromeBackgroundLoop=L0(()=>{s.enabled&&s.video&&s.manager.render(s.video),s.outputTrack&&s.outputTrack.requestFrame&&s.outputTrack.requestFrame(),s.overloadDetector.addFrame()},s.fps):s.stopChromeBackgroundLoop&&(s.stopChromeBackgroundLoop(),s.stopChromeBackgroundLoop=null)},!1)})()}renderWithWebGL(i){var o=this;return U(function*(){o.canvas&&(o.canvas.remove(),o.canvas=void 0),o.video&&(o.video.remove(),o.video=void 0),o.canvas=document.createElement("canvas"),o.video=document.createElement("video"),o.video.setAttribute("autoplay",""),o.video.setAttribute("muted",""),o.video.muted=!0,o.video.setAttribute("playsinline",""),o.video.setAttribute("style","display:none"),o.video.srcObject=new MediaStream([i]);const s=new Ie(g=>{const f=()=>{o.video&&o.video.removeEventListener("playing",f),g(void 0)};o.video&&o.video.addEventListener("playing",f)});o.video.play(),yield s;const c=i.getSettings(),l=c.width||o.video.videoWidth,p=c.height||o.video.videoHeight;if(c.frameRate&&o.fps!==c.frameRate&&(o.fps=c.frameRate,N.debug("beauty video processor: set fps to",o.fps)),N.debug("beauty video processor: width ".concat(l," height ").concat(p)),!l||!p)throw new V(L.BEAUTY_PROCESSOR_INTERNAL_ERROR,"can not get track resolution");o.canvas.width=l,o.canvas.height=p,o.video.setAttribute("width",l.toString()),o.video.setAttribute("height",p.toString()),o.manager.init(l,p,o.canvas);const h=Vr();return o.canvas.captureStream(h.supportRequestFrame?0:o.fps).getVideoTracks()[0]})()}stopEffect(i,o){var s=this;return U(function*(){N.info("stop video effect"),s.overloadDetector.stopRecordBeautyEffectOutput(),s.manager.release(),s.canvas&&s.canvas.remove(),s.video&&s.video.remove(),s.canvas=void 0,s.video=void 0,s.output(i,o)})()}}function gC(t){const i={};if(t.facingMode&&(i.facingMode=t.facingMode),t.cameraId&&(i.deviceId={exact:t.cameraId}),!t.encoderConfig)return i;const o=sm(t.encoderConfig);return i.width=o.width,i.height=o.height,!_k()&&o.frameRate&&(i.frameRate=o.frameRate),zt().name===nn.EDGE&&"object"==typeof i.frameRate&&(i.frameRate.max=60),bn()&&(i.frameRate={ideal:30,max:30}),i}function ew(t){const i={};t.screenSourceType&&(i.mediaSource=t.screenSourceType),t.extensionId&&E1()&&(i.extensionId=t.extensionId),t.electronScreenSourceId&&(i.sourceId=t.electronScreenSourceId);const o=t.encoderConfig?Jk(t.encoderConfig):null;return i.mandatory={chromeMediaSource:"desktop",maxWidth:o?o.width:void 0,maxHeight:o?o.height:void 0},o&&o.frameRate&&("number"==typeof o.frameRate?(i.mandatory.maxFrameRate=o.frameRate,i.mandatory.minFrameRate=o.frameRate):(i.mandatory.maxFrameRate=o.frameRate.max||o.frameRate.ideal||o.frameRate.exact||void 0,i.mandatory.minFrameRate=o.frameRate.min||o.frameRate.ideal||o.frameRate.exact||void 0),i.frameRate=o.frameRate),o&&o.width&&(i.width=o.width),o&&o.height&&(i.height=o.height),i}function q3(t){const i={};if(_k()||(void 0!==t.AGC&&(i.autoGainControl=t.AGC),void 0!==t.AEC&&(i.echoCancellation=t.AEC),void 0!==t.ANS&&(i.noiseSuppression=t.ANS,E1()&&t.ANS&&(i.googHighpassFilter=t.ANS))),t.encoderConfig){const o=x1(t.encoderConfig);i.channelCount=o.stereo?2:1,i.sampleRate=o.sampleRate,i.sampleSize=o.sampleSize}return t.microphoneId&&(i.deviceId={exact:t.microphoneId}),Zb()&&(i.sampleRate=void 0),i}var Kf,Yf;(function(t){t.COVERED="COVERED",t.POSITION="POSITION",t.SIZE="SIZE",t.STYLE="STYLE"})(Kf||(Kf={})),function(t){t.UNMOUNTED="UNMOUNTED",t.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT"}(Yf||(Yf={}));var J9,qf,n_,tw,J3,z3,$3,X3,Rh,Jl,Jf,r_,nw,i_,zl,rw,z9,In,$9,X9,Z9,eG,tG,nG,rG,Yu,iG=new class{constructor(){b(this,"_clientSize",null),b(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),b(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),b(this,"getStyle",t=>window.getComputedStyle(t,null)),b(this,"checkCssVisibleProperty",t=>{let i=!0;const o=this.getStyle(t),{display:s,visibility:c,opacity:l,filter:p}=o;return("none"===s||["hidden","collapse"].includes(c)||Number(l)<.1)&&(i=!1),!!i&&(p&&p.split(" ").filter(h=>{const g=h.split("(")[0];return["brightness","blur","opacity"].includes(g)}).map(h=>{const[g,f]=h.split(/\(|\)/);return[g,Number(f.match(/^[0-9\.]+/))]}).forEach(h=>{const[g,f]=h;switch(g){case"brightness":(f<.1||f>3)&&(i=!1);break;case"blur":f>3&&(i=!1);break;case"opacity":f<.1&&(i=!1)}}),i)}),b(this,"checkPropertyUpToAllParentNodes",(t,i)=>{let o=!0,s=!0;let l=t;for(;l&&s;)i(l)||(o=!1,s=!1),l=l.parentElement,l||(s=!1);return o}),b(this,"checkActualCssVisibleIncludeInherit",t=>this.checkPropertyUpToAllParentNodes(t,this.checkCssVisibleProperty)),b(this,"getSizeAboutClient",t=>{const{width:i,height:o,left:s,right:c,top:l,bottom:p}=t.getBoundingClientRect(),h=this.getClientWidth(),g=this.getClientHeight();return{width:i,height:o,left:s,right:c,top:l,bottom:p,clientWidth:h,clientHeight:g,clientMin:Math.min(h,g)}}),b(this,"checkActualSize",()=>{const{width:t,height:i,clientMin:o}=this._clientSize;return this.checkSizeIsVisible(t,i,o)}),b(this,"elementFromPoint",(t,i)=>document.elementFromPoint?document.elementFromPoint(t,i):null),b(this,"checkCoverForAPoint",(t,i,o)=>{const s=this.elementFromPoint(t,i);return null!==s&&s!==o}),b(this,"getPointPositionList",()=>{const{width:t,height:i,left:o,top:s}=this._clientSize,c=t/6,l=i/6,p=[],h=10**6;for(let g=0;g<5;g++)for(let f=0;f<5;f++)p.push({x:(o*h+(0===g?.1:4===g?(c*g*h-1e5)/h:c*g)*h)/h,y:(s*h+(0===f?.1:4===f?(l*f*h-1e5)/h:l*f)*h)/h});return[...p]}),b(this,"checkElementCover",t=>this.getPointPositionList().map(i=>this.checkCoverForAPoint(i.x,i.y,t)).filter(i=>!!i).length>6),b(this,"checkSizeIsVisible",(t,i,o)=>(t>50||o/t<=10)&&(i>50||o/i<=10)),b(this,"checkSizeOfPartInClient",()=>{const{left:t,right:i,top:o,bottom:s,clientHeight:c,clientWidth:l,clientMin:p}=this._clientSize;let h,g,f,A;if(t<0)h=0;else{if(!(t<l))return!1;h=t}if(i<0)return!1;if(g=i<l?i:l,o<0)f=0;else{if(!(o<c))return!1;f=o}return!(s<0)&&(A=s<c?s:c,this.checkSizeIsVisible(g-h,A-f,p))}),b(this,"returnHiddenResult",t=>(this._clientSize=null,{visible:!1,reason:t})),b(this,"checkOneElementVisible",t=>{if(t instanceof HTMLElement){if(this.checkElementIsMountedOnDom(t)){if(this.checkActualCssVisibleIncludeInherit(t)){if(this._clientSize=this.getSizeAboutClient(t),this.checkElementCover(t))return this.returnHiddenResult(Kf.COVERED);{const i=this.checkActualSize(),o=this.checkSizeOfPartInClient();return i&&!o?this.returnHiddenResult(Kf.POSITION):i?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(Kf.SIZE)}}return this.returnHiddenResult(Kf.STYLE)}return this.returnHiddenResult(Yf.UNMOUNTED)}return this.returnHiddenResult(Yf.INVALID_HTML_ELEMENT)}),b(this,"checkElementIsMountedOnDom",t=>this.checkPropertyUpToAllParentNodes(t,i=>"HTML"!==i.nodeName.toUpperCase()?null!==i.parentElement:!!document.documentElement))}};function oG(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function o_(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?oG(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):oG(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}let dr=(J9=kn("LocalVideoTrack","getTrackId"),qf=or(),n_=Mm("LocalVideoTrack","_enabledMutex"),tw=Bc({className:"LocalVideoTrack"}),J3=or(),z3=Mm("LocalVideoTrack","_enabledMutex"),$3=Bc({className:"LocalVideoTrack"}),X3=or(),Rh=or(),Jl=or(),Jf=or(),r_=or(),nw=or(),i_=or(),zl=or(),rw=or(),J9((Te((In=class Mq extends $R{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==Ei.PLAYING)}constructor(i,o,s,c,l,p){super(i,l),b(this,"trackMediaType","video"),b(this,"_player",void 0),b(this,"_videoBeautyProcessor",void 0),b(this,"_videoVisibleTimer",null),b(this,"_previousVideoVisibleStatus",void 0),b(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),b(this,"_encoderConfig",void 0),b(this,"_scalabiltyMode",{numSpatialLayers:1,numTemporalLayers:1}),b(this,"_optimizationMode",void 0),b(this,"_videoHeight",void 0),b(this,"_videoWidth",void 0),b(this,"_forceBitrateLimit",void 0),b(this,"_enabled",!0),b(this,"processorDestination",void 0),b(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this._encoderConfig=o,this._scalabiltyMode=s,this._optimizationMode=c,this._hints=p||[],-1===this._hints.indexOf(br.SCREEN_TRACK)&&this.updateBitrateFromProfile(),this.processorContext=new CB(this.getTrackId(),"local"),this.processorDestination=new vB(this.processorContext),this.bindProcessorDestinationEvents()}play(i){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.LOCAL_VIDEO_TRACK_PLAY,options:[this.getTrackId(),"string"==typeof i?i:"HTMLElement",o]});if("string"==typeof i){const l=document.getElementById(i);l?i=l:(N.warning("[".concat(this.getTrackId(),'] can not find "#').concat(i,'" element, use document.body')),Re("warning",this,'can not find "#'.concat(i,'" element, use document.body')),i=document.body)}N.debug("[".concat(this.getTrackId(),"] start video playback"),JSON.stringify(o)),le("debug",this,"play",o);const c=o_(o_(o_({},this._getDefaultPlayerConfig()),o),{},{trackId:this.getTrackId(),element:i});this._player?this._player.updateConfig(c):(this._player=new j9(c),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const l=this.getVideoElementVisibleStatus();this.emit(Bu.VIDEO_ELEMENT_VISIBLE_STATUS,l)}catch{}},J("CHECK_VIDEO_VISIBLE_INTERVAL")),s.onSuccess()}stop(){const i=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.LOCAL_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return i.onSuccess();this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,N.debug("[".concat(this.getTrackId(),"] stop video playback")),le("debug",this,"stop"),i.onSuccess()}setEnabled(i,o){var s=this;return U(function*(){if(!o){if(i===s._enabled)return;s.stateCheck("enabled",i)}if(N.info("[".concat(s.getTrackId(),"] start setEnabled"),i),le("info",s,"setEnabled",i),!i){s._originMediaStreamTrack.enabled=!1;try{yield Hn(s,Qe.NEED_DISABLE_TRACK,s)}catch(c){throw N.error("[".concat(s.getTrackId(),"] setEnabled to false error"),c.toString()),le("error",s,"setEnabled",i,c.toString()),c}return o||(s._enabled=!1),N.info("[".concat(s.getTrackId(),"] setEnabled to false success")),void le("info",s,"setEnabled",i,"success")}s._originMediaStreamTrack.enabled=!0;try{yield Hn(s,Qe.NEED_ENABLE_TRACK,s)}catch(c){throw N.error("[".concat(s.getTrackId(),"] setEnabled to true error"),c.toString()),le("error",s,"setEnabled",i,c.toString()),c}N.info("[".concat(s.getTrackId(),"] setEnabled to true success")),le("info",s,"setEnabled",i,"success"),o||(s._enabled=!0)})()}setMuted(i){var o=this;return U(function*(){i!==o._muted&&(o.stateCheck("muted",i),o._muted=i,o._originMediaStreamTrack.enabled=!i,N.debug("[".concat(o.getTrackId(),"] start set muted: ").concat(i)),le("debug",o,"setMuted",i),i?yield Hn(o,Qe.NEED_MUTE_TRACK,o):yield Hn(o,Qe.NEED_UNMUTE_TRACK,o))})()}getStats(){return Co(()=>{N.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead"),Re("warning",this,"[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),Uc(this,Qe.GET_STATS)||o_({},pm)}setBeautyEffect(i){var o=arguments,s=this;return U(function*(){let c=o.length>1&&void 0!==o[1]?o[1]:{};const l=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.LOCAL_VIDEO_TRACK_BEAUTY,options:[s.getTrackId(),i,c]});if(i||s._videoBeautyProcessor){if($b()===oi.IOS||$b()===oi.ANDROID){const p=new V(L.INVALID_OPERATION,"can not enable beauty effect on mobile device");throw l.onError(p),p}if(!s._enabled&&i){const p=new V(L.TRACK_IS_DISABLED,"can not enable beauty effect when track is disabled");throw l.onError(p),p}if(N.info("[".concat(s.getTrackId(),"] start setBeautyEffect"),i,JSON.stringify(c)),le("info",s,"setBeautyEffect",[i,c]),s._videoBeautyProcessor||i){try{if(!s._videoBeautyProcessor)if(s._videoBeautyProcessor=new ZD,s.processor){const p=s.processor;s.pipe(s._videoBeautyProcessor).pipe(p)}else s.pipe(s._videoBeautyProcessor).pipe(s.processorDestination);yield s._videoBeautyProcessor.setBeautyEffectOptions(c),i?yield s._videoBeautyProcessor.enable():yield s._videoBeautyProcessor.disable()}catch(p){throw N.error("[".concat(s.getTrackId(),"] setBeautyEffect error"),p.toString()),le("info",s,"setBeautyEffect",[i,c]),l.onError(p),p}N.info("[".concat(s.getTrackId(),"] setBeautyEffect success")),le("info",s,"setBeautyEffect",[i,c],"success"),l.onSuccess()}else l.onSuccess()}})()}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}getCurrentFrameImage(i){var o=arguments,s=this;return U(function*(){return s._player?s._player.getCurrentFrameToUint8Array(i,o.length>1&&void 0!==o[1]?o[1]:1):yield K3(i)})()}clone(i,o,s,c){const l=this._mediaStreamTrack.clone();return new Mq(l,i,o,s,c)}setBitrateLimit(i){var o=this;return U(function*(){if(N.debug("[".concat(o.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(i))),le("debug",o,"setBitrateLimit",i),i){o._forceBitrateLimit=i,o._encoderConfig&&(o._encoderConfig.bitrateMax=o._encoderConfig.bitrateMax&&o._encoderConfig.bitrateMax<i.max_bitrate?o._encoderConfig.bitrateMax:i.max_bitrate,o._encoderConfig.bitrateMin=i.min_bitrate);try{yield Hn(o,Qe.NEED_UPDATE_VIDEO_ENCODER,o)}catch(s){return s.throw()}}})()}setOptimizationMode(i){var o=this;return U(function*(){if("motion"!==i&&"detail"!==i&&"balanced"!==i)return N.error(L.INVALID_PARAMS,"optimization mode must be motion, detail or balanced"),void le("error",o,"setOptimizationMode",i,L.INVALID_PARAMS);const s=o._optimizationMode;try{o._optimizationMode=i,yield Hn(o,Qe.SET_OPTIMIZATION_MODE,o)}catch(c){throw o._optimizationMode=s,N.error("[".concat(o.getTrackId(),"] set optimization mode failed"),c.toString()),le("error",o,"setOptimizationMode",i,c.toString()),c}N.info("[".concat(o.getTrackId(),"] set optimization mode success (").concat(i,")")),le("info",o,"setOptimizationMode",i,"success")})()}setScalabiltyMode(i){if(1===i.numSpatialLayers&&1!==i.numTemporalLayers)return N.error(L.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),le("error",this,"setScalabiltyMode",i,L.INVALID_PARAMS),void(this._scalabiltyMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabiltyMode=i,N.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(i,")")),le("info",this,"setScalabiltyMode",i,"success")}updateMediaStreamTrackResolution(){DB(this._originMediaStreamTrack).then(i=>{let[o,s]=i;this._videoHeight=s,this._videoWidth=o}).catch(q0)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:i,height:o,frameRate:s}=this.getMediaStreamTrackSettings();if(!i||!o||!s)return;const[c,l]=function(p,h,g){const f=J("BITRATE_ADAPTER_TYPE");let A;const _=200*Math.pow(g/15,.6)*Math.pow(p*h/640/360,.75),v=_;if("STANDARD_BITRATE"===f)A=4*_;else{if("COMPATIABLE_BITRATE"!==f)return;A=2*_}return[Math.floor(A),Math.floor(v)]}(i,o,s)||[void 0,void 0];this._encoderConfig.bitrateMin||this._encoderConfig.bitrateMax||(this._encoderConfig.bitrateMin=l,this._encoderConfig.bitrateMax=c,N.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(i,", h: ").concat(o,", fps: ").concat(s,"] => [brMax: ").concat(c,", brMin: ").concat(l,"]")),le("debug",this,"updateBitrateFromProfile",void 0,"[w: ".concat(i,", h: ").concat(o,", fps: ").concat(s,"] => [brMax: ").concat(c,", brMin: ").concat(l,"]")))}getVideoElementVisibleStatus(){try{var i,o;const s=null==this||null===(i=this._player)||void 0===i?void 0:i.getContainerElement(),c={track:this,element:null==this||null===(o=this._player)||void 0===o?void 0:o.getVideoElement(),slot:s?.parentElement},{element:l,slot:p}=c;if(this.isPlaying&&l instanceof HTMLVideoElement&&p instanceof HTMLElement){const h=iG.checkOneElementVisible(l),g=Object.assign({},h);if(g.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=g.visible;pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]}).onSuccess(g.visible?"Video is visible":"Invisible because of ".concat(g.reason))}return g}return}catch(s){throw new V(L.GET_VIDEO_ELEMENT_VISIBLE_ERROR,s.message)}}renewMediaStreamTrack(i){return U(function*(){})()}pipe(i){if(this._videoBeautyProcessor&&i!==this._videoBeautyProcessor)return this._videoBeautyProcessor.pipe(i);if(this.processor===i)return i;if(i._source)throw new V(L.INVALID_OPERATION,"Processor ".concat(i.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=i,this.processor._source=this,i.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),i}unpipe(){if(!this.processor)return;if(this._videoBeautyProcessor&&this.processor===this._videoBeautyProcessor)return void this._videoBeautyProcessor.unpipe();const i=this.processor;this.processor._source=void 0,this.processor=void 0,i.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}bindProcessorDestinationEvents(){var i=this;this.processorDestination.on(zr.ON_TRACK,function(){var o=U(function*(s){s?s!==i._mediaStreamTrack&&(i._mediaStreamTrack=s,i._updatePlayerSource(),yield Hn(i,Qe.NEED_REPLACE_TRACK,i)):i._mediaStreamTrack!==i._originMediaStreamTrack&&(i._mediaStreamTrack=i._originMediaStreamTrack,i._updatePlayerSource(),yield Hn(i,Qe.NEED_REPLACE_TRACK,i))});return function(s){return o.apply(this,arguments)}}())}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(zr.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(Tr.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(Tr.REQUEST_CONSTRAINTS)}}).prototype,"play",[qf],Object.getOwnPropertyDescriptor(In.prototype,"play"),In.prototype),Te(In.prototype,"setEnabled",[n_,tw,J3],Object.getOwnPropertyDescriptor(In.prototype,"setEnabled"),In.prototype),Te(In.prototype,"setMuted",[z3,$3,X3],Object.getOwnPropertyDescriptor(In.prototype,"setMuted"),In.prototype),Te(In.prototype,"getStats",[Rh],Object.getOwnPropertyDescriptor(In.prototype,"getStats"),In.prototype),Te(In.prototype,"setBeautyEffect",[Jl],Object.getOwnPropertyDescriptor(In.prototype,"setBeautyEffect"),In.prototype),Te(In.prototype,"getCurrentFrameData",[Jf],Object.getOwnPropertyDescriptor(In.prototype,"getCurrentFrameData"),In.prototype),Te(In.prototype,"getCurrentFrameImage",[r_],Object.getOwnPropertyDescriptor(In.prototype,"getCurrentFrameImage"),In.prototype),Te(In.prototype,"setBitrateLimit",[nw],Object.getOwnPropertyDescriptor(In.prototype,"setBitrateLimit"),In.prototype),Te(In.prototype,"setOptimizationMode",[i_],Object.getOwnPropertyDescriptor(In.prototype,"setOptimizationMode"),In.prototype),Te(In.prototype,"setScalabiltyMode",[zl],Object.getOwnPropertyDescriptor(In.prototype,"setScalabiltyMode"),In.prototype),Te(In.prototype,"updateMediaStreamTrackResolution",[rw],Object.getOwnPropertyDescriptor(In.prototype,"updateMediaStreamTrackResolution"),In.prototype),z9=In))||z9),sG=($9=kn("CameraVideoTrack","getTrackId"),X9=or(),Z9=Mm("CameraVideoTrack","_enabledMutex"),eG=Bc({className:"CameraVideoTrack"}),tG=or(),nG=or(),$9((Te((Yu=class extends dr{constructor(t,i,o,s,c,l){var p;super(t,i.encoderConfig?sm(i.encoderConfig):{},s,c,l),p=this,b(this,"_config",void 0),b(this,"_originalConstraints",void 0),b(this,"_constraints",void 0),b(this,"_enabled",!0),b(this,"_deviceName","default"),b(this,"tryResumeVideoForIOS15WeChat",U(function*(){Zd()&&!Du()&&ea()&&p._enabled&&!p._isClosed&&(N.debug("[".concat(p.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),yield p.renewMediaStreamTrack())})),Ke("info",this,"constructor",{trackId:l,deviceId:t.label,constraints:o,config:i}),this._config=i,this._originalConstraints=o,this._constraints=o,this._deviceName=t.label,this._config.encoderConfig&&(this._encoderConfig=sm(this._config.encoderConfig)),_t.on(Dr.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),_t.on(Dr.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),this.bindProcessorContextEvents()}setDevice(t){var i=this;return U(function*(){const o=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.CAM_VIDEO_TRACK_SET_DEVICE,options:[i.getTrackId(),t]});if(N.info("[".concat(i.getTrackId(),"] set device to ").concat(t)),le("info",i,"setDevice",t),i._enabled)try{const s=yield to.getDeviceById(t),c={};c.video=o_({},i._constraints),c.video.deviceId={exact:t},c.video.facingMode=void 0,i._originMediaStreamTrack.stop();let l=null;try{l=yield vo(c,i.getTrackId())}catch(p){throw N.error("[".concat(i.getTrackId(),"] setDevice failed"),p.toString()),le("error",i,"setDevice",t,p.toString()),l=yield vo({video:i._constraints},i.getTrackId()),yield i._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),p}yield i._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),i.updateMediaStreamTrackResolution(),i._deviceName=s.label,i._config.cameraId=t,i._constraints.deviceId={exact:t}}catch(s){throw o.onError(s),N.error("[".concat(i.getTrackId(),"] setDevice error"),s.toString()),le("error",i,"setDevice",t,s.toString()),s}else try{const s=yield to.getDeviceById(t);i._deviceName=s.label,i._config.cameraId=t,i._constraints.deviceId={exact:t}}catch(s){throw o.onError(s),N.error("[".concat(i.getTrackId(),"] setDevice error"),s.toString()),le("error",i,"setDevice",t,s.toString()),s}N.info("[".concat(i.getTrackId(),"] setDevice success")),le("info",i,"setDevice",t,"success"),o.onSuccess()})()}setEnabled(t,i){var o=this;return U(function*(){if(!i){if(t===o._enabled)return;o.stateCheck("enabled",t)}if(N.info("[".concat(o.getTrackId(),"] start setEnabled"),t),le("info",o,"setEnabled",t),!t){o._originMediaStreamTrack.onended=null,o._originMediaStreamTrack.stop(),i||(o._enabled=!1);try{yield Hn(o,Qe.NEED_DISABLE_TRACK,o)}catch(l){throw N.error("[".concat(o.getTrackId(),"] setEnabled to false error"),l.toString()),le("error",o,"setEnabled",t,l.toString()),l}return N.info("[".concat(o.getTrackId(),"] setEnabled to false success")),void le("info",o,"setEnabled",t,"success")}const s=o_({},o._constraints),c=to.searchDeviceIdByName(o._deviceName);c&&!s.deviceId&&(s.deviceId={exact:c});try{const l=yield vo({video:o._constraints},o.getTrackId());yield o._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),yield Hn(o,Qe.NEED_ENABLE_TRACK,o)}catch(l){throw N.error("[".concat(o.getTrackId(),"] setEnabled true error"),l.toString()),le("error",o,"setEnabled",t,l.toString()),l}o.updateMediaStreamTrackResolution(),N.info("[".concat(o.getTrackId(),"] setEnabled to true success")),le("info",o,"setEnabled",t,"success"),i||(o._enabled=!0)})()}setEncoderConfiguration(t,i){var o=this;return U(function*(){const s=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG,options:[o.getTrackId(),t]});if(!o._enabled){const p=new V(L.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");throw s.onError(p),p}t=sm(t),o._forceBitrateLimit&&(t.bitrateMax=o._forceBitrateLimit.max_bitrate?o._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=o._forceBitrateLimit.min_bitrate?o._forceBitrateLimit.min_bitrate:t.bitrateMin);const c=en(o._config);c.encoderConfig=t;const l=gC(c);(Di()||Oo()||bl())&&(l.deviceId=void 0),N.debug("[".concat(o.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(t),JSON.stringify(l)),le("debug",o,"setEncoderConfiguration",t);try{yield o._originMediaStreamTrack.applyConstraints(l),o.updateMediaStreamTrackResolution()}catch(p){const h=new V(L.UNEXPECTED_ERROR,p.toString());throw N.error("[".concat(o.getTrackId(),"] applyConstraints error"),h.toString()),le("error",o,"setEncoderConfiguration",p.toString()),s.onError(h),h}o._config=c,o._constraints=l,o._originalConstraints=l,o._encoderConfig=t,-1===o._hints.indexOf(br.SCREEN_TRACK)&&o.updateBitrateFromProfile();try{yield Hn(o,Qe.NEED_UPDATE_VIDEO_ENCODER,o)}catch(p){return s.onError(p),p.throw()}s.onSuccess()})()}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){var t=this;if((Oo()||bl())&&this._enabled&&!this._isClosed&&_t.duringInterruption){const i=function(){var o=U(function*(){_t.off(Dr.IOS_INTERRUPTION_END,i),t._enabled&&!t._isClosed&&(N.debug("[".concat(t.getTrackId(),"] try capture camera media device for interrupted iOS device.")),Re("debug",t,"try capture camera media device for interrupted iOS device."),yield t.setEnabled(!1),yield t.setEnabled(!0))});return function(){return o.apply(this,arguments)}}();_t.on(Dr.IOS_INTERRUPTION_END,i)}else N.debug("[".concat(this.getTrackId(),"] track ended")),Po("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(Bu.TRACK_ENDED)}renewMediaStreamTrack(t){var i=this;return U(function*(){const o=t||i._constraints,s=to.searchDeviceIdByName(i._deviceName);if(s&&!o.deviceId&&(o.deviceId={exact:s}),i._enabled){const c=yield vo({video:o},i.getTrackId());i._constraints=o,yield i._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!0),i.updateMediaStreamTrackResolution()}})()}close(){super.close(),_t.off(Dr.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),_t.off(Dr.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat)}bindProcessorContextEvents(){var t=this;this.processorContext.on(Tr.REQUEST_UPDATE_CONSTRAINTS,function(){var i=U(function*(o,s,c){try{const l=Object.assign({},t._originalConstraints,...o);yield t.renewMediaStreamTrack(l),s()}catch(l){c(l)}});return function(o,s,c){return i.apply(this,arguments)}}()),this.processorContext.on(Tr.REQUEST_CONSTRAINTS,function(){var i=U(function*(o){o(t._originMediaStreamTrack.getSettings())});return function(o){return i.apply(this,arguments)}}())}}).prototype,"setDevice",[X9],Object.getOwnPropertyDescriptor(Yu.prototype,"setDevice"),Yu.prototype),Te(Yu.prototype,"setEnabled",[Z9,eG,tG],Object.getOwnPropertyDescriptor(Yu.prototype,"setEnabled"),Yu.prototype),Te(Yu.prototype,"setEncoderConfiguration",[nG],Object.getOwnPropertyDescriptor(Yu.prototype,"setEncoderConfiguration"),Yu.prototype),rG=Yu))||rG);class AC{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio)return this._audioTrack}get videoTrack(){if(this.hasVideo)return this._videoTrack}constructor(i,o){b(this,"uid",void 0),b(this,"_uintid",void 0),b(this,"_trust_in_room_",!0),b(this,"_trust_audio_enabled_state_",!0),b(this,"_trust_video_enabled_state_",!0),b(this,"_trust_audio_mute_state_",!0),b(this,"_trust_video_mute_state_",!0),b(this,"_audio_muted_",!1),b(this,"_video_muted_",!1),b(this,"_audio_enabled_",!0),b(this,"_video_enabled_",!0),b(this,"_audio_added_",!1),b(this,"_video_added_",!1),b(this,"_trust_video_stream_added_state_",!0),b(this,"_trust_audio_stream_added_state_",!0),b(this,"_audioTrack",void 0),b(this,"_videoTrack",void 0),b(this,"_audioSSRC",void 0),b(this,"_videoSSRC",void 0),b(this,"_audioOrtc",void 0),b(this,"_videoOrtc",void 0),b(this,"_cname",void 0),b(this,"_rtxSsrcId",void 0),this.uid=i,this._uintid=o}}var aG=Pp,Z3=Tp,eF=hA;ei({target:"Promise",stat:!0},{try:function(t){var i=Z3.f(this),o=eF(t);return(o.error?i.reject:i.resolve)(o.value),i.promise}});var mC=aG,_C=ei,cG=Dt,EC=Cr,GY=Om,tF=ds,Dh=su,nF=dc,rF=F1,iF=Ox,uG=QR,s_=qh,oF=Jr("isConcatSpreadable"),sF=9007199254740991,aF="Maximum allowed index exceeded",cF=cG.TypeError,lG=s_>=51||!EC(function(){var t=[];return t[oF]=!1,t.concat()[0]!==t}),uF=uG("concat"),dG=function(t){if(!tF(t))return!1;var i=t[oF];return void 0!==i?!!i:GY(t)};_C({target:"Array",proto:!0,forced:!lG||!uF},{concat:function(t){var i,o,s,c,l,p=Dh(this),h=iF(p,0),g=0;for(i=-1,s=arguments.length;i<s;i++)if(dG(l=-1===i?p:arguments[i])){if(g+(c=nF(l))>sF)throw cF(aF);for(o=0;o<c;o++,g++)o in l&&rF(h,g,l[o])}else{if(g>=sF)throw cF(aF);rF(h,g++,l)}return h.length=g,h}});var iw={},hG=bi,lF=ru,vC=bE.f,ow=NT,sw="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];iw.f=function(t){return sw&&"Window"==hG(t)?function(i){try{return vC(i)}catch{return ow(sw)}}(t):vC(lF(t))};var a_={};a_.f=Jr;var CC=cc,HY=qi,WY=a_,dF=ba.f,ci=function(t){var i=CC.Symbol||(CC.Symbol={});HY(i,t)||dF(i,t,{value:WY.f(t)})},wh=ei,yC=Dt,hF=Ws,pF=Q_,zf=an,fF=nr,Nh=ve,$f=_y,gF=Cr,ui=qi,fG=Om,gG=Si,AG=ds,mG=To,IC=vy,aw=Ro,AF=su,SC=ru,cw=au,mF=Md,uw=Ad,Xf=Zg,_G=RE,KY=bE,lw=iw,_F=Xg,EG=_g,dw=ba,YY=TE,vG=qr,qY=iv,EF=fp,c_=yg.exports,CG=pu,yG=bg,vF=Jr,JY=a_,zY=ci,CF=gu,IG=xd,hw=UR.forEach,Ps=Jg("hidden"),pw="Symbol",SG=vF("toPrimitive"),yF=IG.set,IF=IG.getterFor(pw),tc=Object.prototype,$l=yC.Symbol,Oh=$l&&$l.prototype,bC=yC.TypeError,SF=yC.QObject,TC=hF("JSON","stringify"),bG=EG.f,Ph=dw.f,bF=lw.f,$Y=vG.f,TG=fF([].push),Xl=c_("symbols"),RC=c_("op-symbols"),DC=c_("string-to-symbol-registry"),TF=c_("symbol-to-string-registry"),XY=c_("wks"),RF=!SF||!SF.prototype||!SF.prototype.findChild,DF=Nh&&gF(function(){return 7!=Xf(Ph({},"a",{get:function(){return Ph(this,"a",{value:7}).a}})).a})?function(t,i,o){var s=bG(tc,i);s&&delete tc[i],Ph(t,i,o),s&&t!==tc&&Ph(tc,i,s)}:Ph,wF=function(t,i){var o=Xl[t]=Xf(Oh);return yF(o,{type:pw,tag:t,description:i}),Nh||(o.description=i),o},fw=function(t,i,o){t===tc&&fw(RC,i,o),aw(t);var s=cw(i);return aw(o),ui(Xl,s)?(o.enumerable?(ui(t,Ps)&&t[Ps][s]&&(t[Ps][s]=!1),o=Xf(o,{enumerable:uw(0,!1)})):(ui(t,Ps)||Ph(t,Ps,uw(1,{})),t[Ps][s]=!0),DF(t,s,o)):Ph(t,s,o)},NF=function(t,i){aw(t);var o=SC(i),s=_G(o).concat(Aw(o));return hw(s,function(c){Nh&&!zf(RG,o,c)||fw(t,c,o[c])}),t},RG=function(t){var i=cw(t),o=zf($Y,this,i);return!(this===tc&&ui(Xl,i)&&!ui(RC,i))&&(!(o||!ui(this,i)||!ui(Xl,i)||ui(this,Ps)&&this[Ps][i])||o)},gw=function(t,i){var o=SC(t),s=cw(i);if(o!==tc||!ui(Xl,s)||ui(RC,s)){var c=bG(o,s);return!c||!ui(Xl,s)||ui(o,Ps)&&o[Ps][s]||(c.enumerable=!0),c}},OF=function(t){var i=bF(SC(t)),o=[];return hw(i,function(s){ui(Xl,s)||ui(CG,s)||TG(o,s)}),o},Aw=function(t){var i=t===tc,o=bF(i?RC:SC(t)),s=[];return hw(o,function(c){!ui(Xl,c)||i&&!ui(tc,c)||TG(s,Xl[c])}),s};if($f||(EF(Oh=($l=function(){if(mG(Oh,this))throw bC("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?mF(arguments[0]):void 0,i=yG(t),o=function(s){this===tc&&zf(o,RC,s),ui(this,Ps)&&ui(this[Ps],i)&&(this[Ps][i]=!1),DF(this,i,uw(1,s))};return Nh&&RF&&DF(tc,i,{configurable:!0,set:o}),wF(i,t)}).prototype,"toString",function(){return IF(this).tag}),EF($l,"withoutSetter",function(t){return wF(yG(t),t)}),vG.f=RG,dw.f=fw,YY.f=NF,EG.f=gw,KY.f=lw.f=OF,_F.f=Aw,JY.f=function(t){return wF(vF(t),t)},Nh&&Ph(Oh,"description",{configurable:!0,get:function(){return IF(this).description}})),wh({global:!0,wrap:!0,forced:!$f,sham:!$f},{Symbol:$l}),hw(_G(XY),function(t){zY(t)}),wh({target:pw,stat:!0,forced:!$f},{for:function(t){var i=mF(t);if(ui(DC,i))return DC[i];var o=$l(i);return DC[i]=o,TF[o]=i,o},keyFor:function(t){if(!IC(t))throw bC(t+" is not a symbol");if(ui(TF,t))return TF[t]},useSetter:function(){RF=!0},useSimple:function(){RF=!1}}),wh({target:"Object",stat:!0,forced:!$f,sham:!Nh},{create:function(t,i){return void 0===i?Xf(t):NF(Xf(t),i)},defineProperty:fw,defineProperties:NF,getOwnPropertyDescriptor:gw}),wh({target:"Object",stat:!0,forced:!$f},{getOwnPropertyNames:OF,getOwnPropertySymbols:Aw}),wh({target:"Object",stat:!0,forced:gF(function(){_F.f(1)})},{getOwnPropertySymbols:function(t){return _F.f(AF(t))}}),TC&&wh({target:"JSON",stat:!0,forced:!$f||gF(function(){var t=$l();return"[null]"!=TC([t])||"{}"!=TC({a:t})||"{}"!=TC(Object(t))})},{stringify:function(t,i,o){var s=qY(arguments),c=i;if((AG(i)||void 0!==t)&&!IC(t))return fG(i)||(i=function(l,p){if(gG(c)&&(p=zf(c,this,l,p)),!IC(p))return p}),s[1]=i,pF(TC,null,s)}}),!Oh[SG]){var DG=Oh.valueOf;EF(Oh,SG,function(t){return zf(DG,this)})}CF($l,pw),CG[Ps]=!0,ci("asyncIterator"),ci("hasInstance"),ci("isConcatSpreadable"),ci("iterator"),ci("match"),ci("matchAll"),ci("replace"),ci("search"),ci("species"),ci("split"),ci("toPrimitive"),ci("toStringTag"),ci("unscopables"),gu(Dt.JSON,"JSON",!0);var wG=cc.Symbol;ci("asyncDispose"),ci("dispose"),ci("matcher"),ci("metadata"),ci("observable"),ci("patternMatch"),ci("replaceAll");var PF=wG,MF=a_.f("asyncIterator");function kF(t){this.wrapped=t}function u_(t){var i,o;function s(l,p){try{var h=t[l](p),g=h.value,f=g instanceof kF;mC.resolve(f?g.wrapped:g).then(function(A){f?s("return"===l?"return":"next",A):c(h.done?"return":"normal",A)},function(A){s("throw",A)})}catch(A){c("throw",A)}}function c(l,p){switch(l){case"return":i.resolve({value:p,done:!0});break;case"throw":i.reject(p);break;default:i.resolve({value:p,done:!1})}(i=i.next)?s(i.key,i.arg):o=null}this._invoke=function(l,p){return new mC(function(h,g){var f={key:l,arg:p,resolve:h,reject:g,next:null};o?o=o.next=f:(i=o=f,s(l,p))})},"function"!=typeof t.return&&(this.return=void 0)}function ha(t){return function(){return new u_(t.apply(this,arguments))}}function It(t){return new kF(t)}u_.prototype["function"==typeof PF&&MF||"@@asyncIterator"]=function(){return this},u_.prototype.next=function(t){return this._invoke("next",t)},u_.prototype.throw=function(t){return this._invoke("throw",t)},u_.prototype.return=function(t){return this._invoke("return",t)};var OG=a_.f("iterator");function l_(t,i){var o={},s=!1;function c(l,p){return s=!0,p=new mC(function(h){h(t[l](p))}),{done:!1,value:i(p)}}return o[void 0!==PF&&OG||"@@iterator"]=function(){return this},o.next=function(l){return s?(s=!1,l):c("next",l)},"function"==typeof t.throw&&(o.throw=function(l){if(s)throw s=!1,l;return c("throw",l)}),"function"==typeof t.return&&(o.return=function(l){return s?(s=!1,l):c("return",l)}),o}var LF=MF,PG=Ii,wC=Dn,xF=Ki,LG=zc,xG=xg,BG=Yi.f,FG=tN,qu=rt.Symbol,Mh=qu&&qu.prototype;if(_r&&Er(qu)&&(!("description"in Mh)||void 0!==qu().description)){var FF={},NC=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:xG(arguments[0]),i=LG(Mh,this)?new qu(t):void 0===t?qu():qu(t);return""===t&&(FF[i]=!0),i};FG(NC,qu),NC.prototype=Mh,Mh.constructor=NC;var UG="Symbol(test)"==String(qu("test")),VG=wC(Mh.toString),jG=wC(Mh.valueOf),QG=/^Symbol\((.*)\)[^)]+$/,GG=wC("".replace),HG=wC("".slice);BG(Mh,"description",{configurable:!0,get:function(){var t=jG(this),i=VG(t);if(xF(FF,t))return"";var o=UG?HG(i,7,-1):GG(i,QG,"$1");return""===o?void 0:o}}),PG({global:!0,forced:!0},{Symbol:NC})}var sr={exports:{}};function UF(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function VF(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?UF(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):UF(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}function mw(t,i,o,s,c,l,p){let h=[],g=[],f=[],A=[],_=!1,v=!1;if(sr.exports.parse(t).mediaDescriptions.forEach(y=>{p&&p!==y.attributes.direction||("video"!==y.media.mediaType||_||(g=y.attributes.payloads,A=y.attributes.extmaps,_=!0),"audio"!==y.media.mediaType||v||(h=y.attributes.payloads,f=y.attributes.extmaps,v=!0))}),!A||0===g.length)throw new Error("Cannot get video capabilities from SDP.");if(!f||0===h.length)throw new Error("Cannot get audio capabilities from SDP.");return g.forEach(y=>{var S;null!==(S=y.rtpMap)&&void 0!==S&&S.clockRate&&(y.rtpMap.clockRate=parseInt(y.rtpMap.clockRate))}),h.forEach(y=>{var S;null!==(S=y.rtpMap)&&void 0!==S&&S.clockRate&&(y.rtpMap.clockRate=parseInt(y.rtpMap.clockRate))}),i&&(h=h.filter(y=>{var S;return"rtx"!==(null===(S=y.rtpMap)||void 0===S?void 0:S.encodingName.toLowerCase())}),g=g.filter(y=>{var S;return"rtx"!==(null===(S=y.rtpMap)||void 0===S?void 0:S.encodingName.toLowerCase())})),o&&(g=g.filter(y=>{var S;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(S=y.rtpMap)||void 0===S?void 0:S.encodingName)||"")})),s&&(h=h.filter(y=>{var S;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(S=y.rtpMap)||void 0===S?void 0:S.encodingName)||"")})),c&&c?.length>0&&(h=h.filter(y=>{var S;return c.includes((null===(S=y.rtpMap)||void 0===S?void 0:S.encodingName.toLowerCase())||"")})),l&&l?.length>0&&(g=g.filter(y=>{var S;return l.includes((null===(S=y.rtpMap)||void 0===S?void 0:S.encodingName.toLowerCase())||"")})),{audioCodecs:h,videoCodecs:g,audioExtensions:f,videoExtensions:A}}function kh(t){const i=sr.exports.parse(t);let o,s;for(const c of i.mediaDescriptions){if(!o){const l=c.attributes.iceUfrag,p=c.attributes.icePwd;if(!l||!p)throw new Error("Cannot get iceUfrag or icePwd from SDP.");o={iceUfrag:l,icePwd:p}}if(!s){const l=c.attributes.fingerprints;l.length>0&&(s={fingerprints:l})}}if(!s&&i.attributes.fingerprints.length>0&&(s={fingerprints:i.attributes.fingerprints}),!s||!o)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:o,dtlsParameters:s}}function jF(t,i){const o=[],s=t.attributes.ssrcGroups.filter(p=>"FID"===p.semantic),c=t.attributes.ssrcGroups.find(p=>"SIM"===p.semantic),l=t.attributes.ssrcs;if(c)c.ssrcIds.forEach(p=>{var h;const g=null===(h=s.find(f=>f.ssrcIds[0]===p))||void 0===h?void 0:h.ssrcIds[1];o.push({ssrcId:p,rtx:i?g:void 0})});else if(s.length>0){const h=s[0].ssrcIds[1];o.push({ssrcId:s[0].ssrcIds[0],rtx:i?h:void 0})}else{if(0===l.length)throw new Error("No ssrcs found on local media description.");o.push({ssrcId:l[0].ssrcId})}return o}function QF(t,i){const{cname:o}=t;let s;i&&i.ip&&"number"==typeof i.port?(s=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:i.ip,port:i.port.toString(),type:"host",extension:{}}],N.debug("Using remote candidate from AP ".concat(i.ip,":").concat(i.port)),Re("debug",[],"Using remote candidate from AP ".concat(i.ip,":").concat(i.port)),i.ip6&&(s.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:i.ip6,port:i.port.toString(),type:"host",extension:{}}),N.debug("Using IPV6 remote candidate from AP ".concat(i.ip6,":").concat(i.port)),Re("debug",[],"Using IPV6 remote candidate from AP ".concat(i.ip6,":").concat(i.port)))):s=t.iceParameters.candidates.map(h=>({foundation:h.foundation,componentId:"1",transport:h.protocol,priority:h.priority.toString(),connectionAddress:h.ip,port:h.port.toString(),type:h.type,extension:{}}));const c={fingerprints:t.dtlsParameters.fingerprints.map(h=>({hashFunction:h.algorithm,fingerprint:h.fingerprint}))},l={iceUfrag:t.iceParameters.iceUfrag,icePwd:t.iceParameters.icePwd};let p;switch(t.dtlsParameters.role){case"server":p="passive";break;case"client":p="active";break;case"auto":p="actpass"}return{dtlsParameters:c,iceParameters:l,candidates:s,rtpCapabilities:Cw(t.rtpCapabilities),setup:p,cname:o}}function Ms(t,i,o){const s=[],c=[];return t.forEach(l=>{let{ssrcId:p,rtx:h}=l;const g=xn(8,"track-"),f={ssrcId:p,attributes:VF({label:g,mslabel:o=o||xn(10,""),msid:"".concat(o," ").concat(g)},i&&{cname:i})};if(s.push(f),void 0!==h){const A={ssrcId:h,attributes:VF({label:g,mslabel:o,msid:"".concat(o," ").concat(g)},i&&{cname:i})};s.push(A),c.push({semantic:"FID",ssrcIds:[p,h]})}}),t.length>1&&c.push({semantic:"SIM",ssrcIds:t.map(l=>{let{ssrcId:p}=l;return p})}),{ssrcs:s,ssrcGroups:c}}function Zf(t,i){i instanceof Li&&t.attributes.payloads.forEach(o=>{var s;const c=null===(s=o.rtpMap)||void 0===s?void 0:s.encodingName.toLowerCase();if(!c||-1===["opus","pcmu","pcma","g722"].indexOf(c))return;o.fmtp||(o.fmtp={parameters:{}}),o.fmtp.parameters.minptime="10",o.fmtp.parameters.useinbandfec="1";const l=i._encoderConfig;l&&"pcmu"!==c&&"pcma"!==c&&"g722"!==c&&(l.bitrate&&!bn()&&(o.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*l.bitrate))),l.sampleRate&&(o.fmtp.parameters.maxplaybackrate="".concat(l.sampleRate),o.fmtp.parameters["sprop-maxcapturerate"]="".concat(l.sampleRate)),l.stereo&&(o.fmtp.parameters.stereo="1",o.fmtp.parameters["sprop-stereo"]="1"))})}function _w(t){const i=t.attributes.unrecognized.findIndex(o=>"x-google-flag"===o.attField&&"conference"===o.attValue);-1!==i&&t.attributes.unrecognized.splice(i,1)}function Ew(t,i){if(!(i instanceof dr&&i._encoderConfig&&-1===i._hints.indexOf(br.SCREEN_TRACK)))return;const o=i._encoderConfig;Vr().supportMinBitrate&&o.bitrateMin&&t.attributes.payloads.forEach(s=>{var c;["h264","vp8","vp9","av1"].includes((null===(c=s.rtpMap)||void 0===c?void 0:c.encodingName.toLowerCase())||"")&&(s.fmtp||(s.fmtp={parameters:{}}),s.fmtp.parameters["x-google-min-bitrate"]="".concat(o.bitrateMin))}),Vr().supportMinBitrate&&!i._hints.includes(br.LOW_STREAM)&&o.bitrateMax&&t.attributes.payloads.forEach(s=>{var c;["h264","vp8","vp9","av1"].includes((null===(c=s.rtpMap)||void 0===c?void 0:c.encodingName.toLowerCase())||"")&&(s.fmtp||(s.fmtp={parameters:{}}),s.fmtp.parameters["x-google-start-bitrate"]="".concat(J("X_GOOGLE_START_BITRATE")||Math.floor(o.bitrateMax)))})}function GF(t){if("video"!==t.media.mediaType)return;const i=zt();if(i.name!==nn.SAFARI&&i.os!==oi.IOS)return;const o=t.attributes.extmaps.findIndex(s=>/video-orientation/g.test(s.extensionName));-1!==o&&t.attributes.extmaps.splice(o,1)}function OC(t,i,o){if(!i)return;let s,c;if("video"===t.media.mediaType?(s=o.videoExtensions,c=o.videoCodecs):(s=o.audioExtensions,c=o.audioCodecs),!0===i.tcc){const l=s.find(p=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===p.extensionName);l&&(t.attributes.extmaps.find(p=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===p.extensionName)||t.attributes.extmaps.push({entry:l.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),(p=c,h=t.attributes.payloads,h.filter(g=>!!p.find(f=>f.payloadType===g.payloadType&&!!f.rtcpFeedbacks.find(A=>"transport-cc"===A.type)))).forEach(p=>{p.rtcpFeedbacks.find(h=>"transport-cc"===h.type)||p.rtcpFeedbacks.push({type:"transport-cc"})}))}else if(!1===i.tcc){const l=t.attributes.extmaps.findIndex(p=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===p.extensionName);-1!==l&&t.attributes.extmaps.splice(l,1),t.attributes.payloads.forEach(p=>{const h=p.rtcpFeedbacks.findIndex(g=>"transport-cc"===g.type);-1!==h&&p.rtcpFeedbacks.splice(h,1)})}var p,h;if(!0===i.remb){const l=s.find(p=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===p.extensionName);l&&(t.attributes.extmaps.find(p=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===p.extensionName)||t.attributes.extmaps.push({entry:l.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(p,h){return h.filter(g=>!!p.find(f=>f.payloadType===g.payloadType&&!!f.rtcpFeedbacks.find(A=>"goog-remb"===A.type)))}(c,t.attributes.payloads).forEach(p=>{p.rtcpFeedbacks.find(h=>"goog-remb"===h.type)||p.rtcpFeedbacks.push({type:"goog-remb"})}))}else if(!1===i.remb){const l=t.attributes.extmaps.findIndex(p=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===p.extensionName);-1!==l&&t.attributes.extmaps.splice(l,1),t.attributes.payloads.forEach(p=>{const h=p.rtcpFeedbacks.findIndex(g=>"goog-remb"===g.type);-1!==h&&p.rtcpFeedbacks.splice(h,1)})}}function HF(t,i,o){if(bn()||"video"!==t.media.mediaType||!(i instanceof dr)||"vp9"!==o&&"vp8"!==o||"vp8"===o&&!J("SIMULCAST")||void 0===i._scalabiltyMode||i._scalabiltyMode.numSpatialLayers<=1)return;const s="vp8"===o?2:i._scalabiltyMode.numSpatialLayers,c=t.attributes.ssrcs[0],l=t.attributes.ssrcGroups.find(h=>"FID"===h.semantic&&h.ssrcIds[0]===c.ssrcId),p={semantic:"SIM",ssrcIds:[c.ssrcId]};for(let h=1;h<s;h++)t.attributes.ssrcs.push({ssrcId:c.ssrcId+h,attributes:en(c.attributes)}),p.ssrcIds.push(c.ssrcId+h),l&&(t.attributes.ssrcs.push({ssrcId:l.ssrcIds[1]+h,attributes:en(c.attributes)}),t.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[c.ssrcId+h,l.ssrcIds[1]+h]}));t.attributes.ssrcGroups.unshift(p)}function WF(t,i,o,s,c){return vw.apply(this,arguments)}function vw(){return vw=U(function*(t,i,o,s,c){const l=new RTCPeerConnection;l.addTransceiver("video",{direction:"sendonly"}),l.addTransceiver("audio",{direction:"sendonly"}),l.addTransceiver("video",{direction:"recvonly"}),l.addTransceiver("audio",{direction:"recvonly"});const p=(yield l.createOffer()).sdp,h=mw(p,t,i,o,s,c,"sendonly"),g=mw(p,t,i,o,s,c,"recvonly"),f={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},A={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},_={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(PC(h,g,"videoExtensions",f,A,_),PC(h,g,"videoCodecs",f,A,_),PC(h,g,"audioExtensions",f,A,_),PC(h,g,"audioCodecs",f,A,_),J("RAISE_H264_BASELINE_PRIORITY")){const v=_.videoCodecs.findIndex(y=>{var S,R;return"h264"===(null===(S=y.rtpMap)||void 0===S?void 0:S.encodingName.toLocaleLowerCase())&&"42001f"===(null===(R=y.fmtp)||void 0===R?void 0:R.parameters["profile-level-id"])});if(-1!==v){const y=_.videoCodecs.findIndex(S=>{var R;return"h264"===(null===(R=S.rtpMap)||void 0===R?void 0:R.encodingName.toLocaleLowerCase())});if(y<v){N.debug("raising H264 baseline profile priority");const S=_.videoCodecs[v];_.videoCodecs.splice(v,1),_.videoCodecs.splice(y,0,S)}-1!==y&&(A.videoCodecs=A.videoCodecs.filter(S=>{var R,D;return!("h264"===(null===(R=S.rtpMap)||void 0===R?void 0:R.encodingName.toLocaleLowerCase())&&"42001f"!==(null===(D=S.fmtp)||void 0===D?void 0:D.parameters["profile-level-id"]))})),-1!==y&&J("FILTER_SEND_H264_BASELINE")&&(f.videoCodecs=f.videoCodecs.filter(S=>{var R,D;return!("h264"===(null===(R=S.rtpMap)||void 0===R?void 0:R.encodingName.toLocaleLowerCase())&&"42001f"!==(null===(D=S.fmtp)||void 0===D?void 0:D.parameters["profile-level-id"]))}))}}try{l.close()}catch{}return{send:f,recv:A,sendrecv:_}}),vw.apply(this,arguments)}function PC(t,i,o,s,c,l){if("videoExtensions"===o||"audioExtensions"===o){const p=[];return t[o].forEach(h=>{i[o].some((g,f)=>{if(h.entry===g.entry&&h.extensionName===g.extensionName)return p.push(f),!0})?l[o].push(h):s[o].push(h)}),void i[o].forEach((h,g)=>{-1===p.indexOf(g)&&c[o].push(h)})}if("videoCodecs"===o||"audioCodecs"===o){const p=[];return t[o].forEach(h=>{i[o].some((g,f)=>{if(h.payloadType===g.payloadType&&JSON.stringify(h)===JSON.stringify(g))return p.push(f),!0})?l[o].push(h):s[o].push(h)}),void i[o].forEach((h,g)=>{-1===p.indexOf(g)&&c[o].push(h)})}}function Cw(t){const{send:i,recv:o,sendrecv:s}=t;if(!s){if(!i||!o)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:i,recv:o}}let c,l;return i?(c={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},c.audioCodecs=[...i.audioCodecs,...s.audioCodecs],c.videoCodecs=[...i.videoCodecs,...s.videoCodecs],c.audioExtensions=[...i.audioExtensions,...s.audioExtensions],c.videoExtensions=[...i.videoExtensions,...s.videoExtensions]):c=s,o?(l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l.audioCodecs=[...o.audioCodecs,...s.audioCodecs],l.videoCodecs=[...o.videoCodecs,...s.videoCodecs],l.audioExtensions=[...o.audioExtensions,...s.audioExtensions],l.videoExtensions=[...o.videoExtensions,...s.videoExtensions]):l=s,{send:c,recv:l}}function Ju(t){"audio"===t.media.mediaType&&t.attributes.payloads.filter(i=>{var o;return"opus"===(null===(o=i.rtpMap)||void 0===o?void 0:o.encodingName.toLowerCase())}).forEach(i=>{i.fmtp||(i.fmtp={parameters:{}}),i.fmtp.parameters.stereo="1",i.fmtp.parameters["sprop-stereo"]="1"})}!function(t,i){t.exports=(()=>{var o={8:(l,p,h)=>{h.r(p),h.d(p,{Parser:()=>Se,Printer:()=>ee,parse:()=>me,print:()=>Ne});const g="\n",f="".concat("\r").concat(g),A=" ";let _;function v(ce){return ce>="0"&&ce<="9"}function y(ce){return ce>="!"&&ce<="~"}function S(ce){return y(ce)||ce>="\x80"&&ce<="\xff"}function R(ce){return"!"===ce||ce>="#"&&ce<="'"||ce>="*"&&ce<="+"||ce>="-"&&ce<="."||ce>="0"&&ce<="9"||ce>="A"&&ce<="Z"||ce>="^"&&ce<="~"}function D(ce){return ce>="1"&&ce<="9"}function O(ce){return ce>="A"&&ce<="Z"||ce>="a"&&ce<="z"}function P(ce){return"d"===ce||"h"===ce||"m"===ce||"s"===ce}function B(ce){return ce>"\x01"&&ce<"\t"||ce>"\v"&&ce<"\f"||ce>"\x0e"&&ce<"\xff"}function G(ce){return O(ce)||v(ce)||"+"===ce||"/"===ce}function Y(ce){return v(ce)||O(ce)||"+"===ce||"/"===ce||"-"===ce||"_"===ce}function ae(ce){return O(ce)||v(ce)||"+"===ce||"/"===ce}function te(ce,T){var k=Object.keys(ce);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(ce);T&&(j=j.filter(function(re){return Object.getOwnPropertyDescriptor(ce,re).enumerable})),k.push.apply(k,j)}return k}function Z(ce){for(var T=1;T<arguments.length;T++){var k=null!=arguments[T]?arguments[T]:{};T%2?te(Object(k),!0).forEach(function(j){_e(ce,j,k[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ce,Object.getOwnPropertyDescriptors(k)):te(Object(k)).forEach(function(j){Object.defineProperty(ce,j,Object.getOwnPropertyDescriptor(k,j))})}return ce}function _e(ce,T,k){return T in ce?Object.defineProperty(ce,T,{value:k,enumerable:!0,configurable:!0,writable:!0}):ce[T]=k,ce}var ce;(ce=_||(_={})).VERSION="v",ce.ORIGIN="o",ce.SESSION_NAME="s",ce.INFORMATION="i",ce.URI="u",ce.EMAIL="e",ce.PHONE="p",ce.CONNECTION="c",ce.BANDWIDTH="b",ce.TIME="t",ce.REPEAT="r",ce.ZONE_ADJUSTMENTS="z",ce.KEY="k",ce.ATTRIBUTE="a",ce.MEDIA="m";class fe{consumeText(T,k){let j=k;for(;j<T.length;){const re=T[j];if("\0"===re||"\r"===re||re===g)break;j+=1}if(j-k==0)throw new Error("Invalid text, at ".concat(T));return j}consumeUnicastAddress(T,k,j){return this.consumeTill(T,k,A)}consumeOneOrMore(T,k,j){let re=k;for(;j(T[re]);)re++;if(re-k==0)throw new Error("Invalid rule at ".concat(k,"."));return re}consumeSpace(T,k){if(T[k]===A)return k+1;throw new Error("Invalid space at ".concat(k,"."))}consumeIP4Address(T,k){let j=k;for(let re=0;re<4;re++)if(j=this.consumeDecimalUChar(T,j),3!==re){if("."!==T[j])throw new Error("Invalid IP4 address.");j++}return j}consumeDecimalUChar(T,k){let j=k;for(let be=0;be<3&&v(T[j]);be++,j++);if(j-k==0)throw new Error("Invalid decimal uchar.");const re=parseInt(T.slice(k,j));if(re>=0&&re<=255)return j;throw new Error("Invalid decimal uchar")}consumeIP6Address(T,k){let j=this.consumeHexpart(T,k);return":"===T[j]&&(j+=1,j=this.consumeIP4Address(T,j)),j}consumeHexpart(T,k){let j=k;if(":"===T[j]&&":"===T[j+1]){j+=2;try{j=this.consumeHexseq(T,j)}catch{}return j}if(j=this.consumeHexseq(T,j),":"===T[j]&&":"===T[j+1]){j+=2;try{j=this.consumeHexseq(T,j)}catch{}return j}return j}consumeHexseq(T,k){let j=k;for(;j=this.consumeHex4(T,j),":"===T[j]&&":"!==T[j+1];)j+=1;return j}consumeHex4(T,k){let j=0;for(;j<4;j++)if(!((re=T[k+j])>="0"&&re<="9"||re>="a"&&re<="f"||re>="A"&&re<="F")){if(0===j)throw new Error("Invalid hex 4");break}var re;return k+j}consumeFQDN(T,k){let j=k;for(;v(T[j])||O(T[j])||"-"===T[j]||"."===T[j];)j+=1;if(j-k<4)throw new Error("Invalid FQDN");return j}consumeExtnAddr(T,k){return this.consumeOneOrMore(T,k,S)}consumeMulticastAddress(T,k,j){switch(j){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(T,k);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(T,k);default:try{return this.consumeFQDN(T,k)}catch{return this.consumeExtnAddr(T,k)}}}consumeIP6MulticastAddress(T,k){const j=this.consumeHexpart(T,k);return"/"===T[j]?this.consumeInteger(T,j+1):j}consumeIP4MulticastAddress(T,k){let j=k+3;const re=T.slice(k,j),be=parseInt(re);if(be<224||be>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let dt=0;dt<3;dt++){if("."!==T[j])throw new Error("Invalid IP4 multicast address.");j+=1,j=this.consumeDecimalUChar(T,j)}return"/"===T[j]&&(j+=1),j=this.consumeTTL(T,j),"/"===T[j]&&(j=this.consumeInteger(T,j)),j}consumeInteger(T,k){if(!D(T[k]))throw new Error("Invalid integer.");for(k+=1;v(T[k]);)k+=1;return k}consumeTTL(T,k){if("0"===T[k])return k+1;if(!D(T[k]))throw new Error("Invalid TTL.");k+=1;for(let j=0;j<2&&v(T[k]);j++)k+=1;return k}consumeToken(T,k){return this.consumeOneOrMore(T,k,R)}consumeTime(T,k){let j=k;if("0"===T[j])return j+1;for(D(T[j])&&(j+=1);v(T[j]);)j++;if(j-k<10)throw new Error("Invalid time");return j}consumeAddress(T,k){return this.consumeTill(T,k,A)}consumeTypedTime(T,k){let j=k;return j=this.consumeOneOrMore(T,j,v),P(T[j])?j+1:j}consumeRepeatInterval(T,k){if(!D(T[k]))throw new Error("Invalid repeat interval");for(k+=1;v(T[k]);)k+=1;return P(T[k])&&(k+=1),k}consumePort(T,k){return this.consumeOneOrMore(T,k,v)}consume(T,k,j){for(let re=0;re<j.length;re++){if(k+re>=T.length)throw new Error("consume exceeding value length");if(T[k+re]!==j[re])throw new Error("consume ".concat(j," failed at ").concat(re))}return k+j.length}consumeTill(T,k,j){let re=k;for(;re<T.length&&("string"!=typeof j||T[re]!==j)&&("function"!=typeof j||!j(T[re]));)re++;return re}}class Se extends fe{constructor(){super(),_e(this,"records",[]),_e(this,"currentLine",0)}parse(T){const k=this.probeEOL(T);this.records=T.split(k).filter(li=>!!li.trim()).map(this.parseLine),this.currentLine=0;const j=this.parseVersion(),re=this.parseOrigin(),be=this.parseSessionName(),dt=this.parseInformation(),St=this.parseUri(),at=this.parseEmail(),sn=this.parsePhone(),vt=this.parseConnection(),Xt=this.parseBandWidth(),et=this.parseTimeFields(),Zt=this.parseKey(),pt=this.parseSessionAttribute(),Gt=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:j,origin:re,sessionName:be,information:dt,uri:St,emails:at,phones:sn,connection:vt,bandwidths:Xt,timeFields:et,key:Zt,attributes:pt,mediaDescriptions:Gt}}getCurrentRecord(){const T=this.records[this.currentLine];if(!T)throw new Error("Record doesn't exit.");return T}probeEOL(T){for(let k=0;k<T.length;k++)if(T[k]===g)return"\r"===T[k-1]?f:g;throw new Error("Invalid newline character.")}parseLine(T,k){if(T.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const j=T[0];if("="!==T[1])throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:j,value:T.slice(2),line:k,cur:0}}parseSessionAttribute(){const T=new Ye;for(;this.currentLine<this.records.length;){const k=this.getCurrentRecord();if(k.type!==_.ATTRIBUTE)break;const j={attField:this.extractOneOrMore(k,re=>R(re)&&":"!==re),_cur:0};":"===k.value[k.cur]&&(k.cur+=1,j.attValue=this.extractOneOrMore(k,B)),T.parse(j),this.currentLine++}return T.digest()}parseMediaAttributes(T){const k=new Ee(T);for(;this.currentLine<this.records.length;){const j=this.getCurrentRecord();if(j.type!==_.ATTRIBUTE)break;const re={attField:this.extractOneOrMore(j,be=>R(be)&&":"!==be),_cur:0};":"===j.value[j.cur]&&(j.cur+=1,re.attValue=this.extractOneOrMore(j,B)),k.parse(re),this.currentLine++}return k.digest()}parseKey(){const T=this.getCurrentRecord();if(T.type===_.KEY){if("prompt"===T.value||"clear:"===T.value||"base64:"===T.value||"uri:"===T.value)return T.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const T=this.getCurrentRecord();if(T.type===_.ZONE_ADJUSTMENTS){const k=[];for(;;)try{const j=this.extract(T,this.consumeTime);this.consumeSpaceForRecord(T);let re=!1;"-"===T.value[T.cur]&&(re=!0,T.cur+=1);const be=this.extract(T,this.consumeTypedTime);k.push({time:j,typedTime:be,back:re})}catch{break}if(0===k.length)throw new Error("Invalid zone adjustments");return this.currentLine++,k}return[]}parseRepeat(){const T=[];for(;;){const k=this.getCurrentRecord();if(k.type!==_.REPEAT)break;{const j=this.extract(k,this.consumeRepeatInterval),re=this.parseTypedTime(k);T.push({repeatInterval:j,typedTimes:re}),this.currentLine++}}return T}parseTypedTime(T){const k=[];for(;;)try{this.consumeSpaceForRecord(T),k.push(this.extract(T,this.consumeTypedTime))}catch{break}if(0===k.length)throw new Error("Invalid typed time.");return k}parseTime(){const T=this.getCurrentRecord(),k=this.extract(T,this.consumeTime);this.consumeSpaceForRecord(T);const j=this.extract(T,this.consumeTime);return this.currentLine++,{startTime:k,stopTime:j}}parseBandWidth(){const T=[];for(;this.currentLine<this.records.length;){const k=this.getCurrentRecord();if(k.type!==_.BANDWIDTH)break;{const j=this.extractOneOrMore(k,R);if(":"!==k.value[k.cur])throw new Error("Invalid bandwidth field.");k.cur++;const re=this.extractOneOrMore(k,v);T.push({bwtype:j,bandwidth:re}),this.currentLine++}}return T}parseVersion(){const T=this.getCurrentRecord();if(T.type!==_.VERSION)throw new Error("first sdp record must be version");const k=T.value.slice(0,this.consumeOneOrMore(T.value,0,v));if(k.length!==T.value.length)throw new Error('invalid proto version, "v='.concat(T.value,'"'));return this.currentLine++,k}parseOrigin(){const T=this.getCurrentRecord();if(T.type!==_.ORIGIN)throw new Error("second line of sdp must be origin");const k=this.extractOneOrMore(T,S);this.consumeSpaceForRecord(T);const j=this.extractOneOrMore(T,v);this.consumeSpaceForRecord(T);const re=this.extractOneOrMore(T,v);this.consumeSpaceForRecord(T);const be=this.extractOneOrMore(T,R);this.consumeSpaceForRecord(T);const dt=this.extractOneOrMore(T,R);this.consumeSpaceForRecord(T);const St=this.extract(T,this.consumeUnicastAddress);return this.currentLine++,{username:k,sessId:j,sessVersion:re,nettype:be,addrtype:dt,unicastAddress:St}}parseSessionName(){const T=this.getCurrentRecord();if(T.type===_.SESSION_NAME){const k=this.extract(T,this.consumeText);return this.currentLine++,k}}parseInformation(){const T=this.getCurrentRecord();if(T.type!==_.INFORMATION)return;const k=this.extract(T,this.consumeText);return this.currentLine++,k}parseUri(){const T=this.getCurrentRecord();if(T.type===_.URI)return this.currentLine++,T.value}parseEmail(){const T=[];for(;;){const k=this.getCurrentRecord();if(k.type!==_.EMAIL)break;T.push(k.value),this.currentLine++}return T}parsePhone(){const T=[];for(;;){const k=this.getCurrentRecord();if(k.type!==_.PHONE)break;T.push(k.value),this.currentLine++}return T}parseConnection(){const T=this.getCurrentRecord();if(T.type===_.CONNECTION){const k=this.extractOneOrMore(T,R);this.consumeSpaceForRecord(T);const j=this.extractOneOrMore(T,R);this.consumeSpaceForRecord(T);const re=this.extract(T,this.consumeAddress);return this.currentLine++,{nettype:k,addrtype:j,address:re}}}parseMedia(){const T=this.getCurrentRecord(),k=this.extract(T,this.consumeToken);this.consumeSpaceForRecord(T);let j=this.extract(T,this.consumePort);"/"===T.value[T.cur]&&(T.cur+=1,j+=this.extract(T,this.consumeInteger)),this.consumeSpaceForRecord(T);const re=[];for(re.push(this.extract(T,this.consumeToken));"/"===T.value[T.cur];)T.cur+=1,re.push(this.extract(T,this.consumeToken));if(0===re.length)throw new Error("Invalid proto");const be=this.parseFmt(T);return this.currentLine++,{mediaType:k,port:j,protos:re,fmts:be}}parseTimeFields(){const T=[];for(;this.getCurrentRecord().type===_.TIME;){const k=this.parseTime(),j=this.parseRepeat(),re=this.parseZone();T.push({time:k,repeats:j,zones:re})}return T}parseMediaDescription(){const T=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===_.MEDIA;){const k=this.parseMedia(),j=this.parseInformation(),re=this.parseConnections(),be=this.parseBandWidth(),dt=this.parseKey(),St=this.parseMediaAttributes(k);T.push({media:k,information:j,connections:re,bandwidths:be,key:dt,attributes:St})}return T}parseConnections(){const T=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===_.CONNECTION;)T.push(this.parseConnection());return T}parseFmt(T){const k=[];for(;;)try{this.consumeSpaceForRecord(T),k.push(this.extract(T,this.consumeToken))}catch{break}if(0===k.length)throw new Error("Invalid fmts");return k}extract(T,k,...j){const re=k.call(this,T.value,T.cur,...j),be=T.value.slice(T.cur,re);return T.cur=re,be}extractOneOrMore(T,k){const j=this.consumeOneOrMore(T.value,T.cur,k),re=T.value.slice(T.cur,j);return T.cur=j,re}consumeSpaceForRecord(T){if(T.value[T.cur]!==A)throw new Error("Invalid space at ".concat(T.cur,"."));T.cur+=1}}class Oe extends fe{constructor(...T){super(...T),_e(this,"attributes",void 0),_e(this,"digested",!1)}extractOneOrMore(T,k,j){const re=this.consumeOneOrMore(T.attValue,T._cur,k),be=T.attValue.slice(T._cur,re),[dt,St]=j||[];if("number"==typeof dt&&be.length<dt)throw new Error("error in length, should be more or equal than ".concat(dt," characters."));if("number"==typeof St&&be.length>St)throw new Error("error in length, should be less or equal than ".concat(St," characters."));return T._cur=re,be}consumeAttributeSpace(T){if(T.attValue[T._cur]!==A)throw new Error("Invalid space at ".concat(T._cur,"."));T._cur+=1}extract(T,k,...j){if(!T.attValue)throw new Error("Nothing to extract from attValue.");const re=k.call(this,T.attValue,T._cur,...j),be=T.attValue.slice(T._cur,re);return T._cur=re,be}atEnd(T){if(!T.attValue)throw new Error;return T._cur>=T.attValue.length}peekChar(T){if(!T.attValue)throw new Error;return T.attValue[T._cur]}peek(T,k){if(!T.attValue)throw new Error;for(let j=0;j<k.length;j++)if(k[j]!==T.attValue[T._cur+j])return!1;return!0}parseIceUfrag(T){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(T,G,[4,256])}parseIcePwd(T){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(T,G,[22,256])}parseIceOptions(T){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const k=[];for(;!this.atEnd(T);){k.push(this.extractOneOrMore(T,G));try{this.consumeAttributeSpace(T)}catch(j){if(this.atEnd(T))break;throw j}}this.attributes.iceOptions=k}parseFingerprint(T){const k=this.extract(T,this.consumeToken);this.consumeAttributeSpace(T);const j=this.extract(T,this.consumeTill);this.attributes.fingerprints.push({hashFunction:k,fingerprint:j})}parseExtmap(T){const k=this.extractOneOrMore(T,v);let j;"/"===this.peekChar(T)&&(this.extract(T,this.consume,"/"),j=this.extract(T,this.consumeToken)),this.consumeAttributeSpace(T);const re=this.extract(T,this.consumeTill,A),be=Z(Z({entry:parseInt(k,10)},j&&{direction:j}),{},{extensionName:re});this.peekChar(T)===A&&(this.consumeAttributeSpace(T),be.extensionAttributes=this.extract(T,this.consumeTill)),this.attributes.extmaps.push(be)}parseSetup(T){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const k=this.extract(T,this.consumeTill);if("active"!==k&&"passive"!==k&&"actpass"!==k&&"holdconn"!==k)throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=k}}class Ye extends Oe{constructor(...T){super(...T),_e(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(T){if(this.digested)throw new Error("already digested");try{switch(T.attField){case"group":this.parseGroup(T);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(T);break;case"ice-pwd":this.parseIcePwd(T);break;case"ice-options":this.parseIceOptions(T);break;case"fingerprint":this.parseFingerprint(T);break;case"setup":this.parseSetup(T);break;case"tls-id":this.parseTlsId(T);break;case"identity":this.parseIdentity(T);break;case"extmap":this.parseExtmap(T);break;case"msid-semantic":this.parseMsidSemantic(T);break;default:T.ignored=!0,this.attributes.unrecognized.push(T)}}catch(k){throw console.error("parsing session attribute ".concat(T.attField,' error, "a=').concat(T.attField,":").concat(T.attValue,'"')),k}if(!T.ignored&&T.attValue&&!this.atEnd(T))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(T){const k=this.extract(T,this.consumeToken),j=[];for(;!this.atEnd(T)&&this.peekChar(T)===A;)this.consumeAttributeSpace(T),j.push(this.extract(T,this.consumeToken));this.attributes.groups.push({semantic:k,identificationTag:j})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(T){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(T,Y)}parseIdentity(T){const k=this.extractOneOrMore(T,ae),j=[];for(;!this.atEnd(T)&&this.peekChar(T)===A;){this.consumeAttributeSpace(T);const re=this.extract(T,this.consumeToken);this.extract(T,this.consume,"=");const be=this.extractOneOrMore(T,dt=>dt!==A&&B(dt));j.push({name:re,value:be})}this.attributes.identities.push({assertionValue:k,extensions:j})}parseMsidSemantic(T){this.peekChar(T)===A&&this.consumeAttributeSpace(T);const k={semantic:this.extract(T,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(T)}catch{break}if("*"===this.peekChar(T)){this.extract(T,this.consume,"*"),k.applyForAll=!0;break}{const j=this.extract(T,this.consumeTill,A);k.identifierList.push(j)}}this.attributes.msidSemantic=k}}class Ee extends Oe{constructor(T){super(),_e(this,"attributes",void 0),-1!==T.protos.indexOf("RTP")||T.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(T){if(this.digested)throw new Error("already digested");try{switch(T.attField){case"extmap":this.parseExtmap(T);break;case"setup":this.parseSetup(T);break;case"ice-ufrag":this.parseIceUfrag(T);break;case"ice-pwd":this.parseIcePwd(T);break;case"ice-options":this.parseIceOptions(T);break;case"candidate":this.parseCandidate(T);break;case"remote-candidate":this.parseRemoteCandidate(T);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(T);break;case"rtpmap":this.parseRtpmap(T);break;case"ptime":this.parsePtime(T);break;case"maxptime":this.parseMaxPtime(T);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(T);break;case"ssrc":this.parseSSRC(T);break;case"fmtp":this.parseFmtp(T);break;case"rtcp-fb":this.parseRtcpFb(T);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(T);break;case"mid":this.parseMid(T);break;case"msid":this.parseMsid(T);break;case"imageattr":this.parseImageAttr(T);break;case"rid":this.parseRid(T);break;case"simulcast":this.parseSimulcast(T);break;case"sctp-port":this.parseSctpPort(T);break;case"max-message-size":this.parseMaxMessageSize(T);break;case"ssrc-group":this.parseSSRCGroup(T);break;default:T.ignored=!0,this.attributes.unrecognized.push(T)}}catch(k){throw console.error("parsing media attribute ".concat(T.attField,' error, "a=').concat(T.attField,":").concat(T.attValue,'"')),k}if(!T.ignored&&T.attValue&&!this.atEnd(T))throw new Error("attribute parsing error")}parseCandidate(T){const k=this.extractOneOrMore(T,G,[1,32]);this.consumeAttributeSpace(T);const j=this.extractOneOrMore(T,v,[1,5]);this.consumeAttributeSpace(T);const re=this.extract(T,this.consumeToken);this.consumeAttributeSpace(T);const be=this.extractOneOrMore(T,v,[1,10]);this.consumeAttributeSpace(T);const dt=this.extract(T,this.consumeAddress);this.consumeAttributeSpace(T);const St=this.extract(T,this.consumePort);this.consumeAttributeSpace(T),this.extract(T,this.consume,"typ"),this.consumeAttributeSpace(T);const at={foundation:k,componentId:j,transport:re,priority:be,connectionAddress:dt,port:St,type:this.extract(T,this.consumeToken),extension:{}};for(this.peek(T," raddr")&&(this.extract(T,this.consume," raddr"),this.consumeAttributeSpace(T),at.relAddr=this.extract(T,this.consumeAddress)),this.peek(T," rport")&&(this.extract(T,this.consume," rport"),this.consumeAttributeSpace(T),at.relPort=this.extract(T,this.consumePort));this.peekChar(T)===A;){this.consumeAttributeSpace(T);const sn=this.extract(T,this.consumeToken);this.consumeAttributeSpace(T),at.extension[sn]=this.extractOneOrMore(T,y)}this.attributes.candidates.push(at)}parseRemoteCandidate(T){const k=[];for(;;){const j=this.extractOneOrMore(T,v,[1,5]);this.consumeAttributeSpace(T);const re=this.extract(T,this.consumeAddress);this.consumeAttributeSpace(T);const be=this.extract(T,this.consumePort);k.push({componentId:j,connectionAddress:re,port:be});try{this.consumeAttributeSpace(T)}catch{break}}this.attributes.remoteCandidatesList.push(k)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(T){const k=this.extract(T,this.consumeToken);this.consumeAttributeSpace(T);const j=this.extract(T,this.consumeTill,"/");this.extract(T,this.consume,"/");const re={encodingName:j,clockRate:this.extractOneOrMore(T,v)};this.atEnd(T)||"/"!==this.peekChar(T)||(this.extract(T,this.consume,"/"),re.encodingParameters=parseInt(this.extract(T,this.consumeTill),10));const be=this.attributes.payloads.find(dt=>dt.payloadType===parseInt(k,10));be?be.rtpMap=re:this.attributes.payloads.push({payloadType:parseInt(k,10),rtpMap:re,rtcpFeedbacks:[]})}parsePtime(T){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(T,this.consumeTill)}parseMaxPtime(T){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(T,this.consumeTill)}parseDirection(T){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=T.attField}parseSSRC(T){const k=this.extractOneOrMore(T,v);this.consumeAttributeSpace(T);const j=this.extract(T,this.consumeTill,":");let re;":"===this.peekChar(T)&&(this.extract(T,this.consume,":"),re=this.extract(T,this.consumeTill));const be=this.attributes.ssrcs.find(dt=>dt.ssrcId===parseInt(k,10));be?be.attributes[j]=re:this.attributes.ssrcs.push({ssrcId:parseInt(k,10),attributes:{[j]:re}})}parseFmtp(T){const k=this.extract(T,this.consumeTill,A);this.consumeAttributeSpace(T);const j=this.extract(T,this.consumeTill),re={};j.split(";").forEach(dt=>{let[St,at]=dt.split("=");St=St.trim();const sn="string"==typeof at?at.trim():null;"string"==typeof St&&St.length>0&&(re[St]=sn)});const be=this.attributes.payloads.find(dt=>dt.payloadType===parseInt(k,10));be?be.fmtp={parameters:re}:this.attributes.payloads.push({payloadType:parseInt(k,10),rtcpFeedbacks:[],fmtp:{parameters:re}})}parseFmtParameters(T){const k={},j=this.extract(T,this.consumeTill,"=");T._cur++;const re=this.extract(T,this.consumeTill,";");for(k[j]=re;";"===T.attValue[T._cur];){const be=this.extract(T,this.consumeTill,"=");T._cur++;const dt=this.extract(T,this.consumeTill,";");k[be]=dt}return k}parseRtcpFb(T){let k="";k="*"===this.peekChar(T)?this.extract(T,this.consume,"*"):this.extract(T,this.consumeTill,A),this.consumeAttributeSpace(T);const j=this.extract(T,this.consumeTill,A);let re;if("trr-int"===j)re={type:j,interval:this.extract(T,this.consumeTill)};else{const be={type:j};this.peekChar(T)===A&&(this.consumeAttributeSpace(T),be.parameter=this.extract(T,this.consumeToken),this.peekChar(T)===A&&(be.additional=this.extract(T,this.consumeTill))),re=be}if("*"===k)this.attributes.rtcpFeedbackWildcards.push(re);else{const be=this.attributes.payloads.find(dt=>dt.payloadType===parseInt(k,10));be?be.rtcpFeedbacks.push(re):this.attributes.payloads.push({payloadType:parseInt(k,10),rtcpFeedbacks:[re]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(T){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const k={port:this.extract(T,this.consumePort)};this.peekChar(T)===A&&(this.consumeAttributeSpace(T),k.netType=this.extractOneOrMore(T,R),this.consumeAttributeSpace(T),k.addressType=this.extractOneOrMore(T,R),this.consumeAttributeSpace(T),k.address=this.extract(T,this.consumeAddress)),this.attributes.rtcp=k}parseMsid(T){const k={id:this.extractOneOrMore(T,R,[1,64])};this.peekChar(T)===A&&(this.consumeAttributeSpace(T),k.appdata=this.extractOneOrMore(T,R,[1,64])),this.attributes.msids.push(k)}parseImageAttr(T){this.attributes.imageattr.push(T.attValue)}parseRid(T){const k=this.extractOneOrMore(T,re=>O(re)||v(re)||"_"===re||"-"===re);this.consumeAttributeSpace(T);const j={id:k,direction:this.extract(T,this.consumeToken),params:[]};if(this.peekChar(T)===A){if(this.consumeAttributeSpace(T),this.peek(T,"pt=")){this.extract(T,this.consume,"pt=");const re=[];for(;;){const be=this.extract(T,this.consumeToken);re.push(be);try{this.extract(T,this.consume,",")}catch{break}}j.payloads=re,this.peekChar(T)===A&&this.extract(T,this.consume,A)}for(;;){const re=this.extract(T,this.consumeToken);switch(re){case"depend":{const be={type:re,rids:this.extract(T,this.consume,"=").split(",")};j.params.push(be);break}default:{const be={type:re};"="===this.peekChar(T)&&(this.extract(T,this.consume,"="),be.val=this.extract(T,this.consumeTill,";")),j.params.push(be)}}try{this.extract(T,this.consume,";")}catch{break}}}this.attributes.rids.push(j)}parseSimulcast(T){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=T.attValue,this.extract(T,this.consumeTill)}parseSctpPort(T){this.attributes.sctpPort=this.extractOneOrMore(T,v,[1,5])}parseMaxMessageSize(T){this.attributes.maxMessageSize=this.extractOneOrMore(T,v,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(T){this.attributes.mid=this.extract(T,this.consumeToken)}parseSSRCGroup(T){const k=this.extract(T,this.consumeToken),j=[];for(;;)try{this.consumeAttributeSpace(T);const re=this.extract(T,this.consumeInteger);j.push(parseInt(re,10))}catch{break}this.attributes.ssrcGroups.push({semantic:k,ssrcIds:j})}}function z(ce,T,k){return T in ce?Object.defineProperty(ce,T,{value:k,enumerable:!0,configurable:!0,writable:!0}):ce[T]=k,ce}class ee{constructor(){z(this,"eol",f)}print(T,k){let j="";return k&&(this.eol=k),j+=this.printVersion(T.version),j+=this.printOrigin(T.origin),j+=this.printSessionName(T.sessionName),j+=this.printInformation(T.information),j+=this.printUri(T.uri),j+=this.printEmail(T.emails),j+=this.printPhone(T.phones),j+=this.printConnection(T.connection),j+=this.printBandwidth(T.bandwidths),j+=this.printTimeFields(T.timeFields),j+=this.printKey(T.key),j+=this.printSessionAttributes(T.attributes),j+=this.printMediaDescription(T.mediaDescriptions),j}printVersion(T){return"v=".concat(T).concat(this.eol)}printOrigin(T){return"o=".concat(T.username," ").concat(T.sessId," ").concat(T.sessVersion," ").concat(T.nettype," ").concat(T.addrtype," ").concat(T.unicastAddress).concat(this.eol)}printSessionName(T){return T?"s=".concat(T).concat(this.eol):""}printInformation(T){return T?"i=".concat(T).concat(this.eol):""}printUri(T){return T?"u=".concat(T).concat(this.eol):""}printEmail(T){let k="";for(const j of T)k+="e=".concat(j).concat(this.eol);return k}printPhone(T){let k="";for(const j of T)k+="e=".concat(j).concat(this.eol);return k}printConnection(T){return T?"c=".concat(T.nettype," ").concat(T.addrtype," ").concat(T.address).concat(this.eol):""}printBandwidth(T){let k="";for(const j of T)k+="b=".concat(j.bwtype,":").concat(j.bandwidth).concat(this.eol);return k}printTimeFields(T){let k="";for(const j of T){k+="t=".concat(j.time.startTime," ").concat(j.time.startTime).concat(this.eol);for(const re of j.repeats)k+="r=".concat(re.repeatInterval," ").concat(re.typedTimes.join(" ")).concat(this.eol);j.zoneAdjustments&&(k+="z=",k+="z=".concat(j.zoneAdjustments.map(re=>"".concat(re.time," ").concat(re.back?"-":""," ").concat(re.typedTime)).join(" ")).concat(this.eol),k+=this.eol)}return k}printKey(T){return T?"k=".concat(T).concat(this.eol):""}printAttributes(T){let k="";for(const j of T)k+="a=".concat(j.attField).concat(j.attValue?":".concat(j.attValue):"").concat(this.eol);return k}printMediaDescription(T){let k="";for(const j of T)k+=this.printMedia(j.media),k+=this.printInformation(j.information),k+=this.printConnections(j.connections),k+=this.printBandwidth(j.bandwidths),k+=this.printKey(j.key),k+=this.printMediaAttributes(j);return k}printConnections(T){let k="";for(const j of T)k+=this.printConnection(j);return k}printMedia(T){return"m=".concat(T.mediaType," ").concat(T.port," ").concat(T.protos.join("/")," ").concat(T.fmts.join(" ")).concat(this.eol)}printSessionAttributes(T){return new K(this.eol).print(T)}printMediaAttributes(T){return new ne(this.eol).print(T)}}class Q{constructor(T){z(this,"eol",void 0),this.eol=T}printIceUfrag(T){return void 0===T?"":"a=ice-ufrag:".concat(T).concat(this.eol)}printIcePwd(T){return void 0===T?"":"a=ice-pwd:".concat(T).concat(this.eol)}printIceOptions(T){return void 0===T?"":"a=ice-options:".concat(T.join(A)).concat(this.eol)}printFingerprints(T){return T.length>0?T.map(k=>"a=fingerprint:".concat(k.hashFunction).concat(A).concat(k.fingerprint)).join(this.eol)+this.eol:""}printExtmap(T){return T.map(k=>"a=extmap:".concat(k.entry).concat(k.direction?"/".concat(k.direction):"").concat(A).concat(k.extensionName).concat(k.extensionAttributes?"".concat(A).concat(k.extensionAttributes):"").concat(this.eol)).join("")}printSetup(T){return void 0===T?"":"a=setup:".concat(T).concat(this.eol)}printUnrecognized(T){return T.map(k=>"a=".concat(k.attField).concat(k.attValue?":".concat(k.attValue):"").concat(this.eol)).join("")}}class K extends Q{print(T){let k="";return k+=this.printGroups(T.groups),k+=this.printMsidSemantic(T.msidSemantic),k+=this.printIceLite(T.iceLite),k+=this.printIceUfrag(T.iceUfrag),k+=this.printIcePwd(T.icePwd),k+=this.printIceOptions(T.iceOptions),k+=this.printFingerprints(T.fingerprints),k+=this.printSetup(T.setup),k+=this.printTlsId(T.tlsId),k+=this.printIdentity(T.identities),k+=this.printExtmap(T.extmaps),k+=this.printUnrecognized(T.unrecognized),k}printGroups(T){let k="";return T.length>0&&(k+=T.map(j=>"a=group:".concat(j.semantic).concat(j.identificationTag.map(re=>"".concat(A).concat(re)).join("")).concat(this.eol)).join("")),k}printIceLite(T){return void 0===T?"":"a=ice-lite"+this.eol}printTlsId(T){return T?"a=tls-id:".concat(T).concat(this.eol):""}printIdentity(T){return 0===T.length?"":T.map(k=>"a=identity:".concat(k.assertionValue).concat(k.extensions.map(j=>"".concat(A).concat(j.name).concat(j.value?"=".concat(j.value):"")))).join(this.eol)+this.eol}printMsidSemantic(T){if(!T)return"";let k="a=msid-semantic:".concat(T.semantic);return T.applyForAll?k+="".concat(A,"*"):T.identifierList.length>0&&(k+=T.identifierList.map(j=>"".concat(A).concat(j))),k+this.eol}}class ne extends Q{print(T){const k=T.attributes;let j="";return j+=this.printRTCP(k.rtcp),j+=this.printIceUfrag(k.iceUfrag),j+=this.printIcePwd(k.icePwd),j+=this.printIceOptions(k.iceOptions),j+=this.printCandidates(k.candidates),j+=this.printRemoteCandidatesList(k.remoteCandidatesList),j+=this.printEndOfCandidates(k.endOfCandidates),j+=this.printFingerprints(k.fingerprints),j+=this.printSetup(k.setup),j+=this.printMid(k.mid),j+=this.printExtmap(k.extmaps),j+=this.printRTPRelated(k),j+=this.printPtime(k.ptime),j+=this.printMaxPtime(k.maxPtime),j+=this.printDirection(k.direction),j+=this.printSSRCGroups(k.ssrcGroups),j+=this.printSSRC(k.ssrcs),j+=this.printRTCPMux(k.rtcpMux),j+=this.printRTCPMuxOnly(k.rtcpMuxOnly),j+=this.printRTCPRsize(k.rtcpRsize),j+=this.printMSId(k.msids),j+=this.printImageattr(k.imageattr),j+=this.printRid(k.rids),j+=this.printSimulcast(k.simulcast),j+=this.printSCTPPort(k.sctpPort),j+=this.printMaxMessageSize(k.maxMessageSize),j+=this.printUnrecognized(k.unrecognized),j}printCandidates(T){return T.map(k=>"a=candidate:".concat(k.foundation).concat(A).concat(k.componentId).concat(A).concat(k.transport).concat(A).concat(k.priority).concat(A).concat(k.connectionAddress).concat(A).concat(k.port).concat(A,"typ").concat(A).concat(k.type).concat(k.relAddr?"".concat(A,"raddr").concat(A).concat(k.relAddr):"").concat(k.relPort?"".concat(A,"rport").concat(A).concat(k.relPort):"").concat(Object.keys(k.extension).map(j=>"".concat(A).concat(j).concat(A).concat(k.extension[j])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(T){return T.map(k=>"a=remote-candidates:".concat(k.join(A)).concat(this.eol)).join("")}printEndOfCandidates(T){return void 0===T?"":"a=end-of-candidates"+this.eol}printRTPRelated(T){if(!T.payloads)return"";const k=T.payloads;let j="";j+=T.rtcpFeedbackWildcards.map(re=>this.printRTCPFeedback("*",re)).join("");for(const re of k)j+=this.printRtpMap(re.payloadType,re.rtpMap),j+=this.printFmtp(re.payloadType,re.fmtp),j+=re.rtcpFeedbacks.map(be=>this.printRTCPFeedback(re.payloadType,be)).join("");return j}printFmtp(T,k){if(!k)return"";const j=Object.keys(k.parameters);return 1===j.length&&null===k.parameters[j[0]]?"a=fmtp:".concat(T).concat(A).concat(j[0]).concat(this.eol):"a=fmtp:".concat(T).concat(A).concat(Object.keys(k.parameters).map(re=>"".concat(re,"=").concat(k.parameters[re])).join(";")).concat(this.eol)}printRtpMap(T,k){return k?"a=rtpmap:".concat(T).concat(A).concat(k.encodingName,"/").concat(k.clockRate).concat(k.encodingParameters?"/".concat(k.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(T,k){let j="a=rtcp-fb:".concat(T).concat(A),re=k;return"trr-int"===re.type?j+="ttr-int".concat(A).concat(re.interval):(j+="".concat(re.type),re.parameter&&(j+="".concat(A).concat(re.parameter),re.additional&&(j+="".concat(A).concat(re.additional)))),j+this.eol}printPtime(T){return void 0===T?"":"a=ptime:".concat(T).concat(this.eol)}printMaxPtime(T){return void 0===T?"":"a=maxptime:".concat(T).concat(this.eol)}printDirection(T){return void 0===T?"":"a=".concat(T).concat(this.eol)}printSSRC(T){return T.map(k=>Object.keys(k.attributes).map(j=>"a=ssrc:".concat(k.ssrcId.toString(10)).concat(A).concat(j).concat(k.attributes[j]?":".concat(k.attributes[j]):"").concat(this.eol)).join("")).join("")}printRTCPMux(T){return void 0===T?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(T){return void 0===T?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(T){return void 0===T?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(T){if(void 0===T)return"";let k="a=rtcp:".concat(T.port);return T.netType&&(k+="".concat(A).concat(T.netType)),T.addressType&&(k+="".concat(A).concat(T.addressType)),T.address&&(k+="".concat(A).concat(T.address)),k+this.eol}printMSId(T){return T.map(k=>"a=msid:".concat(k.id).concat(k.appdata?"".concat(A).concat(k.appdata):"").concat(this.eol)).join("")}printImageattr(T){return T.map(k=>"a=imageattr:".concat(k).concat(this.eol)).join("")}printRid(T){return T.map(k=>{let j="a=rid:".concat(k.id).concat(A).concat(k.direction);return k.payloads&&(j+="".concat(A,"pt=").concat(k.payloads.join(","))),k.params.length>0&&(j+="".concat(A).concat(k.params.map(re=>"depend"===re.type?"depend=".concat(re.rids.join(",")):"".concat(re.type,"=").concat(re.val)).join(";"))),j+this.eol}).join("")}printSimulcast(T){return void 0===T?"":"a=simulcast:".concat(T).concat(this.eol)}printSCTPPort(T){return void 0===T?"":"a=sctp-port:".concat(T).concat(this.eol)}printMaxMessageSize(T){return void 0===T?"":"a=max-message-size:".concat(T).concat(this.eol)}printMid(T){return void 0===T?"":"a=mid:".concat(T).concat(this.eol)}printSSRCGroups(T){return T.map(k=>"a=ssrc-group:".concat(k.semantic).concat(k.ssrcIds.map(j=>"".concat(A).concat(j.toString(10))).join("")).concat(this.eol)).join("")}}function me(ce){return(new Se).parse(ce)}function Ne(ce,T){return(new ee).print(ce,T)}}},s={};function c(l){if(s[l])return s[l].exports;var p=s[l]={exports:{}};return o[l](p,p.exports,c),p.exports}return c.d=(l,p)=>{for(var h in p)c.o(p,h)&&!c.o(l,h)&&Object.defineProperty(l,h,{enumerable:!0,get:p[h]})},c.o=(l,p)=>Object.prototype.hasOwnProperty.call(l,p),c.r=l=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},c(8)})()}(sr);class ZY{constructor(i){b(this,"sessionDesc",void 0),b(this,"localCapabilities",void 0),b(this,"rtpCapabilities",void 0),b(this,"candidates",void 0),b(this,"iceParameters",void 0),b(this,"dtlsParameters",void 0),b(this,"setup",void 0),b(this,"currentMidIndex",void 0),b(this,"cname",void 0),i=en(i);const{remoteIceParameters:o,remoteDtlsParameters:s,candidates:c,remoteRTPCapabilities:l,remoteSetup:p,localCapabilities:h,sdkCodec:g,cname:f}=i,A=sr.exports.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE audio video\na=msid-semantic: WMS\na=ice-lite\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:audio\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:video\n");this.rtpCapabilities=l,this.candidates=c,this.iceParameters=o,this.dtlsParameters=s,this.setup=p,this.localCapabilities=h,this.cname=f;for(let _=0;_<A.mediaDescriptions.length;_++){const v=A.mediaDescriptions[_];if(v.attributes.iceUfrag=o.iceUfrag,v.attributes.icePwd=o.icePwd,v.attributes.fingerprints=s.fingerprints,v.attributes.candidates=c,v.attributes.setup=p,"video"===v.media.mediaType){v.media.fmts=l.videoCodecs.map(S=>S.payloadType.toString(10));const y=l.videoCodecs.filter(S=>{var R;return null===(R=S.rtpMap)||void 0===R?void 0:R.encodingName.toLowerCase().includes(g)});if(0===y.length)throw new Error("Codec ".concat(g," not supported by remote SDP."));v.attributes.payloads=y,v.attributes.extmaps=l.videoExtensions}"audio"===v.media.mediaType&&(v.media.fmts=l.audioCodecs.map(y=>y.payloadType.toString(10)),v.attributes.payloads=l.audioCodecs,v.attributes.extmaps=l.audioExtensions),A.mediaDescriptions[_]=this.mungMediaDesc(v)}this.sessionDesc=A,this.currentMidIndex=A.mediaDescriptions.length-1}toString(){return sr.exports.print(this.sessionDesc)}send(i,o,s){const{ssrcs:c,ssrcGroups:l}=Ms(o,this.cname),p=this.sessionDesc.mediaDescriptions.find(f=>i===ut.VIDEO?"video"===f.media.mediaType:"audio"===f.media.mediaType),h=c[0].attributes.label,g=c[0].attributes.mslabel;return p.attributes.ssrcs=p.attributes.ssrcs.concat(c),p.attributes.ssrcGroups=p.attributes.ssrcGroups.concat(l),{id:h,mslabel:g}}batchSend(i){return i.map(o=>{let{kind:s,ssrcMsg:c}=o;return this.send(s,c,void 0)})}stopSending(i){this.sessionDesc.mediaDescriptions.forEach(o=>{const s=[],c=[],l=[];o.attributes.ssrcs.forEach(p=>{i.includes(p.attributes.label||"")?l.push(p):s.push(p)}),o.attributes.ssrcGroups.forEach(p=>{l.map(h=>h.ssrcId).includes(p.ssrcIds[0])||c.push(p)}),o.attributes.ssrcs=s,o.attributes.ssrcGroups=c})}mute(i){const o=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===i);if(!o)throw new Error("mediaDescription not found with ".concat(i," in remote SDP when calling RemoteSDP.mute."));o.attributes.direction="inactive"}unmute(i){const o=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===i);if(!o)throw new Error("mediaDescription not found with ".concat(i," in remote SDP when calling RemoteSDP.unmute."));o.attributes.direction="sendonly"}receive(i,o,s){i.forEach((c,l)=>{const p=c._mediaStreamTrack,h=this.sessionDesc.mediaDescriptions.findIndex(f=>f.attributes.mid===p.kind),g=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[h],c);this.sessionDesc.mediaDescriptions[h]=g})}stopReceiving(i){}restartICE(i){i=en(i),this.iceParameters=i,this.sessionDesc.mediaDescriptions.forEach(o=>{o.attributes.iceUfrag=i.iceUfrag,o.attributes.icePwd=i.icePwd})}predictReceivingMids(i){const o=[];for(let s=0;s<i;s++)o.push((this.currentMidIndex+s+1).toString(10));return o}mungRecvMediaDsec(i,o){const s=en(i);return Zf(s,o),Ew(s,o),s}updateRecvMedia(i,o){const s=this.sessionDesc.mediaDescriptions.findIndex(c=>c.attributes.mid===i);if(-1!==s){const c=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[s],o);this.sessionDesc.mediaDescriptions[s]=c}}bumpMid(i){this.currentMidIndex+=i}updateTrackLabel(i,o,s){const c=this.sessionDesc.mediaDescriptions.find(p=>i===ut.VIDEO?"video"===p.attributes.mid:"audio"===p.attributes.mid);if(c){const p=c.attributes.ssrcs.find(h=>h.attributes.label===o);var l;p&&(p.attributes.label=s,null===(l=p.attributes.msid)||void 0===l||l.replace(o,s))}}mungMediaDesc(i){const o=en(i);return _w(o),function(s){const c=s.attributes.extmaps.find(l=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===l.extensionName);c&&s.attributes.extmaps.splice(s.attributes.extmaps.indexOf(c),1),s.attributes.payloads.forEach(l=>{const p=l.rtcpFeedbacks.findIndex(h=>"transport-cc"===h.type);-1!==p&&l.rtcpFeedbacks.splice(p,1)})}(o),o}getSSRC(i){for(const o of this.sessionDesc.mediaDescriptions)for(const s of o.attributes.ssrcs)if(s.attributes.label===i)return[s]}}function pa(t){if(Array.isArray(t))return t.map(function(s){return s});if(!KF(t))return t;var i={};for(var o in t)i[o]=KF(t[o])||Array.isArray(t[o])?pa(t[o]):t[o];return i}function KF(t){return!("object"!=typeof t||Array.isArray(t)||!t)}var yw=function(){function t(i){this.input=[],this.size=i}return t.prototype.add=function(i){this.input.push(i),this.input.length>this.size&&this.input.splice(0,1)},t.prototype.diffMean=function(){return 0===this.input.length?0:(this.input[this.input.length-1]-this.input[0])/this.input.length},t}(),YF=function(t,i){return(YF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,s){o.__proto__=s}||function(o,s){for(var c in s)s.hasOwnProperty(c)&&(o[c]=s[c])})(t,i)};function e(t,i){function o(){this.constructor=t}YF(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}var r=function(){return(r=Object.assign||function(t){for(var i,o=1,s=arguments.length;o<s;o++)for(var c in i=arguments[o])Object.prototype.hasOwnProperty.call(i,c)&&(t[c]=i[c]);return t}).apply(this,arguments)};function n(t,i,o,s){return new(o||(o=Promise))(function(c,l){function p(f){try{g(s.next(f))}catch(A){l(A)}}function h(f){try{g(s.throw(f))}catch(A){l(A)}}function g(f){f.done?c(f.value):new o(function(A){A(f.value)}).then(p,h)}g((s=s.apply(t,i||[])).next())})}function a(t,i){var o,s,c,l,p={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return l={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function h(g){return function(f){return function(A){if(o)throw new TypeError("Generator is already executing.");for(;p;)try{if(o=1,s&&(c=2&A[0]?s.return:A[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,A[1])).done)return c;switch(s=0,c&&(A=[2&A[0],c.value]),A[0]){case 0:case 1:c=A;break;case 4:return p.label++,{value:A[1],done:!1};case 5:p.label++,s=A[1],A=[0];continue;case 7:A=p.ops.pop(),p.trys.pop();continue;default:if(!((c=(c=p.trys).length>0&&c[c.length-1])||6!==A[0]&&2!==A[0])){p=0;continue}if(3===A[0]&&(!c||A[1]>c[0]&&A[1]<c[3])){p.label=A[1];break}if(6===A[0]&&p.label<c[1]){p.label=c[1],c=A;break}if(c&&p.label<c[2]){p.label=c[2],p.ops.push(A);break}c[2]&&p.ops.pop(),p.trys.pop();continue}A=i.call(t,p)}catch(_){A=[6,_],s=0}finally{o=c=0}if(5&A[0])throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}([g,f])}}}var u,d={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},m={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:d,remoteCandidate:d}},E={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0},C={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,qpSumPerFrame:0},I={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0},w={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0},M=function(){function t(i,o){var s=this;this.videoIsReady=!1,this.videoIsReady2={},this.stats=pa(m),this.isFirstVideoReceived={},this.isFirstVideoDecoded={},this.isFirstAudioReceived={},this.isFirstAudioDecoded={},this.lossRateWindowStats=[],this.pc=i,this.options=o,this.intervalTimer=window.setInterval(function(){return n(s,void 0,void 0,function(){return a(this,function(c){return this.updateStats(),[2]})})},this.options.updateInterval)}return t.prototype.getStats=function(){return this.stats},t.prototype.setVideoIsReady=function(i){this.videoIsReady=i},t.prototype.setVideoIsReady2=function(i,o){this.videoIsReady2[i]=o},t.prototype.getVideoIsReady=function(i){return this.videoIsReady2[i]||!1},t.prototype.setIsFirstAudioDecoded=function(i){},t.prototype.destroy=function(){window.clearInterval(this.intervalTimer),this.pc=void 0},t.prototype.calcLossRate=function(i){var o=this;this.lossRateWindowStats.push(i),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);for(var s=this.lossRateWindowStats.length,c=0,l=0,p=0,h=0,g=function(_){i[_].forEach(function(v,y){if(o.lossRateWindowStats[s-1][_][y]&&o.lossRateWindowStats[0][_][y]){var S=o.lossRateWindowStats[s-1][_][y].packets-o.lossRateWindowStats[0][_][y].packets,R=o.lossRateWindowStats[s-1][_][y].packetsLost-o.lossRateWindowStats[0][_][y].packetsLost;"videoSend"===_||"audioSend"===_?(c+=S,p+=R):(l+=S,h+=R),v.packetLostRate=Number.isNaN(S)||Number.isNaN(S)||S<=0||R<=0?0:R/(S+R)}})},f=0,A=["videoSend","audioSend","videoRecv","audioRecv"];f<A.length;f++)g(A[f]);i.sendPacketLossRate=c<=0||p<=0?0:p/(c+p),i.recvPacketLossRate=l<=0||h<=0?0:h/(l+h)},t}(),F=function(t){function i(){var o=null!==t&&t.apply(this,arguments)||this;return o._stats=m,o.lastDecodeVideoReceiverStats=new Map,o}return e(i,t),i.prototype.updateStats=function(){return n(this,void 0,void 0,function(){var o,s,c,l;return a(this,function(p){switch(p.label){case 0:return[4,this._getStats()];case 1:return o=p.sent(),s=this.statsResponsesToObjects(o),this._stats=pa(m),c=s.filter(function(h){return"ssrc"===h.type}),this.processSSRCStats(c),(l=s.find(function(h){return"VideoBwe"===h.type}))&&this.processBandwidthStats(l),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}})})},i.prototype.processBandwidthStats=function(o){this._stats.bitrate={actualEncoded:Number(o.googActualEncBitrate),targetEncoded:Number(o.googTargetEncBitrate),retransmit:Number(o.googRetransmitBitrate),transmit:Number(o.googTransmitBitrate)},this._stats.sendBandwidth=Number(o.googAvailableSendBandwidth)},i.prototype.processSSRCStats=function(o){var s=this;o.forEach(function(c){var l=c.id.includes("send");switch(c.mediaType+"_"+(l?"send":"recv")){case"video_send":var p=pa(C);p.codec=c.googCodecName,p.adaptionChangeReason="none",c.googCpuLimitedResolution&&(p.adaptionChangeReason="cpu"),c.googBandwidthLimitedResolution&&(p.adaptionChangeReason="bandwidth"),p.avgEncodeMs=Number(c.googAvgEncodeMs),p.inputFrame={width:Number(c.googFrameWidthInput)||Number(c.googFrameWidthSent),height:Number(c.googFrameHeightInput)||Number(c.googFrameHeightSent),frameRate:Number(c.googFrameRateInput)},p.sentFrame={width:Number(c.googFrameWidthSent),height:Number(c.googFrameHeightSent),frameRate:Number(c.googFrameRateInput)},p.firsCount=Number(c.googFirReceived),p.nacksCount=Number(c.googNacksReceived),p.plisCount=Number(c.googPlisReceived),p.frameCount=Number(c.framesEncoded),p.bytes=Number(c.bytesSent),p.packets=Number(c.packetsSent),p.packetsLost=Number(c.packetsLost),p.ssrc=Number(c.ssrc),p.rttMs=Number(c.googRtt||0),s._stats.videoSend.push(p),s._stats.rtt=p.rttMs;break;case"video_recv":var h=pa(E),g=s.lastDecodeVideoReceiverStats.get(Number(c.ssrc));if(h.codec=c.googCodecName,h.targetDelayMs=Number(c.googTargetDelayMs),h.renderDelayMs=Number(c.googRenderDelayMs),h.currentDelayMs=Number(c.googCurrentDelayMs),h.minPlayoutDelayMs=Number(c.googMinPlayoutDelayMs),h.decodeMs=Number(c.googDecodeMs),h.maxDecodeMs=Number(c.googMaxDecodeMs),h.receivedFrame={width:Number(c.googFrameWidthReceived),height:Number(c.googFrameHeightReceived),frameRate:Number(c.googFrameRateReceived)},h.decodedFrame={width:Number(c.googFrameWidthReceived),height:Number(c.googFrameHeightReceived),frameRate:Number(c.googFrameRateDecoded)},h.decodeFrameRate=Number(c.googFrameRateDecoded),h.outputFrame={width:Number(c.googFrameWidthReceived),height:Number(c.googFrameHeightReceived),frameRate:Number(c.googFrameRateOutput)},h.jitterBufferMs=Number(c.googJitterBufferMs),h.firsCount=Number(c.googFirsSent),h.nacksCount=Number(c.googNacksSent),h.plisCount=Number(c.googPlisSent),h.framesDecodeCount=Number(c.framesDecoded),h.bytes=Number(c.bytesReceived),h.packets=Number(c.packetsReceived),h.packetsLost=Number(c.packetsLost),h.ssrc=Number(c.ssrc),h.packets>0&&!s.isFirstVideoReceived[h.ssrc]&&(s.onFirstVideoReceived&&s.onFirstVideoReceived(h.ssrc),s.isFirstVideoReceived[h.ssrc]=!0),h.framesDecodeCount>0&&!s.isFirstVideoDecoded[h.ssrc]&&(s.onFirstVideoDecoded&&s.onFirstVideoDecoded(h.ssrc,h.decodedFrame.width,h.decodedFrame.height),s.isFirstVideoDecoded[h.ssrc]=!0),g){var f=g.stats,A=Date.now()-g.lts;h.framesDecodeFreezeTime=f.framesDecodeFreezeTime,h.framesDecodeInterval=f.framesDecodeInterval,h.framesDecodeCount>f.framesDecodeCount&&s.isFirstVideoDecoded[h.ssrc]?(g.lts=Date.now(),h.framesDecodeInterval=A,h.framesDecodeInterval>=s.options.freezeRateLimit&&(s.getVideoIsReady(parseInt(c.ssrc,10))?h.framesDecodeFreezeTime+=h.framesDecodeInterval:s.setVideoIsReady2(parseInt(c.ssrc,10),!0))):h.framesDecodeCount<g.stats.framesDecodeCount&&(h.framesDecodeInterval=0)}s.lastDecodeVideoReceiverStats.set(h.ssrc,{stats:r({},h),lts:Date.now()}),s._stats.videoRecv.push(h);break;case"audio_recv":var _=pa(w);_.codec=c.googCodecName,_.outputLevel=Math.abs(Number(c.audioOutputLevel))/32767,_.decodingCNG=Number(c.googDecodingCNG),_.decodingCTN=Number(c.googDecodingCTN),_.decodingCTSG=Number(c.googDecodingCTSG),_.decodingNormal=Number(c.googDecodingNormal),_.decodingPLC=Number(c.googDecodingPLC),_.decodingPLCCNG=Number(c.googDecodingPLCCNG),_.expandRate=Number(c.googExpandRate),_.accelerateRate=Number(c.googAccelerateRate),_.preemptiveExpandRate=Number(c.googPreemptiveExpandRate),_.secondaryDecodedRate=Number(c.googSecondaryDecodedRate),_.speechExpandRate=Number(c.googSpeechExpandRate),_.preferredJitterBufferMs=Number(c.googPreferredJitterBufferMs),_.jitterBufferMs=Number(c.googJitterBufferMs),_.jitterMs=Number(c.googJitterReceived),_.bytes=Number(c.bytesReceived),_.packets=Number(c.packetsReceived),_.packetsLost=Number(c.packetsLost),_.ssrc=Number(c.ssrc),_.receivedFrames=Number(c.googDecodingCTN)||Number(c.packetsReceived),_.droppedFrames=Number(c.googDecodingPLC)+Number(c.googDecodingPLCCNG)||Number(c.packetsLost),_.receivedFrames>0&&!s.isFirstAudioReceived[_.ssrc]&&(s.onFirstAudioReceived&&s.onFirstAudioReceived(_.ssrc),s.isFirstAudioReceived[_.ssrc]=!0),_.decodingNormal>0&&!s.isFirstAudioDecoded[_.ssrc]&&(s.onFirstAudioDecoded&&s.onFirstAudioDecoded(_.ssrc),s.isFirstAudioDecoded[_.ssrc]=!0),s._stats.audioRecv.push(_);break;case"audio_send":var v=pa(I);v.codec=c.googCodecName,v.inputLevel=Math.abs(Number(c.audioInputLevel))/32767,v.aecReturnLoss=Number(c.googEchoCancellationReturnLoss||0),v.aecReturnLossEnhancement=Number(c.googEchoCancellationReturnLossEnhancement||0),v.residualEchoLikelihood=Number(c.googResidualEchoLikelihood||0),v.residualEchoLikelihoodRecentMax=Number(c.googResidualEchoLikelihoodRecentMax||0),v.bytes=Number(c.bytesSent),v.packets=Number(c.packetsSent),v.packetsLost=Number(c.packetsLost),v.ssrc=Number(c.ssrc),v.rttMs=Number(c.googRtt||0),s._stats.rtt=v.rttMs,s._stats.audioSend.push(v)}})},i.prototype._getStats=function(){var o=this;return new Promise(function(s,c){o.pc.getStats(s,c)})},i.prototype.statsResponsesToObjects=function(o){var s=[];return o.result().forEach(function(c){var l={id:c.id,timestamp:c.timestamp.valueOf().toString(),type:c.type};c.names().forEach(function(p){l[p]=c.stat(p)}),s.push(l)}),s},i}(M);!function(t){t.CERTIFICATE="certificate",t.CODEC="codec",t.CANDIDATE_PAIR="candidate-pair",t.LOCAL_CANDIDATE="local-candidate",t.REMOTE_CANDIDATE="remote-candidate",t.INBOUND="inbound-rtp",t.TRACK="track",t.OUTBOUND="outbound-rtp",t.PC="peer-connection",t.REMOTE_INBOUND="remote-inbound-rtp",t.REMOTE_OUTBOUND="remote-outbound-rtp",t.TRANSPORT="transport",t.CSRC="csrc",t.DATA_CHANNEL="data-channel",t.STREAM="stream",t.SENDER="sender",t.RECEIVER="receiver"}(u||(u={}));var H,$=function(t){function i(){var o=null!==t&&t.apply(this,arguments)||this;return o._stats=m,o.lastDecodeVideoReceiverStats=new Map,o.lastVideoFramesRecv=new Map,o.lastVideoFramesSent=new Map,o.lastVideoFramesDecode=new Map,o.lastVideoJBDelay=new Map,o.lastAudioJBDelay=new Map,o.mediaBytesSent=new Map,o.mediaBytesRetransmit=new Map,o.mediaBytesTargetEncode=new Map,o.lastEncoderMs=new Map,o}return e(i,t),i.prototype.updateStats=function(){return n(this,void 0,void 0,function(){var o,s=this;return a(this,function(c){switch(c.label){case 0:return o=this,[4,this.pc.getStats()];case 1:return o.report=c.sent(),this._stats=pa(m),this.report.forEach(function(l){switch(l.type){case u.OUTBOUND:"audio"===l.mediaType?s.processAudioOutboundStats(l):"video"===l.mediaType&&s.processVideoOutboundStats(l);break;case u.INBOUND:"audio"===l.mediaType?s.processAudioInboundStats(l):"video"===l.mediaType&&s.processVideoInboundStats(l);break;case u.TRANSPORT:var p=s.report.get(l.selectedCandidatePairId);p&&s.processCandidatePairStats(p);break;case u.CANDIDATE_PAIR:l.selected&&s.processCandidatePairStats(l)}}),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}})})},i.prototype.processCandidatePairStats=function(o){if(this._stats.sendBandwidth=o.availableOutgoingBitrate||0,o.currentRoundTripTime&&(this._stats.rtt=1e3*o.currentRoundTripTime),this._stats.videoSend.forEach(function(l){!l.rttMs&&o.currentRoundTripTime&&(l.rttMs=1e3*o.currentRoundTripTime)}),this._stats.audioSend.forEach(function(l){!l.rttMs&&o.currentRoundTripTime&&(l.rttMs=1e3*o.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=o.id,o.localCandidateId){var s=this.report.get(o.localCandidateId);s&&this.processCandidateStats(s)}if(o.remoteCandidateId){var c=this.report.get(o.remoteCandidateId);c&&this.processCandidateStats(c)}},i.prototype.processCandidateStats=function(o){var s;o.type===u.LOCAL_CANDIDATE&&(s=this._stats.selectedCandidatePair.localCandidate),o.type===u.REMOTE_CANDIDATE&&(s=this._stats.selectedCandidatePair.remoteCandidate),s&&(s.type=o.type,s.id=o.id,o.address&&(s.address=o.address),o.candidateType&&(s.candidateType=o.candidateType),o.port&&(s.port=o.port),o.priority&&(s.priority=o.priority),o.protocol&&(s.protocol=o.protocol),o.relayProtocol&&(s.relayProtocol=o.relayProtocol),o.type===u.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==s.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(r({},s),r({},this.stats.selectedCandidatePair.localCandidate)),o.type===u.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==s.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(r({},s),r({},this.stats.selectedCandidatePair.remoteCandidate)))},i.prototype.processAudioInboundStats=function(o){var s=this._stats.audioRecv.find(function(c){return c.ssrc===o.ssrc});s||(s=pa(w),this._stats.audioRecv.push(s)),s.ssrc=o.ssrc,s.packets=o.packetsReceived,s.packetsLost=o.packetsLost,s.bytes=o.bytesReceived,s.jitterMs=1e3*o.jitter,o.trackId&&this.processAudioTrackReceiverStats(o.trackId,s),o.codecId&&(s.codec=this.getCodecFromCodecStats(o.codecId)),s.receivedFrames||(s.receivedFrames=o.packetsReceived),s.droppedFrames||(s.droppedFrames=o.packetsLost),s.receivedFrames>0&&!this.isFirstAudioReceived[s.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(s.ssrc),this.isFirstAudioReceived[s.ssrc]=!0),s.outputLevel&&s.outputLevel>0&&!this.isFirstAudioDecoded[s.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(s.ssrc),this.isFirstAudioDecoded[s.ssrc]=!0)},i.prototype.processVideoInboundStats=function(o){var s=this._stats.videoRecv.find(function(_){return _.ssrc===o.ssrc});s||(s=pa(E),this._stats.videoRecv.push(s)),s.ssrc=o.ssrc,s.packets=o.packetsReceived,s.packetsLost=o.packetsLost,s.bytes=o.bytesReceived,s.firsCount=o.firCount,s.nacksCount=o.nackCount,s.plisCount=o.pliCount,s.framesDecodeCount=o.framesDecoded;var c=this.lastDecodeVideoReceiverStats.get(s.ssrc),l=this.lastVideoFramesDecode.get(s.ssrc),p=Date.now();if(s.framesDecodeCount>0&&!this.isFirstVideoDecoded[s.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(s.ssrc,s.decodedFrame?s.decodedFrame.width:0,s.decodedFrame?s.decodedFrame.height:0),this.isFirstVideoDecoded[s.ssrc]=!0),c){var f=c.stats,A=p-c.lts;s.framesDecodeFreezeTime=f.framesDecodeFreezeTime,s.framesDecodeInterval=f.framesDecodeInterval,!this.isFirstVideoDecoded[s.ssrc]&&A>this.options.firstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(s.ssrc),s.framesDecodeCount>f.framesDecodeCount&&this.isFirstVideoDecoded[s.ssrc]?(c.lts=Date.now(),s.framesDecodeInterval=A,s.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(o.ssrc))?s.framesDecodeFreezeTime+=s.framesDecodeInterval:this.setVideoIsReady2(parseInt(o.ssrc,10),!0))):s.framesDecodeCount<f.framesDecodeCount&&(s.framesDecodeInterval=0),o.framesDecoded&&o.qpSum&&(s.qpSumPerFrame=c.stats.framesDecodeCount>o.framesDecoded?o.qpSum/o.framesDecoded:(o.qpSum-c.qpSum)/(o.framesDecoded-c.stats.framesDecodeCount))}l&&p-l.lts>=800?(s.decodeFrameRate=Math.round((s.framesDecodeCount-l.count)/((p-l.lts)/1e3)),this.lastVideoFramesDecode.set(s.ssrc,{count:s.framesDecodeCount,lts:p,rate:s.decodeFrameRate})):l?s.decodeFrameRate=l.rate:this.lastVideoFramesDecode.set(s.ssrc,{count:s.framesDecodeCount,lts:p,rate:0}),o.totalDecodeTime&&(s.decodeMs=1e3*o.totalDecodeTime),o.trackId&&this.processVideoTrackReceiverStats(o.trackId,s),o.codecId&&(s.codec=this.getCodecFromCodecStats(o.codecId)),o.framerateMean&&(s.framesRateFirefox=o.framerateMean),s.packets>0&&!this.isFirstVideoReceived[s.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(s.ssrc),this.isFirstVideoReceived[s.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(s.ssrc,{stats:r({},s),lts:c?c.lts:Date.now(),qpSum:o.qpSum})},i.prototype.processVideoOutboundStats=function(o){var s=this._stats.videoSend.find(function(v){return v.ssrc===o.ssrc});s||(s=pa(C),this._stats.videoSend.push(s));var c,l=this.mediaBytesSent.get(o.ssrc);if(l?l.add(o.bytesSent):((h=new yw(10)).add(o.bytesSent),this.mediaBytesSent.set(o.ssrc,h)),void 0!==o.retransmittedBytesSent){var p=this.mediaBytesRetransmit.get(o.ssrc);p?p.add(o.retransmittedBytesSent):((h=new yw(10)).add(o.retransmittedBytesSent),this.mediaBytesRetransmit.set(o.ssrc,h))}if(o.totalEncodedBytesTarget){var h,g=this.mediaBytesTargetEncode.get(o.ssrc);g?g.add(o.totalEncodedBytesTarget):((h=new yw(10)).add(o.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(o.ssrc,h))}if(s.ssrc=o.ssrc,s.bytes=o.bytesSent,s.packets=o.packetsSent,s.firsCount=o.firCount,s.nacksCount=o.nackCount,s.plisCount=o.pliCount,s.frameCount=o.framesEncoded,s.adaptionChangeReason=o.qualityLimitationReason,o.totalEncodeTime&&o.framesEncoded&&(s.avgEncodeMs=!(c=this.lastEncoderMs.get(o.ssrc))||c.lastFrameCount>o.framesEncoded?1e3*o.totalEncodeTime/o.framesEncoded:1e3*(o.totalEncodeTime-c.lastEncoderTime)/(o.framesEncoded-c.lastFrameCount)),o.framesEncoded&&o.qpSum&&(s.qpSumPerFrame=!(c=this.lastEncoderMs.get(o.ssrc))||c.lastFrameCount>o.framesEncoded?o.qpSum/o.framesEncoded:(o.qpSum-c.lastQpSum)/(o.framesEncoded-c.lastFrameCount)),this.lastEncoderMs.set(o.ssrc,{lastFrameCount:o.framesEncoded,lastEncoderTime:o.totalEncodeTime,lastQpSum:o.qpSum,lts:Date.now()}),o.codecId&&(s.codec=this.getCodecFromCodecStats(o.codecId)),o.mediaSourceId&&this.processVideoMediaSource(o.mediaSourceId,s),o.trackId&&this.processVideoTrackSenderStats(o.trackId,s),o.remoteId)this.processRemoteInboundStats(o.remoteId,s);else{var _=this.findRemoteStatsId(o.ssrc,u.REMOTE_INBOUND);_&&this.processRemoteInboundStats(_,s)}},i.prototype.processAudioOutboundStats=function(o){var s=this._stats.audioSend.find(function(l){return l.ssrc===o.ssrc});if(s||(s=pa(I),this._stats.audioSend.push(s)),s.ssrc=o.ssrc,s.packets=o.packetsSent,s.bytes=o.bytesSent,o.mediaSourceId&&this.processAudioMediaSource(o.mediaSourceId,s),o.codecId&&(s.codec=this.getCodecFromCodecStats(o.codecId)),o.trackId&&this.processAudioTrackSenderStats(o.trackId,s),o.remoteId)this.processRemoteInboundStats(o.remoteId,s);else{var c=this.findRemoteStatsId(o.ssrc,u.REMOTE_INBOUND);c&&this.processRemoteInboundStats(c,s)}},i.prototype.findRemoteStatsId=function(o,s){var c=Array.from(this.report.values()).find(function(l){return l.type===s&&l.ssrc===o});return c?c.id:null},i.prototype.processVideoMediaSource=function(o,s){var c=this.report.get(o);c&&c.width&&c.height&&c.framesPerSecond&&(s.inputFrame={width:c.width,height:c.height,frameRate:c.framesPerSecond})},i.prototype.processAudioMediaSource=function(o,s){var c=this.report.get(o);c&&(s.inputLevel=c.audioLevel)},i.prototype.processVideoTrackSenderStats=function(o,s){var c=this.report.get(o);if(c){var l=0,p=Date.now(),h=this.lastVideoFramesSent.get(s.ssrc);h&&p-h.lts>=800?(l=Math.round((c.framesSent-h.count)/((p-h.lts)/1e3)),this.lastVideoFramesSent.set(s.ssrc,{count:c.framesSent,lts:p,rate:l})):h?l=h.rate:this.lastVideoFramesSent.set(s.ssrc,{count:c.framesSent,lts:p,rate:0}),s.sentFrame={width:c.frameWidth,height:c.frameHeight,frameRate:l}}},i.prototype.processVideoTrackReceiverStats=function(o,s){var c=this.report.get(o);if(c){var l=this.lastVideoFramesRecv.get(s.ssrc),p=Date.now();s.framesReceivedCount=c.framesReceived;var h=0;if(l&&p-l.lts>=800?(h=Math.round((c.framesReceived-l.count)/((p-l.lts)/1e3)),this.lastVideoFramesRecv.set(s.ssrc,{count:c.framesReceived,lts:p,rate:h})):l?h=l.rate:this.lastVideoFramesRecv.set(s.ssrc,{count:c.framesReceived,lts:p,rate:0}),s.receivedFrame={width:c.frameWidth||0,height:c.frameHeight||0,frameRate:h||0},s.decodedFrame={width:c.frameWidth||0,height:c.frameHeight||0,frameRate:s.decodeFrameRate||0},s.outputFrame={width:c.frameWidth||0,height:c.frameHeight||0,frameRate:s.decodeFrameRate||0},c.jitterBufferDelay&&c.jitterBufferEmittedCount){var g=this.lastVideoJBDelay.get(s.ssrc);this.lastVideoJBDelay.set(s.ssrc,{jitterBufferDelay:c.jitterBufferDelay,jitterBufferEmittedCount:c.jitterBufferEmittedCount}),g||(g={jitterBufferDelay:0,jitterBufferEmittedCount:0});var f=1e3*(c.jitterBufferDelay-g.jitterBufferDelay)/(c.jitterBufferEmittedCount-g.jitterBufferEmittedCount);s.jitterBufferMs=f,s.currentDelayMs=Math.round(f)}}},i.prototype.processAudioTrackSenderStats=function(o,s){var c=this.report.get(o);c&&(s.aecReturnLoss=c.echoReturnLoss||0,s.aecReturnLossEnhancement=c.echoReturnLossEnhancement||0)},i.prototype.processAudioTrackReceiverStats=function(o,s){var c=this.report.get(o);if(c){if(c.removedSamplesForAcceleration&&c.totalSamplesReceived&&(s.accelerateRate=c.removedSamplesForAcceleration/c.totalSamplesReceived),c.jitterBufferDelay&&c.jitterBufferEmittedCount){var l=this.lastAudioJBDelay.get(s.ssrc);this.lastAudioJBDelay.set(s.ssrc,{jitterBufferDelay:c.jitterBufferDelay,jitterBufferEmittedCount:c.jitterBufferEmittedCount}),l||(l={jitterBufferDelay:0,jitterBufferEmittedCount:0}),s.jitterBufferMs=Math.round(1e3*(c.jitterBufferDelay-l.jitterBufferDelay)/(c.jitterBufferEmittedCount-l.jitterBufferEmittedCount))}s.outputLevel=c.audioLevel;var h=1920;c.totalSamplesDuration&&c.totalSamplesReceived&&(h=c.totalSamplesReceived/c.totalSamplesDuration/50,s.receivedFrames=Math.round(c.totalSamplesReceived/h)),c.concealedSamples&&(s.droppedFrames=Math.round(c.concealedSamples/h))}},i.prototype.processRemoteInboundStats=function(o,s){var c=this.report.get(o);c&&(s.packetsLost=c.packetsLost,c.roundTripTime&&(s.rttMs=1e3*c.roundTripTime))},i.prototype.getCodecFromCodecStats=function(o){var s=this.report.get(o);if(!s)return"";var c=s.mimeType.match(/\/(.*)$/);return c&&c[1]?c[1]:""},i.prototype.updateSendBitrate=function(){var o=0,s=null,c=null;this.mediaBytesSent.forEach(function(p){o+=p.diffMean()}),this.mediaBytesRetransmit.forEach(function(p){s=null===s?p.diffMean():s+p.diffMean()}),this.mediaBytesTargetEncode.forEach(function(p){c=null===c?p.diffMean():c+p.diffMean()}),this._stats.bitrate={actualEncoded:8*(null!==s?o-s:o)/(this.options.updateInterval/1e3),transmit:8*o/(this.options.updateInterval/1e3)},null!==s&&(this._stats.bitrate.retransmit=8*s/(this.options.updateInterval/1e3)),null!==c&&(this._stats.bitrate.targetEncoded=8*c/(this.options.updateInterval/1e3))},i}(M),oe=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.updateStats=function(){return Promise.resolve()},i}(M);function he(t,i,o,s,c){void 0===i&&(i=250),void 0===o&&(o=8),void 0===s&&(s=500),void 0===c&&(c=1e4);var l,p=(l=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i))&&l[0]?Number(l[0].split("/")[1]):null;return p?p<76?new F(t,{updateInterval:i,lossRateInterval:o,freezeRateLimit:s,firstVideoDecodedTimeout:c}):new $(t,{updateInterval:i,lossRateInterval:o,freezeRateLimit:s,firstVideoDecodedTimeout:c}):window.RTCStatsReport&&t.getStats()instanceof Promise?new $(t,{updateInterval:i,lossRateInterval:o,freezeRateLimit:s,firstVideoDecodedTimeout:c}):new oe(t,{updateInterval:i,lossRateInterval:o,freezeRateLimit:s,firstVideoDecodedTimeout:c})}function Ae(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function Ce(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?Ae(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Ae(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}let ge=(Te((H=class nU extends gm{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}constructor(i,o){super(i,o),b(this,"store",void 0),b(this,"peerConnection",void 0),b(this,"remoteSDP",void 0),b(this,"initialOffer",void 0),b(this,"statsFilter",void 0),b(this,"useRTX",!1),b(this,"localCapabilities",void 0),b(this,"localCandidateCount",0),b(this,"allCandidatesReceived",!1),b(this,"mutex",new eo("P2PConnection-mutex")),this.store=o,this.peerConnection=new RTCPeerConnection(nU.resolvePCConfiguration(i),{optional:[{googDscp:!0}]}),this.statsFilter=he(this.peerConnection,void 0,void 0,bn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}establish(){var i=this;return U(function*(){try{const o=yield i.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!o.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const s=kh(o.sdp),c=mw(o.sdp,!i.useRTX,J("FILTER_VIDEO_FEC"),J("FILTER_AUDIO_FEC"),["opus"]);return i.localCapabilities=c,i.initialOffer=o,Ce(Ce({},s),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:c},offerSDP:o.sdp})}catch(o){throw new V(L.GET_LOCAL_CONNECTION_PARAMS_FAILED,o.toString())}})()}connect(i,o,s,c,l,p){var h=this;return U(function*(){try{if(!h.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");h.remoteSDP=new ZY({remoteIceParameters:i,remoteDtlsParameters:o,candidates:s,remoteRTPCapabilities:c.send,remoteSetup:l,localCapabilities:h.localCapabilities,sdkCodec:h.store.codec,cname:p});const g=h.remoteSDP.toString();yield h.peerConnection.setLocalDescription(h.initialOffer),yield h.peerConnection.setRemoteDescription({type:"answer",sdp:g})}catch(g){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(g.toString()))}})()}send(i,o){var s=this;return ha(function*(){const c=yield It(s.mutex.lock());try{if(!s.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const l=i.map(v=>s.peerConnection.addTrack(v._mediaStreamTrack)),p=yield It(s.peerConnection.createOffer()),h=sr.exports.parse(p.sdp),g=i.map(v=>{const y=v._mediaStreamTrack,S=h.mediaDescriptions.find(R=>R.attributes.mid===y.kind);if(!S)throw new Error("Cannot extract ssrc from mediaDescription.");return function(R,D,O){const P=R.attributes.ssrcs.filter(G=>G.attributes.label===D),B=R.attributes.ssrcGroups;if(0===P.length)throw new Error("Cannot extract ssrc from plan-b SDP.");if(B&&P.length>1){const G=B.find(Y=>-1!==Y.ssrcIds.indexOf(P[0].ssrcId));return G?[{ssrcId:G.ssrcIds[0],rtx:O?G.ssrcIds[1]:void 0}]:[{ssrcId:P[0].ssrcId}]}return[{ssrcId:P[0].ssrcId}]}(S,y.id,s.useRTX)});let f;try{f=yield g}catch(v){throw l.forEach(y=>{Di()&&y.replaceTrack(null),s.peerConnection.removeTrack(y)}),v}const A=s.mungSendOfferSDP(p.sdp,i);s.remoteSDP.receive(i,o,f);const _=s.remoteSDP.toString();return yield It(s.peerConnection.setLocalDescription({type:"offer",sdp:A})),yield It(s.applySendEncodings(l,i)),yield It(s.peerConnection.setRemoteDescription({type:"answer",sdp:_})),i.map((v,y)=>({localSSRC:g[y],id:v._mediaStreamTrack.id}))}catch(l){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(l.toString()))}finally{c()}})()}stopSending(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const s=o.peerConnection.getSenders().filter(p=>{var h;return-1!==i.indexOf((null===(h=p.track)||void 0===h?void 0:h.id)||"")});if(s.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");s.map(p=>{Di()&&p.replaceTrack(null),o.peerConnection.removeTrack(p)});const c=yield o.peerConnection.createOffer();yield o.peerConnection.setLocalDescription(c),o.remoteSDP.stopReceiving(i);const l=o.remoteSDP.toString();yield o.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(s.toString()))}})()}receive(i,o,s,c){var l=this;return U(function*(){try{if(!l.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(i," before remoteSDP created."));const{id:p,mslabel:h}=l.remoteSDP.send(i,o,c),g=new Ie((_,v)=>{const y=setTimeout(()=>{v(new Error("Cannot receive track, id: ".concat(p)))},1e4),S=R=>{const D=zt();if(("Safari"===D.name&&11===Number(D.version)||Oo())&&R.track.id!==p&&R.streams[0].id===h){var O;const P=R.streams[0].getTracks()[0];return null===(O=l.remoteSDP)||void 0===O||O.updateTrackLabel(i,p,R.track.id),l.peerConnection.removeEventListener("track",S),clearTimeout(y),void _(P)}if(R.track.id===p)return l.peerConnection.removeEventListener("track",S),clearTimeout(y),void _(R.track)};l.peerConnection.addEventListener("track",S)}),f=l.remoteSDP.toString();yield l.peerConnection.setRemoteDescription({type:"offer",sdp:f});const A=yield l.peerConnection.createAnswer();return yield l.peerConnection.setLocalDescription(A),{track:yield g,id:p}}catch(p){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(p.toString()))}})()}stopReceiving(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");o.remoteSDP.stopSending(i);const s=o.remoteSDP.toString();yield o.peerConnection.setRemoteDescription({type:"offer",sdp:s});const c=yield o.peerConnection.createAnswer();yield o.peerConnection.setLocalDescription(c)}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}})()}muteRemote(i){return U(function*(){})()}unmuteRemote(i){return U(function*(){})()}muteLocal(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const s=o.peerConnection.getSenders().filter(c=>{var l;return-1!==i.indexOf((null===(l=c.track)||void 0===l?void 0:l.id)||"")});if(s.length!==i.length)throw new Error("sender' length doesn't match mids' length.");s.map(c=>{if(Di()&&c.track)c.track.enabled=!1;else{const l=c.getParameters();l.encodings.forEach(p=>p.active=!1),c.setParameters(l)}})}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(s.toString()))}})()}unmuteLocal(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const s=o.peerConnection.getSenders().filter(p=>{var h;return-1!==i.indexOf((null===(h=p.track)||void 0===h?void 0:h.id)||"")});if(s.length!==i.length)throw new Error("Senders' length doesn't match mids' length.");s.map(function(){var p=U(function*(h){if(Di()&&h.track)h.track.enabled=!0;else{const g=h.getParameters();g.encodings.forEach(f=>f.active=!0),yield h.setParameters(g)}});return function(h){return p.apply(this,arguments)}}());const c=yield o.peerConnection.createOffer();yield o.peerConnection.setLocalDescription(c);const l=o.remoteSDP.toString();yield o.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(s.toString()))}})()}restartICE(){var i=this;return ha(function*(){const o=yield It(i.mutex.lock("From P2PConnection.restartICE"));try{const s=yield It(i.peerConnection.createOffer({iceRestart:!0}));if(!s.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const c=kh(s.sdp),{remoteIceParameters:l}=yield c.iceParameters;if(!i.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");i.remoteSDP.restartICE(l);const p=i.remoteSDP.toString();yield It(i.peerConnection.setLocalDescription(s)),yield It(i.peerConnection.setRemoteDescription({type:"answer",sdp:p}))}catch(s){N.warning("restart ICE failed, abort operation",s)}finally{o()}})()}close(){var i;this.peerConnection.close(),null===(i=this.onConnectionStateChange)||void 0===i||i.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(i){return this.statsFilter.getVideoIsReady(i)}updateEncoderConfig(i,o){var s=this;return U(function*(){try{if(!s.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const c=yield s.peerConnection.createOffer(),l=s.mungSendOfferSDP(c.sdp,[o]);s.remoteSDP.updateRecvMedia(o._mediaStreamTrack.kind,o);const p=s.remoteSDP.toString();yield s.peerConnection.setLocalDescription({type:"offer",sdp:l}),yield s.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(c){throw new V(L.EXCHANGE_SDP_FAILED,c.toString())}})()}updateSendParameters(i,o){var s=this;return U(function*(){const c=s.peerConnection.getSenders().filter(l=>{var p;return(null===(p=l.track)||void 0===p?void 0:p.id)===i});1===c.length&&(yield s.applySendEncodings(c,[o]))})()}setStatsRemoteVideoIsReady(i,o){this.statsFilter.setVideoIsReady2(i,o)}replaceTrack(i,o){var s=this;return U(function*(){const c=s.peerConnection.getSenders().find(l=>{var p;return(null===(p=l.track)||void 0===p?void 0:p.id)===o});c&&(yield c.replaceTrack(i._mediaStreamTrack))})()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var i;null===(i=this.onICEConnectionStateChange)||void 0===i||i.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var i;null===(i=this.onConnectionStateChange)||void 0===i||i.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=i=>{i.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,N.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,N.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},J("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(i){const o={iceServers:[],sdpSemantics:"plan-b"};return i.iceServers?o.iceServers=i.iceServers:i.turnServer&&"off"!==i.turnServer.mode&&(oh(i.turnServer.servers)?o.iceServers=i.turnServer.servers:(o.iceServers&&o.iceServers.push(...nU.turnServerConfigToIceServers(i.turnServer.servers)),J("USE_TURN_SERVER_OF_GATEWAY")&&o.iceServers&&i.turnServer.serversFromGateway&&o.iceServers.push(...nU.turnServerConfigToIceServers(i.turnServer.serversFromGateway)),i.turnServer.servers.concat(i.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(o.iceTransportPolicy="relay")}))),o}static turnServerConfigToIceServers(i){const o=[];return i.forEach(s=>{s.security?s.tcpport&&o.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&o.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&o.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),o}applySendEncodings(i,o){return U(function*(){try{if(!Vr().supportSetRtpSenderParameters||i.length!==o.length)return;for(let c=0;c<i.length;c++){var s;const l=i[c],p=o[c];if(!p)continue;const h={},g={};if(p instanceof dr)switch(p._optimizationMode){case"motion":h.degradationPreference="maintain-framerate";break;case"detail":h.degradationPreference="maintain-resolution";break;default:h.degradationPreference="balanced"}if(J("DSCP_TYPE")&&eh()){const _=J("DSCP_TYPE");["very-low","low","medium","high"].includes(_)&&(g.networkPriority=_)}const f=l.getParameters(),A=null===(s=f.encodings)||void 0===s?void 0:s[0];A&&Object.assign(A,g),Object.assign(f,h),yield l.setParameters(f)}}catch{N.debug("Apply RTPSendEncodings failed.")}})()}mungSendOfferSDP(i,o){const s=sr.exports.parse(i);return o.forEach((c,l)=>{const p=c._mediaStreamTrack,h=s.mediaDescriptions.find(g=>g.attributes.mid===p.kind);h&&Zf(h,c)}),sr.exports.print(s)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=i=>{var o;null===(o=this.onFirstAudioReceived)||void 0===o||o.call(this,i)},this.statsFilter.onFirstVideoReceived=i=>{var o;null===(o=this.onFirstVideoReceived)||void 0===o||o.call(this,i)},this.statsFilter.onFirstAudioDecoded=i=>{var o;null===(o=this.onFirstAudioDecoded)||void 0===o||o.call(this,i)},this.statsFilter.onFirstVideoDecoded=(i,o,s)=>{var c;null===(c=this.onFirstVideoDecoded)||void 0===c||c.call(this,i,o,s)},this.statsFilter.onSelectedLocalCandidateChanged=(i,o)=>{var s;null===(s=this.onSelectedLocalCandidateChanged)||void 0===s||s.call(this,i,o)},this.statsFilter.onSelectedRemoteCandidateChanged=(i,o)=>{var s;null===(s=this.onSelectedRemoteCandidateChanged)||void 0===s||s.call(this,i,o)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}batchReceive(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const s=o.remoteSDP.batchSend(i).map((p,h)=>{let{id:g,mslabel:f}=p;const{kind:A}=i[h];return new Ie((_,v)=>{const y=setTimeout(()=>{v(new Error("Cannot receive track, id: ".concat(g)))},1e4),S=R=>{const D=zt();if("Safari"===D.name&&11===Number(D.version)&&R.track.id!==g&&R.streams[0].id===f){var O;const P=R.streams[0].getTracks()[0];return null===(O=o.remoteSDP)||void 0===O||O.updateTrackLabel(A,g,R.track.id),o.peerConnection.removeEventListener("track",S),clearTimeout(y),void _({track:P,id:g})}if(R.track.id===g)return o.peerConnection.removeEventListener("track",S),clearTimeout(y),void _({track:R.track,id:g})};o.peerConnection.addEventListener("track",S)})}),c=o.remoteSDP.toString();yield o.peerConnection.setRemoteDescription({type:"offer",sdp:c});const l=yield o.peerConnection.createAnswer();return yield o.peerConnection.setLocalDescription(l),yield Ie.all(s)}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(s.toString()))}})()}getRemoteSSRC(i){var o=this;return U(function*(){if(o.remoteSDP)return o.remoteSDP.getSSRC(i)?.[0].ssrcId})()}}).prototype,"connect",[De],Object.getOwnPropertyDescriptor(H.prototype,"connect"),H.prototype),Te(H.prototype,"stopSending",[De],Object.getOwnPropertyDescriptor(H.prototype,"stopSending"),H.prototype),Te(H.prototype,"receive",[De],Object.getOwnPropertyDescriptor(H.prototype,"receive"),H.prototype),Te(H.prototype,"stopReceiving",[De],Object.getOwnPropertyDescriptor(H.prototype,"stopReceiving"),H.prototype),Te(H.prototype,"muteRemote",[De],Object.getOwnPropertyDescriptor(H.prototype,"muteRemote"),H.prototype),Te(H.prototype,"unmuteRemote",[De],Object.getOwnPropertyDescriptor(H.prototype,"unmuteRemote"),H.prototype),Te(H.prototype,"muteLocal",[De],Object.getOwnPropertyDescriptor(H.prototype,"muteLocal"),H.prototype),Te(H.prototype,"unmuteLocal",[De],Object.getOwnPropertyDescriptor(H.prototype,"unmuteLocal"),H.prototype),Te(H.prototype,"close",[De],Object.getOwnPropertyDescriptor(H.prototype,"close"),H.prototype),Te(H.prototype,"updateEncoderConfig",[De],Object.getOwnPropertyDescriptor(H.prototype,"updateEncoderConfig"),H.prototype),Te(H.prototype,"updateSendParameters",[De],Object.getOwnPropertyDescriptor(H.prototype,"updateSendParameters"),H.prototype),Te(H.prototype,"replaceTrack",[De],Object.getOwnPropertyDescriptor(H.prototype,"replaceTrack"),H.prototype),Te(H.prototype,"getRemoteSSRC",[De],Object.getOwnPropertyDescriptor(H.prototype,"getRemoteSSRC"),H.prototype),H);function De(t,i,o){const s=t[i];if("function"!=typeof s)throw new Error("Cannot use mutex on object property.");return o.value=U(function*(){const c=this.mutex,l=yield c.lock("Locking from P2PConnection.".concat(i));try{for(var p=arguments.length,h=new Array(p),g=0;g<p;g++)h[g]=arguments[g];return yield s.apply(this,h)}finally{l()}}),o}var Ze;let Tn=kn("RemoteSDP")(Ze=class{get localCapabilities(){return en(this._localCapabilities)}get rtpCapabilities(){return en(this._rtpCapabilities)}get candidates(){return en(this._candidates)}get iceParameters(){return en(this._iceParameters)}get dtlsParameters(){return en(this._dtlsParameters)}constructor(t){b(this,"sessionDesc",void 0),b(this,"_localCapabilities",void 0),b(this,"_rtpCapabilities",void 0),b(this,"_candidates",void 0),b(this,"_iceParameters",void 0),b(this,"_dtlsParameters",void 0),b(this,"setup",void 0),b(this,"currentMidIndex",void 0),b(this,"cname",void 0),b(this,"firefoxSsrcMidMap",new Map),t=en(t);const{remoteIceParameters:i,remoteDtlsParameters:o,candidates:s,remoteRTPCapabilities:c,remoteSetup:l,localCapabilities:p,cname:h}=t,g=sr.exports.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=ice-lite\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n");this._rtpCapabilities=c,this._candidates=s,this._iceParameters=i,this._dtlsParameters=o,this._localCapabilities=p,this.setup=l,this.cname=h;const f=this.rtpCapabilities.send;for(const A of g.mediaDescriptions){if(A.attributes.iceUfrag=i.iceUfrag,A.attributes.icePwd=i.icePwd,A.attributes.fingerprints=o.fingerprints,A.attributes.candidates=s,A.attributes.setup=l,"video"===A.media.mediaType&&(A.media.fmts=f.videoCodecs.map(_=>_.payloadType.toString(10)),A.attributes.payloads=f.videoCodecs,A.attributes.extmaps=f.videoExtensions,J("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_,ssrcGroups:v}=Ms([{ssrcId:4e4,rtx:J("USE_RTX")?40001:void 0}],this.cname);A.attributes.ssrcs=_,A.attributes.ssrcGroups=v}if("audio"===A.media.mediaType&&(A.media.fmts=f.audioCodecs.map(_=>_.payloadType.toString(10)),A.attributes.payloads=f.audioCodecs,A.attributes.extmaps=f.audioExtensions,Ju(A),J("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_,ssrcGroups:v}=Ms([{ssrcId:2e4}],this.cname);A.attributes.ssrcs=_,A.attributes.ssrcGroups=v}}this.sessionDesc=g,this.currentMidIndex=g.mediaDescriptions.length-1}preloadRemoteMedia(){const t=J("PRELOAD_MEDIA_COUNT");le("debug",this,"preloadRemoteMedia",t);const i=this.candidates,o=this.dtlsParameters,s=this.iceParameters,c=this.rtpCapabilities.send;for(let l=1;l<t;l++){const p=2*l+2e4,h=2*l+4e4,{ssrcs:g,ssrcGroups:f}=Ms([{ssrcId:p}],this.cname),{ssrcs:A,ssrcGroups:_}=Ms([{ssrcId:h,rtx:J("USE_RTX")?h+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:c.videoCodecs.map(v=>v.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:s.iceUfrag,icePwd:s.icePwd,unrecognized:[],candidates:i,extmaps:c.videoExtensions,fingerprints:o.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:A,ssrcGroups:_,rtcpFeedbackWildcards:[],payloads:c.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*l)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:c.audioCodecs.map(v=>v.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:s.iceUfrag,icePwd:s.icePwd,unrecognized:[],candidates:i,extmaps:c.audioExtensions,fingerprints:o.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:g,ssrcGroups:f,rtcpFeedbackWildcards:[],payloads:c.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*l+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return sr.exports.print(this.sessionDesc)}send(t,i,o,s){const{ssrcs:c,ssrcGroups:l}=Ms(i,this.cname,o),p=this.findPreloadMediaDesc(c);if(p){if(bn()&&this.firefoxSsrcMidMap.set(c[0].ssrcId,p.attributes.mid),s&&(s.tcc||s.remb)){const h=this.sessionDesc.mediaDescriptions.indexOf(p);return this.sessionDesc.mediaDescriptions[h]=this.mungSendMediaDesc(p,s),{mid:p.attributes.mid,needExchangeSDP:!0}}return{mid:p.attributes.mid,needExchangeSDP:!1}}{const h=this.findAvailableMediaIndex(t,c);if(Di()||Xb()||v1()){if(-1!==h&&1!==h){const g=en(this.sessionDesc.mediaDescriptions[h]);return g.attributes.direction="sendonly",g.attributes.ssrcs=c,g.attributes.ssrcGroups=l,this.sessionDesc.mediaDescriptions[h]=this.mungSendMediaDesc(g,s),{mid:g.attributes.mid,needExchangeSDP:!0}}{const g=this.createOrRecycleSendMedia(t,c,l,"sendonly",s);return this.updateBundleMids(),{mid:g.attributes.mid,needExchangeSDP:!0}}}if(-1!==h){const g=en(this.sessionDesc.mediaDescriptions[h]);return g.attributes.direction="sendonly",g.attributes.ssrcs=c,g.attributes.ssrcGroups=l,this.sessionDesc.mediaDescriptions[h]=this.mungSendMediaDesc(g,s),bn()&&this.firefoxSsrcMidMap.set(c[0].ssrcId,g.attributes.mid),{mid:g.attributes.mid,needExchangeSDP:!0}}{const g=this.createOrRecycleSendMedia(t,c,l,"sendonly",s);return this.updateBundleMids(),bn()&&this.firefoxSsrcMidMap.set(c[0].ssrcId,g.attributes.mid),{mid:g.attributes.mid,needExchangeSDP:!0}}}}batchSend(t){const i=t.map(c=>{let{kind:l,ssrcMsg:p,mslabel:h}=c;return this.send(l,p,h)}),o=[];let s=!1;return i.forEach(c=>{let{mid:l,needExchangeSDP:p}=c;p&&(s=!0),o.push(l)}),{mids:o,needExchangeSDP:s}}stopSending(t){const i=this.sessionDesc.mediaDescriptions.filter(o=>o.attributes.mid&&-1!==t.indexOf(o.attributes.mid));if(i.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");i.forEach(o=>{"0"===o.attributes.mid||bn()||Di()||Xb()||v1()?o.attributes.ssrcs=[]:(o.attributes.ssrcs=[],o.attributes.direction="inactive",o.media.port="0")}),this.updateBundleMids()}mute(t){const i=this.sessionDesc.mediaDescriptions.find(o=>o.attributes.mid===t);if(!i)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.mute."));i.attributes.direction="inactive"}unmute(t){const i=this.sessionDesc.mediaDescriptions.find(o=>o.attributes.mid===t);if(!i)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.unmute."));i.attributes.direction="sendonly"}muteRemote(t){const i=this.sessionDesc.mediaDescriptions.filter(o=>t.includes(o.attributes.mid||""));if(i.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");i.forEach(o=>{o.attributes.direction="inactive"})}unmuteRemote(t){const i=this.sessionDesc.mediaDescriptions.filter(o=>t.includes(o.attributes.mid||""));if(i.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");i.forEach(o=>{o.attributes.direction="recvonly"})}receive(t,i,o,s){t.forEach((c,l)=>{this.createOrRecycleRecvMedia(c,[],"recvonly",i,o,s[l])}),this.updateBundleMids()}stopReceiving(t){const i=this.sessionDesc.mediaDescriptions.filter(o=>-1!==t.indexOf(o.attributes.mid));if(i.length!==t.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");i.forEach(o=>{o.media.port="0",o.attributes.direction="inactive"}),this.updateBundleMids()}restartICE(t){t=en(t),this._iceParameters=t,this.sessionDesc.mediaDescriptions.forEach(i=>{i.attributes.iceUfrag=t.iceUfrag,i.attributes.icePwd=t.icePwd})}predictReceivingMids(t){const i=[];for(let o=0;o<t;o++)i.push((this.currentMidIndex+o+1).toString(10));return i}findAvailableMediaIndex(t,i){return this.sessionDesc.mediaDescriptions.findIndex(o=>{const s=o.media.mediaType===t&&"0"!==o.media.port&&("sendonly"===o.attributes.direction||"sendrecv"===o.attributes.direction)&&0===o.attributes.ssrcs.length;if(bn()){if(s){const c=this.firefoxSsrcMidMap.get(i[0].ssrcId);return!(c||"0"!==o.attributes.mid&&"1"!==o.attributes.mid)||!(!c||c!==o.attributes.mid)}return!1}return s})}createOrRecycleRecvMedia(t,i,o,s,c,l){const p=t._mediaStreamTrack.kind,h=this.rtpCapabilities.recv,g=this.localCapabilities.send;let f=[];if(p===ut.VIDEO){var A,_;if(J("H264_PROFILE_LEVEL_ID")&&"h264"===s&&(f=h.videoCodecs.filter(D=>{var O,P;return((null===(O=D.rtpMap)||void 0===O?void 0:O.encodingName.toLowerCase())||"").includes(s)&&(null==D||null===(P=D.fmtp)||void 0===P?void 0:P.parameters["profile-level-id"])===J("H264_PROFILE_LEVEL_ID")})),!f||0===(null===(A=f)||void 0===A?void 0:A.length)){const D=g.videoCodecs.filter(O=>{var P;return((null===(P=O.rtpMap)||void 0===P?void 0:P.encodingName.toLowerCase())||"").includes(s)});0!==D.length&&(f=h.videoCodecs.filter(O=>D.some(P=>P.payloadType===O.payloadType)))}if(J("USE_RTX")){const D=f.map(P=>P.payloadType.toString()),O=h.videoCodecs.filter(P=>{var B,G;return"rtx"===(null===(B=P.rtpMap)||void 0===B?void 0:B.encodingName)&&D.includes((null===(G=P.fmtp)||void 0===G?void 0:G.parameters.apt)||"")});f=[...f,...O]}0===f.length&&(N.warning("codec ".concat(s," not included in rtpCapabilities, fallback to default payloads: ").concat(null===(_=h.videoCodecs[0].rtpMap)||void 0===_?void 0:_.encodingName)),f=h.videoCodecs)}else f=h.audioCodecs.filter(D=>{var O;return((null===(O=D.rtpMap)||void 0===O?void 0:O.encodingName.toLowerCase())||"").includes(c)}),0===f.length&&(N.warning("codec ".concat(c," not included in rtpCapabilities, fallback to opus")),f=h.audioCodecs.filter(D=>{var O;return((null===(O=D.rtpMap)||void 0===O?void 0:O.encodingName.toLowerCase())||"").includes("opus")}));const v=p===ut.VIDEO?h.videoExtensions:h.audioExtensions;this.currentMidIndex+=1;const y="".concat(this.currentMidIndex);let S={media:{mediaType:p,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:f.map(D=>D.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:v,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:i,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:f,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:o,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(y)}};S=this.mungRecvMediaDsec(S,t,l);const R=this.findFirstClosedMedia(p);if(R){const D=this.sessionDesc.mediaDescriptions.indexOf(R);this.sessionDesc.mediaDescriptions[D]=S}else this.sessionDesc.mediaDescriptions.push(S);return S}createOrRecycleSendMedia(t,i,o,s,c){const l=this.rtpCapabilities.send,p=t===ut.VIDEO?l.videoCodecs:l.audioCodecs,h=t===ut.VIDEO?l.videoExtensions:l.audioExtensions;this.currentMidIndex+=1;const g="".concat(this.currentMidIndex);let f={media:{mediaType:t,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:p.map(_=>_.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:h,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:i,ssrcGroups:o,rtcpFeedbackWildcards:[],payloads:p,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:s,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(g)}};f=this.mungSendMediaDesc(f,c);const A=this.findFirstClosedMedia(t);if(A){const _=this.sessionDesc.mediaDescriptions.indexOf(A);this.sessionDesc.mediaDescriptions[_]=f}else this.sessionDesc.mediaDescriptions.push(f);return f}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(t=>"0"!==t.media.port).map(t=>t.attributes.mid)}mungRecvMediaDsec(t,i,o){const s=en(t);return _w(s),Zf(s,i),Ew(s,i),GF(s),OC(s,o,this.localCapabilities.send),s}mungSendMediaDesc(t,i){const o=en(t);return OC(o,i,this.localCapabilities.recv),Ju(o),o}updateRecvMedia(t,i){const o=this.sessionDesc.mediaDescriptions.findIndex(s=>s.attributes.mid===t);if(-1!==o){const s=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[o],i);this.sessionDesc.mediaDescriptions[o]=s}}bumpMid(t){this.currentMidIndex+=t}findFirstClosedMedia(t){return this.sessionDesc.mediaDescriptions.find(i=>bn()?"0"===i.media.port&&i.media.mediaType===t:"0"===i.media.port)}findPreloadMediaDesc(t){return this.sessionDesc.mediaDescriptions.find(i=>{var o,s;return(null===(o=i.attributes)||void 0===o||null===(s=o.ssrcs[0])||void 0===s?void 0:s.ssrcId)===t[0].ssrcId})}getSSRC(t){var i;return null===(i=this.sessionDesc.mediaDescriptions.find(o=>o.attributes.mid===t))||void 0===i?void 0:i.attributes.ssrcs}})||Ze;var Nr,st;function hr(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function yo(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?hr(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):hr(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}let xi=kn("P2PConnection","store.p2pId")((Te((st=class rU extends gm{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(i,o){super(i,o),b(this,"store",void 0),b(this,"peerConnection",void 0),b(this,"remoteSDP",void 0),b(this,"initialOffer",void 0),b(this,"transportEventReceiver",void 0),b(this,"statsFilter",void 0),b(this,"useRTX",J("USE_RTX")),b(this,"localCapabilities",void 0),b(this,"localCandidateCount",0),b(this,"allCandidatesReceived",!1),b(this,"mutex",new eo("P2PConnection-mutex")),this.store=o,this.peerConnection=new RTCPeerConnection(rU.resolvePCConfiguration(i),{optional:[{googDscp:!0}]}),this.statsFilter=he(this.peerConnection,void 0,void 0,bn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}establish(){var i=this;return U(function*(){try{i.peerConnection.addTransceiver("video",{direction:"recvonly"}),i.peerConnection.addTransceiver("audio",{direction:"recvonly"});const o=yield i.peerConnection.createOffer();if(!o.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const s=kh(o.sdp),c=yield WF(!i.useRTX,J("FILTER_VIDEO_FEC"),J("FILTER_AUDIO_FEC"));return i.localCapabilities=Cw(c),i.initialOffer=o,yo(yo({},s),{},{rtpCapabilities:c,offerSDP:o.sdp})}catch(o){throw new V(L.GET_LOCAL_CONNECTION_PARAMS_FAILED,o.toString())}})()}connect(i,o,s,c,l,p){var h=this;return U(function*(){try{if(!h.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");h.remoteSDP=new Tn({remoteIceParameters:i,remoteDtlsParameters:o,candidates:s,remoteRTPCapabilities:c,remoteSetup:l,localCapabilities:h.localCapabilities,cname:p});const g=h.remoteSDP.toString(),f=sr.exports.parse(h.initialOffer.sdp),A=f.mediaDescriptions.find(S=>"audio"===S.media.mediaType);A&&Ju(A);const _=sr.exports.print(f),v=h.logSDPExchange(_||"","offer","local","connect");yield h.peerConnection.setLocalDescription({type:"offer",sdp:_}),v?.(g),yield h.peerConnection.setRemoteDescription({type:"answer",sdp:g});const y=h.peerConnection.getTransceivers()[0];if(null!=y&&y.receiver&&h.tryBindTransportEvents(y.receiver),J("PRELOAD_MEDIA_COUNT")>0){h.remoteSDP.preloadRemoteMedia();const S=h.remoteSDP.toString();yield h.peerConnection.setRemoteDescription({type:"offer",sdp:S});const R=yield h.peerConnection.createAnswer();yield h.peerConnection.setLocalDescription(R)}}catch(g){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(g.toString()))}})()}send(i,o,s){var c=this;return ha(function*(){const l=yield It(c.mutex.lock("From P2PConnection.send"));try{if(!c.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const p=[];i.forEach(R=>{const D=c.peerConnection.addTransceiver(R._mediaStreamTrack,{direction:"sendonly"});p.push(D)}),bn()&&!0===J("SIMULCAST")&&(Re("debug",c,"apply simulcast for firefox"),yield It(c.applySimulcastForFirefox(p,i)));const h=yield It(c.peerConnection.createOffer()),g=c.remoteSDP.predictReceivingMids(i.length),f=c.mungSendOfferSDP(h.sdp,i,g),A=sr.exports.parse(f),_=g.map(R=>{const D=A.mediaDescriptions.find(O=>O.attributes.mid===R);if(!D)throw new Error("Cannot extract ssrc from mediaDescription.");return jF(D,c.useRTX)});let v;try{v=yield _}catch(R){v=[],c.remoteSDP.receive(i,o,s,v);const D=c.remoteSDP.toString();throw yield It(c.peerConnection.setLocalDescription({type:"offer",sdp:f})),yield It(c.peerConnection.setRemoteDescription({type:"answer",sdp:D})),yield It(c.stopSending(g,!0)),R}c.remoteSDP.receive(i,o,s,v);const y=c.remoteSDP.toString(),S=c.logSDPExchange(f,"offer","local","send");return yield It(c.peerConnection.setLocalDescription({type:"offer",sdp:f})),yield It(c.applySimulcastEncodings(p,i)),yield It(c.applySendEncodings(p,i)),S?.(y),yield It(c.peerConnection.setRemoteDescription({type:"answer",sdp:y})),p.map((R,D)=>({localSSRC:_[D],id:g[D],transceiver:R}))}catch(p){throw p instanceof V?p:new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(p.toString()))}finally{l()}})()}stopSending(i,o){var s=this;return U(function*(){const c=o?void 0:yield s.mutex.lock("From P2PConnection.stopSending");try{if(!s.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const l=s.peerConnection.getTransceivers().filter(f=>-1!==i.indexOf(f.mid));if(l.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");l.map(f=>{var A;f.direction="inactive",null===(A=f.stop)||void 0===A||A.call(f)});const p=yield s.peerConnection.createOffer(),h=s.logSDPExchange(p.sdp||"","offer","local","stopSending");yield s.peerConnection.setLocalDescription(p),s.remoteSDP.stopReceiving(i);const g=s.remoteSDP.toString();h?.(g),yield s.peerConnection.setRemoteDescription({type:"answer",sdp:g})}catch(l){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(l.toString()))}finally{c&&c()}})()}receive(i,o,s,c){var l=this;return U(function*(){try{if(!l.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(i," before remoteSDP created."));const{mid:p,needExchangeSDP:h}=l.remoteSDP.send(i,o,s,c);if(h){const f=l.remoteSDP.toString(),A=l.logSDPExchange(f,"offer","remote","receive");yield l.peerConnection.setRemoteDescription({type:"offer",sdp:f});const _=yield l.peerConnection.createAnswer(),v=l.mungReceiveAnswerSDP(_.sdp,p,i);A?.(v||""),yield l.peerConnection.setLocalDescription({type:"answer",sdp:v}),N.debug("[P2PConnection] receive ".concat(i," by exchanging SDP."))}else N.debug("[P2PConnection] receive ".concat(i," no need to exchange SDP."));const g=l.peerConnection.getTransceivers().find(f=>f.mid===p);if(!g)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:g.receiver.track,id:p}}catch(p){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(p.toString()))}})()}batchReceive(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:s,needExchangeSDP:c}=o.remoteSDP.batchSend(i);if(c){const l=o.remoteSDP.toString(),p=o.logSDPExchange(l,"offer","remote","receive");yield o.peerConnection.setRemoteDescription({type:"offer",sdp:l});const h=yield o.peerConnection.createAnswer();p?.(h.sdp||""),yield o.peerConnection.setLocalDescription(h),N.debug("[P2PConnection] batchReceive by exchanging SDP.")}else N.debug("[P2PConnection] batchReceive no need to exchange SDP.");return s.map(l=>{const p=o.peerConnection.getTransceivers().find(h=>h.mid===l);if(!p)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:p.receiver.track,id:l}})}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(s.toString()))}})()}stopReceiving(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");o.remoteSDP.stopSending(i);const s=o.remoteSDP.toString(),c=o.logSDPExchange(s,"offer","remote","stopReceiving");yield o.peerConnection.setRemoteDescription({type:"offer",sdp:s});const l=yield o.peerConnection.createAnswer();c?.(l.sdp||""),yield o.peerConnection.setLocalDescription(l)}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}})()}muteRemote(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(i," before remote SDP created."));o.remoteSDP.mute(i);const s=o.remoteSDP.toString(),c=o.logSDPExchange(s,"offer","remote","muteRemote");yield o.peerConnection.setRemoteDescription({type:"offer",sdp:s});const l=yield o.peerConnection.createAnswer();c?.(l.sdp||""),yield o.peerConnection.setLocalDescription(l)}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(s.toString()))}})()}unmuteRemote(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(i," before remote SDP created."));o.remoteSDP.unmute(i);const s=o.remoteSDP.toString(),c=o.logSDPExchange(s,"offer","remote","unmuteRemote");yield o.peerConnection.setRemoteDescription({type:"offer",sdp:s});const l=yield o.peerConnection.createAnswer();c?.(l.sdp||""),yield o.peerConnection.setLocalDescription(l)}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(s.toString()))}})()}muteLocal(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const s=o.peerConnection.getTransceivers().filter(h=>h.mid&&-1!==i.indexOf(h.mid));if(s.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(h=>{h.direction="inactive"});const c=yield o.peerConnection.createOffer(),l=o.logSDPExchange(c.sdp||"","offer","local","muteLocal");yield o.peerConnection.setLocalDescription(c),o.remoteSDP.muteRemote(i);const p=o.remoteSDP.toString();l?.(p),yield o.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(s.toString()))}})()}unmuteLocal(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const s=o.peerConnection.getTransceivers().filter(h=>h.mid&&-1!==i.indexOf(h.mid));if(s.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(function(){var h=U(function*(g,f){g.direction="sendonly"});return function(g,f){return h.apply(this,arguments)}}());const c=yield o.peerConnection.createOffer(),l=o.logSDPExchange(c.sdp||"","offer","local","unmuteLocal");yield o.peerConnection.setLocalDescription(c),o.remoteSDP.unmuteRemote(i);const p=o.remoteSDP.toString();l?.(p),yield o.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(s.toString()))}})()}restartICE(){var i=this;return ha(function*(){const o=yield It(i.mutex.lock("From P2PConnection.restartICE"));try{const s=yield It(i.peerConnection.createOffer({iceRestart:!0}));if(!s.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const c=kh(s.sdp),{remoteIceParameters:l}=yield c.iceParameters;if(!i.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");i.remoteSDP.restartICE(l);const p=i.remoteSDP.toString(),h=i.logSDPExchange(s.sdp||"","offer","local","restartICE");yield It(i.peerConnection.setLocalDescription(s)),h?.(p),yield It(i.peerConnection.setRemoteDescription({type:"answer",sdp:p}))}catch(s){N.warning("restart ICE failed, abort operation",s)}finally{o()}})()}close(){var i;this.peerConnection.close(),null===(i=this.onConnectionStateChange)||void 0===i||i.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(i){return this.statsFilter.getVideoIsReady(i)}updateEncoderConfig(i,o){var s=this;return U(function*(){try{if(!s.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const c=yield s.peerConnection.createOffer(),l=s.mungSendOfferSDP(c.sdp,[o],[i]);s.remoteSDP.updateRecvMedia(i,o);const p=s.remoteSDP.toString(),h=s.logSDPExchange(l,"offer","local","updateEncoderConfig");yield s.peerConnection.setLocalDescription({type:"offer",sdp:l}),h?.(p),yield s.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(c){throw new V(L.EXCHANGE_SDP_FAILED,c.toString())}})()}updateSendParameters(i,o){var s=this;return U(function*(){const c=s.peerConnection.getTransceivers().filter(l=>l.mid===i);1===c.length&&(s.isVP8Simulcast(o)?bn()||(yield s.applySimulcastEncodings(c,[o])):yield s.applySendEncodings(c,[o]))})()}setStatsRemoteVideoIsReady(i,o){this.statsFilter.setVideoIsReady2(i,o)}replaceTrack(i,o){var s=this;return U(function*(){const c=s.peerConnection.getTransceivers().find(l=>l.mid===o);c&&(yield c.sender.replaceTrack(i._mediaStreamTrack))})()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var i;null===(i=this.onICEConnectionStateChange)||void 0===i||i.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var i;null===(i=this.onConnectionStateChange)||void 0===i||i.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=i=>{i.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,N.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,N.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},J("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(i){const o={iceServers:[]};return i.iceServers?o.iceServers=i.iceServers:i.turnServer&&"off"!==i.turnServer.mode&&(oh(i.turnServer.servers)?o.iceServers=i.turnServer.servers:(o.iceServers&&o.iceServers.push(...rU.turnServerConfigToIceServers(i.turnServer.servers)),J("USE_TURN_SERVER_OF_GATEWAY")&&o.iceServers&&i.turnServer.serversFromGateway&&o.iceServers.push(...rU.turnServerConfigToIceServers(i.turnServer.serversFromGateway)),J("FORCE_TURN_TCP")?o.iceTransportPolicy="relay":i.turnServer.servers.concat(i.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(o.iceTransportPolicy="relay")}))),o}static turnServerConfigToIceServers(i){const o=[];return i.forEach(s=>{s.security?s.tcpport&&o.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(Eh(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&!J("FORCE_TURN_TCP")&&o.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&o.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),o}tryBindTransportEvents(i){i.transport&&(this.transportEventReceiver=i,i.transport.onstatechange=()=>{var o,s;null!==(o=i.transport)&&void 0!==o&&o.state&&(null===(s=this.onDTLSTransportStateChange)||void 0===s||s.call(this,i.transport.state))},i.transport.onerror=o=>{var s;null===(s=this.onDTLSTransportError)||void 0===s||s.call(this,o.error)},i.transport.iceTransport&&(i.transport.iceTransport.onstatechange=()=>{var o,s,c;null!==(o=i.transport)&&void 0!==o&&o.iceTransport.state&&(null===(s=this.onICETransportStateChange)||void 0===s||s.call(this,null===(c=i.transport)||void 0===c?void 0:c.iceTransport.state))}))}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}applySendEncodings(i,o){var s=this;return U(function*(){try{if(!Vr().supportSetRtpSenderParameters||i.length!==o.length)return;for(let A=0;A<i.length;A++){const _=i[A],v=o[A];if(v&&v instanceof dr){var c,l;if(s.isVP8Simulcast(v))continue;const y={},S={};switch(v._optimizationMode){case"motion":y.degradationPreference="maintain-framerate";break;case"detail":y.degradationPreference="maintain-resolution";break;default:y.degradationPreference="balanced"}var p,h,g,f;if(null!==(c=v._encoderConfig)&&void 0!==c&&c.bitrateMax&&(S.maxBitrate=1e3*(null===(p=v._encoderConfig)||void 0===p?void 0:p.bitrateMax)),v._hints.includes(br.LOW_STREAM)&&(null!==(h=v._encoderConfig)&&void 0!==h&&h.frameRate&&(S.maxFramerate=Qu(v._encoderConfig.frameRate)),null!==(g=v._encoderConfig)&&void 0!==g&&g.scaleResolutionDownBy&&(null===(f=v._encoderConfig)||void 0===f?void 0:f.scaleResolutionDownBy)>1&&(S.scaleResolutionDownBy=v._encoderConfig.scaleResolutionDownBy)),J("DSCP_TYPE")&&eh()){const O=J("DSCP_TYPE");["very-low","low","medium","high"].includes(O)&&(S.networkPriority=O)}const R=_.sender.getParameters(),D=null===(l=R.encodings)||void 0===l?void 0:l[0];bn()&&!D&&(y.encodings=[S]),D&&Object.assign(D,S),Object.assign(R,y),yield _.sender.setParameters(R)}}}catch{N.debug("Apply RTPSendEncodings failed.")}})()}mungSendOfferSDP(i,o,s){const c=sr.exports.parse(i);return o.forEach((l,p)=>{const h=s[p],g=c.mediaDescriptions.find(f=>f.attributes.mid===h);g&&(Zf(g,l),HF(g,l,this.store.codec))}),sr.exports.print(c)}mungReceiveAnswerSDP(i,o,s){const c=sr.exports.parse(i),l=c.mediaDescriptions.find(p=>p.attributes.mid===o);return l&&s===ut.AUDIO&&"audio"===l.media.mediaType&&Ju(l),sr.exports.print(c)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=i=>{var o;null===(o=this.onFirstAudioReceived)||void 0===o||o.call(this,i)},this.statsFilter.onFirstVideoReceived=i=>{var o;null===(o=this.onFirstVideoReceived)||void 0===o||o.call(this,i)},this.statsFilter.onFirstAudioDecoded=i=>{var o;null===(o=this.onFirstAudioDecoded)||void 0===o||o.call(this,i)},this.statsFilter.onFirstVideoDecoded=(i,o,s)=>{var c;null===(c=this.onFirstVideoDecoded)||void 0===c||c.call(this,i,o,s)},this.statsFilter.onSelectedLocalCandidateChanged=(i,o)=>{var s;null===(s=this.onSelectedLocalCandidateChanged)||void 0===s||s.call(this,i,o)},this.statsFilter.onSelectedRemoteCandidateChanged=(i,o)=>{var s;null===(s=this.onSelectedRemoteCandidateChanged)||void 0===s||s.call(this,i,o)},this.statsFilter.onFirstVideoDecodedTimeout=i=>{var o;null===(o=this.onFirstVideoDecodedTimeout)||void 0===o||o.call(this,i)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}applySimulcastForFirefox(i,o){var s=this;return U(function*(){if(i.length===o.length)for(let g=0;g<i.length;g++){var c,l,p,h;const f=i[g],A=o[g];if(A instanceof dr&&!A._hints.includes(br.LOW_STREAM)&&null!==(c=A._encoderConfig)&&void 0!==c&&c.bitrateMax&&(null===(l=A._encoderConfig)||void 0===l?void 0:l.bitrateMax)>200&&null!==(p=A._scalabiltyMode)&&void 0!==p&&p.numSpatialLayers&&(null===(h=A._scalabiltyMode)||void 0===h?void 0:h.numSpatialLayers)>1&&"vp8"===s.store.codec){const _={},v={high:1e3*(A._encoderConfig.bitrateMax-50),medium:5e4};_.encodings=[{rid:"m",active:!0,maxBitrate:v.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:v.high}];const y=f.sender.getParameters();yield f.sender.setParameters(Object.assign(y,_))}}})()}applySimulcastEncodings(i,o){var s=this;return U(function*(){if(!bn()&&i.length===o.length)for(let c=0;c<i.length;c++){const l=o[c];if(l instanceof dr&&s.isVP8Simulcast(l)){const p=i[c],h={},g={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:g.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:g.medium,scaleResolutionDownBy:4}];const f=p.sender.getParameters();yield p.sender.setParameters(Object.assign(f,h))}}})()}isVP8Simulcast(i){var o,s,c,l;return!!(i instanceof dr&&J("SIMULCAST")&&"vp8"===this.store.codec&&!i._hints.includes(br.LOW_STREAM)&&null!==(o=i._encoderConfig)&&void 0!==o&&o.bitrateMax&&(null===(s=i._encoderConfig)||void 0===s?void 0:s.bitrateMax)>200&&null!==(c=i._scalabiltyMode)&&void 0!==c&&c.numSpatialLayers&&(null===(l=i._scalabiltyMode)||void 0===l?void 0:l.numSpatialLayers)>1)}logSDPExchange(i,o,s,c){if(J("SDP_LOGGING"))return N.upload("exchanging ".concat(s," ").concat(o," SDP during P2PConnection.").concat(c,"\n"),i),"offer"===o?l=>{this.logSDPExchange(l,"answer","local"===s?"remote":"local",c)}:void 0}getRemoteSSRC(i){var o=this;return U(function*(){if(o.remoteSDP)return o.remoteSDP.getSSRC(i)?.[0].ssrcId})()}}).prototype,"connect",[Gr],Object.getOwnPropertyDescriptor(st.prototype,"connect"),st.prototype),Te(st.prototype,"receive",[Gr],Object.getOwnPropertyDescriptor(st.prototype,"receive"),st.prototype),Te(st.prototype,"batchReceive",[Gr],Object.getOwnPropertyDescriptor(st.prototype,"batchReceive"),st.prototype),Te(st.prototype,"stopReceiving",[Gr],Object.getOwnPropertyDescriptor(st.prototype,"stopReceiving"),st.prototype),Te(st.prototype,"muteRemote",[Gr],Object.getOwnPropertyDescriptor(st.prototype,"muteRemote"),st.prototype),Te(st.prototype,"unmuteRemote",[Gr],Object.getOwnPropertyDescriptor(st.prototype,"unmuteRemote"),st.prototype),Te(st.prototype,"muteLocal",[Gr],Object.getOwnPropertyDescriptor(st.prototype,"muteLocal"),st.prototype),Te(st.prototype,"unmuteLocal",[Gr],Object.getOwnPropertyDescriptor(st.prototype,"unmuteLocal"),st.prototype),Te(st.prototype,"close",[Gr],Object.getOwnPropertyDescriptor(st.prototype,"close"),st.prototype),Te(st.prototype,"updateEncoderConfig",[Gr],Object.getOwnPropertyDescriptor(st.prototype,"updateEncoderConfig"),st.prototype),Te(st.prototype,"updateSendParameters",[Gr],Object.getOwnPropertyDescriptor(st.prototype,"updateSendParameters"),st.prototype),Te(st.prototype,"replaceTrack",[Gr],Object.getOwnPropertyDescriptor(st.prototype,"replaceTrack"),st.prototype),Te(st.prototype,"getRemoteSSRC",[Gr],Object.getOwnPropertyDescriptor(st.prototype,"getRemoteSSRC"),st.prototype),Nr=st))||Nr;function Gr(t,i,o){const s=t[i];if("function"!=typeof s)throw new Error("Cannot use mutex on object property.");return o.value=U(function*(){const c=this.mutex,l=yield c.lock("From P2PConnection.".concat(i));try{for(var p=arguments.length,h=new Array(p),g=0;g<p;g++)h[g]=arguments[g];return yield s.apply(this,h)}finally{l()}}),o}function fa(t,i){let o=document.createElement("video"),s=document.createElement("canvas");o.setAttribute("style","display:none"),s.setAttribute("style","display:none"),o.setAttribute("muted",""),o.muted=!0,o.setAttribute("autoplay",""),o.autoplay=!0,o.setAttribute("playsinline",""),s.width=Qu(i.width),s.height=Qu(i.height);const c=Qu(i.framerate||15);document.body.append(o),document.body.append(s);let l=t._mediaStreamTrack;o.srcObject=new MediaStream([l]),o.play();const p=s.getContext("2d");if(!p)throw new V(L.UNEXPECTED_ERROR,"can not get canvas context");const h=Vr(),g=s.captureStream(h.supportRequestFrame?0:c).getVideoTracks()[0],f=L0(()=>(()=>{if(o.paused&&o.play(),o.videoHeight>2&&o.videoWidth>2){const y=s.width*(o.videoHeight/o.videoWidth);Math.abs(y-s.height)>=2&&(N.debug("adjust low stream resolution","".concat(s.width,"x").concat(s.height," -> ").concat(s.width,"x").concat(y)),s.height=y)}p.drawImage(o,0,0,s.width,s.height),g.requestFrame&&g.requestFrame(),l!==t._mediaStreamTrack&&(l=t._mediaStreamTrack,o.srcObject=new MediaStream([l]))})(),c),A=g.stop;return g.stop=()=>{A.call(g),f(),o&&(o.remove(),o=null),s&&(s.width=0,s.remove(),s=null),N.debug("clean low stream renderer")},g}var Hi,ga;function d_(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function Hc(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?d_(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):d_(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}class h_ extends HQ{getUserId(){return this._userId}constructor(i,o,s,c){super(i,"track-".concat(i.kind,"-").concat(o,"-").concat(c.clientId,"_").concat(xn(5,""))),b(this,"_userId",void 0),b(this,"_uintId",void 0),b(this,"_isDestroyed",!1),b(this,"store",void 0),b(this,"processor",void 0),b(this,"processorContext",void 0),this._userId=o,this._uintId=s,this.store=c}_updateOriginMediaStreamTrack(i){this._originMediaStreamTrack=i,this._mediaStreamTrack=i,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,N.info("[".concat(this.getTrackId(),"] is destroyed")),le("info",this,"_destroy"),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let eg=kn("RemoteVideoTrack","getTrackId")(Hi=class extends h_{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==Ei.PLAYING)}constructor(t,i,o,s){super(t,i,o,s),b(this,"_videoVisibleTimer",null),b(this,"_previousVideoVisibleStatus",void 0),b(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),b(this,"trackMediaType","video"),b(this,"_videoWidth",void 0),b(this,"_videoHeight",void 0),b(this,"_player",void 0),b(this,"processorDestination",void 0),b(this,"processorContext",void 0),le("info",this,"constructor",{userId:i}),this.updateMediaStreamTrackResolution(),this.processorContext=new CB(this.getTrackId(),"remote"),this.processorDestination=new vB(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return Co(()=>{N.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead"),Re("warning",this,"[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),Uc(this,Qe.GET_STATS)||Hc({},pL)}play(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.REMOTE_VIDEO_TRACK_PLAY,options:[this.getTrackId(),"string"==typeof t?t:"HTMLElement",i]});if("string"==typeof t){const c=document.getElementById(t);c?t=c:(N.warning("[".concat(this.getTrackId(),'] can not find "#').concat(t,'" element, use document.body')),Re("warning",this,'can not find "#'.concat(t,'" element, use document.body')),t=document.body)}N.debug("[".concat(this.getTrackId(),"] start video playback"),JSON.stringify(i)),le("debug",this,"play",i);const s=Hc(Hc({fit:"cover"},i),{},{trackId:this.getTrackId(),element:t});this._player?this._player.updateConfig(s):(this._player=new j9(s),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.emit(df.FIRST_FRAME_DECODED)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const c=this.getVideoElementVisibleStatus();this.emit(df.VIDEO_ELEMENT_VISIBLE_STATUS,c)}catch{}},J("CHECK_VIDEO_VISIBLE_INTERVAL")),o.onSuccess()}stop(){const t=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.REMOTE_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return t.onSuccess();this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,N.debug("[".concat(this.getTrackId(),"] stop video playback")),le("debug",this,"stop"),t.onSuccess()}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){DB(this._originMediaStreamTrack).then(t=>{let[i,o]=t;this._videoHeight=o,this._videoWidth=i}).catch(q0)}_updatePlayerSource(){N.debug("[".concat(this.getTrackId(),"] update player source track")),le("debug",this,"_updatePlayerSource"),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var t,i;const o=null==this||null===(t=this._player)||void 0===t?void 0:t.getContainerElement(),s={track:this,element:null==this||null===(i=this._player)||void 0===i?void 0:i.getVideoElement(),slot:o?.parentElement},{element:c,slot:l}=s;if(this.isPlaying&&c instanceof HTMLVideoElement&&l instanceof HTMLElement){const p=iG.checkOneElementVisible(c),h=Object.assign({},p);if(h.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=h.visible;pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]}).onSuccess(h.visible?"Video is visible":"Invisible because of ".concat(h.reason))}return h}return}catch(o){throw new V(L.GET_VIDEO_ELEMENT_VISIBLE_ERROR,o.message)}}pipe(t){if(this.processor===t)return t;if(t._source)throw new V(L.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),t}unpipe(){if(!this.processor)return;const t=this.processor;this.processor._source=void 0,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){var t=this;this.processorDestination.on(zr.ON_TRACK,function(){var i=U(function*(o){o?o!==t._mediaStreamTrack&&(t._mediaStreamTrack=o,t._updatePlayerSource()):t._mediaStreamTrack!==t._originMediaStreamTrack&&(t._mediaStreamTrack=t._originMediaStreamTrack,t._updatePlayerSource())});return function(o){return i.apply(this,arguments)}}())}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(zr.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}})||Hi,Zl=kn("RemoteAudioTrack","getTrackId")(ga=class extends h_{get isPlaying(){return this._useAudioElement?Fo.isPlaying(this.getTrackId()):this._source.isPlayed}constructor(t,i,o,s){super(t,i,o,s),b(this,"trackMediaType","audio"),b(this,"_source",void 0),b(this,"_useAudioElement",!0),b(this,"_volume",100),b(this,"processorContext",void 0),b(this,"processorDestination",void 0),b(this,"_played",!1),b(this,"_bypassWebAudio",!1),le("info",this,"constructor",{userId:i}),J("DISABLE_WEBAUDIO")?(this._source=new aD,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new rB(t,!0),J("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(go.RECEIVE_TRACK_BUFFER,()=>{this.emit(df.FIRST_FRAME_DECODED)}),this.processorContext=new yB(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new H0(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(go.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!t)return this._source.removeAllListeners(go.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(i),this._source.removeAllListeners(go.ON_AUDIO_BUFFER),this._source.on(go.ON_AUDIO_BUFFER,o=>t(o))}setVolume(t){const i=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.REMOTE_AUDIO_SET_VOLUME,options:[this.getTrackId(),t]},300);this._volume=t,this._useAudioElement?Fo.setVolume(this.getTrackId(),t):this._source.setVolume(t/100),i.onSuccess()}setPlaybackDevice(t){var i=this;return U(function*(){const o=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[i.getTrackId(),t]});if(!i._useAudioElement)throw new V(L.NOT_SUPPORTED,"your browser does not support setting the audio output device");try{yield Fo.setSinkID(i.getTrackId(),t)}catch(s){throw o.onError(s),s}o.onSuccess()})()}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return Co(()=>{N.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead"),Re("warning",this,"[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),Uc(this,Qe.GET_STATS)||Hc({},yj)}play(){const t=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.REMOTE_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});N.debug("[".concat(this.getTrackId(),"] start audio playback")),le("debug",this,"play"),this._played=!0,this._useAudioElement?(N.debug("[".concat(this.getTrackId(),"] use audio element to play")),Re("debug",this,"use audio element to play"),Fo.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play(),t.onSuccess()}stop(){const t=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.REMOTE_AUDIO_TRACK_STOP,options:[this.getTrackId()]});N.debug("[".concat(this.getTrackId(),"] stop audio playback")),le("debug",this,"stop"),this._played=!1,this._useAudioElement?Fo.stop(this.getTrackId()):this._source.stop(),t.onSuccess()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];N.debug("[".concat(this.getTrackId(),"] update player source track")),le("debug",this,"_updatePlayerSource"),t&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Fo.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(t){if(this._bypassWebAudio)throw new V(L.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===t)return t;if(t._source)throw new V(L.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),t}unpipe(){var t;if(this._bypassWebAudio)throw new V(L.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const i=this.processor;null===(t=this._source.processSourceNode)||void 0===t||t.disconnect(),this.processor._source=!1,this.processor=void 0,i.reset()}bindProcessorDestinationEvents(){var t=this;this.processorDestination.on(zr.ON_TRACK,function(){var i=U(function*(o){o?o!==t._mediaStreamTrack&&(t._mediaStreamTrack=o,t._updatePlayerSource(!1),t._source.processedNode=t._source.createMediaStreamSourceNode(o)):t._mediaStreamTrack!==t._originMediaStreamTrack&&(t._mediaStreamTrack=t._originMediaStreamTrack,t._updatePlayerSource())});return function(o){return i.apply(this,arguments)}}()),this.processorDestination.on(zr.ON_NODE,i=>{this._source.processedNode=i;const o=!i;this._useAudioElement!==o&&(this._played?(this.stop(),this._useAudioElement=o,this.play()):this._useAudioElement=o)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(zr.ON_TRACK),this.processorDestination.removeAllListeners(zr.ON_NODE)}})||ga;function p_(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function Lh(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?p_(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):p_(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}class ed extends En{constructor(){super(),b(this,"uplinkStatsUploadInterval",void 0),b(this,"uplinkStatsUploadSlowInterval",void 0),b(this,"uplinkRelatedStatsUploadInterval",void 0),b(this,"uplinkDenoiserStatsUploadInterval",void 0),b(this,"transportStatsUploadInterval",void 0),b(this,"uplinkExtensionStatsUploadInterval",void 0),b(this,"downlinkExtensionStatsUploadInterval",void 0),b(this,"extensionUsageStatsUploadInterval",void 0),b(this,"downlinkStatsUploadInterval",void 0),b(this,"downlinkStatsUploadSlowInterval",void 0),b(this,"downlinkRelatedStatsUploadInterval",void 0),b(this,"lastStats",void 0),b(this,"uploadUnplinkStarted",!1),b(this,"uploadDownlinkStarted",!1),b(this,"uploadTransportStarted",!1),b(this,"uploadExtensionUsageStarted",!1),b(this,"requestStats",void 0),b(this,"requestLocalMedia",void 0),b(this,"requestRemoteMedia",void 0),b(this,"requestAllTracks",void 0),b(this,"requestVideoIsReady",void 0),b(this,"requestUpload",void 0)}startUploadTransportStats(){this.uploadTransportStarted||(this.uploadTransportStarted=!0,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=window.setInterval(()=>{var i;const o=null===(i=this.requestStats)||void 0===i?void 0:i.call(this);o&&this.uploadTransportStats(o)},6e3))}startUploadExtensionUsageStats(){var i=this;if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.extensionUsageStatsUploadInterval&&window.clearInterval(this.extensionUsageStatsUploadInterval);const o=new Map;this.extensionUsageStatsUploadInterval=window.setInterval(U(function*(){var s,c,l;const p=Date.now(),h={connectionInterval:J("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:p};let g=[];const f=(null===(s=i.requestAllTracks)||void 0===s?void 0:s.call(i))||[];for(const y of f)!y.muted&&y.enabled&&(g=g.concat(yield y.getProcessorUsage()));const A=(null===(c=i.requestRemoteMedia)||void 0===c?void 0:c.call(i))||[];for(const[y,S]of A)S.has(ut.VIDEO)&&y.videoTrack&&(g=g.concat(yield y.videoTrack.getProcessorUsage())),S.has(ut.AUDIO)&&y.audioTrack&&(g=g.concat(yield y.audioTrack.getProcessorUsage()));if(0===g.length)return;h.details=function(y,S){const R={};for(const{id:O,value:P,level:B,direction:G}of y)if(R[O])2===P&&(R[O].value=P),B>R[O].level&&(R[O].level=B),"remote"===G&&(R[O].remoteUidCount+=1);else{var D;const Y=null!==(D=S.get(O))&&void 0!==D?D:0;R[O]={value:P,level:B,remoteUidCount:"local"===G?0:1,totalTs:Y};const ae=2===P?Y+J("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:Y;S.set(O,ae)}return Object.keys(R).map(O=>{const{level:P,value:B,totalTs:G}=R[O];return{id:O,level:P,value:B,totalTs:G}})}(g,o);const _=Date.now();null===(l=i.requestUpload)||void 0===l||l.call(i,Oi.EXTENSION_USAGE_STATS,{usageStats:h,sendTs:_>p?_:p+1})}),J("EXTENSION_USAGE_UPLOAD_INTERVAL"))}startUploadUplinkStats(){this.uploadUnplinkStarted||(this.uploadUnplinkStarted=!0,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkStatsUploadInterval=window.setInterval(()=>{var i;const o=null===(i=this.requestStats)||void 0===i?void 0:i.call(this);o&&(this.uploadUplinkStats(o,this.lastStats),this.lastStats=o)},3e3),this.uplinkStatsUploadSlowInterval&&window.clearInterval(this.uplinkStatsUploadSlowInterval),this.uplinkStatsUploadSlowInterval=window.setInterval(()=>{var i;const o=null===(i=this.requestStats)||void 0===i?void 0:i.call(this);o&&this.uploadSlowUplinkStats(o)},6e4),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkRelatedStatsUploadInterval=window.setInterval(()=>{var i;const o=null===(i=this.requestStats)||void 0===i?void 0:i.call(this);o&&this.uploadRelatedUplinkStats(o,this.lastStats),this.lastStats=o},1e3),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval=window.setInterval(()=>{var i;const o=null===(i=this.requestAllTracks)||void 0===i?void 0:i.call(this);o&&this.uploadDenoiserStats(o)},2e3),this.uplinkExtensionStatsUploadInterval&&window.clearInterval(this.uplinkExtensionStatsUploadInterval),this.uplinkExtensionStatsUploadInterval=window.setInterval(()=>{var i;const o=null===(i=this.requestAllTracks)||void 0===i?void 0:i.call(this);o&&this.uploadExtensionStats(o)},2e3))}uploadTransportStats(i){Ns(()=>{var o;null===(o=this.requestUpload)||void 0===o||o.call(this,Oi.TRANSPORT_STATS,function(s){const c={connectionType:100};if("relay"===s.selectedCandidatePair.localCandidate.candidateType){const l=s.selectedCandidatePair.localCandidate.relayProtocol;"udp"===l&&(c.connectionType=101),"tcp"===l&&(c.connectionType=103),"tls"===l&&(c.connectionType=104)}return c}(i))})}uploadUplinkStats(i,o){var s;((null===(s=this.requestLocalMedia)||void 0===s?void 0:s.call(this))||[]).forEach(c=>{let[l,{track:p,ssrcs:h}]=c;switch(l){case Pe.LocalVideoLowTrack:case Pe.LocalVideoTrack:{const f=function(_,v,y){var S;const R=v.videoSend.find(O=>O.ssrc===_);if(!R)return null;const D={id:xn(10,""),timestamp:new Date(v.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:R.ssrc.toString()};switch(D.A_vstd=y._originMediaStreamTrack&&!y._originMediaStreamTrack.enabled||y._mediaStreamTrack&&!y._mediaStreamTrack.enabled?"1":"0",R.sentFrame&&(D.A_fhs=R.sentFrame.height.toString(),D.A_frs=R.sentFrame.frameRate.toString(),D.A_fws=R.sentFrame.width.toString()),R.adaptionChangeReason){case"none":D.A_ac="0";break;case"cpu":D.A_ac="1";break;case"bandwidth":D.A_ac="2";break;case"other":D.A_ac="3"}return D.A_lvps=G1[y._player?y._player.videoElementStatus:"uninit"].toString(),D.A_nr=null===(S=R.nacksCount)||void 0===S?void 0:S.toString(),R.avgEncodeMs&&(D.A_aem=R.avgEncodeMs.toFixed(0).toString()),D}(h[0].ssrcId,i,p),A=rs(h[0].ssrcId,i,o);f&&Ns(()=>{var _;return null===(_=this.requestUpload)||void 0===_?void 0:_.call(this,Oi.PUBLISH_STATS,{stream_type:l===Pe.LocalVideoLowTrack?"low":"high",stats:Lh(Lh({},f),A)})});break}case Pe.LocalAudioTrack:{const f=function(A,_,v){const y=_.audioSend.find(R=>R.ssrc===A);if(!y)return null;const S={id:xn(10,""),timestamp:new Date(_.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:y.ssrc.toString()};return S.A_astd=v._originMediaStreamTrack.enabled&&v._mediaStreamTrack.enabled?"0":"1",S.A_ail=y.inputLevel?Math.round(100*y.inputLevel).toString():Math.round(100*v._source.getAccurateVolumeLevel()).toString(),S.A_apil=Math.round(100*v._source.getAccurateVolumeLevel()).toString(),y.aecReturnLoss&&(S.A_ecrl=Math.round(y.aecReturnLoss).toString()),y.aecReturnLossEnhancement&&(S.A_ecrle=Math.round(y.aecReturnLossEnhancement).toString()),S}(h[0].ssrcId,i,p);f&&Ns(()=>{var A;return null===(A=this.requestUpload)||void 0===A?void 0:A.call(this,Oi.PUBLISH_STATS,{stream_type:"high",stats:f})});break}}const g=function(f){const A={id:"bweforvideo",timestamp:new Date(f.timestamp).toISOString(),type:"VideoBwe"};return f.bitrate.retransmit&&(A.A_rb=f.bitrate.retransmit.toString()),f.bitrate.targetEncoded&&(A.A_teb=f.bitrate.targetEncoded.toString()),A.A_aeb=f.bitrate.actualEncoded.toString(),A.A_tb=f.bitrate.transmit.toString(),void 0!==f.sendBandwidth&&(A.A_asb=f.sendBandwidth.toString()),A}(i);g&&Ns(()=>{var f;return null===(f=this.requestUpload)||void 0===f?void 0:f.call(this,Oi.PUBLISH_STATS,{stream_type:l===Pe.LocalVideoLowTrack?"low":"high",stats:g})})})}uploadSlowUplinkStats(i){var o;((null===(o=this.requestLocalMedia)||void 0===o?void 0:o.call(this))||[]).filter(s=>{let[c]=s;return c===Pe.LocalVideoLowTrack||c===Pe.LocalVideoTrack}).forEach(s=>{let[c,{ssrcs:l}]=s;const p=rs(l[0].ssrcId,i);p&&Ns(()=>{var h;return null===(h=this.requestUpload)||void 0===h?void 0:h.call(this,Oi.PUBLISH_STATS,{stream_type:c===Pe.LocalVideoLowTrack?"low":"high",stats:p})})})}uploadRelatedUplinkStats(i,o){var s;((null===(s=this.requestLocalMedia)||void 0===s?void 0:s.call(this))||[]).filter(c=>{let[l]=c;return l===Pe.LocalVideoLowTrack||l===Pe.LocalVideoTrack}).forEach(c=>{let[l,{ssrcs:p}]=c;const h=function(g,f){const A=f.videoSend.find(_=>_.ssrc===g);return A?{mediaType:"video",isVideoMute:!1,frameRateInput:A.inputFrame&&A.inputFrame.frameRate.toString(),frameRateSent:A.sentFrame&&A.sentFrame.frameRate.toString(),googRtt:A.rttMs.toString(),qpSumPerFrame:Math.floor(A.qpSumPerFrame).toString()}:null}(p[0].ssrcId,i);h&&Ns(()=>{var g;null===(g=this.requestUpload)||void 0===g||g.call(this,Oi.PUBLISH_RELATED_STATS,{stream_type:l===Pe.LocalVideoLowTrack?"low":"high",stats:h})})})}uploadDenoiserStats(i){for(let l=0;l<i.length;l++){const p=i[l];if(p instanceof mh){var o,s,c;const h=null===(o=(s=p._external).getDenoiserStats)||void 0===o?void 0:o.call(s);return void(h&&(null===(c=this.requestUpload)||void 0===c||c.call(this,Oi.DENOISER_STATS,h)))}}}uploadExtensionStats(i){for(let o=0;o<i.length;o++)i[o].getProcessorStats().forEach(s=>{var c;null===(c=this.requestUpload)||void 0===c||c.call(this,s.type,s.stats)})}stopUploadUplinkStats(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkStatsUploadInterval=void 0,this.uplinkRelatedStatsUploadInterval=void 0,this.uplinkDenoiserStatsUploadInterval=void 0)}startUploadDownlinkStats(){this.uploadDownlinkStarted||(this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkStatsUploadInterval=window.setInterval(()=>{var i;const o=null===(i=this.requestStats)||void 0===i?void 0:i.call(this);o&&(this.uploadDownlinkStats(o,this.lastStats),this.lastStats=o)},3e3),this.downlinkStatsUploadSlowInterval&&window.clearInterval(this.downlinkStatsUploadSlowInterval),this.downlinkStatsUploadSlowInterval=window.setInterval(()=>{var i;const o=null===(i=this.requestStats)||void 0===i?void 0:i.call(this);o&&this.uploadSlowDownlinkStats(o)},6e4),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkRelatedStatsUploadInterval=window.setInterval(()=>{var i;const o=null===(i=this.requestStats)||void 0===i?void 0:i.call(this);o&&(this.uploadRelatedDownlinkStats(o,this.lastStats),this.lastStats=o)},1e3),this.downlinkExtensionStatsUploadInterval&&window.clearInterval(this.downlinkExtensionStatsUploadInterval),this.downlinkExtensionStatsUploadInterval=window.setInterval(()=>{var i;const o=null===(i=this.requestRemoteMedia)||void 0===i?void 0:i.call(this);o&&this.uploadDownlinkExtensionStats(o)},2e3))}uploadDownlinkStats(i,o){var s;((null===(s=this.requestRemoteMedia)||void 0===s?void 0:s.call(this))||[]).forEach(c=>{let[l,p]=c;if(p.has(ut.VIDEO)&&l.videoTrack){const h=l.videoTrack?function(g,f,A){const _=f.videoRecv.find(R=>R.ssrc===g);if(!_)return null;const v={id:xn(10,""),timestamp:new Date(f.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:_.ssrc.toString()};var y,S;return v.bytesReceived=_.bytes.toString(),v.packetsLost=_.packetsLost.toString(),v.packetsReceived=_.packets.toString(),_.framesRateFirefox&&(v.A_frr=_.framesRateFirefox.toString()),_.receivedFrame?(v.A_frr=_.receivedFrame.frameRate.toString(),v.A_fhr=_.receivedFrame.height.toString(),v.A_fwr=_.receivedFrame.width.toString()):(v.A_fhr=null===(y=A._videoHeight)||void 0===y?void 0:y.toString(),v.A_fwr=null===(S=A._videoWidth)||void 0===S?void 0:S.toString()),v.A_frd=_.decodeFrameRate.toString(),_.outputFrame&&(v.A_fro=_.outputFrame.frameRate.toString()),void 0!==_.jitterBufferMs&&(v.A_jbm=Math.floor(_.jitterBufferMs).toString()),void 0!==_.currentDelayMs&&(v.A_cdm=Math.floor(_.currentDelayMs).toString()),v.A_fs=_.firsCount.toString(),v.A_ns=_.nacksCount.toString(),v.A_ps=_.plisCount.toString(),A&&(v.A_vrtd=A._originMediaStreamTrack.enabled&&A._mediaStreamTrack.enabled?"0":"1"),A._player&&A._player.freezeTimeCounterList.length>0&&(v.A_vrft=A._player.freezeTimeCounterList.splice(0,1)[0].toString()),v.A_rvps=G1[A._player?A._player.videoElementStatus:"uninit"].toString(),v}(l._videoSSRC,i,l.videoTrack):void 0;h&&Ns(()=>{var g;return null===(g=this.requestUpload)||void 0===g?void 0:g.call(this,Oi.SUBSCRIBE_STATS,{stream_id:l.uid,stats:h})})}if(p.has(ut.AUDIO)&&l.audioTrack){const h=l.audioTrack?function(g,f,A){const _=f.audioRecv.find(y=>y.ssrc===g);if(!_)return null;const v={id:xn(10,""),timestamp:new Date(f.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:_.ssrc.toString()};return v.bytesReceived=_.bytes.toString(),v.packetsLost=_.packetsLost.toString(),v.packetsReceived=_.packets.toString(),v.A_aol=_.outputLevel?Math.round(100*_.outputLevel).toString():Math.round(100*A._source.getAccurateVolumeLevel()).toString(),v.A_apol=Math.round(100*A._source.getAccurateVolumeLevel()).toString(),A&&(v.A_artd=A._originMediaStreamTrack.enabled&&A._mediaStreamTrack.enabled?"0":"1"),v.A_jr=_.jitterMs.toString(),v.A_jbm=Math.floor(_.jitterBufferMs).toString(),v.A_cdm=Math.floor(_.jitterBufferMs).toString(),v.A_raps=G1[Fo.getPlayerState(A.getTrackId())].toString(),v}(l._audioSSRC,i,l.audioTrack):void 0;h&&Ns(()=>{var g;return null===(g=this.requestUpload)||void 0===g?void 0:g.call(this,Oi.SUBSCRIBE_STATS,{stream_id:l.uid,stats:h})})}})}uploadSlowDownlinkStats(i){}uploadRelatedDownlinkStats(i,o){var s;((null===(s=this.requestRemoteMedia)||void 0===s?void 0:s.call(this))||[]).forEach(c=>{let[l,p]=c;if(p.has(ut.VIDEO)&&l.videoTrack){var h;const g=!0===(l._videoSSRC&&(null===(h=this.requestVideoIsReady)||void 0===h?void 0:h.call(this,l._videoSSRC))||!1),f=function(A,_,v,y,S,R){const D=v.videoRecv.find(G=>G.ssrc===A),O=S?S.videoRecv.find(G=>G.ssrc===A):void 0;if(!D)return null;const P=_h.isRemoteVideoFreeze(R,D,O)&&_,B={mediaType:"video",isVideoMute:!1,peerId:y,frameRateReceived:D.receivedFrame&&D.receivedFrame.frameRate.toString(),frameRateDecoded:D.decodedFrame&&D.decodedFrame.frameRate.toString(),isFreeze:P,bytesReceived:D.bytes.toString(),packetsReceived:D.packets.toString(),packetsLost:D.packetsLost.toString(),qpSumPerFrame:Math.floor(D.qpSumPerFrame).toString()};return D.framesRateFirefox&&(B.frameRateDecoded=D.framesRateFirefox.toString(),B.frameRateReceived=D.framesRateFirefox.toString()),B}(l._videoSSRC,g,i,l.uid,o,l.videoTrack);f&&Ns(()=>{var A;null===(A=this.requestUpload)||void 0===A||A.call(this,Oi.SUBSCRIBE_RELATED_STATS,{stream_id:l.uid,stats:f})})}if(p.has(ut.AUDIO)&&l.audioTrack){const g=function(f,A,_,v){const y=A.audioRecv.find(R=>R.ssrc===f);if(!y)return null;const S=_h.isRemoteAudioFreeze(v);return{mediaType:"audio",isAudioMute:!1,peerId:_,googJitterReceived:y.jitterMs.toString(),isFreeze:S,bytesReceived:y.bytes.toString(),packetsReceived:y.packets.toString(),packetsLost:y.packetsLost.toString(),frameReceived:y.receivedFrames.toString(),frameDropped:y.droppedFrames.toString()}}(l._audioSSRC,i,l.uid,l.audioTrack);g&&Ns(()=>{var f;null===(f=this.requestUpload)||void 0===f||f.call(this,Oi.SUBSCRIBE_RELATED_STATS,{stream_id:l.uid,stats:g})})}})}stopUploadDownlinkStats(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkStatsUploadInterval=void 0,this.downlinkRelatedStatsUploadInterval=void 0)}stopUploadTransportStats(){this.uploadTransportStarted&&(this.uploadTransportStarted=!1,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=void 0)}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.extensionUsageStatsUploadInterval&&window.clearInterval(this.extensionUsageStatsUploadInterval),this.extensionUsageStatsUploadInterval=void 0)}uploadDownlinkExtensionStats(i){i.forEach(o=>{let[s,c]=o;c.has(ut.VIDEO)&&s.videoTrack&&s.videoTrack.getProcessorStats().forEach(l=>{var p;null===(p=this.requestUpload)||void 0===p||p.call(this,l.type,l.stats)}),c.has(ut.AUDIO)&&s.audioTrack&&s.audioTrack.getProcessorStats().forEach(l=>{var p;null===(p=this.requestUpload)||void 0===p||p.call(this,l.type,l.stats)})})}}var tg;const f_="v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0\na=msid-semantic: WMS\na=ice-lite\nm=application 9 UDP/DTLS/SCTP webrtc-datachannel\nc=IN IP4 127.0.0.1\na=mid:0\n";let Sw=kn("RemoteSDP")(tg=class{get localCapabilities(){return en(this._localCapabilities)}get rtpCapabilities(){return en(this._rtpCapabilities)}get candidates(){return en(this._candidates)}get iceParameters(){return en(this._iceParameters)}get dtlsParameters(){return en(this._dtlsParameters)}constructor(t){b(this,"sessionDesc",void 0),b(this,"_localCapabilities",void 0),b(this,"_rtpCapabilities",void 0),b(this,"_candidates",void 0),b(this,"_iceParameters",void 0),b(this,"_dtlsParameters",void 0),b(this,"setup",void 0),b(this,"currentMidIndex",void 0),b(this,"cname",void 0),b(this,"firefoxSsrcMidMap",new Map),t=en(t);const{remoteIceParameters:i,remoteDtlsParameters:o,candidates:s,remoteRTPCapabilities:c,remoteSetup:l,localCapabilities:p,cname:h}=t,g=sr.exports.parse(f_);this._rtpCapabilities=c,this._candidates=s,this._iceParameters=i,this._dtlsParameters=o,this._localCapabilities=p,this.setup=l,this.cname=h;const f=this.rtpCapabilities.send;for(const A of g.mediaDescriptions){if(A.attributes.iceUfrag=i.iceUfrag,A.attributes.icePwd=i.icePwd,A.attributes.fingerprints=o.fingerprints,A.attributes.candidates=s,A.attributes.setup=l,"application"===A.media.mediaType&&(A.attributes.sctpPort="5000"),"video"===A.media.mediaType&&(A.media.fmts=f.videoCodecs.map(_=>_.payloadType.toString(10)),A.attributes.payloads=f.videoCodecs,A.attributes.extmaps=f.videoExtensions,J("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_,ssrcGroups:v}=Ms([{ssrcId:4e4,rtx:J("USE_RTX")?40001:void 0}],this.cname);A.attributes.ssrcs=_,A.attributes.ssrcGroups=v}if("audio"===A.media.mediaType&&(A.media.fmts=f.audioCodecs.map(_=>_.payloadType.toString(10)),A.attributes.payloads=f.audioCodecs,A.attributes.extmaps=f.audioExtensions,Ju(A),J("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_,ssrcGroups:v}=Ms([{ssrcId:2e4}],this.cname);A.attributes.ssrcs=_,A.attributes.ssrcGroups=v}}this.sessionDesc=g,this.currentMidIndex=g.mediaDescriptions.length-1}updateRemoteRTPCapabilities(t){const i=sr.exports.parse(f_);this._rtpCapabilities=t;const o=this.rtpCapabilities.send;for(const s of i.mediaDescriptions){if(s.attributes.iceUfrag=this._iceParameters.iceUfrag,s.attributes.icePwd=this._iceParameters.icePwd,s.attributes.fingerprints=this._dtlsParameters.fingerprints,s.attributes.candidates=this._candidates,s.attributes.setup=this.setup,"application"===s.media.mediaType&&(s.attributes.sctpPort="5000"),"video"===s.media.mediaType&&(s.media.fmts=o.videoCodecs.map(c=>c.payloadType.toString(10)),s.attributes.payloads=o.videoCodecs,s.attributes.extmaps=o.videoExtensions,J("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:c,ssrcGroups:l}=Ms([{ssrcId:4e4,rtx:J("USE_RTX")?40001:void 0}],this.cname);s.attributes.ssrcs=c,s.attributes.ssrcGroups=l}if("audio"===s.media.mediaType&&(s.media.fmts=o.audioCodecs.map(c=>c.payloadType.toString(10)),s.attributes.payloads=o.audioCodecs,s.attributes.extmaps=o.audioExtensions,J("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:c,ssrcGroups:l}=Ms([{ssrcId:2e4}],this.cname);s.attributes.ssrcs=c,s.attributes.ssrcGroups=l}}this.sessionDesc=i,this.currentMidIndex=i.mediaDescriptions.length-1}preloadRemoteMedia(t){const i=this.candidates,o=this.dtlsParameters,s=this.iceParameters,c=this.rtpCapabilities.send;for(let l=1;l<t;l++){const p=2*l+2e4,h=2*l+4e4,{ssrcs:g,ssrcGroups:f}=Ms([{ssrcId:p}],this.cname),{ssrcs:A,ssrcGroups:_}=Ms([{ssrcId:h,rtx:J("USE_RTX")?h+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:c.videoCodecs.map(v=>v.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:s.iceUfrag,icePwd:s.icePwd,unrecognized:[],candidates:i,extmaps:c.videoExtensions,fingerprints:o.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:A,ssrcGroups:_,rtcpFeedbackWildcards:[],payloads:c.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*l-1)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:c.audioCodecs.map(v=>v.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:s.iceUfrag,icePwd:s.icePwd,unrecognized:[],candidates:i,extmaps:c.audioExtensions,fingerprints:o.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:g,ssrcGroups:f,rtcpFeedbackWildcards:[],payloads:c.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*l)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return sr.exports.print(this.sessionDesc)}send(t,i,o,s){const{ssrcs:c,ssrcGroups:l}=Ms(i,this.cname,o),p=this.findPreloadMediaDesc(c);if(p){if(bn()&&this.firefoxSsrcMidMap.set(c[0].ssrcId,p.attributes.mid),s&&(s.tcc||s.remb)){const h=this.sessionDesc.mediaDescriptions.indexOf(p);return this.sessionDesc.mediaDescriptions[h]=this.mungSendMediaDesc(p,s),{mid:p.attributes.mid,needExchangeSDP:!0}}return{mid:p.attributes.mid,needExchangeSDP:!1}}{const h=this.findAvailableMediaIndex(t,c);if(Di()||Xb()||v1()){if(-1!==h&&2!==h){const g=en(this.sessionDesc.mediaDescriptions[h]);return g.attributes.direction="sendonly",g.attributes.ssrcs=c,g.attributes.ssrcGroups=l,this.sessionDesc.mediaDescriptions[h]=this.mungSendMediaDesc(g,s),{mid:g.attributes.mid,needExchangeSDP:!0}}{const g=this.createOrRecycleSendMedia(t,c,l,"sendonly",s);return this.updateBundleMids(),{mid:g.attributes.mid,needExchangeSDP:!0}}}if(-1!==h){const g=en(this.sessionDesc.mediaDescriptions[h]);return g.attributes.direction="sendonly",g.attributes.ssrcs=c,g.attributes.ssrcGroups=l,this.sessionDesc.mediaDescriptions[h]=this.mungSendMediaDesc(g,s),bn()&&this.firefoxSsrcMidMap.set(c[0].ssrcId,g.attributes.mid),{mid:g.attributes.mid,needExchangeSDP:!0}}{const g=this.createOrRecycleSendMedia(t,c,l,"sendonly",s);return this.updateBundleMids(),bn()&&this.firefoxSsrcMidMap.set(c[0].ssrcId,g.attributes.mid),{mid:g.attributes.mid,needExchangeSDP:!0}}}}batchSend(t){const i=t.map(c=>{let{kind:l,ssrcMsg:p,mslabel:h}=c;return this.send(l,p,h)}),o=[];let s=!1;return i.forEach(c=>{let{mid:l,needExchangeSDP:p}=c;p&&(s=!0),o.push(l)}),{mids:o,needExchangeSDP:s}}stopSending(t){const i=this.sessionDesc.mediaDescriptions.filter(o=>o.attributes.mid&&-1!==t.indexOf(o.attributes.mid));if(i.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");i.forEach(o=>{"0"===o.attributes.mid||bn()||Di()||Xb()||v1()?o.attributes.ssrcs=[]:(o.attributes.ssrcs=[],o.attributes.direction="inactive",o.media.port="0")}),this.updateBundleMids()}mute(t){const i=this.sessionDesc.mediaDescriptions.find(o=>o.attributes.mid===t);if(!i)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.mute."));i.attributes.direction="inactive"}unmute(t){const i=this.sessionDesc.mediaDescriptions.find(o=>o.attributes.mid===t);if(!i)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.unmute."));i.attributes.direction="sendonly"}muteRemote(t){const i=this.sessionDesc.mediaDescriptions.filter(o=>t.includes(o.attributes.mid||""));if(i.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");i.forEach(o=>{o.attributes.direction="inactive"})}unmuteRemote(t){const i=this.sessionDesc.mediaDescriptions.filter(o=>t.includes(o.attributes.mid||""));if(i.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");i.forEach(o=>{o.attributes.direction="recvonly"})}receive(t,i,o,s){t.forEach((c,l)=>{this.createOrRecycleRecvMedia(c,[],"recvonly",i,o,s[l])}),this.updateBundleMids()}stopReceiving(t){const i=this.sessionDesc.mediaDescriptions.filter(o=>-1!==t.indexOf(o.attributes.mid));if(i.length!==t.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");i.forEach(o=>{o.media.port="0",o.attributes.direction="inactive"}),this.updateBundleMids()}restartICE(t){t=en(t),this._iceParameters=t,this.sessionDesc.mediaDescriptions.forEach(i=>{i.attributes.iceUfrag=t.iceUfrag,i.attributes.icePwd=t.icePwd})}predictReceivingMids(t){const i=[];for(let o=0;o<t;o++)i.push((this.currentMidIndex+o+1).toString(10));return i}findAvailableMediaIndex(t,i){return this.sessionDesc.mediaDescriptions.findIndex(o=>{const s=o.media.mediaType===t&&"0"!==o.media.port&&("sendonly"===o.attributes.direction||"sendrecv"===o.attributes.direction)&&0===o.attributes.ssrcs.length;if(bn()){if(s){const c=this.firefoxSsrcMidMap.get(i[0].ssrcId);return!(c||"0"!==o.attributes.mid&&"1"!==o.attributes.mid)||!(!c||c!==o.attributes.mid)}return!1}return s})}createOrRecycleRecvMedia(t,i,o,s,c,l){const p=t._mediaStreamTrack.kind,h=this.rtpCapabilities.recv,g=this.localCapabilities.send;let f=[];if(p===ut.VIDEO){var A,_;if(J("H264_PROFILE_LEVEL_ID")&&"h264"===s&&(f=h.videoCodecs.filter(D=>{var O,P;return((null===(O=D.rtpMap)||void 0===O?void 0:O.encodingName.toLowerCase())||"").includes(s)&&(null==D||null===(P=D.fmtp)||void 0===P?void 0:P.parameters["profile-level-id"])===J("H264_PROFILE_LEVEL_ID")})),!f||0===(null===(A=f)||void 0===A?void 0:A.length)){const D=g.videoCodecs.filter(O=>{var P;return((null===(P=O.rtpMap)||void 0===P?void 0:P.encodingName.toLowerCase())||"").includes(s)});0!==D.length&&(f=h.videoCodecs.filter(O=>D.some(P=>P.payloadType===O.payloadType)))}if(J("USE_RTX")){const D=f.map(P=>P.payloadType.toString()),O=h.videoCodecs.filter(P=>{var B,G;return"rtx"===(null===(B=P.rtpMap)||void 0===B?void 0:B.encodingName)&&D.includes((null===(G=P.fmtp)||void 0===G?void 0:G.parameters.apt)||"")});f=[...f,...O]}0===f.length&&(N.warning("codec ".concat(s," not included in rtpCapabilities, fallback to default payloads: ").concat(null===(_=h.videoCodecs[0].rtpMap)||void 0===_?void 0:_.encodingName)),f=h.videoCodecs)}else f=h.audioCodecs.filter(D=>{var O;return((null===(O=D.rtpMap)||void 0===O?void 0:O.encodingName.toLowerCase())||"").includes(c)}),0===f.length&&(N.warning("codec ".concat(c," not included in rtpCapabilities, fallback to opus")),f=h.audioCodecs.filter(D=>{var O;return((null===(O=D.rtpMap)||void 0===O?void 0:O.encodingName.toLowerCase())||"").includes("opus")}));const v=p===ut.VIDEO?h.videoExtensions:h.audioExtensions;this.currentMidIndex+=1;const y="".concat(this.currentMidIndex);let S={media:{mediaType:p,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:f.map(D=>D.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:v,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:i,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:f,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:o,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(y)}};S=this.mungRecvMediaDsec(S,t,l);const R=this.findFirstClosedMedia(p);if(R){const D=this.sessionDesc.mediaDescriptions.indexOf(R);this.sessionDesc.mediaDescriptions[D]=S}else this.sessionDesc.mediaDescriptions.push(S);return S}createOrRecycleSendMedia(t,i,o,s,c){const l=this.rtpCapabilities.send,p=t===ut.VIDEO?l.videoCodecs:l.audioCodecs,h=t===ut.VIDEO?l.videoExtensions:l.audioExtensions;this.currentMidIndex+=1;const g="".concat(this.currentMidIndex);let f={media:{mediaType:t,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:p.map(_=>_.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:h,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:i,ssrcGroups:o,rtcpFeedbackWildcards:[],payloads:p,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:s,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(g)}};f=this.mungSendMediaDesc(f,c);const A=this.findFirstClosedMedia(t);if(A){const _=this.sessionDesc.mediaDescriptions.indexOf(A);this.sessionDesc.mediaDescriptions[_]=f}else this.sessionDesc.mediaDescriptions.push(f);return f}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(t=>"0"!==t.media.port).map(t=>t.attributes.mid)}mungRecvMediaDsec(t,i,o){const s=en(t);return _w(s),Zf(s,i),Ew(s,i),GF(s),OC(s,o,this.localCapabilities.send),s}mungSendMediaDesc(t,i){const o=en(t);return OC(o,i,this.localCapabilities.recv),Ju(o),o}updateRecvMedia(t,i){const o=this.sessionDesc.mediaDescriptions.findIndex(s=>s.attributes.mid===t);if(-1!==o){const s=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[o],i);this.sessionDesc.mediaDescriptions[o]=s}}bumpMid(t){this.currentMidIndex+=t}findFirstClosedMedia(t){return this.sessionDesc.mediaDescriptions.find(i=>bn()?"0"===i.media.port&&i.media.mediaType===t:"0"===i.media.port)}findPreloadMediaDesc(t){return this.sessionDesc.mediaDescriptions.find(i=>{var o,s;return(null===(o=i.attributes)||void 0===o||null===(s=o.ssrcs[0])||void 0===s?void 0:s.ssrcId)===t[0].ssrcId})}getSSRC(t){var i;return null===(i=this.sessionDesc.mediaDescriptions.find(o=>o.attributes.mid===t))||void 0===i?void 0:i.attributes.ssrcs}})||tg;var qF,Qt;function JF(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function MC(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?JF(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):JF(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}let zF=kn("NVExtentionsConnection","store.p2pId")((Te((Qt=class tH extends gm{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(i,o,s){super(i,o),b(this,"store",void 0),b(this,"peerConnection",void 0),b(this,"remoteSDP",void 0),b(this,"initialOffer",void 0),b(this,"transportEventReceiver",void 0),b(this,"statsFilter",void 0),b(this,"useRTX",J("USE_RTX")),b(this,"localCapabilities",void 0),b(this,"localCandidateCount",0),b(this,"allCandidatesReceived",!1),b(this,"mutex",new eo("NVExtentionsConnection-mutex")),b(this,"rtcMedia",void 0),this.store=o,this.peerConnection=s,this.statsFilter=he(this.peerConnection,void 0,void 0,bn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}establish(i){var o=this;return U(function*(){try{const s=yield o.peerConnection.createOffer();if(!s.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const c=kh(s.sdp),l=yield WF(!o.useRTX,J("FILTER_VIDEO_FEC"),J("FILTER_AUDIO_FEC"));return o.localCapabilities=l,o.initialOffer=s,MC(MC({},c),{},{rtpCapabilities:l,offerSDP:s.sdp})}catch(s){throw new V(L.GET_LOCAL_CONNECTION_PARAMS_FAILED,s.toString())}})()}connect(i,o,s,c,l,p){var h=this;return U(function*(){try{if(!h.initialOffer)throw new Error("Cannot establish NVConnection without initial offer.");h.remoteSDP=new Sw({remoteIceParameters:i,remoteDtlsParameters:o,candidates:s,remoteRTPCapabilities:c,remoteSetup:l,localCapabilities:Cw(h.localCapabilities),cname:p});const g=h.remoteSDP.toString(),f=sr.exports.parse(h.initialOffer.sdp),A=f.mediaDescriptions.find(y=>"audio"===y.media.mediaType);A&&Ju(A);const _=sr.exports.print(f),v=h.logSDPExchange(_||"","offer","local","connect");yield h.peerConnection.setLocalDescription({type:"offer",sdp:_}),v?.(g),yield h.peerConnection.setRemoteDescription({type:"answer",sdp:g})}catch(g){throw new V(L.EXCHANGE_SDP_FAILED,"NV.connect failed; ".concat(g.toString()))}})()}updateRemoteConnect(i){var o=this;return U(function*(){var s,c,l;null===(s=o.remoteSDP)||void 0===s||s.updateRemoteRTPCapabilities(i),null===(c=o.remoteSDP)||void 0===c||c.preloadRemoteMedia(2);const p=null===(l=o.remoteSDP)||void 0===l?void 0:l.toString();yield o.peerConnection.setRemoteDescription({type:"offer",sdp:p});const h=yield o.peerConnection.createAnswer();yield o.peerConnection.setLocalDescription(h),N.debug("[NVExtentionsConnection] updateRemoteRTPCapabilities by exchanging SDP.")})()}send(i,o,s){var c=this;return ha(function*(){const l=yield It(c.mutex.lock("From NVExtentionsConnection.send"));try{if(!c.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.send before remote SDP created");const p=[];i.forEach(R=>{const D=c.peerConnection.addTransceiver(R._mediaStreamTrack,{direction:"sendonly"});p.push(D)}),bn()&&!0===J("SIMULCAST")&&(Re("debug",c,"apply simulcast for firefox"),yield It(c.applySimulcastForFirefox(p,i)));const h=yield It(c.peerConnection.createOffer()),g=c.remoteSDP.predictReceivingMids(i.length),f=c.mungSendOfferSDP(h.sdp,i,g),A=sr.exports.parse(f),_=g.map(R=>{const D=A.mediaDescriptions.find(O=>O.attributes.mid===R);if(!D)throw new Error("Cannot extract ssrc from mediaDescription.");return jF(D,c.useRTX)});let v;try{v=yield _}catch(R){v=[],c.remoteSDP.receive(i,o,s,v);const D=c.remoteSDP.toString();throw yield It(c.peerConnection.setLocalDescription({type:"offer",sdp:f})),yield It(c.peerConnection.setRemoteDescription({type:"answer",sdp:D})),yield It(c.stopSending(g,!0)),R}c.remoteSDP.receive(i,o,s,v);const y=c.remoteSDP.toString(),S=c.logSDPExchange(f,"offer","local","send");return yield It(c.peerConnection.setLocalDescription({type:"offer",sdp:f})),yield It(c.applySimulcastEncodings(p,i)),yield It(c.applySendEncodings(p,i)),S?.(y),yield It(c.peerConnection.setRemoteDescription({type:"answer",sdp:y})),p.map((R,D)=>({localSSRC:_[D],id:g[D],transceiver:R}))}catch(p){throw p instanceof V?p:new V(L.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.send failed; ".concat(p.toString()))}finally{l()}})()}stopSending(i,o){var s=this;return U(function*(){const c=o?void 0:yield s.mutex.lock("From NVExtentionsConnection.stopSending");try{if(!s.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopSending before remote SDP created");const l=s.peerConnection.getTransceivers().filter(f=>-1!==i.indexOf(f.mid));if(l.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call NVExtentionsConnection.stopSending.");l.map(f=>{var A;f.direction="inactive",null===(A=f.stop)||void 0===A||A.call(f)});const p=yield s.peerConnection.createOffer(),h=s.logSDPExchange(p.sdp||"","offer","local","stopSending");yield s.peerConnection.setLocalDescription(p),s.remoteSDP.stopReceiving(i);const g=s.remoteSDP.toString();h?.(g),yield s.peerConnection.setRemoteDescription({type:"answer",sdp:g})}catch(l){throw new V(L.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.stopSending failed; ".concat(l.toString()))}finally{c&&c()}})()}receive(i,o,s,c){var l=this;return U(function*(){try{if(!l.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.receive ".concat(i," before remoteSDP created."));const{mid:p,needExchangeSDP:h}=l.remoteSDP.send(i,o,s,c);if(h){const f=l.remoteSDP.toString(),A=l.logSDPExchange(f,"offer","remote","receive");yield l.peerConnection.setRemoteDescription({type:"offer",sdp:f});const _=yield l.peerConnection.createAnswer(),v=l.mungReceiveAnswerSDP(_.sdp,p,i);A?.(v||""),yield l.peerConnection.setLocalDescription({type:"answer",sdp:v}),N.debug("[NVExtentionsConnection] receive ".concat(i," by exchanging SDP."))}else N.debug("[NVExtentionsConnection] receive ".concat(i," no need to exchange SDP."));const g=l.peerConnection.getTransceivers().find(f=>f.mid===p);if(!g)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:g.receiver.track,id:p}}catch(p){throw new V(L.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(p.toString()))}})()}batchReceive(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.batchReceive before remoteSDP created.");const{mids:s,needExchangeSDP:c}=o.remoteSDP.batchSend(i);if(c){const l=o.remoteSDP.toString(),p=o.logSDPExchange(l,"offer","remote","receive");yield o.peerConnection.setRemoteDescription({type:"offer",sdp:l});const h=yield o.peerConnection.createAnswer();p?.(h.sdp||""),yield o.peerConnection.setLocalDescription(h),N.debug("[NVExtentionsConnection] batchReceive by exchanging SDP.")}else N.debug("[NVExtentionsConnection] batchReceive no need to exchange SDP.");return s.map(l=>{const p=o.peerConnection.getTransceivers().find(h=>h.mid===l);if(!p)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:p.receiver.track,id:l}})}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(s.toString()))}})()}stopReceiving(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopReceiving before remote SDP created.");o.remoteSDP.stopSending(i);const s=o.remoteSDP.toString(),c=o.logSDPExchange(s,"offer","remote","stopReceiving");yield o.peerConnection.setRemoteDescription({type:"offer",sdp:s});const l=yield o.peerConnection.createAnswer();c?.(l.sdp||""),yield o.peerConnection.setLocalDescription(l)}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"NVExtentionsConnection stopReceiving failed; ".concat(s.toString()))}})()}muteRemote(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteRemote mid=".concat(i," before remote SDP created."));o.remoteSDP.mute(i);const s=o.remoteSDP.toString(),c=o.logSDPExchange(s,"offer","remote","muteRemote");yield o.peerConnection.setRemoteDescription({type:"offer",sdp:s});const l=yield o.peerConnection.createAnswer();c?.(l.sdp||""),yield o.peerConnection.setLocalDescription(l)}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteRemote failed; ".concat(s.toString()))}})()}unmuteRemote(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteRemote mid=".concat(i," before remote SDP created."));o.remoteSDP.unmute(i);const s=o.remoteSDP.toString(),c=o.logSDPExchange(s,"offer","remote","unmuteRemote");yield o.peerConnection.setRemoteDescription({type:"offer",sdp:s});const l=yield o.peerConnection.createAnswer();c?.(l.sdp||""),yield o.peerConnection.setLocalDescription(l)}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteRemote failed; ".concat(s.toString()))}})()}muteLocal(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteLocal before remote SDP created.");const s=o.peerConnection.getTransceivers().filter(h=>h.mid&&-1!==i.indexOf(h.mid));if(s.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(h=>{h.direction="inactive"});const c=yield o.peerConnection.createOffer(),l=o.logSDPExchange(c.sdp||"","offer","local","muteLocal");yield o.peerConnection.setLocalDescription(c),o.remoteSDP.muteRemote(i);const p=o.remoteSDP.toString();l?.(p),yield o.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteLocal failed; ".concat(s.toString()))}})()}unmuteLocal(i){var o=this;return U(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteLocal before remote SDP created.");const s=o.peerConnection.getTransceivers().filter(h=>h.mid&&-1!==i.indexOf(h.mid));if(s.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(function(){var h=U(function*(g,f){g.direction="sendonly"});return function(g,f){return h.apply(this,arguments)}}());const c=yield o.peerConnection.createOffer(),l=o.logSDPExchange(c.sdp||"","offer","local","unmuteLocal");yield o.peerConnection.setLocalDescription(c),o.remoteSDP.unmuteRemote(i);const p=o.remoteSDP.toString();l?.(p),yield o.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(s){throw new V(L.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteLocal failed; ".concat(s.toString()))}})()}restartICE(){var i=this;return ha(function*(){const o=yield It(i.mutex.lock("From NVExtentionsConnection.restartICE"));try{const s=yield It(i.peerConnection.createOffer({iceRestart:!0}));if(!s.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const c=kh(s.sdp),{remoteIceParameters:l}=yield c.iceParameters;if(!i.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");i.remoteSDP.restartICE(l);const p=i.remoteSDP.toString(),h=i.logSDPExchange(s.sdp||"","offer","local","restartICE");yield It(i.peerConnection.setLocalDescription(s)),h?.(p),yield It(i.peerConnection.setRemoteDescription({type:"answer",sdp:p}))}catch(s){N.warning("restart ICE failed, abort operation",s)}finally{o()}})()}close(){var i;null===(i=this.onConnectionStateChange)||void 0===i||i.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(i){return this.statsFilter.getVideoIsReady(i)}updateEncoderConfig(i,o){var s=this;return U(function*(){try{if(!s.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.updateEncoderConfig before remote SDP created.");const c=yield s.peerConnection.createOffer(),l=s.mungSendOfferSDP(c.sdp,[o],[i]);s.remoteSDP.updateRecvMedia(i,o);const p=s.remoteSDP.toString(),h=s.logSDPExchange(l,"offer","local","updateEncoderConfig");yield s.peerConnection.setLocalDescription({type:"offer",sdp:l}),h?.(p),yield s.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(c){throw new V(L.EXCHANGE_SDP_FAILED,c.toString())}})()}updateSendParameters(i,o){var s=this;return U(function*(){const c=s.peerConnection.getTransceivers().filter(l=>l.mid===i);1===c.length&&(s.isVP8Simulcast(o)?bn()||(yield s.applySimulcastEncodings(c,[o])):yield s.applySendEncodings(c,[o]))})()}setStatsRemoteVideoIsReady(i,o){this.statsFilter.setVideoIsReady2(i,o)}replaceTrack(i,o){var s=this;return U(function*(){const c=s.peerConnection.getTransceivers().find(l=>l.mid===o);c&&(yield c.sender.replaceTrack(i._mediaStreamTrack))})()}getP2PConnectionParams(){var i;if(null===(i=this.peerConnection.currentLocalDescription)||void 0===i||!i.sdp||!this.localCapabilities)throw new Error;return MC(MC({},kh(this.peerConnection.currentLocalDescription.sdp)),{},{rtpCapabilities:this.localCapabilities})}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var i;null===(i=this.onICEConnectionStateChange)||void 0===i||i.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var i;null===(i=this.onConnectionStateChange)||void 0===i||i.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=i=>{i.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,N.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,N.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},J("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(i){const o={iceServers:[]};return i.iceServers?o.iceServers=i.iceServers:i.turnServer&&"off"!==i.turnServer.mode&&(oh(i.turnServer.servers)?o.iceServers=i.turnServer.servers:(o.iceServers&&o.iceServers.push(...tH.turnServerConfigToIceServers(i.turnServer.servers)),J("USE_TURN_SERVER_OF_GATEWAY")&&o.iceServers&&i.turnServer.serversFromGateway&&o.iceServers.push(...tH.turnServerConfigToIceServers(i.turnServer.serversFromGateway)),J("FORCE_TURN_TCP")?o.iceTransportPolicy="relay":i.turnServer.servers.concat(i.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(o.iceTransportPolicy="relay")}))),o}static turnServerConfigToIceServers(i){const o=[];return i.forEach(s=>{s.security?s.tcpport&&o.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(Eh(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&!J("FORCE_TURN_TCP")&&o.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&o.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),o}applySendEncodings(i,o){var s=this;return U(function*(){try{if(!Vr().supportSetRtpSenderParameters||i.length!==o.length)return;for(let A=0;A<i.length;A++){const _=i[A],v=o[A];if(v&&v instanceof dr){var c,l;if(s.isVP8Simulcast(v))continue;const y={},S={};switch(v._optimizationMode){case"motion":y.degradationPreference="maintain-framerate";break;case"detail":y.degradationPreference="maintain-resolution";break;default:y.degradationPreference="balanced"}var p,h,g,f;if(null!==(c=v._encoderConfig)&&void 0!==c&&c.bitrateMax&&(S.maxBitrate=1e3*(null===(p=v._encoderConfig)||void 0===p?void 0:p.bitrateMax)),v._hints.includes(br.LOW_STREAM)&&(null!==(h=v._encoderConfig)&&void 0!==h&&h.frameRate&&(S.maxFramerate=Qu(v._encoderConfig.frameRate)),null!==(g=v._encoderConfig)&&void 0!==g&&g.scaleResolutionDownBy&&(null===(f=v._encoderConfig)||void 0===f?void 0:f.scaleResolutionDownBy)>1&&(S.scaleResolutionDownBy=v._encoderConfig.scaleResolutionDownBy)),J("DSCP_TYPE")&&eh()){const O=J("DSCP_TYPE");["very-low","low","medium","high"].includes(O)&&(S.networkPriority=O)}const R=_.sender.getParameters(),D=null===(l=R.encodings)||void 0===l?void 0:l[0];bn()&&!D&&(y.encodings=[S]),D&&Object.assign(D,S),Object.assign(R,y),yield _.sender.setParameters(R)}}}catch{N.debug("Apply RTPSendEncodings failed.")}})()}mungSendOfferSDP(i,o,s){const c=sr.exports.parse(i);return o.forEach((l,p)=>{const h=s[p],g=c.mediaDescriptions.find(f=>f.attributes.mid===h);g&&(Zf(g,l),HF(g,l,this.store.codec))}),sr.exports.print(c)}mungReceiveAnswerSDP(i,o,s){const c=sr.exports.parse(i),l=c.mediaDescriptions.find(p=>p.attributes.mid===o);return l&&s===ut.AUDIO&&"audio"===l.media.mediaType&&Ju(l),sr.exports.print(c)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=i=>{var o;null===(o=this.onFirstAudioReceived)||void 0===o||o.call(this,i)},this.statsFilter.onFirstVideoReceived=i=>{var o;null===(o=this.onFirstVideoReceived)||void 0===o||o.call(this,i)},this.statsFilter.onFirstAudioDecoded=i=>{var o;null===(o=this.onFirstAudioDecoded)||void 0===o||o.call(this,i)},this.statsFilter.onFirstVideoDecoded=(i,o,s)=>{var c;null===(c=this.onFirstVideoDecoded)||void 0===c||c.call(this,i,o,s)},this.statsFilter.onSelectedLocalCandidateChanged=(i,o)=>{var s;null===(s=this.onSelectedLocalCandidateChanged)||void 0===s||s.call(this,i,o)},this.statsFilter.onSelectedRemoteCandidateChanged=(i,o)=>{var s;null===(s=this.onSelectedRemoteCandidateChanged)||void 0===s||s.call(this,i,o)},this.statsFilter.onFirstVideoDecodedTimeout=i=>{var o;null===(o=this.onFirstVideoDecodedTimeout)||void 0===o||o.call(this,i)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}applySimulcastForFirefox(i,o){var s=this;return U(function*(){if(i.length===o.length)for(let g=0;g<i.length;g++){var c,l,p,h;const f=i[g],A=o[g];if(A instanceof dr&&!A._hints.includes(br.LOW_STREAM)&&null!==(c=A._encoderConfig)&&void 0!==c&&c.bitrateMax&&(null===(l=A._encoderConfig)||void 0===l?void 0:l.bitrateMax)>200&&null!==(p=A._scalabiltyMode)&&void 0!==p&&p.numSpatialLayers&&(null===(h=A._scalabiltyMode)||void 0===h?void 0:h.numSpatialLayers)>1&&"vp8"===s.store.codec){const _={},v={high:1e3*(A._encoderConfig.bitrateMax-50),medium:5e4};_.encodings=[{rid:"m",active:!0,maxBitrate:v.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:v.high}];const y=f.sender.getParameters();yield f.sender.setParameters(Object.assign(y,_))}}})()}applySimulcastEncodings(i,o){var s=this;return U(function*(){if(!bn()&&i.length===o.length)for(let c=0;c<i.length;c++){const l=o[c];if(l instanceof dr&&s.isVP8Simulcast(l)){const p=i[c],h={},g={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:g.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:g.medium,scaleResolutionDownBy:4}];const f=p.sender.getParameters();yield p.sender.setParameters(Object.assign(f,h))}}})()}isVP8Simulcast(i){var o,s,c,l;return!!(i instanceof dr&&J("SIMULCAST")&&"vp8"===this.store.codec&&!i._hints.includes(br.LOW_STREAM)&&null!==(o=i._encoderConfig)&&void 0!==o&&o.bitrateMax&&(null===(s=i._encoderConfig)||void 0===s?void 0:s.bitrateMax)>200&&null!==(c=i._scalabiltyMode)&&void 0!==c&&c.numSpatialLayers&&(null===(l=i._scalabiltyMode)||void 0===l?void 0:l.numSpatialLayers)>1)}logSDPExchange(i,o,s,c){if(J("SDP_LOGGING"))return N.upload("exchanging ".concat(s," ").concat(o," SDP during NVExtentionsConnection.").concat(c,"\n"),i),"offer"===o?l=>{this.logSDPExchange(l,"answer","local"===s?"remote":"local",c)}:void 0}getRemoteSSRC(i){var o=this;return U(function*(){if(o.remoteSDP)return o.remoteSDP.getSSRC(i)?.[0].ssrcId})()}}).prototype,"connect",[Vo],Object.getOwnPropertyDescriptor(Qt.prototype,"connect"),Qt.prototype),Te(Qt.prototype,"updateRemoteConnect",[Vo],Object.getOwnPropertyDescriptor(Qt.prototype,"updateRemoteConnect"),Qt.prototype),Te(Qt.prototype,"receive",[Vo],Object.getOwnPropertyDescriptor(Qt.prototype,"receive"),Qt.prototype),Te(Qt.prototype,"batchReceive",[Vo],Object.getOwnPropertyDescriptor(Qt.prototype,"batchReceive"),Qt.prototype),Te(Qt.prototype,"stopReceiving",[Vo],Object.getOwnPropertyDescriptor(Qt.prototype,"stopReceiving"),Qt.prototype),Te(Qt.prototype,"muteRemote",[Vo],Object.getOwnPropertyDescriptor(Qt.prototype,"muteRemote"),Qt.prototype),Te(Qt.prototype,"unmuteRemote",[Vo],Object.getOwnPropertyDescriptor(Qt.prototype,"unmuteRemote"),Qt.prototype),Te(Qt.prototype,"muteLocal",[Vo],Object.getOwnPropertyDescriptor(Qt.prototype,"muteLocal"),Qt.prototype),Te(Qt.prototype,"unmuteLocal",[Vo],Object.getOwnPropertyDescriptor(Qt.prototype,"unmuteLocal"),Qt.prototype),Te(Qt.prototype,"close",[Vo],Object.getOwnPropertyDescriptor(Qt.prototype,"close"),Qt.prototype),Te(Qt.prototype,"updateEncoderConfig",[Vo],Object.getOwnPropertyDescriptor(Qt.prototype,"updateEncoderConfig"),Qt.prototype),Te(Qt.prototype,"updateSendParameters",[Vo],Object.getOwnPropertyDescriptor(Qt.prototype,"updateSendParameters"),Qt.prototype),Te(Qt.prototype,"replaceTrack",[Vo],Object.getOwnPropertyDescriptor(Qt.prototype,"replaceTrack"),Qt.prototype),Te(Qt.prototype,"getRemoteSSRC",[Vo],Object.getOwnPropertyDescriptor(Qt.prototype,"getRemoteSSRC"),Qt.prototype),qF=Qt))||qF;function Vo(t,i,o){const s=t[i];if("function"!=typeof s)throw new Error("Cannot use mutex on object property.");return o.value=U(function*(){const c=this.mutex,l=yield c.lock("From NVExtentionsConnection.".concat(i));try{for(var p=arguments.length,h=new Array(p),g=0;g<p;g++)h[g]=arguments[g];return yield s.apply(this,h)}finally{l()}}),o}var $F,un;function td(t){var i,o,s,c=2;for(typeof Symbol<"u"&&(o=LF,s=Symbol.iterator);c--;){if(o&&null!=(i=t[o]))return i.call(t);if(s&&null!=(i=t[s]))return new ng(i.call(t));o="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function ng(t){function i(o){if(Object(o)!==o)return Ie.reject(new TypeError(o+" is not an object."));var s=o.done;return Ie.resolve(o.value).then(function(c){return{value:c,done:s}})}return(ng=function(o){this.s=o,this.n=o.next}).prototype={s:null,n:null,next:function(){return i(this.n.apply(this.s,arguments))},return:function(o){var s=this.s.return;return void 0===s?Ie.resolve({value:o,done:!0}):i(s.apply(this.s,arguments))},throw:function(o){var s=this.s.return;return void 0===s?Ie.reject(o):i(s.apply(this.s,arguments))}},new ng(t)}let kC=kn("DataChannelConnection","store.dcId")((Te((un=class iU extends gm{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(i,o){super(i,o),b(this,"store",void 0),b(this,"peerConnection",void 0),b(this,"cname",void 0),b(this,"mutex",new eo("DataChannelConnection-mutex")),b(this,"dataChannel",void 0),b(this,"_p2pConnection",void 0),b(this,"_nvMedia",void 0),this.store=o,this.store.dcId=this.store.dcId+1,this.peerConnection=new RTCPeerConnection(iU.resolvePCConfiguration(i),{optional:[{googDscp:!0}]}),this.dataChannel=this.peerConnection.createDataChannel("agora-signal",{ordered:!1,maxPacketLifeTime:50}),this.dataChannel.binaryType="arraybuffer",this._p2pConnection=new zF(i,o,this.peerConnection),this.bindPCEvents()}establish(){var i=this;return U(function*(){var o;const s=null===(o=i._nvMedia)||void 0===o?void 0:o.getLocalRtpCapabilities();return yield i._p2pConnection.establish(s)})()}getP2PConnectionParams(){return this._p2pConnection.getP2PConnectionParams()}connect(i,o,s,c,l,p){var h=this;return U(function*(){return h.cname=p,yield h._p2pConnection.connect(i,o,s,c,l,p),yield new Ie((g,f)=>{const A=setTimeout(()=>{h.closeSignal(),f(new V(L.DATACHANNEL_CONNECTION_TIMEOUT,"Datachannel connection timed out, candidates: ".concat(JSON.stringify(s))))},2e3);h.dataChannel.onopen=()=>{if("open"===h.dataChannel.readyState)return clearTimeout(A),void g()},h.dataChannel.onerror=_=>{h.closeSignal(),f(_)}}),{transmitter:h.dataChannel,close:h.closeSignal.bind(h)}})()}send(i,o,s){var c=this;return ha(function*(){const l=yield It(c.mutex.lock("From DataChannelConnection.send"));try{return yield*l_(td(c._p2pConnection.send(i,o,s)),It)}finally{l()}})()}stopSending(i,o){var s=this;return U(function*(){return s._p2pConnection.stopSending(i,o)})()}receive(i,o,s,c){var l=this;return U(function*(){return l._nvMedia?(N.debug("[DataChannelConnection] receive ".concat(i," by DataChannel.")),yield l._nvMedia.reveiveByRTCMedia(i,o,l.cname)):(N.debug("[DataChannelConnection] receive ".concat(i," by WebRTC.")),yield l._p2pConnection.receive(i,o,s,c))})()}batchReceive(i){var o=this;return U(function*(){return[...yield o._p2pConnection.batchReceive(i)]})()}stopReceiving(i){var o=this;return U(function*(){return yield o._p2pConnection.stopReceiving(i)})()}muteRemote(i){var o=this;return U(function*(){return yield o._p2pConnection.muteRemote(i)})()}unmuteRemote(i){var o=this;return U(function*(){return yield o._p2pConnection.unmuteRemote(i)})()}muteLocal(i){var o=this;return U(function*(){return yield o._p2pConnection.muteLocal(i)})()}unmuteLocal(i){var o=this;return U(function*(){return yield o._p2pConnection.unmuteLocal(i)})()}restartICE(){var i=this;return ha(function*(){return yield*l_(td(i._p2pConnection.restartICE()),It)})()}close(){var i;null===(i=this._nvMedia)||void 0===i||i.close(),this._p2pConnection.close(),this.unbindConnectionEvents(this._p2pConnection)}getStats(){return this._p2pConnection.getStats()}getRemoteVideoIsReady(i){return this._p2pConnection.getRemoteVideoIsReady(i)}updateRemoteConnect(i){var o;null===(o=this._nvMedia)||void 0===o||o.setRemoteRtpCapabilities(i),this._p2pConnection.updateRemoteConnect(i)}updateEncoderConfig(i,o){var s=this;return U(function*(){return yield s._p2pConnection.updateEncoderConfig(i,o)})()}updateSendParameters(i,o){var s=this;return U(function*(){return yield s._p2pConnection.updateSendParameters(i,o)})()}setStatsRemoteVideoIsReady(i,o){this._p2pConnection.setStatsRemoteVideoIsReady(i,o)}replaceTrack(i,o){var s=this;return U(function*(){return yield s._p2pConnection.replaceTrack(i,o)})()}getRemoteSSRC(i){var o=this;return U(function*(){return o._p2pConnection.getRemoteSSRC(i)})()}logSDPExchange(i,o,s,c){if(J("SDP_LOGGING"))return N.upload("exchanging ".concat(s," ").concat(o," SDP during DataChannelConnection.").concat(c,"\n"),i),"offer"===o?l=>{this.logSDPExchange(l,"answer","local"===s?"remote":"local",c)}:void 0}static resolvePCConfiguration(i){const o={iceServers:[]};return i.iceServers?o.iceServers=i.iceServers:i.turnServer&&"off"!==i.turnServer.mode&&(oh(i.turnServer.servers)?o.iceServers=i.turnServer.servers:(o.iceServers&&o.iceServers.push(...iU.turnServerConfigToIceServers(i.turnServer.servers)),J("USE_TURN_SERVER_OF_GATEWAY")&&o.iceServers&&i.turnServer.serversFromGateway&&o.iceServers.push(...iU.turnServerConfigToIceServers(i.turnServer.serversFromGateway)),J("FORCE_TURN_TCP")?o.iceTransportPolicy="relay":i.turnServer.servers.concat(i.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(o.iceTransportPolicy="relay")}))),o}static turnServerConfigToIceServers(i){const o=[];return i.forEach(s=>{s.security?s.tcpport&&o.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(Eh(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&!J("FORCE_TURN_TCP")&&o.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&o.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),o}bindPCEvents(){this._p2pConnection.onICEConnectionStateChange=i=>{var o;return null===(o=this.onICEConnectionStateChange)||void 0===o?void 0:o.call(this,i)},this._p2pConnection.onConnectionStateChange=i=>{var o;return null===(o=this.onConnectionStateChange)||void 0===o?void 0:o.call(this,i)},this._p2pConnection.onDTLSTransportStateChange=i=>{var o;return null===(o=this.onDTLSTransportStateChange)||void 0===o?void 0:o.call(this,i)},this._p2pConnection.onDTLSTransportError=i=>{var o;return null===(o=this.onDTLSTransportError)||void 0===o?void 0:o.call(this,i)},this._p2pConnection.onICETransportStateChange=i=>{var o;return null===(o=this.onICETransportStateChange)||void 0===o?void 0:o.call(this,i)},this._p2pConnection.onFirstAudioReceived=i=>{var o;return null===(o=this.onFirstAudioReceived)||void 0===o?void 0:o.call(this,i)},this._p2pConnection.onFirstVideoReceived=i=>{var o;return null===(o=this.onFirstVideoReceived)||void 0===o?void 0:o.call(this,i)},this._p2pConnection.onFirstAudioDecoded=i=>{var o;return null===(o=this.onFirstAudioDecoded)||void 0===o?void 0:o.call(this,i)},this._p2pConnection.onFirstVideoDecoded=(i,o,s)=>{var c;return null===(c=this.onFirstVideoDecoded)||void 0===c?void 0:c.call(this,i,o,s)},this._p2pConnection.onFirstVideoDecodedTimeout=i=>{var o;return null===(o=this.onFirstVideoDecodedTimeout)||void 0===o?void 0:o.call(this,i)},this._p2pConnection.onSelectedLocalCandidateChanged=(i,o)=>{var s;return null===(s=this.onSelectedLocalCandidateChanged)||void 0===s?void 0:s.call(this,i,o)},this._p2pConnection.onSelectedRemoteCandidateChanged=(i,o)=>{var s;return null===(s=this.onSelectedRemoteCandidateChanged)||void 0===s?void 0:s.call(this,i,o)}}closeSignal(){this.dataChannel.close(),this.peerConnection.close()}unbindConnectionEvents(i){i.onConnectionStateChange=void 0,i.onICEConnectionStateChange=void 0,i.onICETransportStateChange=void 0,i.onDTLSTransportStateChange=void 0,i.onDTLSTransportError=void 0,i.onFirstAudioDecoded=void 0,i.onFirstAudioReceived=void 0,i.onFirstVideoDecoded=void 0,i.onFirstVideoReceived=void 0,i.onSelectedLocalCandidateChanged=void 0,i.onSelectedRemoteCandidateChanged=void 0,i.onFirstVideoDecodedTimeout=void 0}}).prototype,"connect",[ks],Object.getOwnPropertyDescriptor(un.prototype,"connect"),un.prototype),Te(un.prototype,"receive",[ks],Object.getOwnPropertyDescriptor(un.prototype,"receive"),un.prototype),Te(un.prototype,"stopReceiving",[ks],Object.getOwnPropertyDescriptor(un.prototype,"stopReceiving"),un.prototype),Te(un.prototype,"muteRemote",[ks],Object.getOwnPropertyDescriptor(un.prototype,"muteRemote"),un.prototype),Te(un.prototype,"unmuteRemote",[ks],Object.getOwnPropertyDescriptor(un.prototype,"unmuteRemote"),un.prototype),Te(un.prototype,"muteLocal",[ks],Object.getOwnPropertyDescriptor(un.prototype,"muteLocal"),un.prototype),Te(un.prototype,"unmuteLocal",[ks],Object.getOwnPropertyDescriptor(un.prototype,"unmuteLocal"),un.prototype),Te(un.prototype,"close",[ks],Object.getOwnPropertyDescriptor(un.prototype,"close"),un.prototype),Te(un.prototype,"updateEncoderConfig",[ks],Object.getOwnPropertyDescriptor(un.prototype,"updateEncoderConfig"),un.prototype),Te(un.prototype,"updateSendParameters",[ks],Object.getOwnPropertyDescriptor(un.prototype,"updateSendParameters"),un.prototype),Te(un.prototype,"replaceTrack",[ks],Object.getOwnPropertyDescriptor(un.prototype,"replaceTrack"),un.prototype),Te(un.prototype,"getRemoteSSRC",[ks],Object.getOwnPropertyDescriptor(un.prototype,"getRemoteSSRC"),un.prototype),$F=un))||$F;function ks(t,i,o){const s=t[i];if("function"!=typeof s)throw new Error("Cannot use mutex on object property.");return o.value=U(function*(){const c=this.mutex,l=yield c.lock("From DataChannelConnection.".concat(i));try{for(var p=arguments.length,h=new Array(p),g=0;g<p;g++)h[g]=arguments[g];return yield s.apply(this,h)}finally{l()}}),o}var LC,Lt;function bw(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function zu(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?bw(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):bw(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}function xC(t){var i,o,s,c=2;for(typeof Symbol<"u"&&(o=LF,s=Symbol.iterator);c--;){if(o&&null!=(i=t[o]))return i.call(t);if(s&&null!=(i=t[s]))return new WG(i.call(t));o="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function WG(t){function i(o){if(Object(o)!==o)return Ie.reject(new TypeError(o+" is not an object."));var s=o.done;return Ie.resolve(o.value).then(function(c){return{value:c,done:s}})}return(WG=function(o){this.s=o,this.n=o.next}).prototype={s:null,n:null,next:function(){return i(this.n.apply(this.s,arguments))},return:function(o){var s=this.s.return;return void 0===s?Ie.resolve({value:o,done:!0}):i(s.apply(this.s,arguments))},throw:function(o){var s=this.s.return;return void 0===s?Ie.reject(o):i(s.apply(this.s,arguments))}},new WG(t)}let kq=kn("P2PChannel","store.p2pId")((Te((Lt=class extends En{get state(){return this._state}set state(t){const i=this._state;this._state=t,this.emit(Nt.StateChange,i,this._state)}constructor(t,i){var o;super(),o=this,b(this,"store",void 0),b(this,"statsUploader",void 0),b(this,"connection",void 0),b(this,"localTrackMap",new Map),b(this,"remoteUserMap",new Map),b(this,"pendingLocalTracks",[]),b(this,"pendingRemoteTracks",[]),b(this,"statsCollector",void 0),b(this,"isPlanB",!1),b(this,"iceFailedCount",0),b(this,"dtlsFailedCount",0),b(this,"mutex",new eo("P2PChannel-mutex")),b(this,"_state",Ao.Disconnected),b(this,"handleMuteLocalTrack",function(){var s=U(function*(c,l,p){const h=yield o.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!o.connection)return void p(new V(L.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));le("debug",o,"handleMuteLocalTrack",c.getTrackId()),yield o.waitTillConnected();const g=o.filterTobeMutedTracks(c);if(0===g.length)return void l();const f=g.find(_=>"videoLowTrack"===_[0]);f&&f[1].track._originMediaStreamTrack.stop(),yield o.connection.muteLocal(g.map(_=>{let[,{id:v}]=_;return v}));const A=o.createMuteMessage(g);yield Hn(o,Nt.RequestMuteLocal,A),l()}catch(g){p(g)}finally{h()}});return function(c,l,p){return s.apply(this,arguments)}}()),b(this,"handleUnmuteLocalTrack",function(){var s=U(function*(c,l,p){const h=yield o.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!o.connection)return void p(new V(L.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));le("debug",o,"handleUnmuteLocalTrack",c.getTrackId()),yield o.waitTillConnected();const g=o.filterTobeUnmutedTracks(c);if(0===g.length)return void l();const f=g.find(_=>"videoLowTrack"===_[0]);if(f){const _=f[1];if(_.track._originMediaStreamTrack.stop(),Vr().supportDualStreamEncoding){const v=c._mediaStreamTrack.clone();_.track._mediaStreamTrack=v,_.track._originMediaStreamTrack=v}else{const v=fa(c,yh(o,Nt.RequestLowStreamParameter));_.track._mediaStreamTrack=v,_.track._originMediaStreamTrack=v}yield new Ie((v,y)=>{o.handleReplaceTrack(_.track,v,y,!0)})}yield o.connection.unmuteLocal(g.map(_=>{let[,{id:v}]=_;return v}));const A=o.createUnmuteMessage(g);yield Hn(o,Nt.RequestUnmuteLocal,A),l()}catch(g){p(g)}finally{h()}});return function(c,l,p){return s.apply(this,arguments)}}()),b(this,"handleUpdateVideoEncoder",function(){var s=U(function*(c,l,p){const h=yield o.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const g=o.localTrackMap.get(Pe.LocalVideoTrack);if(!o.connection||!g||g.track!==c)return void l();yield o.waitTillConnected();const{id:f,track:A}=g;yield o.connection.updateSendParameters(f,A),yield o.connection.updateEncoderConfig(f,A),o.emit(Nt.UpdateVideoEncoder,A),l()}catch(g){p(g)}finally{h()}});return function(c,l,p){return s.apply(this,arguments)}}()),b(this,"handleSetOptimizationMode",function(){var s=U(function*(c,l,p){const h=yield o.mutex.lock("Locking from P2PChannel.handleSetOptimizationMode");try{const g=o.localTrackMap.get(Pe.LocalVideoTrack);if(!o.connection||!g||g.track!==c)return;yield o.waitTillConnected();const{id:f,track:A}=g;yield o.connection.updateSendParameters(f,A),l()}catch(g){p(g)}finally{h()}});return function(c,l,p){return s.apply(this,arguments)}}()),b(this,"handleReplaceTrack",function(){var s=U(function*(c,l,p,h){let g;N.debug("P2PChannel handleReplaceTrack for [track-id-".concat(c.getTrackId(),"]")),"boolean"==typeof h&&h||(g=yield o.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var f;const _=Array.from(o.localTrackMap.entries()).find(v=>{let[,{track:y}]=v;return c===y});if(!o.connection||!_)return void l();if(yield o.waitTillConnected(),yield null===(f=o.connection)||void 0===f?void 0:f.replaceTrack(c,_[1].id),o.isPlanB){const v=_[1];v.id=c._mediaStreamTrack.id,o.localTrackMap.set(_[0],v)}if(_[0]===Pe.LocalVideoTrack&&Vr().supportDualStreamEncoding){const v=o.localTrackMap.get(Pe.LocalVideoLowTrack);if(v){const y=c._mediaStreamTrack.clone();v.track._originMediaStreamTrack.stop(),v.track._mediaStreamTrack=y,v.track._originMediaStreamTrack=y,yield new Ie((S,R)=>{o.handleReplaceTrack(v.track,S,R,!0)})}}l()}catch(_){p(_)}finally{var A;null===(A=g)||void 0===A||A()}});return function(c,l,p,h){return s.apply(this,arguments)}}()),b(this,"handleGetLocalVideoStats",s=>{s(this.statsCollector.getLocalVideoTrackStats())}),b(this,"handleGetLocalAudioStats",s=>{s(this.statsCollector.getLocalAudioTrackStats())}),b(this,"handleGetRemoteVideoStats",s=>this.statsCollector.getRemoteVideoTrackStats(s.uid)[s.uid]),b(this,"handleGetRemoteAudioStats",s=>this.statsCollector.getRemoteAudioTrackStats(s.uid)[s.uid]),this.store=t,this.statsCollector=i,this.statsCollector.addP2PChannel(this),this.statsUploader=new ed,this.bindStatsUploaderEvents(),this.isPlanB=!Vr().supportUnifiedPlan||J("CHROME_FORCE_PLAN_B")&&eh()}startP2PConnection(t,i){var o=this;return U(function*(){return o.state=Ao.New,o.connection=i?new kC(t,o.store):o.isPlanB?new ge(t,o.store):new xi(t,o.store),o.bindConnectionEvents(o.connection),o.connection.establish()})()}connect(t,i,o,s,c,l){var p=this;return U(function*(){if(!p.connection)throw new V(L.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");p.connection instanceof kC?p.connection.updateRemoteConnect(s):(p.store.peerConnectionStart(),yield p.connection.connect(t,i,o,s,c,l),p.statsUploader.startUploadTransportStats(),p.statsUploader.startUploadExtensionUsageStats(),p.state=Ao.Connected)})()}preConnect(t,i,o,s,c,l){var p=this;return U(function*(){if(!p.connection)throw new V(L.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");p.store.peerConnectionStart();const h=yield p.connection.connect(t,i,o,s,c,l);return p.statsUploader.startUploadTransportStats(),p.statsUploader.startUploadExtensionUsageStats(),p.state=Ao.Connected,h})()}getEstablishParams(){if(this.connection instanceof kC)return this.connection.getP2PConnectionParams();throw new Error("Only DataChannelConnection needs to obtain establishParams")}publish(t,i,o){var s=this;return ha(function*(){const c=yield It(s.mutex.lock("From P2PChannel.publish"));try{if(!s.connection){if(s.state===Ao.Disconnected)throw new V(L.UNEXPECTED_ERROR,"PeerConnection already disconnected.");s.throwIfTrackTypeNotMatch(t);const p=t.filter(h=>-1===s.pendingLocalTracks.indexOf(h));return void(s.pendingLocalTracks=s.pendingLocalTracks.concat(p))}s.store.pubId=s.store.pubId+1,Uo.markPublishStart(s.store.clientId,s.store.pubId),yield It(s.waitTillConnected());const l=s.filterTobePublishedTracks(t,i,o);if(0===l.length)return void(yield It(s.tryToUnmuteAudio(t)));yield*l_(xC(s.doPublish(s.connection,l)),It)}finally{c()}})()}doPublish(t,i){var o=this;return ha(function*(){i.forEach(f=>{let{track:A,type:_}=f;const v=Date.now();o.store.publish(A.getTrackId(),_===Pe.LocalAudioTrack?"audio":"video",v)}),o.bindLocalTrackEvents(i);const s=yield It(t.send(i.map(f=>{let{track:A}=f;return A}),o.store.codec,o.store.audioCodec)),c=(yield It(s.next())).value,l=o.createGatewayPublishMessage(i,c);let p;try{p=yield l}catch(f){throw Re("error",o,"doPublish yield error: ".concat(f.toString())),s.throw(f),f?.code===L.WS_ABORT&&i.forEach(A=>{let{track:_}=A;-1===o.pendingLocalTracks.indexOf(_)&&o.pendingLocalTracks.push(_)}),o.unbindLocalTrackEvents(i),f}const h=o.mapPubResToRemoteConfig(l,p);le("debug",o,"doPublish",{remoteConfigs:h,tracks:i.map(f=>{let{track:A}=f;return A.getTrackId()}),pubMsg:l,pubAns:p});const g=(yield It(s.next(h))).value;i.forEach(f=>{let{type:A}=f;o.statsCollector.addLocalStats(A)}),o.assignLocalTracks(i,g),o.statsUploader.startUploadUplinkStats(),i.forEach(f=>{let{track:A,type:_}=f;const v=Date.now();o.store.publish(A.getTrackId(),_===Pe.LocalAudioTrack?"audio":"video",void 0,v)})})()}publishLowStream(t){var i=this;return ha(function*(){if(!i.connection)return;le("debug",i,"publishLowStream",t);const o=yield It(i.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const c=i.localTrackMap.get(Pe.LocalVideoTrack);if(!c)throw new V(L.UNEXPECTED_ERROR,"Could not find high stream");if(i.localTrackMap.has(Pe.LocalVideoLowTrack))throw new V(L.UNEXPECTED_ERROR,"[".concat(i.store.clientId,"] Can't publish low stream when stream already publish"));yield It(i.waitTillConnected());const l=[{track:i.getLowVideoTrack(c.track,t),type:Pe.LocalVideoLowTrack}];if(yield*l_(xC(i.doPublish(i.connection,l)),It),c.track.muted||!c.track.enabled){var s;const p=null===(s=i.localTrackMap.get(Pe.LocalVideoLowTrack))||void 0===s?void 0:s.id;void 0!==p&&(yield It(i.connection.muteLocal([p])))}}finally{o()}})()}republish(){var t=this;return U(function*(){t.pendingLocalTracks.length>0&&(N.debug("Emit P2PChannelEvents.RequestRePublish to republish tracks."),le("debug",t,"republish",t.pendingLocalTracks.map(i=>i.getTrackId())),yield yi(t,Nt.RequestRePublish,t.pendingLocalTracks),t.emit(Nt.MediaReconnectEnd,t.store.uid),t.pendingLocalTracks=[])})()}reSubscribe(t){var i=this;return U(function*(){le("debug",i,"reSubscribe",i.pendingRemoteTracks.map(o=>{let{user:s}=o;return s.uid}));for(let o=i.pendingRemoteTracks.length-1;o>=0;o--){const{user:s,kind:c}=i.pendingRemoteTracks[o];(c!==ut.AUDIO||s._audio_added_&&s._audioSSRC)&&(c!==ut.VIDEO||s._video_added_&&s._videoSSRC)||i.pendingRemoteTracks.splice(o,1)}if(t)yield yi(i,Nt.RequestReSubscribe,i.pendingRemoteTracks);else for(const{user:o,kind:s}of i.pendingRemoteTracks)yield i.subscribe(o,s,s===ut.VIDEO?o._videoSSRC:o._audioSSRC);i.pendingRemoteTracks.forEach(o=>{let{user:s}=o;i.emit(Nt.MediaReconnectEnd,s.uid)}),i.pendingRemoteTracks=[]})()}unpublish(t){var i=this;return U(function*(){if(!i.connection)return void t.forEach(c=>{const l=i.pendingLocalTracks.indexOf(c);-1!==l&&i.pendingLocalTracks.splice(l,1)});yield i.waitTillConnected();const o=i.filterTobeUnpublishedTracks(t);if(0===o.length)return;const s=o.find(c=>"videoLowTrack"===c[0]);return s&&s[1].track.close(),le("debug",i,"unpublish"),i.doUnpublish(i.connection,o)})()}unpublishLowStream(){var t=this;return U(function*(){if(!t.connection)return;le("debug",t,"unpublishLowStream");const i=t.localTrackMap.get(Pe.LocalVideoLowTrack);return i?(yield t.waitTillConnected(),i.track.close(),t.doUnpublish(t.connection,[[Pe.LocalVideoLowTrack,i]])):void 0})()}doUnpublish(t,i){var o=this;return U(function*(){const s=o.createGatewayUnpublishMessage(i);return yield t.stopSending(i.map(c=>{let[,{id:l}]=c;return l})),o.withdrawLocalTracks(i),o.unbindLocalTrackEvents(i.map(c=>{let[l,{track:p}]=c;return{type:l,track:p}})),i.forEach(c=>{let[l]=c;o.statsCollector.removeLocalStats(l)}),0===o.localTrackMap.size&&o.statsUploader.stopUploadUplinkStats(),s})()}subscribe(t,i,o,s,c){var l=this;return U(function*(){var p;if(!l.connection)throw new V(L.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if(le("debug",l,"subscribe",{uid:t.uid,mediaType:i,ssrcId:o}),null!==(p=l.remoteUserMap.get(t))&&void 0!==p&&p.has(i))return;let h,g;if(yield l.waitTillConnected(),c){const _=c.find(y=>{let{stream_type:S}=y;return S===i});if(!_)throw new V(L.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(i," for user: ").concat(t.uid," because subscribe answer from gateway does not contain stream_type: ").concat(i,"."));const v=yield l.connection.receive(i,_.ssrcs,String(t._uintid),_.attributes);h=v.track,g=v.id}else{const _=yield l.connection.receive(i,[{ssrcId:o,rtx:s}],String(t._uintid),void 0);h=_.track,g=_.id}i===ut.AUDIO?(t._audioTrack?t._audioTrack._updateOriginMediaStreamTrack(h):(t._audioTrack=new Zl(h,t.uid,t._uintid,l.store),N.info("[".concat(l.store.p2pId,"] create remote audio track: ").concat(t._audioTrack.getTrackId()))),l.bindRemoteTrackEvents(t,t._audioTrack)):(t._videoTrack?t._videoTrack._updateOriginMediaStreamTrack(h):(t._videoTrack=new eg(h,t.uid,t._uintid,l.store),N.info("[".concat(l.store.p2pId,"] create remote video track: ").concat(t._videoTrack.getTrackId()))),l.bindRemoteTrackEvents(t,t._videoTrack));const f=l.remoteUserMap.get(t);f?f.set(i,g):l.remoteUserMap.set(t,new Map([[i,g]])),l.statsCollector.addRemoteStats(t.uid),l.statsUploader.startUploadDownlinkStats();const A=l.pendingRemoteTracks.findIndex(_=>{let{user:v,kind:y}=_;return v.uid===t.uid&&i===y});-1!==A&&(l.pendingRemoteTracks.splice(A,1),l.emit(Nt.MediaReconnectEnd,t.uid))})()}massSubscribe(t){var i=this;return U(function*(){return i.massSubscribeNoLock(t)})()}massSubscribeNoLock(t){var i=this;return U(function*(){if(!i.connection)throw new V(L.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");le("debug",i,"subscribeAll",t.map(s=>{let{user:c,mediaType:l,ssrcId:p}=s;return{uid:c.uid,mediaType:l,ssrcId:p}})),t=t.filter(s=>{var c;let{user:l,mediaType:p}=s;return!(null!==(c=i.remoteUserMap.get(l))&&void 0!==c&&c.has(p))}),yield i.waitTillConnected();const o=yield i.connection.batchReceive(t.map(s=>{let{user:c,mediaType:l,ssrcId:p,rtxSsrcId:h}=s;return{kind:l,ssrcMsg:[{ssrcId:p,rtx:h}],mslabel:String(c._uintid)}}));t.forEach((s,c)=>{let{user:l,mediaType:p}=s;const{track:h,id:g}=o[c];p===ut.AUDIO?(l._audioTrack?l._audioTrack._updateOriginMediaStreamTrack(h):(l._audioTrack=new Zl(h,l.uid,l._uintid,i.store),N.info("[".concat(i.store.p2pId,"] create remote audio track: ").concat(l._audioTrack.getTrackId()))),i.bindRemoteTrackEvents(l,l._audioTrack)):(l._videoTrack?l._videoTrack._updateOriginMediaStreamTrack(h):(l._videoTrack=new eg(h,l.uid,l._uintid,i.store),N.info("[".concat(i.store.p2pId,"] create remote video track: ").concat(l._videoTrack.getTrackId()))),i.bindRemoteTrackEvents(l,l._videoTrack));const f=i.remoteUserMap.get(l);f?f.set(p,g):i.remoteUserMap.set(l,new Map([[p,g]])),i.statsCollector.addRemoteStats(l.uid),i.statsUploader.startUploadDownlinkStats();const A=i.pendingRemoteTracks.findIndex(_=>{let{user:v,kind:y}=_;return v.uid===l.uid&&p===y});-1!==A&&(i.pendingRemoteTracks.splice(A,1),i.emit(Nt.MediaReconnectEnd,l.uid))})})()}unsubscribe(t,i,o){var s=this;return U(function*(){const c=s.pendingRemoteTracks.filter(h=>{let{user:g,kind:f}=h;return void 0!==i?g.uid===t.uid&&i===f:g.uid===t.uid});if(c.forEach(h=>{const g=s.pendingRemoteTracks.indexOf(h);s.pendingRemoteTracks.splice(g,1)}),s.connection||o||c.forEach(h=>{let{kind:g}=h;var f;if(g===ut.AUDIO)null===(f=t._audioTrack)||void 0===f||f._destroy(),t._audioTrack=void 0;else if(g===ut.VIDEO){var A;null===(A=t._videoTrack)||void 0===A||A._destroy(),t._videoTrack=void 0}}),!s.connection)return;le("debug",s,"unsubscribe",{uid:t.uid,mediaType:i});const l=s.filterTobeUnSubscribedTracks(t,i);if(0===l.length)return;yield s.connection.stopReceiving(l.map(h=>{let[,{id:g}]=h;return g}));const p=s.createUnsubscribeMessage(l);return s.withdrawRemoteTracks(l),0===s.remoteUserMap.size&&s.statsUploader.stopUploadDownlinkStats(),l.forEach(h=>{let[g,{kind:f}]=h;var A,_;if(f===ut.VIDEO&&g._videoSSRC&&(null===(A=s.connection)||void 0===A||A.setStatsRemoteVideoIsReady(g._videoSSRC,!1)),f===ut.VIDEO)s.unbindRemoteTrackEvents(g._videoTrack),o||(null===(_=g._videoTrack)||void 0===_||_._destroy(),g._videoTrack=void 0);else if(f===ut.AUDIO){var v;s.unbindRemoteTrackEvents(g._audioTrack),!o&&(null===(v=g._audioTrack)||void 0===v||v._destroy(),g._audioTrack=void 0)}}),p})()}massUnsubscribe(t){var i=this;return U(function*(){return i.massUnsubscribeNoLock(t)})()}massUnsubscribeNoLock(t){var i=this;return U(function*(){let o=[];for(const{user:l,mediaType:p}of t){const h=i.pendingRemoteTracks.filter(g=>{let{user:f,kind:A}=g;return void 0!==p?f.uid===l.uid&&p===A:f.uid===l.uid});h.forEach(g=>{const f=i.pendingRemoteTracks.indexOf(g);i.pendingRemoteTracks.splice(f,1)}),o=o.concat(h)}if(!i.connection)return void o.forEach(l=>{let{user:p,kind:h}=l;var g;if(h===ut.AUDIO)null===(g=p._audioTrack)||void 0===g||g._destroy(),p._audioTrack=void 0;else if(h===ut.VIDEO){var f;null===(f=p._videoTrack)||void 0===f||f._destroy(),p._videoTrack=void 0}});le("debug",i,"batchUnsubscribe",t.map(l=>{let{user:p,mediaType:h}=l;return{uid:p.uid,mediaType:h}}));const s=hc(t).call(t,(l,p)=>{let{user:h,mediaType:g}=p;const f=i.filterTobeUnSubscribedTracks(h,g);return l.concat(f)},[]);if(0===s.length)return;yield i.connection.stopReceiving(s.map(l=>{let[,{id:p}]=l;return p}));const c=i.createUnsubscribeAllMessage(s);return i.withdrawRemoteTracks(s),0===i.remoteUserMap.size&&i.statsUploader.stopUploadDownlinkStats(),s.forEach(l=>{let[p,{kind:h}]=l;var g,f;if(h===ut.VIDEO&&p._videoSSRC&&(null===(g=i.connection)||void 0===g||g.setStatsRemoteVideoIsReady(p._videoSSRC,!1)),h===ut.VIDEO)i.unbindRemoteTrackEvents(p._videoTrack),null===(f=p._videoTrack)||void 0===f||f._destroy(),p._videoTrack=void 0;else if(h===ut.AUDIO){var A;i.unbindRemoteTrackEvents(p._audioTrack),null===(A=p._audioTrack)||void 0===A||A._destroy(),p._audioTrack=void 0}}),c})()}muteRemote(t,i){var o=this;return U(function*(){if(!o.connection)return;le("debug",o,"muteRemote",{uid:t.uid,kind:i});const s=o.remoteUserMap.get(t);if(!s)return N.warning("P2PChannel.muteRemote has no remote user ".concat(t.uid,".")),void Re("warning",o,"P2PChannel.muteRemote has no remote user ".concat(t.uid,"."));if(!s.get(i))return N.warning("P2PChannel.muteRemote has no remote user ".concat(t.uid," media type ").concat(i,".")),void Re("warning",o,"P2PChannel.muteRemote has no remote user ".concat(t.uid," media type ").concat(i,"."));const c=i===ut.VIDEO?t._videoSSRC:t._audioSSRC;void 0!==c&&o.connection.setStatsRemoteVideoIsReady(c,!1)})()}unmuteRemote(t,i){var o=this;return U(function*(){return o.unmuteRemoteNoLock(t,i)})()}unmuteRemoteNoLock(t,i){var o=this;return U(function*(){if(!o.connection)return;le("debug",o,"unmuteRemote",{uid:t.uid,kind:i});const s=o.remoteUserMap.get(t);return s?s.get(i)?void 0:(N.warning("P2PChannel.unmuteRemote has no remote user ".concat(t.uid," media type ").concat(i,".")),void Re("warning",o,"unmuteRemote has no remote user ".concat(t.uid," media type ").concat(i))):(N.warning("P2PChannel.unmuteRemote has no remote user ".concat(t.uid,".")),void Re("warning",o,"unmuteRemote has no remote user ".concat(t.uid)))})()}getAllTracks(t){const i=this.localTrackMap.get(Pe.LocalAudioTrack);if(i?.track instanceof Ln){const o=i.track;return Array.from(this.localTrackMap.entries()).filter(s=>{let[c]=s;return c!==Pe.LocalAudioTrack}).filter(s=>{let[c]=s;return!(t&&c===Pe.LocalVideoLowTrack)}).map(s=>{let[,{track:c}]=s;return c}).concat(o.trackList)}return Array.from(this.localTrackMap.entries()).filter(o=>{let[s]=o;return!(t&&s===Pe.LocalVideoLowTrack)}).map(o=>{let[,{track:s}]=o;return s})}reportPublishEvent(t,i,o,s,c){if(t){const p=this.localTrackMap.get(Pe.LocalAudioTrack),h=this.localTrackMap.get(s?Pe.LocalVideoLowTrack:Pe.LocalVideoTrack);pe.publish(this.store.sessionId,{eventElapse:Uo.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:t,ec:i,audioName:p?.track.getTrackLabel(),videoName:h?.track.getTrackLabel(),screenshare:-1!==h?.track._hints.indexOf(br.SCREEN_TRACK),audio:!!p,video:!!h,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:c})}else{var l;o||(o=[]);const p=o.find(g=>g instanceof Li),h=s?null===(l=this.localTrackMap.get(Pe.LocalVideoTrack))||void 0===l?void 0:l.track:o.find(g=>g instanceof dr);pe.publish(this.store.sessionId,{eventElapse:Uo.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:t,ec:i,audioName:p?.getTrackLabel(),videoName:h?.getTrackLabel(),screenshare:-1!==h?._hints.indexOf(br.SCREEN_TRACK),audio:!!p,video:!!h,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:c})}}reportSubscribeEvent(t,i,o,s){const c=s===ut.VIDEO?o._videoSSRC:o._audioSSRC;c&&pe.subscribe(this.store.sessionId,{succ:t,ec:i,video:s===ut.VIDEO,audio:s===ut.AUDIO,peerid:o.uid,subscribeRequestid:s===ut.VIDEO?o._videoSSRC:o._audioSSRC,p2pid:this.store.p2pId,eventElapse:Uo.measureFromSubscribeStart(this.store.clientId,c)})}reset(){N.debug("P2PChannel.reset"),this.mutex=new eo("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.state=Ao.Disconnected}getStats(){var t;return null===(t=this.connection)||void 0===t?void 0:t.getStats()}getRemoteVideoIsReady(t){var i;return(null===(i=this.connection)||void 0===i?void 0:i.getRemoteVideoIsReady(t))||!1}getLocalAudioVolume(){const t=this.localTrackMap.get(Pe.LocalAudioTrack);if(t)return t.track.getVolumeLevel()}getLocalVideoSize(){const t=this.localTrackMap.get(Pe.LocalVideoTrack);if(t)return{width:t.track._videoWidth||0,height:t.track._videoHeight||0}}getEncoderConfig(t){const i=this.localTrackMap.get(t);return i&&i.track instanceof dr||i&&i.track instanceof Li?i.track._encoderConfig:void 0}getLocalMedia(t){return this.localTrackMap.get(t)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(t,i){if(!t)return this.remoteUserMap.size>0;const o=this.remoteUserMap.get(t);return!!o&&(!i||o.has(i))}hasRemoteMediaWithLock(t,i){var o=this;return U(function*(){if(!t)return o.remoteUserMap.size>0;const s=o.remoteUserMap.get(t);return!!s&&(!i||s.has(i))})()}getRemoteMedia(t){var i;const o=Array.from(ph(i=this.remoteUserMap).call(i)).find(s=>s.uid===t);return o?{audioTrack:o.audioTrack,audioSSRC:o._audioSSRC,videoTrack:o.videoTrack,videoSSRC:o._videoSSRC}:{}}getAudioLevels(){let t=Array.from(this.remoteUserMap.entries()).map(o=>{let[s]=o;return{uid:s.uid,level:s.audioTrack?100*s.audioTrack._source.getAccurateVolumeLevel():0}});const i=this.localTrackMap.get(Pe.LocalAudioTrack);return i&&t.push({level:100*i.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),t=na(t).call(t,(o,s)=>o.level-s.level),t}disconnectForReconnect(){var t=this;return U(function*(){t.connection&&(le("debug",t,"disconnectForReconnect"),N.debug("P2PChannel.disconnectForReconnect closing P2PConnection"),t.state=Ao.Reconnecting,t.connection.close(),t.unbindConnectionEvents(t.connection),t.connection=void 0,0!==t.localTrackMap.size&&(Array.from(t.localTrackMap.entries()).forEach(i=>{let[o,{track:s}]=i;switch(o){case Pe.LocalVideoTrack:s._hints.includes(br.LOW_STREAM)?s.close():t.pendingLocalTracks.push(s);break;case Pe.LocalAudioTrack:s instanceof Ln?t.pendingLocalTracks=t.pendingLocalTracks.concat(s.trackList):t.pendingLocalTracks.push(s)}}),t.emit(Nt.MediaReconnectStart,t.store.uid)),t.unbindLocalTrackEvents(),t.localTrackMap.clear(),0!==t.remoteUserMap.size&&Array.from(t.remoteUserMap.entries()).forEach(i=>{let[o,s]=i;Array.from(ph(s).call(s)).forEach(c=>{t.setPendingRemoteMedia(o,c)}),t.emit(Nt.MediaReconnectStart,o.uid)}),t.unbindAllRemoteTrackEvents(),t.remoteUserMap.clear(),t.statsUploader.stopUploadUplinkStats(),t.statsUploader.stopUploadDownlinkStats(),t.statsUploader.stopUploadTransportStats(),N.debug("P2PChannel disconnected, waiting to reconnect."))})()}hasPendingRemoteMedia(t,i){for(const o of this.pendingRemoteTracks){const{user:s,kind:c}=o;if((t instanceof AC?t.uid:t)===s.uid&&i===c)return!0}return!1}setPendingRemoteMedia(t,i){this.hasPendingRemoteMedia(t,i)||this.pendingRemoteTracks.push({user:t,kind:i})}restartICE(){var t=this;return ha(function*(){if(!t.connection)throw new Error;const i=yield It(t.mutex.lock("From P2PChannel.restartICE"));try{yield*l_(xC(t.connection.restartICE()),It)}finally{i()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const t=this.connection.getStats(),i=this.localTrackMap.get(Pe.LocalVideoTrack),o=this.localTrackMap.get(Pe.LocalAudioTrack),s=t.videoSend.find(y=>y.ssrc===i?.ssrcs[0].ssrcId),c=t.audioSend.find(y=>y.ssrc===o?.ssrcs[0].ssrcId);if(!s||!c)return 1;const l=Uc(this,Nt.NeedSignalRTT),p=s?s.rttMs:void 0,h=c?c.rttMs:void 0,g=p&&h?(p+h)/2:p||h,A=100*t.sendPacketLossRate*.7/50+.3*((g&&l?(g+l)/2:g||l)||0)/1500,_=A<.17?1:A<.36?2:A<.59?3:A<.1?4:5,v=i?.track;if(v&&v._encoderConfig&&-1===v._hints.indexOf(br.SCREEN_TRACK)){const y=v._encoderConfig.bitrateMax,S=t.bitrate.actualEncoded;if(y&&S){const R=(1e3*y-S)/(1e3*y);return dj[R<.15?0:R<.3?1:R<.45?2:R<.6?3:4][_]}}return _}getDownlinkNetworkQuality(){if(!this.connection)return 0;const t=this.connection.getStats();let i=0;return Array.from(this.remoteUserMap.entries()).forEach(o=>{let[s]=o;const c=s._audioSSRC,l=s._videoSSRC,p=t.audioRecv.find(S=>S.ssrc===c),h=t.videoRecv.find(S=>S.ssrc===l);if(!p&&!h)return void(i+=1);const g=Uc(this,Nt.NeedSignalRTT),f=t.rtt,A=(f&&g?(f+g)/2:f||g)||0,_=p?p.jitterMs:void 0,v=t.recvPacketLossRate;let y=.7*v*100/50+.3*A/1500;_&&(y=.6*v*100/50+.2*A/1500+.2*_/400),i+=y<.1?1:y<.17?2:y<.36?3:y<.59?4:5}),this.remoteUserMap.size>0?Math.round(i/this.remoteUserMap.size):i}muteLocalTrack(t){var i=this;return U(function*(){return new Ie((o,s)=>{i.handleMuteLocalTrack(t,o,s)})})()}filterTobePublishedTracks(t,i,o){const s=[],c=Vr(),l=this.getAllTracks();t=wB(t=t.filter(g=>-1===l.indexOf(g)));let p=!1,h=!1;for(const g of t){if(g instanceof dr&&(this.localTrackMap.has(Pe.LocalVideoTrack)||p?new V(L.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(s.push({track:g,type:Pe.LocalVideoTrack}),p=!0),i)){const f=this.getLowVideoTrack(g,o);s.push({track:f,type:Pe.LocalVideoLowTrack})}if(g instanceof Li){const f=this.localTrackMap.get(Pe.LocalAudioTrack);if(f){if(!(f.track instanceof Ln))throw new V(L.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(g._bypassWebAudio)throw new V(L.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");f.track.addAudioTrack(g),this.bindLocalAudioTrackEvents(g,!0)}else if(h){const A=s.find(_=>{let{type:v}=_;return v===Pe.LocalAudioTrack});if(!(A.track instanceof Ln))throw new V(L.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(g._bypassWebAudio)throw new V(L.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");A.track.addAudioTrack(g)}else{if(!c.webAudioMediaStreamDest||g instanceof Ln||g._bypassWebAudio)s.push({track:g,type:Pe.LocalAudioTrack});else{const A=new Ln;A.addAudioTrack(g),s.push({track:A,type:Pe.LocalAudioTrack})}h=!0}}}return s}filterTobeUnpublishedTracks(t){const i=[],o=this.getAllTracks();t=wB(t=t.filter(s=>-1!==o.indexOf(s)));for(const s of t){if(s instanceof Li){const c=this.localTrackMap.get(Pe.LocalAudioTrack);if(!c)continue;c.track instanceof Ln?(c.track.removeAudioTrack(s),this.unbindLocalAudioTrackEvents(s),0===c.track.trackList.length&&(i.push([Pe.LocalAudioTrack,c]),c.track.close())):i.push([Pe.LocalAudioTrack,c])}if(s instanceof dr){const c=this.localTrackMap.get(Pe.LocalVideoTrack);if(!c)continue;i.push([Pe.LocalVideoTrack,c]);const l=this.localTrackMap.get(Pe.LocalVideoLowTrack);l&&i.push([Pe.LocalVideoLowTrack,l])}}return i}bindLocalTrackEvents(t){t.forEach(i=>{let{track:o,type:s}=i;switch(s){case Pe.LocalVideoTrack:o.addListener(Qe.GET_STATS,this.handleGetLocalVideoStats),o.addListener(Qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),o.addListener(Qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),o.addListener(Qe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),o.addListener(Qe.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),o.addListener(Qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),o.addListener(Qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),o.addListener(Qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Pe.LocalAudioTrack:this.bindLocalAudioTrackEvents(o)}})}bindLocalAudioTrackEvents(t,i){t instanceof Ln?t.trackList.forEach(o=>{o.addListener(Qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),o.addListener(Qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),o.addListener(Qe.GET_STATS,this.handleGetLocalAudioStats),o.addListener(Qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),o.addListener(Qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(t.addListener(Qe.GET_STATS,this.handleGetLocalAudioStats),t.addListener(Qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(Qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(Qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(Qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),i||t.addListener(Qe.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(t){t||(t=Array.from(this.localTrackMap.entries()).map(i=>{let[o,{track:s}]=i;return{track:s,type:o}})),t.forEach(i=>{let{track:o,type:s}=i;switch(s){case Pe.LocalVideoTrack:o.off(Qe.GET_STATS,this.handleGetLocalVideoStats),o.off(Qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),o.off(Qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),o.off(Qe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),o.off(Qe.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),o.off(Qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),o.off(Qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),o.off(Qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Pe.LocalAudioTrack:this.unbindLocalAudioTrackEvents(o)}})}unbindLocalAudioTrackEvents(t){t instanceof Ln?t.trackList.forEach(i=>{i.off(Qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.off(Qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.off(Qe.GET_STATS,this.handleGetLocalAudioStats),i.off(Qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.off(Qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(t.off(Qe.GET_STATS,this.handleGetLocalAudioStats),t.off(Qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(Qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(Qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(Qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(Qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(t,i){i instanceof eg&&i.addListener(Qe.GET_STATS,o=>{o(this.handleGetRemoteVideoStats(t))}),i instanceof Zl&&i.addListener(Qe.GET_STATS,o=>{o(this.handleGetRemoteAudioStats(t))})}unbindRemoteTrackEvents(t){t&&t.removeAllListeners(Qe.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(t=>{let[i,o]=t;o.has(ut.AUDIO)&&this.unbindRemoteTrackEvents(i._audioTrack),o.has(ut.VIDEO)&&this.unbindRemoteTrackEvents(i._videoTrack)})}createGatewayPublishMessage(t,i){return t.map((o,s)=>{let c,l,{track:p,type:h}=o;switch(h){case Pe.LocalAudioTrack:c=lr.Audio,l={dtx:p instanceof mh&&p._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case Pe.LocalVideoTrack:c=p._hints.includes(br.SCREEN_TRACK)?lr.Screen:lr.High,l=zu(zu({},uD(p)),{},{codec:this.store.codec});break;case Pe.LocalVideoLowTrack:c=lr.Low,l=zu(zu({},uD(p)),{},{codec:this.store.codec})}return{stream_type:c,attributes:l,ssrcs:i[s]}})}createGatewayUnpublishMessage(t){return t.map(i=>{let o,[s,{track:c,ssrcs:l,id:p}]=i;switch(s){case Pe.LocalVideoTrack:o=c._hints.includes(br.SCREEN_TRACK)?lr.Screen:lr.High;break;case Pe.LocalAudioTrack:o=lr.Audio;break;case Pe.LocalVideoLowTrack:o=lr.Low}return{stream_type:o,ssrcs:l,mid:p}})}assignLocalTracks(t,i){t.forEach((o,s)=>{let{track:c,type:l}=o;this.localTrackMap.set(l,{track:c,id:i[s].id,ssrcs:i[s].localSSRC})})}withdrawLocalTracks(t){t.forEach(i=>{let[o]=i;this.localTrackMap.delete(o)})}waitTillConnected(){var t=this;return U(function*(){return new Ie((i,o)=>{switch(t.state){case Ao.New:case Ao.Reconnecting:{const s=(c,l)=>l===Ao.Disconnected?(t.off(Nt.StateChange,s),void o(new V(L.UNEXPECTED_ERROR,"PeerConnection already disconnected."))):l===Ao.Connected?(t.off(Nt.StateChange,s),void i(void 0)):void 0;t.on(Nt.StateChange,s);break}case Ao.Connected:i(void 0);break;case Ao.Disconnected:o(new V(L.UNEXPECTED_ERROR,"PeerConnection already disconnected."))}})})()}bindConnectionEvents(t){var i=this;t.onConnectionStateChange=function(){var o=U(function*(s){if(N.info("[p2pId: ".concat(i.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(s,")")),vn("info",i,"connectionStateChange",s),i.emit(Nt.PeerConnectionStateChange,s),"connected"!==s||i.store.keyMetrics.peerConnectionEnd||i.store.peerConnectionEnd(),"disconnected"===s&&"disconnected"===t.iceConnectionState)return setTimeout(()=>{"disconnected"===t.iceConnectionState&&J("ICE_RESTART")&&"CONNECTED"===Uc(i,Nt.QueryClientConnectionState)&&i.emit(Nt.RequestRestartICE)},800),void setTimeout(()=>{"disconnected"===t.peerConnectionState&&(N.debug("P2PConnection disconnected timeout 4000ms, force reconnect"),setTimeout(()=>i.emit(Nt.P2PLost),0),i.iceFailedCount+=1,i.requestReconnect())},4e3);"failed"===s&&(N.debug("P2PConnection state failed, force reconnect"),setTimeout(()=>i.emit(Nt.P2PLost),0),i.iceFailedCount+=1,yield i.requestReconnect())});return function(s){return o.apply(this,arguments)}}(),t.onICEConnectionStateChange=o=>{"connected"!==o||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),N.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(o,")")),vn("info",this,"iceConnectionStateChange",o),pe.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:o,tag:Ve.TRACER}).onSuccess(),this.emit(Nt.IceConnectionStateChange,o)},t.onICETransportStateChange=o=>{N.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(o,")")),vn("info",this,"ICETransportStateChange",o)},t.onDTLSTransportStateChange=o=>{N.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(o,")")),vn("info",this,"DTLSTransportStateChange",o)},t.onDTLSTransportError=o=>{N.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(o,")")),vn("info",this,"DTLSTransportError",o)},t.onFirstAudioDecoded=o=>{var s;const c=Array.from(ph(s=this.remoteUserMap).call(s)).find(p=>p._audioSSRC===o);var l;c&&(this.store.subscribe(c.uid,"audio",void 0,void 0,void 0,Date.now()),null===(l=c.audioTrack)||void 0===l||l.emit(df.FIRST_FRAME_DECODED),pe.firstRemoteFrame(this.store.sessionId,gt.FIRST_AUDIO_DECODE,gn.FIRST_AUDIO_DECODE,{peer:c._uintid,subscribeElapse:Uo.measureFromSubscribeStart(this.store.clientId,o),subscribeRequestid:o,p2pid:this.store.p2pId}))},t.onFirstAudioReceived=o=>{var s;const c=Array.from(ph(s=this.remoteUserMap).call(s)).find(l=>l._audioSSRC===o);c&&pe.firstRemoteFrame(this.store.sessionId,gt.FIRST_AUDIO_RECEIVED,gn.FIRST_AUDIO_RECEIVED,{peer:c._uintid,subscribeElapse:Uo.measureFromSubscribeStart(this.store.clientId,o),subscribeRequestid:o,p2pid:this.store.p2pId})},t.onFirstVideoDecoded=(o,s,c)=>{this.reportVideoFirstFrameDecoded(o,s,c)},t.onFirstVideoReceived=o=>{var s;const c=Array.from(ph(s=this.remoteUserMap).call(s)).find(l=>l._videoSSRC===o);c&&pe.firstRemoteFrame(this.store.sessionId,gt.FIRST_VIDEO_RECEIVED,gn.FIRST_VIDEO_RECEIVED,{peer:c._uintid,subscribeElapse:Uo.measureFromSubscribeStart(this.store.clientId,o),subscribeRequestid:o,p2pid:this.store.p2pId})},t.onSelectedLocalCandidateChanged=(o,s)=>{const c="relay"===o.candidateType;"unknown"!==s.candidateType&&c===("relay"===s.candidateType)||this.emit(Nt.ConnectionTypeChange,c),N.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(ws(s))," -> ").concat(JSON.stringify(ws(o)),")")),vn("info",this,"SelectedLocalCandidateChanged","".concat(JSON.stringify(ws(s))," -> ").concat(JSON.stringify(ws(o))))},t.onSelectedRemoteCandidateChanged=(o,s)=>{N.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(ws(s))," -> ").concat(JSON.stringify(ws(o)),")")),vn("info",this,"SelectedRemoteCandidateChanged","".concat(JSON.stringify(ws(s))," -> ").concat(JSON.stringify(ws(o))))},t.onFirstVideoDecodedTimeout=o=>{this.reportVideoFirstFrameDecoded(o,void 0,void 0,!0)}}unbindConnectionEvents(t){t.onConnectionStateChange=void 0,t.onICEConnectionStateChange=void 0,t.onICETransportStateChange=void 0,t.onDTLSTransportStateChange=void 0,t.onDTLSTransportError=void 0,t.onFirstAudioDecoded=void 0,t.onFirstAudioReceived=void 0,t.onFirstVideoDecoded=void 0,t.onFirstVideoReceived=void 0,t.onSelectedLocalCandidateChanged=void 0,t.onSelectedRemoteCandidateChanged=void 0,t.onFirstVideoDecodedTimeout=void 0}filterTobeMutedTracks(t){const i=[];if(-1===this.getAllTracks().indexOf(t))return i;const o=this.localTrackMap.get(Pe.LocalAudioTrack);if(t instanceof Li&&o?.track instanceof Ln)return o.track.isActive||i.push([Pe.LocalAudioTrack,o]),i;const s=Array.from(this.localTrackMap.entries()).find(c=>{let[,{track:l}]=c;return t===l});if(s&&(i.push(s),s[0]===Pe.LocalVideoTrack)){const c=this.localTrackMap.get(Pe.LocalVideoLowTrack);c&&i.push([Pe.LocalVideoLowTrack,c])}return i}filterTobeUnmutedTracks(t){const i=[],o=this.localTrackMap.get(Pe.LocalAudioTrack);if(t instanceof Li&&o?.track instanceof Ln)return o.track.isActive&&i.push([Pe.LocalAudioTrack,o]),i;const s=Array.from(this.localTrackMap.entries()).find(c=>{let[,{track:l}]=c;return t===l});if(s)if(s[0]===Pe.LocalVideoTrack){i.push(s);const c=this.localTrackMap.get(Pe.LocalVideoLowTrack);c&&i.push([Pe.LocalVideoLowTrack,c])}else i.push(s);return i}createMuteMessage(t){return t.map(i=>{let o,[s,{track:c,ssrcs:l,id:p}]=i;switch(s){case Pe.LocalAudioTrack:o=lr.Audio;break;case Pe.LocalVideoTrack:o=c._hints.includes(br.SCREEN_TRACK)?lr.Screen:lr.High;break;case Pe.LocalVideoLowTrack:o=lr.Low}return{stream_type:o,ssrcs:l,mid:p}})}createUnmuteMessage(t){return t.map(i=>{let o,[s,{track:c,ssrcs:l,id:p}]=i;switch(s){case Pe.LocalAudioTrack:o=lr.Audio;break;case Pe.LocalVideoTrack:o=c._hints.includes(br.SCREEN_TRACK)?lr.Screen:lr.High;break;case Pe.LocalVideoLowTrack:o=lr.Low}return{stream_type:o,ssrcs:l,mid:p}})}filterTobeUnSubscribedTracks(t,i){const o=[],s=this.remoteUserMap.get(t);if(!s)return o;if(i){const c=s.get(i);if(!c)return o;o.push([t,{kind:i,id:c}])}else Array.from(s.entries()).forEach(c=>{let[l,p]=c;o.push([t,{kind:l,id:p}])});return o}createUnsubscribeMessage(t){const i=[];return t.forEach(o=>{let[s,{kind:c}]=o;switch(c){case ut.VIDEO:return void(s._videoSSRC&&i.push({stream_type:ut.VIDEO,ssrcId:s._videoSSRC}));case ut.AUDIO:return void(s._audioSSRC&&i.push({stream_type:ut.AUDIO,ssrcId:s._audioSSRC}))}}),i}createUnsubscribeAllMessage(t){const i=new Map;return t.forEach(o=>{let[s,{kind:c}]=o;if(i.has(s)){let l=i.get(s);l|=c===ut.VIDEO?Jn.Video:Jn.Audio,i.set(s,l)}else i.set(s,c===ut.VIDEO?Jn.Video:Jn.Audio)}),{users:Array.from(i.entries()).map(o=>{let[s,c]=o;return{stream_id:s.uid,stream_type:c}})}}withdrawRemoteTracks(t){t.forEach(i=>{let[o,{kind:s}]=i;const c=this.remoteUserMap.get(o);c&&(c.delete(s),0===Array.from(c.entries()).length&&this.remoteUserMap.delete(o))})}updateBitrateLimit(t){var i=this;return U(function*(){const o=i.localTrackMap.get(Pe.LocalVideoTrack),s=i.localTrackMap.get(Pe.LocalVideoLowTrack);o&&(yield o.track.setBitrateLimit(t.uplink)),s&&t.low_stream_uplink&&(yield s.track.setBitrateLimit({max_bitrate:t.low_stream_uplink.bitrate,min_bitrate:t.low_stream_uplink.bitrate||0}))})()}isP2PDisconnected(){return!this.connection||"connected"!==this.connection.peerConnectionState}mapPubResToRemoteConfig(t,i){return t.map((o,s)=>{var c;let{stream_type:l}=o;return null===(c=i.find(p=>{let{stream_type:h}=p;return l===h}))||void 0===c?void 0:c.attributes})}tryToUnmuteAudio(t){var i=this;return U(function*(){for(let s=0;s<t.length;s++)if(t[s]instanceof Li){var o;const c=i.filterTobeUnmutedTracks(t[s]);if(0===c.length)continue;yield null===(o=i.connection)||void 0===o?void 0:o.unmuteLocal(c.map(p=>{let[,{id:h}]=p;return h}));const l=i.createUnmuteMessage(c);return void(yield Hn(i,Nt.RequestUnmuteLocal,l))}})()}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=t=>{var i;return!(null===(i=this.connection)||void 0===i||!i.getRemoteVideoIsReady(t))},this.statsUploader.requestUpload=(t,i)=>this.emit(Nt.RequestUploadStats,t,i),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}requestReconnect(){var t=this;return U(function*(){t.dtlsFailedCount+=1,yield Ar(_T(t.dtlsFailedCount,ur)),t.emit(Nt.RequestReconnect)})()}reconnectP2P(){var t=this;return U(function*(){const i=Array.from(t.localTrackMap.entries()),o=t.createGatewayUnpublishMessage(i);Array.from(t.remoteUserMap.entries()),o.length>0&&(yield yi(t,Nt.RequestUnpublishForReconnectPC,o)),t.disconnectForReconnect(),t.emit(Nt.RequestReconnectPC)})()}canPublishLowStream(){return this.localTrackMap.has(Pe.LocalVideoTrack)||this.pendingLocalTracks.some(t=>t instanceof dr)}throwIfTrackTypeNotMatch(t){if(t.filter(i=>i instanceof dr).length>1)throw new V(L.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t.filter(i=>i instanceof Li).length>1&&(t.some(i=>i instanceof Li&&i._bypassWebAudio)||!Vr().webAudioMediaStreamDest))throw new V(L.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const i of t){if(i instanceof dr&&this.pendingLocalTracks.some(o=>o instanceof dr))throw new V(L.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(i instanceof Li&&this.pendingLocalTracks.some(o=>o instanceof Li)&&(!Vr().webAudioMediaStreamDest||i._bypassWebAudio||this.pendingLocalTracks.some(o=>o instanceof Li&&o._bypassWebAudio)))throw new V(L.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(t,i){const o=Vr().supportDualStreamEncoding,s=zu(zu({},{width:160,height:120,framerate:15,bitrate:50}),i);let c;c=o?t._mediaStreamTrack.clone():fa(t,s);const l=new dr(c,zu(zu({},o&&{scaleResolutionDownBy:Bm(s,t)}),{},{frameRate:s.framerate,bitrateMax:s.bitrate,bitrateMin:s.bitrate}));return l._hints.push(br.LOW_STREAM),t.addListener(Qe.NEED_CLOSE,()=>{l.close()}),l}globalLock(){var t=this;return U(function*(){return t.mutex.lock("From P2PChannel.globalLock")})()}reportVideoFirstFrameDecoded(t,i,o,s){var c;const l=Array.from(ph(c=this.remoteUserMap).call(c)).find(p=>p._videoSSRC===t);if(l){s||this.store.subscribe(l.uid,"video",void 0,void 0,void 0,void 0,Date.now());const p=this.store.keyMetrics,h=p.subscribe.find(g=>g.userId===l.uid&&"video"===g.type);pe.firstRemoteVideoDecode(this.store.sessionId,gt.FIRST_VIDEO_DECODE,gn.FIRST_VIDEO_DECODE,{peer:l._uintid,videowidth:i,videoheight:o,subscribeElapse:Uo.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId,apEnd:p.requestAPEnd||0,apStart:p.requestAPStart||0,joinGwEnd:p.joinGatewayEnd||0,joinGwStart:p.joinGatewayStart||0,pcEnd:p.peerConnectionEnd||0,pcStart:p.peerConnectionStart||0,subscriberEnd:h?.subscribeEnd||0,subscriberStart:h?.subscribeStart||0,videoAddNotify:h?.streamAdded||0,state:s?1:0})}}remoteMediaSsrcChanged(t,i,o){var s=this;return U(function*(){if(!s.connection)return!1;const c=s.remoteUserMap.get(t);if(!c)return!1;const l=c.get(i);if(!l)return!1;const p=yield s.connection.getRemoteSSRC(l);return void 0!==p&&p!==o})()}}).prototype,"startP2PConnection",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"startP2PConnection"),Lt.prototype),Te(Lt.prototype,"connect",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"connect"),Lt.prototype),Te(Lt.prototype,"preConnect",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"preConnect"),Lt.prototype),Te(Lt.prototype,"unpublish",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"unpublish"),Lt.prototype),Te(Lt.prototype,"unpublishLowStream",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"unpublishLowStream"),Lt.prototype),Te(Lt.prototype,"subscribe",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"subscribe"),Lt.prototype),Te(Lt.prototype,"massSubscribe",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"massSubscribe"),Lt.prototype),Te(Lt.prototype,"unsubscribe",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"unsubscribe"),Lt.prototype),Te(Lt.prototype,"massUnsubscribe",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"massUnsubscribe"),Lt.prototype),Te(Lt.prototype,"muteRemote",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"muteRemote"),Lt.prototype),Te(Lt.prototype,"unmuteRemote",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"unmuteRemote"),Lt.prototype),Te(Lt.prototype,"hasRemoteMediaWithLock",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"hasRemoteMediaWithLock"),Lt.prototype),Te(Lt.prototype,"disconnectForReconnect",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"disconnectForReconnect"),Lt.prototype),Te(Lt.prototype,"updateBitrateLimit",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"updateBitrateLimit"),Lt.prototype),Te(Lt.prototype,"remoteMediaSsrcChanged",[Ls],Object.getOwnPropertyDescriptor(Lt.prototype,"remoteMediaSsrcChanged"),Lt.prototype),LC=Lt))||LC;function Ls(t,i,o){const s=t[i];if("function"!=typeof s)throw new Error("Cannot use mutex on object property.");return o.value=U(function*(){const c=this.mutex,l=yield c.lock("From P2PChannel.".concat(i));try{for(var p=arguments.length,h=new Array(p),g=0;g<p;g++)h[g]=arguments[g];return yield s.apply(this,h)}finally{l()}}),o}function Kc(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var xt,eq="function"==typeof Symbol&&Symbol.observable||"@@observable",KG=function(){return Math.random().toString(36).substring(7).split("").join(".")},tq={INIT:"@@redux/INIT"+KG(),REPLACE:"@@redux/REPLACE"+KG(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+KG()}};function Lq(t){if("object"!=typeof t||null===t)return!1;for(var i=t;null!==Object.getPrototypeOf(i);)i=Object.getPrototypeOf(i);return Object.getPrototypeOf(t)===i}function nq(t,i,o){var s;if("function"==typeof i&&"function"==typeof o||"function"==typeof o&&"function"==typeof arguments[3])throw new Error(Kc(0));if("function"==typeof i&&void 0===o&&(o=i,i=void 0),void 0!==o){if("function"!=typeof o)throw new Error(Kc(1));return o(nq)(t,i)}if("function"!=typeof t)throw new Error(Kc(2));var c=t,l=i,p=[],h=p,g=!1;function f(){h===p&&(h=p.slice())}function A(){if(g)throw new Error(Kc(3));return l}function _(R){if("function"!=typeof R)throw new Error(Kc(4));if(g)throw new Error(Kc(5));var D=!0;return f(),h.push(R),function(){if(D){if(g)throw new Error(Kc(6));D=!1,f();var O=h.indexOf(R);h.splice(O,1),p=null}}}function v(R){if(!Lq(R))throw new Error(Kc(7));if(void 0===R.type)throw new Error(Kc(8));if(g)throw new Error(Kc(9));try{g=!0,l=c(l,R)}finally{g=!1}for(var D=p=h,O=0;O<D.length;O++)(0,D[O])();return R}function y(R){if("function"!=typeof R)throw new Error(Kc(10));c=R,v({type:tq.REPLACE})}function S(){var R,D=_;return(R={subscribe:function(O){if("object"!=typeof O||null===O)throw new Error(Kc(11));function P(){O.next&&O.next(A())}return P(),{unsubscribe:D(P)}}})[eq]=function(){return this},R}return v({type:tq.INIT}),(s={dispatch:v,subscribe:_,getState:A,replaceReducer:y})[eq]=S,s}function rq(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function Le(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?rq(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):rq(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}!function(t){t.SET_SESSION_ID="SET_SESSION_ID",t.SET_P2P_ID="SET_P2P_id",t.SET_DC_ID="SET_DC_id",t.SET_UID="SET_UID",t.SET_PUB_ID="SET_PUB_ID",t.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",t.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",t.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",t.AVOID_JOIN_START="AVOID_JOIN_START",t.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",t.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",t.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",t.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",t.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",t.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",t.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",t.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",t.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",t.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",t.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",t.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",t.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",t.RESET_KEY_METRICS="RESET_KEY_METRICS"}(xt||(xt={}));class xq{constructor(i,o,s,c){b(this,"store",void 0),b(this,"reducer",void 0);const l={codec:i,audioCodec:o,mode:s,clientId:c,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled"};this.reducer=function(){let p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,h=arguments.length>1?arguments[1]:void 0;switch(h.type){case xt.SET_SESSION_ID:return Le(Le({},p),{},{sessionId:h.sessionId});case xt.SET_P2P_ID:return Le(Le({},p),{},{p2pId:h.p2pId});case xt.SET_UID:return Le(Le({},p),{},{uid:h.uid});case xt.SET_PUB_ID:return Le(Le({},p),{},{pubId:h.pubId});case xt.KEY_METRIC_CLIENT_CREATED:return Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{clientCreated:h.metric})});case xt.KEY_METRIC_JOIN_START:return Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{joinStart:h.metric})});case xt.AVOID_JOIN_START:return Le(Le({},p),{},{avoidJoinStart:h.avoidJoinStart});case xt.KEY_METRIC_JOIN_END:return Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{joinEnd:h.metric})});case xt.KEY_METRIC_REQUEST_AP_START:return Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{requestAPStart:h.metric})});case xt.KEY_METRIC_REQUEST_AP_END:return Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{requestAPEnd:h.metric})});case xt.KEY_METRIC_JOIN_GATEWAY_START:return Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{joinGatewayStart:h.metric})});case xt.KEY_METRIC_JOIN_GATEWAY_END:return Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{joinGatewayEnd:h.metric})});case xt.KEY_METRIC_PEER_CONNECTION_START:return Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{peerConnectionStart:h.metric})});case xt.KEY_METRIC_PEER_CONNECTION_END:return Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{peerConnectionEnd:h.metric})});case xt.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{signalChannelOpen:h.metric})});case xt.KEY_METRIC_ICE_CONNECTION_END:return Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{iceConnectionEnd:h.metric})});case xt.KEY_METRIC_PUBLISH:{const g=p.keyMetrics.publish,f=g.findIndex(A=>A.trackId===h.metric.trackId);return-1!==f?(g[f]=Le(Le({},g[f]),h.metric),Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{publish:[...g]})})):Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{publish:[...p.keyMetrics.publish,h.metric]})})}case xt.KEY_METRIC_SUBSCRIBE:{const g=p.keyMetrics.subscribe,f=g.findIndex(A=>A.userId===h.metric.userId&&A.type===h.metric.type);return-1!==f?(g[f]=Le(Le({},g[f]),h.metric),Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{subscribe:[...g]})})):Le(Le({},p),{},{keyMetrics:Le(Le({},p.keyMetrics),{},{subscribe:[...p.keyMetrics.subscribe,h.metric]})})}case xt.SET_CLOUD_PROXY_SERVER_MODE:return p.cloudProxyServerMode=h.mode,p;case xt.RECORD_JOIN_CHANNEL_SERVICE:return"number"!=typeof h.index?p.joinChannelServiceRecords=[...p.joinChannelServiceRecords,h.record]:(p.joinChannelServiceRecords[h.index]=Le(Le({},p.joinChannelServiceRecords[h.index]),h.record),p.joinChannelServiceRecords=[...p.joinChannelServiceRecords]),p;case xt.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return p.joinChannelServiceRecords=[],p;case xt.RESET_KEY_METRICS:return p.keyMetrics={publish:[],subscribe:[]},p;default:return p}},this.store=nq(this.reducer)}set sessionId(i){this.store.dispatch({type:xt.SET_SESSION_ID,sessionId:i})}get sessionId(){return this.store.getState().sessionId}get codec(){return this.store.getState().codec}get audioCodec(){return this.store.getState().audioCodec}get clientId(){return this.store.getState().clientId}set p2pId(i){this.store.dispatch({type:xt.SET_P2P_ID,p2pId:i})}get p2pId(){return this.store.getState().p2pId}set dcId(i){this.store.dispatch({type:xt.SET_DC_ID,dcId:i})}get dcId(){return this.store.getState().dcId}set uid(i){this.store.dispatch({type:xt.SET_UID,uid:i})}get uid(){return this.store.getState().uid}set pubId(i){this.store.dispatch({type:xt.SET_PUB_ID,pubId:i})}get pubId(){return this.store.getState().pubId}set cloudProxyServerMode(i){this.store.dispatch({type:xt.SET_CLOUD_PROXY_SERVER_MODE,mode:i})}get cloudProxyServerMode(){return this.store.getState().cloudProxyServerMode}clientCreated(){this.store.dispatch({type:xt.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.store.dispatch({type:xt.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.store.dispatch({type:xt.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.store.dispatch({type:xt.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.store.dispatch({type:xt.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.store.dispatch({type:xt.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.store.dispatch({type:xt.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.store.dispatch({type:xt.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.store.dispatch({type:xt.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}signalChannelOpen(){this.store.dispatch({type:xt.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.store.dispatch({type:xt.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(i,o,s,c){this.store.dispatch({type:xt.KEY_METRIC_PUBLISH,metric:Le(Le({trackId:i,type:o},s&&{publishStart:s}),c&&{publishEnd:c})})}subscribe(i,o,s,c,l,p,h){this.store.dispatch({type:xt.KEY_METRIC_SUBSCRIBE,metric:Le(Le(Le(Le(Le({userId:i,type:o},s&&{subscribeStart:s}),c&&{subscribeEnd:c}),l&&{firstFrame:l}),p&&{streamAdded:p}),h&&{firstDecoded:h})})}massSubscribe(i,o,s,c){i.forEach(l=>{this.store.dispatch({type:xt.KEY_METRIC_SUBSCRIBE,metric:Le(Le(Le({userId:l.userId,type:l.type},o&&{subscribeStart:o}),s&&{subscribeEnd:s}),c&&{firstFrame:c})})})}get keyMetrics(){return this.store.getState().keyMetrics}recordJoinChannelService(i,o){"gateway"===i.service&&Array.isArray(i.urls)&&(i.urls=i.urls.map(s=>s.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return"number"!=typeof o?(this.store.dispatch({type:xt.RECORD_JOIN_CHANNEL_SERVICE,record:Le(Le({},i),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.store.getState().joinChannelServiceRecords.length-1):(o<0||o>=this.store.getState().joinChannelServiceRecords.length||this.store.dispatch({type:xt.RECORD_JOIN_CHANNEL_SERVICE,record:i,index:o}),o)}catch{return 0}}resetJoinChannelServiceRecords(){this.store.dispatch({type:xt.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.store.dispatch({type:xt.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.store.getState().joinChannelServiceRecords}catch{return[]}}get avoidJoinStart(){return this.store.getState().avoidJoinStart}set avoidJoinStart(i){this.store.dispatch({type:xt.AVOID_JOIN_START,avoidJoinStart:i})}}let XF;const iq=()=>void 0!==window.isSecureContext;function Vq(t){let i={};e:for(;!cq(t);){let o=rd(t);switch(o>>>3){case 0:break e;case 1:i.requestId=uq(t,rd(t));break;case 2:i.requestType=rd(t)>>>0;break;case 3:i.scorePorn=zG(t);break;case 4:i.scoreSexy=zG(t);break;case 5:i.scoreNeutral=zG(t);break;case 6:i.requestScene=rd(t)>>>0;break;case 7:i.scene=rd(t)>>>0;break;default:oq(t,7&o)}}return i}function jq(t,i){let o=t.service;void 0!==o&&(Kt(i,8),Kt(i,o));let s=t.vendor;void 0!==s&&(Kt(i,16),Kt(i,s));let c=t.token;void 0!==c&&(Kt(i,26),nd(i,c));let l=t.callbackUrl;void 0!==l&&(Kt(i,34),nd(i,l))}function Qq(t){let i=rd(t),o=t.limit;return t.limit=t.offset+i,o}function oq(t,i){switch(i){case 0:for(;128&lq(t););break;case 2:qG(t,rd(t));break;case 5:qG(t,4);break;case 1:qG(t,8);break;default:throw new Error("Unimplemented type: "+i)}}let Gq=new Float32Array(1);new Uint8Array(Gq.buffer);let YG=new Float64Array(1),is=new Uint8Array(YG.buffer);function BC(t){return{low:t|=0,high:t>>31,unsigned:t>=0}}let sq=[];function aq(){const t=sq.pop();return t?(t.offset=t.limit=0,t):{bytes:new Uint8Array(64),offset:0,limit:0}}function Hq(t){sq.push(t)}function qG(t,i){if(t.offset+i>t.limit)throw new Error("Skip past limit");t.offset+=i}function cq(t){return t.offset>=t.limit}function FC(t,i){let o=t.bytes,s=t.offset,c=t.limit,l=s+i;if(l>o.length){let p=new Uint8Array(2*l);p.set(o),t.bytes=p}return t.offset=l,l>c&&(t.limit=l),s}function JG(t,i){let o=t.offset;if(o+i>t.limit)throw new Error("Read past limit");return t.offset+=i,o}function uq(t,i){let o=JG(t,i),s=String.fromCharCode,c=t.bytes,l="\ufffd",p="";for(let h=0;h<i;h++){let g,f,A,_,v=c[h+o];0==(128&v)?p+=s(v):192==(224&v)?h+1>=i?p+=l:(g=c[h+o+1],128!=(192&g)?p+=l:(_=(31&v)<<6|63&g,_<128?p+=l:(p+=s(_),h++))):224==(240&v)?h+2>=i?p+=l:(g=c[h+o+1],f=c[h+o+2],32896!=(49344&(g|f<<8))?p+=l:(_=(15&v)<<12|(63&g)<<6|63&f,_<2048||_>=55296&&_<=57343?p+=l:(p+=s(_),h+=2))):240==(248&v)?h+3>=i?p+=l:(g=c[h+o+1],f=c[h+o+2],A=c[h+o+3],8421504!=(12632256&(g|f<<8|A<<16))?p+=l:(_=(7&v)<<18|(63&g)<<12|(63&f)<<6|63&A,_<65536||_>1114111?p+=l:(_-=65536,p+=s(55296+(_>>10),56320+(1023&_)),h+=3))):p+=l}return p}function nd(t,i){let o=i.length,s=0;for(let p=0;p<o;p++){let h=i.charCodeAt(p);h>=55296&&h<=56319&&p+1<o&&(h=(h<<10)+i.charCodeAt(++p)-56613888),s+=h<128?1:h<2048?2:h<65536?3:4}Kt(t,s);let c=FC(t,s),l=t.bytes;for(let p=0;p<o;p++){let h=i.charCodeAt(p);h>=55296&&h<=56319&&p+1<o&&(h=(h<<10)+i.charCodeAt(++p)-56613888),h<128?l[c++]=h:(h<2048?l[c++]=h>>6&31|192:(h<65536?l[c++]=h>>12&15|224:(l[c++]=h>>18&7|240,l[c++]=h>>12&63|128),l[c++]=h>>6&63|128),l[c++]=63&h|128)}}function Wq(t,i){let o=FC(t,i.limit),s=t.bytes,c=i.bytes;for(let l=0,p=i.limit;l<p;l++)s[l+o]=c[l]}function lq(t){return t.bytes[JG(t,1)]}function dq(t,i){let o=FC(t,1);t.bytes[o]=i}function zG(t){let i=JG(t,8),o=t.bytes;return is[0]=o[i++],is[1]=o[i++],is[2]=o[i++],is[3]=o[i++],is[4]=o[i++],is[5]=o[i++],is[6]=o[i++],is[7]=o[i++],YG[0]}function $G(t,i){let o=FC(t,8),s=t.bytes;YG[0]=i,s[o++]=is[0],s[o++]=is[1],s[o++]=is[2],s[o++]=is[3],s[o++]=is[4],s[o++]=is[5],s[o++]=is[6],s[o++]=is[7]}function rd(t){let i,o=0,s=0;do{i=lq(t),o<32&&(s|=(127&i)<<o),o+=7}while(128&i);return s}function Kt(t,i){for(i>>>=0;i>=128;)dq(t,127&i|128),i>>>=7;dq(t,i)}function rg(t,i){let o=i.low>>>0,s=(i.low>>>28|i.high<<4)>>>0,c=i.high>>>24,l=0===c?0===s?o<16384?o<128?1:2:o<1<<21?3:4:s<16384?s<128?5:6:s<1<<21?7:8:c<128?9:10,p=FC(t,l),h=t.bytes;switch(l){case 10:h[p+9]=c>>>7&1;case 9:h[p+8]=9!==l?128|c:127&c;case 8:h[p+7]=8!==l?s>>>21|128:s>>>21&127;case 7:h[p+6]=7!==l?s>>>14|128:s>>>14&127;case 6:h[p+5]=6!==l?s>>>7|128:s>>>7&127;case 5:h[p+4]=5!==l?128|s:127&s;case 4:h[p+3]=4!==l?o>>>21|128:o>>>21&127;case 3:h[p+2]=3!==l?o>>>14|128:o>>>14&127;case 2:h[p+1]=2!==l?o>>>7|128:o>>>7&127;case 1:h[p]=1!==l?128|o:127&o}}var hq={};Object.defineProperty(hq,"__esModule",{value:!0});var pq=function(){function t(){this._dataLength=0,this._bufferLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}return t.hashStr=function(i,o){return void 0===o&&(o=!1),this.onePassHasher.start().appendStr(i).end(o)},t.hashAsciiStr=function(i,o){return void 0===o&&(o=!1),this.onePassHasher.start().appendAsciiStr(i).end(o)},t._hex=function(i){var o,s,c,l,p=t.hexChars,h=t.hexOut;for(l=0;l<4;l+=1)for(s=8*l,o=i[l],c=0;c<8;c+=2)h[s+1+c]=p.charAt(15&o),h[s+0+c]=p.charAt(15&(o>>>=4)),o>>>=4;return h.join("")},t._md5cycle=function(i,o){var s=i[0],c=i[1],l=i[2],p=i[3];c=((c+=((l=((l+=((p=((p+=((s=((s+=(c&l|~c&p)+o[0]-680876936|0)<<7|s>>>25)+c|0)&c|~s&l)+o[1]-389564586|0)<<12|p>>>20)+s|0)&s|~p&c)+o[2]+606105819|0)<<17|l>>>15)+p|0)&p|~l&s)+o[3]-1044525330|0)<<22|c>>>10)+l|0,c=((c+=((l=((l+=((p=((p+=((s=((s+=(c&l|~c&p)+o[4]-176418897|0)<<7|s>>>25)+c|0)&c|~s&l)+o[5]+1200080426|0)<<12|p>>>20)+s|0)&s|~p&c)+o[6]-1473231341|0)<<17|l>>>15)+p|0)&p|~l&s)+o[7]-45705983|0)<<22|c>>>10)+l|0,c=((c+=((l=((l+=((p=((p+=((s=((s+=(c&l|~c&p)+o[8]+1770035416|0)<<7|s>>>25)+c|0)&c|~s&l)+o[9]-1958414417|0)<<12|p>>>20)+s|0)&s|~p&c)+o[10]-42063|0)<<17|l>>>15)+p|0)&p|~l&s)+o[11]-1990404162|0)<<22|c>>>10)+l|0,c=((c+=((l=((l+=((p=((p+=((s=((s+=(c&l|~c&p)+o[12]+1804603682|0)<<7|s>>>25)+c|0)&c|~s&l)+o[13]-40341101|0)<<12|p>>>20)+s|0)&s|~p&c)+o[14]-1502002290|0)<<17|l>>>15)+p|0)&p|~l&s)+o[15]+1236535329|0)<<22|c>>>10)+l|0,c=((c+=((l=((l+=((p=((p+=((s=((s+=(c&p|l&~p)+o[1]-165796510|0)<<5|s>>>27)+c|0)&l|c&~l)+o[6]-1069501632|0)<<9|p>>>23)+s|0)&c|s&~c)+o[11]+643717713|0)<<14|l>>>18)+p|0)&s|p&~s)+o[0]-373897302|0)<<20|c>>>12)+l|0,c=((c+=((l=((l+=((p=((p+=((s=((s+=(c&p|l&~p)+o[5]-701558691|0)<<5|s>>>27)+c|0)&l|c&~l)+o[10]+38016083|0)<<9|p>>>23)+s|0)&c|s&~c)+o[15]-660478335|0)<<14|l>>>18)+p|0)&s|p&~s)+o[4]-405537848|0)<<20|c>>>12)+l|0,c=((c+=((l=((l+=((p=((p+=((s=((s+=(c&p|l&~p)+o[9]+568446438|0)<<5|s>>>27)+c|0)&l|c&~l)+o[14]-1019803690|0)<<9|p>>>23)+s|0)&c|s&~c)+o[3]-187363961|0)<<14|l>>>18)+p|0)&s|p&~s)+o[8]+1163531501|0)<<20|c>>>12)+l|0,c=((c+=((l=((l+=((p=((p+=((s=((s+=(c&p|l&~p)+o[13]-1444681467|0)<<5|s>>>27)+c|0)&l|c&~l)+o[2]-51403784|0)<<9|p>>>23)+s|0)&c|s&~c)+o[7]+1735328473|0)<<14|l>>>18)+p|0)&s|p&~s)+o[12]-1926607734|0)<<20|c>>>12)+l|0,c=((c+=((l=((l+=((p=((p+=((s=((s+=(c^l^p)+o[5]-378558|0)<<4|s>>>28)+c|0)^c^l)+o[8]-2022574463|0)<<11|p>>>21)+s|0)^s^c)+o[11]+1839030562|0)<<16|l>>>16)+p|0)^p^s)+o[14]-35309556|0)<<23|c>>>9)+l|0,c=((c+=((l=((l+=((p=((p+=((s=((s+=(c^l^p)+o[1]-1530992060|0)<<4|s>>>28)+c|0)^c^l)+o[4]+1272893353|0)<<11|p>>>21)+s|0)^s^c)+o[7]-155497632|0)<<16|l>>>16)+p|0)^p^s)+o[10]-1094730640|0)<<23|c>>>9)+l|0,c=((c+=((l=((l+=((p=((p+=((s=((s+=(c^l^p)+o[13]+681279174|0)<<4|s>>>28)+c|0)^c^l)+o[0]-358537222|0)<<11|p>>>21)+s|0)^s^c)+o[3]-722521979|0)<<16|l>>>16)+p|0)^p^s)+o[6]+76029189|0)<<23|c>>>9)+l|0,c=((c+=((l=((l+=((p=((p+=((s=((s+=(c^l^p)+o[9]-640364487|0)<<4|s>>>28)+c|0)^c^l)+o[12]-421815835|0)<<11|p>>>21)+s|0)^s^c)+o[15]+530742520|0)<<16|l>>>16)+p|0)^p^s)+o[2]-995338651|0)<<23|c>>>9)+l|0,c=((c+=((p=((p+=(c^((s=((s+=(l^(c|~p))+o[0]-198630844|0)<<6|s>>>26)+c|0)|~l))+o[7]+1126891415|0)<<10|p>>>22)+s|0)^((l=((l+=(s^(p|~c))+o[14]-1416354905|0)<<15|l>>>17)+p|0)|~s))+o[5]-57434055|0)<<21|c>>>11)+l|0,c=((c+=((p=((p+=(c^((s=((s+=(l^(c|~p))+o[12]+1700485571|0)<<6|s>>>26)+c|0)|~l))+o[3]-1894986606|0)<<10|p>>>22)+s|0)^((l=((l+=(s^(p|~c))+o[10]-1051523|0)<<15|l>>>17)+p|0)|~s))+o[1]-2054922799|0)<<21|c>>>11)+l|0,c=((c+=((p=((p+=(c^((s=((s+=(l^(c|~p))+o[8]+1873313359|0)<<6|s>>>26)+c|0)|~l))+o[15]-30611744|0)<<10|p>>>22)+s|0)^((l=((l+=(s^(p|~c))+o[6]-1560198380|0)<<15|l>>>17)+p|0)|~s))+o[13]+1309151649|0)<<21|c>>>11)+l|0,c=((c+=((p=((p+=(c^((s=((s+=(l^(c|~p))+o[4]-145523070|0)<<6|s>>>26)+c|0)|~l))+o[11]-1120210379|0)<<10|p>>>22)+s|0)^((l=((l+=(s^(p|~c))+o[2]+718787259|0)<<15|l>>>17)+p|0)|~s))+o[9]-343485551|0)<<21|c>>>11)+l|0,i[0]=s+i[0]|0,i[1]=c+i[1]|0,i[2]=l+i[2]|0,i[3]=p+i[3]|0},t.prototype.start=function(){return this._dataLength=0,this._bufferLength=0,this._state.set(t.stateIdentity),this},t.prototype.appendStr=function(i){var o,s,c=this._buffer8,l=this._buffer32,p=this._bufferLength;for(s=0;s<i.length;s+=1){if((o=i.charCodeAt(s))<128)c[p++]=o;else if(o<2048)c[p++]=192+(o>>>6),c[p++]=63&o|128;else if(o<55296||o>56319)c[p++]=224+(o>>>12),c[p++]=o>>>6&63|128,c[p++]=63&o|128;else{if((o=1024*(o-55296)+(i.charCodeAt(++s)-56320)+65536)>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");c[p++]=240+(o>>>18),c[p++]=o>>>12&63|128,c[p++]=o>>>6&63|128,c[p++]=63&o|128}p>=64&&(this._dataLength+=64,t._md5cycle(this._state,l),p-=64,l[0]=l[16])}return this._bufferLength=p,this},t.prototype.appendAsciiStr=function(i){for(var o,s=this._buffer8,c=this._buffer32,l=this._bufferLength,p=0;;){for(o=Math.min(i.length-p,64-l);o--;)s[l++]=i.charCodeAt(p++);if(l<64)break;this._dataLength+=64,t._md5cycle(this._state,c),l=0}return this._bufferLength=l,this},t.prototype.appendByteArray=function(i){for(var o,s=this._buffer8,c=this._buffer32,l=this._bufferLength,p=0;;){for(o=Math.min(i.length-p,64-l);o--;)s[l++]=i[p++];if(l<64)break;this._dataLength+=64,t._md5cycle(this._state,c),l=0}return this._bufferLength=l,this},t.prototype.getState=function(){var i=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[i[0],i[1],i[2],i[3]]}},t.prototype.setState=function(i){var o,s=i.buffer,c=i.state,l=this._state;for(this._dataLength=i.length,this._bufferLength=i.buflen,l[0]=c[0],l[1]=c[1],l[2]=c[2],l[3]=c[3],o=0;o<s.length;o+=1)this._buffer8[o]=s.charCodeAt(o)},t.prototype.end=function(i){void 0===i&&(i=!1);var o=this._bufferLength,s=this._buffer8,c=this._buffer32,l=1+(o>>2);this._dataLength+=o;var p=8*this._dataLength;if(s[o]=128,s[o+1]=s[o+2]=s[o+3]=0,c.set(t.buffer32Identity.subarray(l),l),o>55&&(t._md5cycle(this._state,c),c.set(t.buffer32Identity)),p<=4294967295)c[14]=p;else{var h=p.toString(16).match(/(.*?)(.{0,8})$/);if(null===h)return;var g=parseInt(h[2],16),f=parseInt(h[1],16)||0;c[14]=g,c[15]=f}return t._md5cycle(this._state,c),i?this._state:t._hex(this._state)},t.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),t.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),t.hexChars="0123456789abcdef",t.hexOut=[],t.onePassHasher=new t,t}(),Kq=hq.Md5=pq;if("5d41402abc4b2a76b9719d911017c592"!==pq.hashStr("hello"))throw new Error("Md5 self test failed.");const Yq=function(){var t=U(function*(i,o,s){return yield(c=U(function*(l,p,h){const f=new Uint8Array(Kq.hashStr(""+p+h,!0).buffer).slice(0,16),A=f.slice(0,12),_=yield window.crypto.subtle.importKey("raw",f,"AES-GCM",!0,["encrypt"]);return new Uint8Array(yield window.crypto.subtle.encrypt({name:"AES-GCM",iv:A},_,l))}),function(l,p,h){return c.apply(this,arguments)})(i.buffer,o,s);var c});return function(o,s,c){return t.apply(this,arguments)}}();function fq(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}const qq=new Map([["moderation",1],["supervise",2]]);class ZF extends En{get connectionState(){return this._connectionState}set connectionState(i){if(this._connectionState===i)return;const o=this._connectionState;this._connectionState=i,this.emit(zn.CONNECTION_STATE_CHANGE,o,i)}get inspectType(){return this._inspectType}set inspectType(i){var o;this._inspectMode=hc(o=i.map(s=>qq.get(s)||0)).call(o,(s,c)=>s+c),this._inspectType=i}get quality(){return this._quality}set quality(i){this._quality=i>1?1:i<.1?.1:i,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(i){super(),b(this,"name","AgoraRTCVideoContentInspect"),b(this,"_connectionState",Pi.CONNECTING),b(this,"_innerConnectionState",void 0),b(this,"sequence",0),b(this,"inspectStartTime",void 0),b(this,"workerManagerConnection",void 0),b(this,"workerConnection",void 0),b(this,"workerMessageLengthLimit",void 0),b(this,"inspectIntervalMinimum",void 0),b(this,"qualityRatio",void 0),b(this,"_connectInfo",void 0),b(this,"_cancelTokenSource",es.CancelToken.source()),b(this,"_retryConfig",void 0),b(this,"wmSequence",0),b(this,"inspectInterval",void 0),b(this,"inspectTimer",null),b(this,"ossFilePrefix",void 0),b(this,"extraInfo",void 0),b(this,"_inspectType",void 0),b(this,"_inspectMode",void 0),b(this,"_quality",1),b(this,"qualityTimer",null),b(this,"_inspectId",void 0),b(this,"_needWorkUrlOnly",!1),b(this,"inspectImage",()=>{if(this.connectionState!==Pi.CONNECTED)throw new V(L.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{if(this.connectionState!==Pi.CONNECTED)return N.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState),void Re("debug",this,"Inspect State is not connected , ".concat(this.connectionState));this.requestToInspectImage()},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=xn(5,"inspect-"),this.workerMessageLengthLimit=J("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=J("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=J("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=i.interval,this.ossFilePrefix=i.ossFilePrefix,this.extraInfo=i.extraInfo,this.inspectType=i.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new Th("worker-manager-"+this._inspectId,ur),this.on(zn.STATE_CHANGE,(o,s)=>{this._innerConnectionState=o,N.debug("[".concat(this._inspectId,"] Inspect operation :").concat(mo[o]," ").concat(s||"")),Po("debug",["Inspect",this._inspectId],zn.STATE_CHANGE,"".concat(mo[o]," ").concat(s||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new Th("worker-"+this._inspectId,ur),this.handleWorkerEvents()}init(i,o){var s=this;return U(function*(){s.emit(zn.STATE_CHANGE,mo.CONNECT_AP),s._connectInfo=i;const c=s._cancelTokenSource.token;return s._retryConfig=o,new Ie((l,p)=>{s.on(zn.CONNECTION_STATE_CHANGE,(h,g)=>{g===Pi.CONNECTED&&l()}),s.requestAP(i,c,o).then(h=>{s.connectWorkerManager(h)}).catch(h=>{p(h)})})})()}requestAP(i,o,s){var c=this;return U(function*(){const l=J("WEBCS_DOMAIN").map(g=>"https://".concat(g,"/api/v1")),p=yield function(g,f,A,_){let{appId:v,areaCode:y,cname:S,sid:R,token:D,uid:O}=f;M3++;const P="image_moderation_api",B={service_name:P,json_body:JSON.stringify({appId:v,areaCode:y,cname:S,command:"allocateEdge",requestId:M3,seq:M3,sid:R,token:D,ts:Date.now(),uid:O+""})};let G,Y,ae=g[0];return Va(U(function*(){G=Date.now();const te=yield Ka(ae,{data:B,cancelToken:A,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(Y=Date.now()-G,0!==te.code){const Se=new V(L.UNEXPECTED_RESPONSE,"image inspect ap error, code"+te.code,{retry:!0,responseTime:Y});throw N.error(Se.toString()),le("error",["AjaxAPI"],"requestImageInspectAP",void 0,Se.toString()),Se}const Z=JSON.parse(te.json_body);if(200!==Z.code){const Se=new V(L.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(Z.code,", reason: ").concat(Z.reason),{code:Z.code,responseTime:Y});throw N.error(Se.toString()),le("error",["AjaxAPI"],"requestImageInspectAP",void 0,Se.toString()),Se}if(!Z.servers||!Array.isArray(Z.servers)||0===Z.servers.length){const Se=new V(L.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:Z.code,responseTime:Y});throw N.error(Se.toString()),le("error",["AjaxAPI"],"requestImageInspectAP",void 0,Se.toString()),Se}const _e=J("VIDEO_INSPECT_WORKER_MANAGER_HOST"),fe=J("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:Z.servers.map(Se=>{let{address:Oe,wss:Ye}=Se;if(Oe&&Ye)return"wss://".concat(Oe.replace(/\./g,"-"),".").concat(_e,":").concat(fe||Ye)}).filter(Se=>!!Se),workerToken:Z.workerToken,vid:Z.vid,responseTime:Y}}),(te,Z)=>(pe.apworkerEvent(R,{success:!0,sc:200,serviceName:P,responseDetail:JSON.stringify(te.addressList),firstSuccess:0===Z,responseTime:Y,serverIp:g[Z%g.length]}),!1),(te,Z)=>(pe.apworkerEvent(R,{success:!1,sc:te.data&&te.data.code||200,serviceName:P,responseTime:Y,serverIp:g[Z%g.length]}),!!(te.code!==L.OPERATION_ABORTED&&te.code!==L.UNEXPECTED_RESPONSE||te.data&&te.data.retry)&&(ae=g[(Z+1)%g.length],!0)),_)}(l,i,o,s);c.emit(zn.STATE_CHANGE,mo.AP_CONNECTED);const{addressList:h}=p;return c.wmSequence++,h})()}connectWorkerManager(i){var o=arguments,s=this;return U(function*(){s._needWorkUrlOnly=o.length>1&&void 0!==o[1]&&o[1],s.emit(zn.STATE_CHANGE,mo.CONNECT_WORKER_MANAGER),yield s.workerManagerConnection.init(i,1e4)})()}connectWorker(i){var o=this;return U(function*(){yield o.workerConnection.init([i])})()}handleWorkerManagerEvents(){var i=this;this.workerManagerConnection.on(ht.CONNECTED,U(function*(){i.emit(zn.STATE_CHANGE,mo.WORKER_MANAGER_CONNECTED,i.workerManagerConnection.url),i.workerManagerConnection.sendMessage({appId:i._connectInfo.appId,cname:i._connectInfo.cname,uid:i._connectInfo.uid+"",sdkVersion:"4.15.1",sid:i._connectInfo.sid,seq:i.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)})),this.workerManagerConnection.on(ht.CLOSED,()=>{this._innerConnectionState<mo.GET_WORKER_MANAGER_RESPONSE&&(N.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker")),Po("debug",["Inspect",this._inspectId],"workerManagerConnectionClosed"))}),this.workerManagerConnection.on(ht.FAILED,()=>{this._innerConnectionState<mo.GET_WORKER_MANAGER_RESPONSE&&(N.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker")),Po("debug",["Inspect",this._inspectId],"workerManagerConnectionFailed"))}),this.workerManagerConnection.on(ht.RECONNECTING,()=>{this._innerConnectionState<mo.GET_WORKER_MANAGER_RESPONSE&&(N.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker")),Po("debug",["Inspect",this._inspectId],"workerManagerConnectionReconnecting"))}),this.workerManagerConnection.on(ht.ON_MESSAGE,function(){var o=U(function*(s){i.emit(zn.STATE_CHANGE,mo.GET_WORKER_MANAGER_RESPONSE);const c=i.workerManagerConnection.url;i.workerManagerConnection.close();const l=JSON.parse(s.data);if(200!==l.code)throw N.error("[".concat(i._inspectId,"] Unexpected code ").concat(l.code," from worker manager")),Re("error",i,"Unexpected code ".concat(l.code," from worker manager")),new V(L.UNEXPECTED_RESPONSE,"response code of worker is unexpected",l);if(!(l.serverResponse&&l.serverResponse.portWss&&c))throw N.error("[".concat(i._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(l))),Re("error",i,"Unexpected content from worker manager : "+JSON.stringify(l)),new V(L.UNEXPECTED_RESPONSE,"response content of worker is unexpected",l);{const p=J("VIDEO_INSPECT_WORKER_PORT")||l.serverResponse.portWss,h=c.replace(/:\d+\/?$/,":".concat(p));i.emit(zn.STATE_CHANGE,mo.CONNECT_WORKER,h),i._needWorkUrlOnly?i.emit(zn.REQUEST_NEW_WORKER_URL,h):yield i.connectWorker(h)}});return function(s){return o.apply(this,arguments)}}()),this.workerManagerConnection.on(ht.WILL_RECONNECT,(o,s)=>{s(o)}),this.workerManagerConnection.on(ht.REQUEST_NEW_URLS,(o,s)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(o).catch(s)})}handleWorkerEvents(){var i=this;this.workerConnection.on(ht.CONNECTED,U(function*(){i.emit(zn.STATE_CHANGE,mo.WORKER_CONNECTED,i.workerConnection.url),i.connectionState=Pi.CONNECTED})),this.workerConnection.on(ht.ON_MESSAGE,function(){var o=U(function*(s){if(s.data instanceof ArrayBuffer){const l=function Uq(t){return function(o){let s={};e:for(;!cq(o);){let c=rd(o);switch(c>>>3){case 0:break e;case 1:s.code=rd(o);break;case 2:s.msg=uq(o,rd(o));break;case 3:{let l=Qq(o);s.data=Vq(o),o.limit=l;break}default:oq(o,7&c)}}return s}({bytes:i=t,offset:0,limit:i.length});var i}(new Uint8Array(s.data));if(J("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&N.debug("[".concat(i._inspectId,"] Response message for worker of inspect content "),JSON.stringify(l)),200===l.code){if(Array.isArray(i.inspectType)&&1===i.inspectType.length&&"supervise"===i.inspectType[0])return void i.emit(zn.INSPECT_RESULT,void 0,void 0);if(l.data&&l.data.scorePorn&&l.data.scoreSexy&&l.data.scoreNeutral){var c;const p={porn:l.data.scorePorn,sexy:l.data.scoreSexy,neutral:l.data.scoreNeutral},h=hc(c=Object.keys(p)).call(c,(f,A)=>p[f]>p[A]?f:A,"porn"),g=Object.keys(p).find(f=>f===h);i.emit(zn.INSPECT_RESULT,g)}else i.emit(zn.INSPECT_RESULT,void 0,new V(L.UNEXPECTED_RESPONSE,l.code+"","There is an unexpected data on message"))}else i.emit(zn.INSPECT_RESULT,void 0,new V(L.UNEXPECTED_RESPONSE,l.code+"",l.msg))}else N.error("[".concat(i._inspectId,"] Unexpected message type from worker")),Re("error",i,"Unexpected message type from worker"),i.emit(zn.INSPECT_RESULT,void 0,new V(L.UNEXPECTED_RESPONSE,"invalid worker message type"))});return function(s){return o.apply(this,arguments)}}()),this.workerConnection.on(ht.CLOSED,()=>{this.connectionState=Pi.CLOSED}),this.workerConnection.on(ht.FAILED,()=>{this.connectionState=Pi.CLOSED}),this.workerConnection.on(ht.RECONNECTING,()=>{this.connectionState=this.connectionState===Pi.CONNECTED?Pi.RECONNECTING:Pi.CONNECTING}),this.workerConnection.on(ht.WILL_RECONNECT,(o,s)=>{"recover"===o&&s(o),s("tryNext")}),this.workerConnection.on(ht.REQUEST_NEW_URLS,(o,s)=>{this.workerManagerConnection.close(),this.once(zn.REQUEST_NEW_WORKER_URL,c=>{o([c])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(c=>{this.connectWorkerManager(c,!0)}).catch(c=>{s(c)})})}static intToLong(i){return{low:i|=0,high:i>>31,unsigned:i>=0}}requestToInspectImage(){var i=this;return U(function*(){i.sequence++;const o=Uc(i,zn.CLIENT_LOCAL_VIDEO_TRACK),s={appId:i._connectInfo.appId,cname:i._connectInfo.cname,cid:i._connectInfo.cid,sid:i._connectInfo.sid,uid:i._connectInfo.uid,vid:i._connectInfo.vid};if(o){if(!o.isPlaying)return void i.emit(zn.INSPECT_RESULT,void 0,new V(L.INVALID_OPERATION,"Only the track being played can be inspected"));const c=yield i.generateRequestData(o,s);i.workerConnection.sendMessage(c,!0,!0)}else i.emit(zn.INSPECT_RESULT,void 0,new V(L.INVALID_OPERATION,"Only the track being published can be inspected"))})()}generateRequestData(i,o){var s=this;return U(function*(){let{appId:c,cname:l,cid:p,vid:h,sid:g,uid:f}=o;const A=Date.now(),_=yield i.getCurrentFrameImage("image/jpeg",s.quality),v=yield Yq(_,c,l),y=s.sequence+"-"+p+"-"+f+"-"+A+"-"+xn(12,""),S={appId:c,cid:p,cname:l,deviceId:"",elapse:ZF.intToLong(Number(A-s.inspectStartTime)),fileSize:v.byteLength,jpgEncryption:2,height:_.height,width:_.width,jpg:v,networkType:6,osType:7,requestId:y,sdkVersion:"4.15.1",sequence:s.sequence,sid:g,timestamp:ZF.intToLong(A),uid:f,vid:h,service:s._inspectMode,callbackData:s.extraInfo,ossFilePrefix:s.ossFilePrefix};void 0===s.extraInfo&&delete S.callbackData,void 0===s.ossFilePrefix&&delete S.ossFilePrefix;const R=function Fq(t){let i=aq();return function(o,s){let c=o.appId;void 0!==c&&(Kt(s,10),nd(s,c));let l=o.cid;void 0!==l&&(Kt(s,16),Kt(s,l));let p=o.cname;void 0!==p&&(Kt(s,26),nd(s,p));let h=o.deviceId;void 0!==h&&(Kt(s,34),nd(s,h));let g=o.elapse;void 0!==g&&(Kt(s,40),rg(s,g));let f=o.fileSize;void 0!==f&&(Kt(s,48),rg(s,BC(f)));let A=o.height;void 0!==A&&(Kt(s,56),rg(s,BC(A)));let _=o.jpg;void 0!==_&&(Kt(s,66),Kt(s,_.length),function(ee,Q){let K=FC(ee,Q.length);ee.bytes.set(Q,K)}(s,_));let v=o.networkType;void 0!==v&&(Kt(s,72),rg(s,BC(v)));let y=o.osType;void 0!==y&&(Kt(s,80),rg(s,BC(y)));let S=o.requestId;void 0!==S&&(Kt(s,90),nd(s,S));let R=o.sdkVersion;void 0!==R&&(Kt(s,98),nd(s,R));let D=o.sequence;void 0!==D&&(Kt(s,104),rg(s,BC(D)));let O=o.sid;void 0!==O&&(Kt(s,114),nd(s,O));let P=o.timestamp;void 0!==P&&(Kt(s,120),rg(s,P));let B=o.uid;void 0!==B&&(Kt(s,128),Kt(s,B));let G=o.vid;void 0!==G&&(Kt(s,136),Kt(s,G));let Y=o.width;void 0!==Y&&(Kt(s,144),rg(s,BC(Y)));let ae=o.service;void 0!==ae&&(Kt(s,152),Kt(s,ae));let te=o.callbackData;void 0!==te&&(Kt(s,162),nd(s,te));let Z=o.jpgEncryption;void 0!==Z&&(Kt(s,168),Kt(s,Z));let _e=o.requestType;void 0!==_e&&(Kt(s,176),Kt(s,_e));let fe=o.scorePorn;void 0!==fe&&(Kt(s,185),$G(s,fe));let Se=o.scoreSexy;void 0!==Se&&(Kt(s,193),$G(s,Se));let Oe=o.scoreNeutral;void 0!==Oe&&(Kt(s,201),$G(s,Oe));let Ye=o.scene;void 0!==Ye&&(Kt(s,208),Kt(s,Ye));let Ee=o.ossFilePrefix;void 0!==Ee&&(Kt(s,218),nd(s,Ee));let z=o.serviceVendor;if(void 0!==z)for(let ee of z){Kt(s,226);let Q=aq();jq(ee,Q),Kt(s,Q.limit),Wq(s,Q),Hq(Q)}}(t,i),function(o){let s=o.bytes,c=o.limit;return s.length===c?s:s.subarray(0,c)}(i)}(S);if(R.byteLength<s.workerMessageLengthLimit){if(J("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const D=function(O){for(var P=1;P<arguments.length;P++){var B=null!=arguments[P]?arguments[P]:{};P%2?fq(Object(B),!0).forEach(function(G){b(O,G,B[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(B)):fq(Object(B)).forEach(function(G){Object.defineProperty(O,G,Object.getOwnPropertyDescriptor(B,G))})}return O}({},S);delete D.jpg,N.debug("[".concat(s._inspectId,"] Request message for worker of inspect content "),JSON.stringify(D)),Re("debug",s,"Request message for worker of inspect content ".concat(JSON.stringify(D)))}return R}return s.quality=s.quality*s.qualityRatio,yield s.generateRequestData(i,{appId:c,cname:l,cid:p,vid:h,sid:g,uid:f})})()}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=es.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=Pi.CLOSED,this.emit(zn.STATE_CHANGE,mo.CLOSED)}}var gq,Aq,mq,_q,Eq,vq,Cq,yq,Iq,Sq,bq,Tq,Rq,Rn;function Dq(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function Tw(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?Dq(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Dq(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}let Jq=(gq=kn("AgoraRTCClient","store.clientId"),Aq=Df({report:pe}),mq=Df(),_q=Df(),Eq=Df({report:pe}),vq=Df({report:pe}),Cq=Bc(),yq=Bc({report:pe}),Iq=Bc({report:pe}),Sq=Bc({report:pe}),bq=Df({reportResult:!0,report:pe}),Tq=Bc(),gq((Te((Rn=class extends En{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}constructor(t){var i;let o;if(super(),i=this,b(this,"store",void 0),b(this,"_uid",void 0),b(this,"_channelName",void 0),b(this,"_uintUid",void 0),b(this,"_users",[]),b(this,"_codec",void 0),b(this,"_mode",void 0),b(this,"_config",void 0),b(this,"_clientId",void 0),b(this,"_appId",void 0),b(this,"_sessionId",null),b(this,"_key",void 0),b(this,"_joinInfo",void 0),b(this,"_gateway",void 0),b(this,"_statsCollector",void 0),b(this,"_configDistribute",void 0),b(this,"_leaveMutex",new eo("client-leave")),b(this,"_publishMutex",new eo("client-publish")),b(this,"_renewTokenMutex",new eo("client-renewtoken")),b(this,"_subscribeMutex",new eo("client-subscribe")),b(this,"_encryptionMode","none"),b(this,"_encryptionSecret",null),b(this,"_encryptionSalt",null),b(this,"_proxyServer",void 0),b(this,"_turnServer",{servers:[],mode:"auto"}),b(this,"_cloudProxyServerMode","disabled"),b(this,"_isDualStreamEnabled",!1),b(this,"_defaultStreamFallbackType",void 0),b(this,"_lowStreamParameter",void 0),b(this,"_streamFallbackTypeCacheMap",new Map),b(this,"_remoteStreamTypeCacheMap",new Map),b(this,"_axiosCancelSource",es.CancelToken.source()),b(this,"_audioVolumeIndicationInterval",void 0),b(this,"_networkQualityInterval",void 0),b(this,"_userOfflineTimeout",void 0),b(this,"_streamRemovedTimeout",void 0),b(this,"_injectStreamingClient",void 0),b(this,"_liveTranscodeStreamingClient",void 0),b(this,"_liveRawStreamingClient",void 0),b(this,"_channelMediaRelayClient",void 0),b(this,"_networkQualitySensitivity","normal"),b(this,"_p2pChannel",void 0),b(this,"_useLocalAccessPoint",!1),b(this,"_setLocalAPVersion",void 0),b(this,"_joinAndNotLeaveYet",!1),b(this,"_numberOfJoinCount",0),b(this,"_remoteDefaultVideoStreamType",void 0),b(this,"_inspect",void 0),b(this,"_license",void 0),b(this,"_handleLocalTrackEnable",(s,c,l)=>{this.publish(s,!1).then(c).catch(l)}),b(this,"_handleLocalTrackDisable",(s,c,l)=>{this.unpublish(s).then(c).catch(l)}),b(this,"_handleUserOnline",s=>{this.isStringUID&&"string"!=typeof s.uid&&(N.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID")),Re("error",this,"StringUID is Mixed with UintUID"));const c=this._users.find(l=>l.uid===s.uid);if(c)c._trust_in_room_=!0;else{const l=new AC(s.uid,s.uint_id||s.uid);this._users.push(l),N.debug("[".concat(this._clientId,"] user online"),s.uid),Is("info",this,"user-joined",{uid:s.uid}),this.emit(yt.USER_JOINED,l)}}),b(this,"_handleUserOffline",s=>{const c=this._users.find(l=>l.uid===s.uid);c&&(this._handleRemoveStream(s),lD(this._users,c),this._remoteStreamTypeCacheMap.delete(c.uid),this._streamFallbackTypeCacheMap.delete(c.uid),N.debug("[".concat(this._clientId,"] user offline"),s.uid,"reason:",s.reason),Is("info",this,"user-left",{reason:s.reason,uid:s.uid}),this.emit(yt.USER_LEAVED,c,s.reason))}),b(this,"_handleAddAudioOrVideoStream",(s,c,l,p,h,g,f)=>{const A=this._users.find(v=>v.uid===c);if(!A)return N.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)")),void vn("error",["AgoraRTCGateway",this._clientId],"add_".concat(s,"_stream"),"can not find target user!");N.debug("[".concat(this._clientId,"] stream added with uid ").concat(c,", type ").concat(s)),vn("debug",["AgoraRTCGateway",this._clientId],"add_".concat(s,"_stream"),{uid:c,mediaType:s}),this.store.subscribe(A.uid,s,void 0,void 0,void 0,Date.now());const _="audio"===s?A.hasAudio:A.hasVideo;A._uintid||(A._uintid=h||c),"audio"===s?A._trust_audio_stream_added_state_=!0:A._trust_video_stream_added_state_=!0,"audio"===s?(A._audio_added_=!0,void 0!==l&&(A._audioSSRC=l),void 0!==p&&(A._cname=p),g&&(A._audioOrtc=g)):(A._video_added_=!0,void 0!==l&&(A._videoSSRC=l),void 0!==p&&(A._cname=p),void 0!==f&&(A._rtxSsrcId=f),g&&(A._videoOrtc=g)),("audio"===s?A.hasAudio:A.hasVideo)&&!_&&(N.info("[".concat(this._clientId,"] remote user ").concat(A.uid," published ").concat(s)),Re("info",this,"remote user ".concat(A.uid," published ").concat(s)),Is("info",this,"user-published",{uid:A.uid,mediaType:s}),this.emit(yt.USER_PUBLISHED,A,s)),"video"===s?pe.onGatewayStream(this._sessionId,gt.ON_ADD_VIDEO_STREAM,gn.ON_ADD_VIDEO_STREAM,{peer:h||c}):pe.onGatewayStream(this._sessionId,gt.ON_ADD_AUDIO_STREAM,gn.ON_ADD_AUDIO_STREAM,{peer:h||c}),this._p2pChannel.remoteMediaSsrcChanged(A,s,l).then(v=>{if(v)return N.debug("[".concat(this._clientId,"] resubscribe ").concat(s," for user ").concat(A.uid," after rejoin because SSRC id changed.")),this._p2pChannel.unsubscribe(A,s,!0).then(()=>this._subscribe(A,s,!0).catch(y=>{N.error("[".concat(this._clientId,"] resubscribe error"),y.toString()),Re("error",this,"resubscribe error: ".concat(y.toString()))}))}),this._p2pChannel.hasPendingRemoteMedia(A,s)&&(N.debug("[".concat(this._clientId,"] resubscribe ").concat(s," for user ").concat(A.uid," after reconnect.")),this._subscribe(A,s,!0).catch(v=>{N.error("[".concat(this._clientId,"] resubscribe error"),v.toString()),Re("error",this,"resubscribe error: ".concat(v.toString()))}))}),b(this,"_handleRemoveStream",s=>{const c=this._users.find(p=>p.uid===s.uid);if(!c)return N.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)")),void vn("warning",["AgoraRTCGateway",this._clientId],"remove_stream",{uid:s.uid,info:"can not find target user!"});N.debug("[".concat(this._clientId,"] stream removed with uid ").concat(s.uid)),vn("debug",["AgoraRTCGateway",this._clientId],"remove_stream",{uid:s.uid});let l=()=>{};c.hasAudio&&c.hasVideo?l=()=>{N.info("[".concat(this._clientId,"] remote user ").concat(c.uid," unpublished audio track")),Is("info",this,"user-unpublished",{uid:c.uid,mediaType:"audio"}),this.emit(yt.USER_UNPUBLISHED,c,"audio"),N.info("[".concat(this._clientId,"] remote user ").concat(c.uid," unpublished video track")),Is("info",this,"user-unpublished",{uid:c.uid,mediaType:"video"}),this.emit(yt.USER_UNPUBLISHED,c,"video")}:c.hasVideo?l=()=>{N.info("[".concat(this._clientId,"] remote user ").concat(c.uid," unpublished video track")),Is("info",this,"user-unpublished",{uid:c.uid,mediaType:"video"}),this.emit(yt.USER_UNPUBLISHED,c,"video")}:c.hasAudio&&(l=()=>{N.info("[".concat(this._clientId,"] remote user ").concat(c.uid," unpublished audio track")),Is("info",this,"user-unpublished",{uid:c.uid,mediaType:"audio"}),this.emit(yt.USER_UNPUBLISHED,c,"audio")}),c._trust_audio_stream_added_state_=!0,c._trust_video_stream_added_state_=!0,c._audio_added_=!1,c._video_added_=!1,this._p2pChannel.unsubscribe(c).then(p=>{if(p)return this._gateway.unsubscribe(p,c.uid)}),c._audioSSRC=void 0,c._videoSSRC=void 0,c._audioOrtc=void 0,c._videoOrtc=void 0,c._rtxSsrcId=void 0,pe.onGatewayStream(this._sessionId,gt.ON_REMOVE_STREAM,gn.ON_REMOVE_STREAM,{peer:s.uint_id||s.uid}),l()}),b(this,"_handleSetStreamLocalEnable",(s,c,l)=>{const p=this._users.find(f=>f.uid===c);if(!p)return N.error("[".concat(this._clientId,"] can not find target user!(disable_local)")),void vn("error",this,"disable_local_video","can not find target user!(disable_local)");N.debug("[".concat(this._clientId,"] local ").concat(s," ").concat(l?"enabled":"disabled"," with uid ").concat(c)),vn("debug",this,"disable_local_video","local ".concat(s," ").concat(l?"enabled":"disabled"," with uid ").concat(c));const h="audio"===s?p.hasAudio:p.hasVideo;if("audio"===s){p._trust_audio_enabled_state_=!0;const f=p._audio_enabled_;if(p._audio_enabled_=l,p._audio_enabled_===f)return;{const A=p._audio_enabled_?"enable-local-audio":"disable-local-audio";N.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(c,", msg: ").concat(A)),Ke("debug",this,"user-info-updated",{uid:c,msg:A}),this.emit(yt.USER_INFO_UPDATED,c,A)}}else{p._trust_video_enabled_state_=!0;const f=p._video_enabled_;if(p._video_enabled_=l,p._video_enabled_===f)return;{const A=p._video_enabled_?"enable-local-video":"disable-local-video";N.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(c,", msg: ").concat(A)),Ke("debug",this,"user-info-updated",{uid:c,msg:A}),this.emit(yt.USER_INFO_UPDATED,c,A)}}const g="audio"===s?p.hasAudio:p.hasVideo;return h!==g?!h&&g?(N.info("[".concat(this._clientId,"] remote user ").concat(c," published ").concat(s)),Is("info",this,"user-published",{uid:c,mediaType:s}),void this.emit(yt.USER_PUBLISHED,p,s)):("video"===s&&p._videoTrack&&p._videoTrack._destroy(),this._p2pChannel.muteRemote(p,s),N.info("[".concat(this._clientId,"] remote user ").concat(c," unpublished ").concat(s)),Is("info",this,"user-unpublished",{uid:c,mediaType:s}),void this.emit(yt.USER_UNPUBLISHED,p,s)):void 0}),b(this,"_handleMuteStream",(s,c,l)=>{N.debug("[".concat(this._clientId,"] receive mute message"),s,c,l),vn("debug",this,"mute_".concat(c),l);const p=this._users.find(f=>f.uid===s);if(!p)return N.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(s)),void vn("warning",this,"mute_".concat(c),"can not find remote user, ignore mute event, uid: ".concat(s));const h="audio"===c?p.hasAudio:p.hasVideo;if("audio"===c){p._trust_audio_mute_state_=!0;const f=p._audio_muted_;if(p._audio_muted_=l,p._audio_muted_===f)return;{const A=p._audio_muted_?"mute-audio":"unmute-audio";N.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(s,", msg: ").concat(A)),Ke("debug",this,"user-info-updated",{uid:s,msg:A}),this.emit(yt.USER_INFO_UPDATED,s,A)}}else{p._trust_video_mute_state_=!0;const f=p._video_muted_;if(p._video_muted_=l,p._video_muted_===f)return;{const A=p._video_muted_?"mute-video":"unmute-video";N.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(s,", msg: ").concat(A)),Ke("debug",this,"user-info-updated",{uid:s,msg:A}),this.emit(yt.USER_INFO_UPDATED,s,A)}}const g="audio"===c?p.hasAudio:p.hasVideo;if(h!==g){if(!h&&g)return("audio"===c?p._audioSSRC:p._videoSSRC)?(N.info("[".concat(this._clientId,"] remote user ").concat(s," published ").concat(c)),Is("info",this,"user-published",{uid:p.uid,mediaType:c}),void this.emit(yt.USER_PUBLISHED,p,c)):void N.warning("[".concat(this._clientId,"] remote user ").concat(s," receive ").concat(c," unmute message  before add stream message, ").concat(c," SSRC doesn't exist yet."));"video"===c&&p._videoTrack&&p._videoTrack._destroy(),this._p2pChannel.muteRemote(p,c),N.info("[".concat(this._clientId,"] remote user ").concat(s," unpublished ").concat(c)),Is("info",this,"user-unpublished",{uid:s,mediaType:c}),this.emit(yt.USER_UNPUBLISHED,p,c)}}),b(this,"_handleP2PLost",function(){var s=U(function*(c){if(N.debug("[".concat(i._clientId,"] receive p2p lost"),c),vn("debug",i,"p2p_lost",c),parseInt(c.p2pid,10)!==i.store.p2pId)return N.warning("P2PLost stream not found",c),void vn("warning",i,"p2p_lost","P2PLost stream not found, ".concat(c));yield i._p2pChannel.requestReconnect()});return function(c){return s.apply(this,arguments)}}()),b(this,"_handleTokenWillExpire",()=>{N.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),vn("debug",this,"token_privilege_will_expire"),this.emit(yt.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),b(this,"_handleBeforeUnload",s=>{"beforeunload"===s.type&&void 0!==s.returnValue&&""!==s.returnValue||(this.leave(),N.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")),Po("info",["window",this.store.clientId],Di()?"beforeunload":"pagehide"))}),b(this,"_handleUpdateNetworkQuality",()=>{if("normal"===this._networkQualitySensitivity)return;if(navigator&&void 0!==navigator.onLine&&!navigator.onLine)return void this.emit(yt.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const s={downlinkNetworkQuality:0,uplinkNetworkQuality:0};s.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),s.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.emit(yt.NETWORK_QUALITY,s)}),this._codec=t.codec,this._mode=t.mode,this._clientId=xn(5,"client-"),this.store=new xq(t.codec,t.audioCodec,t.mode,this._clientId),this.store.clientCreated(),t.proxyServer&&this.setProxyServer(t.proxyServer,!0),t.turnServer&&this.setTurnServer(t.turnServer,!0),N.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(po," build: ").concat(Zp,", mode: ").concat(this._mode,", codec: ").concat(this._codec)),Ke("info",this,"constructor",{version:po,build:Zp,mode:this._mode,codec:this._codec}),t.clientRoleOptions)try{hL(t.clientRoleOptions),o=Object.assign({},t.clientRoleOptions)}catch(s){N.warning("[".concat(this._clientId,"] ").concat(s.toString())),Re("warning",this,s.toString())}this._statsCollector=new _h(this.store),this._statsCollector.onStatsException=(s,c,l)=>{N.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(s,", msg: ").concat(c,", uid: ").concat(l)),Is("debug",this,yt.EXCEPTION,{code:s,message:c,uid:l}),this.emit(yt.EXCEPTION,{code:s,msg:c,uid:l})},this._statsCollector.onUploadPublishDuration=(s,c,l,p)=>{const h=this._users.find(g=>g.uid===s);h&&pe.peerPublishStatus(this._sessionId,{subscribeElapse:p,audioPublishDuration:c,videoPublishDuration:l,peer:h._uintid})},this._gateway=new bY(this.store,{clientId:this._clientId,mode:this._mode,codec:this._codec,websocketRetryConfig:t.websocketRetryConfig||ur,httpRetryConfig:t.httpRetryConfig||ur,forceWaitGatewayResponse:void 0===t.forceWaitGatewayResponse||t.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:t.role,clientRoleOptions:o}),this._config=t,this._configDistribute=new B9,this._p2pChannel=new kq(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}join(t,i,o,s,c){var l=this;return U(function*(){const p=++l._numberOfJoinCount;l.store.joinStart(),s&&(l.store.uid=s);const h="HTTPS"===(XF||XF||(XF=(window.location.protocol.split(":")[0]||"").toUpperCase(),XF)),g=iq()?window.isSecureContext:"Browser Not Support";if(!iq()&&!h||!window.isSecureContext){const S="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";N.warning(S),le("warning",l,S)}const f=Y0();"DISCONNECTED"===l.connectionState&&(l.store.avoidJoinStart=Math.round(Date.now()),N.debug("[".concat(l._clientId,"] set avoidJoinStart to ").concat(l.store.avoidJoinStart)),le("debug",l,"join",void 0,"[".concat(l._clientId,"] set avoidJoinStart to ").concat(l.store.avoidJoinStart)));const A=pe.reportApiInvoke(f,{name:qe.JOIN,options:[t,i,o,s],states:{isHttps:h,isSecureContext:g},tag:Ve.TRACER});pe.setAppId(t);try{if(!o&&null!==o)throw new V(L.INVALID_PARAMS,"Invalid token: ".concat(o,". If you don not use token, set it to null"));o&&ln(o,"token",1,2047),ln(t,"appid",1,2047),lm(i),s&&BT(s),c&&ln(c,"optionalInfo",1,2047)}catch(S){throw A.onError(S),S}if(N.info("[".concat(l._clientId,"] start join channel ").concat(i,", join number: ").concat(p)),Ke("info",l,"join",{channel:i}),l._leaveMutex.isLocked&&(N.debug("[".concat(l._clientId,"] join: waiting leave operation")),Re("debug",l,"join: waiting leave operation"),(yield l._leaveMutex.lock())(),N.debug("[".concat(l._clientId,"] join: continue")),Re("debug",l,"join: continue")),l._joinAndNotLeaveYet=!0,"DISCONNECTED"!==l.connectionState){const S=new V(L.INVALID_OPERATION,"[".concat(l._clientId,"] Client already in connecting/connected state"));throw A.onError(S),S}l._sessionId||(l._sessionId=f,l.store.sessionId=l._sessionId),l._gateway.state="CONNECTING";const _=Tw({clientId:l._clientId,appId:t,sid:l._sessionId,cname:i,uid:"string"!=typeof s?s:null,turnServer:l._turnServer,proxyServer:l._proxyServer,token:o||t,cloudProxyServer:l._cloudProxyServerMode,optionalInfo:c,license:l._license,useLocalAccessPoint:l._useLocalAccessPoint},void 0!==l._remoteDefaultVideoStreamType&&{defaultVideoStream:l._remoteDefaultVideoStreamType});if(l._useLocalAccessPoint&&(_.setLocalAPVersion=l._setLocalAPVersion),"string"==typeof s&&(_.stringUid=s,l._uintUid?(_.uid=l._uintUid,l._uintUid=void 0):_.uid=0),"none"!==l._encryptionMode&&l._encryptionSecret){if(_.aesmode=l._encryptionMode,_.aespassword=yield(S=U(function*(R){const D=Fm("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu\nSTM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+\nHvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy\nxQiYDz3vqa6bP29adwIDAQAB"),O=yield window.crypto.subtle.importKey("spki",D,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),P=Xx(R),B=yield window.crypto.subtle.encrypt({name:"RSA-OAEP"},O,P);return qa(new Uint8Array(B))}),function(R){return S.apply(this,arguments)})(l._encryptionSecret),!l._joinAndNotLeaveYet)throw new V(L.INVALID_OPERATION,"[".concat(l._clientId,"] Client already left"));l._encryptionSalt&&(_.aessalt=l._encryptionSalt)}var S;l._startSession(l._sessionId,{channel:i,appId:t});const v=l._sessionId;setTimeout(()=>{"CONNECTING"===l.connectionState&&v===l._sessionId&&pe.joinChannelTimeout(l._sessionId,5)},5e3);try{let S;if(["proxy3","proxy4","proxy5"].includes(_.cloudProxyServer)){const P=J("PROXY_SERVER_TYPE3");_.proxyServer=Array.isArray(P)?P[0]:P}if(pe.setProxyServer(_.proxyServer),N.setProxyServer(_.proxyServer),k1(_.proxyServer),l.store.requestAPStart(),_.stringUid&&!_.uid){const P=yield k9(_.stringUid,_,l._axiosCancelSource.token,l._config.httpRetryConfig||ur,l.store);N.debug("getUserAccount Success ".concat(_.stringUid," => ").concat(P)),Re("debug",l,"getUserAccount Success ".concat(_.stringUid," => ").concat(P)),_.uid=P,S=yield M9(_,l._axiosCancelSource.token,l._config.httpRetryConfig||ur,!0,l.store)}else S=yield M9(_,l._axiosCancelSource.token,l._config.httpRetryConfig||ur,!0,l.store);if(!l._joinAndNotLeaveYet)throw new V(L.INVALID_OPERATION,"[".concat(l._clientId,"] Client already left"));l.store.requestAPEnd(),setTimeout(()=>{l._configDistribute.startGetConfigDistribute(_,l._axiosCancelSource.token),l._configDistribute.on(fm.UPDATE_BITRATE_LIMIT,P=>{l._p2pChannel.updateBitrateLimit(P)})},0),l._key=o||t;const D=S.gatewayInfo;l._joinInfo=Tw(Tw({},_),{},{cid:D.cid,uid:_.uid?_.uid:D.uid,vid:D.vid,apResponse:D.res,uni_lbs_ip:D.uni_lbs_ip,gatewayAddrs:D.gatewayAddrs});const O=yield l._joinGateway();if(!l._joinAndNotLeaveYet)throw new V(L.INVALID_OPERATION,"[".concat(l._clientId,"] Client already left"));return A.onSuccess(O),l._appId=t,l._channelName=_.cname,l._uid=O,l.store.uid=O,setTimeout(()=>{l._networkQualityInterval&&window.clearInterval(l._networkQualityInterval),l._networkQualityInterval=window.setInterval(l._handleUpdateNetworkQuality,2e3),window.addEventListener(Di()?"beforeunload":"pagehide",l._handleBeforeUnload)},0),N.info("[".concat(l._clientId,"] Joining channel success: ").concat(i)),Ke("info",l,"join",i,"success"),setTimeout(()=>{J("USE_NEW_LOG")?L1():N.startUpload()},5e3),l.store.joinEnd(),cm.includes(y=l)||cm.push(y),O}catch(S){const R=Array.isArray(S)?S[0]:S;throw N.error("[".concat(l._clientId,"] join number: ").concat(p,", Joining channel failed, rollback"),R),Ke("error",l,"join",i,R.toString()),R.code!==L.OPERATION_ABORTED&&l._numberOfJoinCount===p&&(l._gateway.state="DISCONNECTED",l._reset()),A.onError(R),R}var y})()}_joinGateway(){if(!this._joinInfo||!this._key)throw new V(L.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!("disabled"!==this._joinInfo.cloudProxyServer||this._joinInfo.proxyServer||!J("JOIN_WITH_FALLBACK_SIGNAL_PROXY"))).then(t=>t).catch(t=>{if(t.code===L.INIT_WEBSOCKET_TIMEOUT)return this._gateway.leave(!0,Bt.FALLBACK),t;if(t.code===L.INIT_DATACHANNEL_TIMEOUT)return this._gateway.leave(!0,Bt.FALLBACK),t;throw t}).then(t=>{if(t instanceof V){if(t.code===L.INIT_WEBSOCKET_TIMEOUT){if(N.info("[".concat(this._clientId,"] join timeout, fallback to proxy")),!this._joinInfo||!this._key)throw new V(L.INVALID_OPERATION);this._joinInfo.cloudProxyServer="fallback",this._cloudProxyServerMode="fallback",this.store.cloudProxyServerMode="fallback";const i=J("PROXY_SERVER_TYPE3");if(Array.isArray(i))if(this._joinInfo.apUrl){const s=new dC(this._joinInfo.apUrl).host.split("."),c=s.slice(s.length-2).join(".");i.forEach(l=>{this._joinInfo&&l.includes(c)&&(this._joinInfo.proxyServer=l)}),this._joinInfo.proxyServer||(this._joinInfo.proxyServer=i[0])}else this._joinInfo.proxyServer=i[0];else this._joinInfo.proxyServer=i;const o=J("LOG_UPLOAD_SERVER").match(/.+:(\d{1,5})$/);return o&&o[1]&&"443"!==o[1]&&(N.setProxyServer(this._joinInfo.proxyServer),k1(this._joinInfo.proxyServer)),"443"!==J("STATS_COLLECTOR_PORT").toString()&&pe.setProxyServer(this._joinInfo.proxyServer),pe.reportApiInvoke(this._sessionId,{name:qe.JOIN_FALLBACK_TO_PROXY,options:[this._joinInfo.proxyServer],tag:Ve.TRACER}).onSuccess(),this.emit(yt.JOIN_FALLBACK_TO_PROXY,this._joinInfo.proxyServer),this._gateway.join(this._joinInfo,this._key)}if(N.info("[".concat(this._clientId,"] join by datachannel timeout, fallback to websocket")),!this._joinInfo||!this._key)throw new V(L.INVALID_OPERATION);return pe.reportApiInvoke(this._sessionId,{name:qe.DATACHANNEL_FAILBACK,options:[this.store.clientId],tag:Ve.TRACER}).onSuccess(),this._joinGateway()}return t}).then(t=>t)}leave(){var t=this;return U(function*(){const i=pe.reportApiInvoke(t._sessionId,{name:qe.LEAVE,options:[],tag:Ve.TRACER});N.info("[".concat(t._clientId,"] Leaving channel")),Ke("info",t,"leave"),window.removeEventListener(Di()?"beforeunload":"pagehide",t._handleBeforeUnload),t._reset(),function(s){const c=cm.indexOf(s);-1!==c&&cm.splice(c,1)}(t);const o=yield t._leaveMutex.lock();if("DISCONNECTED"===t.connectionState)return N.info("[".concat(t._clientId,"] Leaving channel repeated, success")),o(),i.onSuccess();yield t._gateway.leave("CONNECTED"!==t.connectionState),N.info("[".concat(t._clientId,"] Leaving channel success")),Ke("info",t,"leave",void 0,"success"),t._joinAndNotLeaveYet=!1,t.store.resetJoinChannelServiceRecords(),o(),i.onSuccess()})()}publish(t){var i=arguments,o=this;return U(function*(){let s=!(i.length>1&&void 0!==i[1])||i[1];Array.isArray(t)||(t=[t]);const c=pe.reportApiInvoke(o._sessionId,{name:qe.PUBLISH,options:t.map(p=>p?Object(p).toString():"null"),tag:Ve.TRACER});if(0===t.length){const p=new V(L.INVALID_PARAMS,"track list is empty");return c.onError(p),p.throw()}if("audience"===o._gateway.role){const p=new V(L.INVALID_OPERATION,"audience can not publish stream");return c.onError(p),p.throw()}for(const p of t){if(!(p instanceof $R)){const h=new V(L.INVALID_PARAMS,"parameter is not local track");return c.onError(h),h.throw()}if(!p._enabled&&s){const h=new V(L.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(p.getTrackId()));return c.onError(h),h.throw()}}N.info("[".concat(o._clientId,"] Publishing tracks, id ").concat(t.map(p=>"".concat(p.getTrackId()," ")))),Ke("info",o,"publish",t.map(p=>"".concat(p.getTrackId()))),yield o._configDistribute.awaitConfigDistributeComplete(),s&&t.forEach(p=>{const h=o._configDistribute.getBitrateLimit();p instanceof dr&&h&&p.setBitrateLimit(h.uplink)});const l=yield o._publishMutex.lock();try{yield o._publishHighStream(t),c.onSuccess(t.map(p=>p.trackMediaType+":"+p.getTrackLabel()).toString()),N.info("[".concat(o._clientId,"] Publish success, id ").concat(t.map(p=>"".concat(p.getTrackId()," ")))),Ke("info",o,"publish",t.map(p=>"".concat(p.getTrackId())),"success")}catch(p){throw c.onError(p),N.error("[".concat(o._clientId,"] publish error"),p.toString()),Ke("error",o,"publish",void 0,p.toString()),p}finally{l()}})()}unpublish(t){var i=this;return U(function*(){if(!i._joinInfo||void 0===i._uid)throw new V(L.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");t?Array.isArray(t)||(t=[t]):t=i._p2pChannel.getAllTracks(!0);const o=pe.reportApiInvoke(i._sessionId,{name:qe.UNPUBLISH,options:t.map(c=>c.getTrackId()),tag:Ve.TRACER});N.info("[".concat(i._clientId,"] Unpublish tracks, tracks ").concat(t.map(c=>"".concat(c.getTrackId()," "))," ")),Ke("info",i,"unpublish",t.map(c=>"".concat(c.getTrackId())));const s=yield i._publishMutex.lock();try{const c=yield i._p2pChannel.unpublish(t);c&&(yield i._gateway.unpublish(c,i._uid)),N.info("[".concat(i._clientId,"] Unpublish success,tracks ").concat(t.map(l=>"".concat(l.getTrackId())))),Ke("info",i,"unpublish",t.map(l=>"".concat(l.getTrackId())),"success"),o.onSuccess()}catch(c){throw o.onError(c),N.error("[".concat(i._clientId,"] unpublish error"),c.toString()),Ke("error",i,"unpublish",void 0,c.toString()),c}finally{s&&s()}})()}subscribe(t,i){var o=this;return U(function*(){return o._subscribe(t,i)})()}_subscribe(t,i,o){var s=this;return U(function*(){si(i,"mediaType",["audio","video"]);const c=pe.reportApiInvoke(s._sessionId,{name:qe.SUBSCRIBE,options:[t.uid,i],tag:Ve.TRACER});if(!s._joinInfo){const A=new V(L.INVALID_OPERATION,"Can't subscribe stream, not joined");throw c.onError(A),A}if("CONNECTED"!==s.connectionState&&"RECONNECTING"!==s.connectionState){const A=new V(L.INVALID_OPERATION,"Can't subscribe stream in ".concat(s.connectionState," state"));throw c.onError(A),A}if(!s._users.find(A=>A===t)){const A=new V(L.INVALID_REMOTE_USER,"user is not in the channel");throw N.error("[".concat(s._clientId,"] can not subscribe ").concat(t.uid,", this user is not in the channel")),Ke("error",s,"subscribe",t.uid,"this user is not in the channel"),c.onError(A),A}if(!t.hasAudio&&!t.hasVideo){const A=new V(L.INVALID_REMOTE_USER,"user is not published");throw N.error("[".concat(s._clientId,"] can not subscribe ").concat(t.uid,", user is not published")),Ke("error",s,"subscribe",t.uid,"this user is not published"),c.onError(A),A}if(!(o||("audio"!==i||t.hasAudio&&void 0!==t._audioSSRC)&&("video"!==i||t.hasVideo&&void 0!==t._videoSSRC))){const A=new V(L.REMOTE_USER_IS_NOT_PUBLISHED);throw N.error("[".concat(s._clientId,"] can not subscribe ").concat(t.uid," with mediaType ").concat(i,", remote track is not published")),Ke("error",s,"subscribe",t.uid,"mediaType ".concat(i,", remote track is not published")),c.onError(A),A}const l="audio"===i?t._audioSSRC:t._videoSSRC,p="audio"===i?t._audioOrtc:t._videoOrtc,h="video"===i?t._rtxSsrcId:void 0,g={stream_type:"audio"===i?ut.AUDIO:ut.VIDEO,ssrcId:l},f=yield s._subscribeMutex.lock();N.info("[".concat(s._clientId,"] subscribe user ").concat(t.uid,", mediaType: ").concat(i)),Ke("info",s,"subscribe",{uid:t.uid,mediaType:i});try{if(yield s._p2pChannel.hasRemoteMediaWithLock(t,i))yield s._p2pChannel.unmuteRemote(t,i);else try{Uo.markSubscribeStart(s.store.clientId,l),s.store.subscribe(t.uid,i,Date.now()),yield s._p2pChannel.subscribe(t,i,l,h,p);try{yield s._gateway.subscribe(t.uid,g,!0)}catch(_){if(_?.code!==L.WS_ABORT)throw yield s._p2pChannel.unsubscribe(t,i),_;yield s._p2pChannel.unsubscribe(t,i,!0),s._p2pChannel.setPendingRemoteMedia(t,i)}s.store.subscribe(t.uid,i,void 0,Date.now()),s._p2pChannel.reportSubscribeEvent(!0,null,t,i)}catch(_){throw s._p2pChannel.reportSubscribeEvent(!1,_?.code,t,i),_}N.info("[".concat(s._clientId,"] subscribe success user ").concat(t.uid,", mediaType: ").concat(i)),Ke("info",s,"subscribe",{uid:t.uid,mediaType:i},"success"),s._defaultStreamFallbackType&&s.setStreamFallbackOption(t.uid,s._defaultStreamFallbackType).catch(_=>{N.warning("[".concat(s._clientId,"] auto set fallback failed"),_),Re("warning",s,"auto set fallback failed, ".concat(_.toString()))});const A="audio"===i?t._audioTrack:t._videoTrack;if(!A){const _=new V(L.UNEXPECTED_ERROR,"can not find remote track in user object");return c.onError(_),_.throw()}return c.onSuccess(A.getTrackId()),A}catch(A){throw c.onError(A),N.error("[".concat(s._clientId,"] subscribe user ").concat(t.uid," error"),A),Ke("error",s,"subscribe",{uid:t.uid,mediaType:i},A.toString()),A}finally{f()}})()}massSubscribe(t){var i=this;return U(function*(){fo(t,"subscribeList");const o=pe.reportApiInvoke(i._sessionId,{name:qe.MASS_SUBSCRIBE,options:t.map(f=>{let{user:A,mediaType:_}=f;return[A?.uid,_]}),tag:Ve.TRACER});if(!i._joinInfo){const f=new V(L.INVALID_OPERATION,"Can't subscribe stream, not joined");throw o.onError(f),f}if("CONNECTED"!==i.connectionState&&"RECONNECTING"!==i.connectionState){const f=new V(L.INVALID_OPERATION,"Can't subscribe stream in ".concat(i.connectionState," state"));throw o.onError(f),f}const s=Date.now(),c=new Map,l=yield i._subscribeMutex.lock();N.info("[".concat(i._clientId,"]start massSubscribe user ").concat(t.map(f=>{let{user:A,mediaType:_}=f;return"user: ".concat(A?.uid,", mediaType: ").concat(_)}).join("; "))),Ke("info",i,"massSubscribe",t);const p=(t=[...t]).map(f=>{let{user:A,mediaType:_}=f;return{user:A,mediaType:_}}),h=yield i._p2pChannel.globalLock();try{var g;for(let A=t.length-1;A>=0;A--){const _=t[A],{user:v,mediaType:y}=_;if(si(y,"mediaType",["audio","video"]),!v){const D=new V(L.INVALID_PARAMS,"user property does not exist in subscribeList item");throw N.error("[".concat(i._clientId,"] user property does not exist in subscribeList item")),o.onError(D),D}if(!i._users.find(D=>D===v)){const D=new V(L.INVALID_REMOTE_USER,"user is not in the channel");N.error("[".concat(i._clientId,"] can not massSubscribe ").concat(v.uid,", this user is not in the channel")),Ke("error",i,"massSubscribe",v.uid,"this user is not in the channel"),p[A].error=D,t.splice(A,1);continue}if("audio"===y&&(!v.hasAudio||void 0===v._audioSSRC)||"video"===y&&(!v.hasVideo||void 0===v._videoSSRC)){const D=new V(L.REMOTE_USER_IS_NOT_PUBLISHED);N.error("[".concat(i._clientId,"] can not subscribe ").concat(v.uid," with mediaType ").concat(y,", remote user is not published")),Ke("error",i,"subscribe",v.uid,"mediaType ".concat(y,", remote user is not published")),p[A].error=D,t.splice(A,1);continue}const S=Jn.Video|Jn.LwoVideo,R=c.get(v);if(R){if("video"===y?R&S:R&Jn.Audio){t.splice(A,1),N.warning("repeat massSubscribe user:".concat(v.uid,", mediaType:").concat(y," twice"));continue}c.set(v,R|("video"===y?S:Jn.Audio))}else c.set(v,"video"===y?S:Jn.Audio)}for(let A=t.length-1;A>=0;A--){const _=t[A],{user:v,mediaType:y}=_,S=Jn.Video|Jn.LwoVideo;if(i._p2pChannel.hasRemoteMedia(v,y)){yield i._p2pChannel.unmuteRemoteNoLock(v,y);const R=c.get(v);c.set(v,"video"===y?R^S:R^Jn.Audio),t.splice(A,1)}}i.store.massSubscribe(t.map(A=>({userId:A.user.uid,type:A.mediaType})),s);const f=hc(g=Array.from(c.entries())).call(g,(A,_)=>{let[v,y]=_;if(0===y)return A;const S={stream_id:v.uid,stream_type:y};return y&Jn.Audio&&(S.audio_ssrc=v._audioSSRC),y&Jn.Video&&(S.video_ssrc=v._videoSSRC),A.push(S),A},[]);try{t.length>0&&(yield i._p2pChannel.massSubscribeNoLock(t.map(_=>{let{user:v,mediaType:y}=_;return{user:v,mediaType:y,ssrcId:y===ut.VIDEO?v._videoSSRC:v._audioSSRC,rtxSsrcId:v._rtxSsrcId}})));const A=new Map;if(f.length>0&&((yield i._gateway.subscribeAll(f,!0))?.users||[]).forEach(v=>{let{stream_id:y,video_error_code:S,audio_error_code:R,error_code:D}=v;(S||R||D)&&A.set(y,{video_error_code:S,audio_error_code:R,error_code:D})}),Array.from(A.entries()).length>0){const _=Array.from(A.entries()).map(v=>{let y,[S,R]=v;return R.error_code||R.video_error_code&&R.audio_error_code?y=void 0:R.video_error_code?y=ut.VIDEO:R.audio_error_code&&(y=ut.AUDIO),{user:i.remoteUsers.find(D=>D.uid===S),mediaType:y}});yield i._p2pChannel.massUnsubscribeNoLock(_)}for(const _ of p){const v=A.get(_.user.uid);if(v){const y=v.error_code||"audio"===_.mediaType&&v.audio_error_code||"video"===_.mediaType&&v.video_error_code;if(y){const S=Xm(y);N.error("user:".concat(_.user.uid," mediaType:").concat(_.mediaType," has massSubscribe error ").concat(S.desc)),_.error=new V(L.SUBSCRIBE_FAILED,"code ".concat(y,": ").concat(S.desc))}}_.error||(_.track="video"===_.mediaType?_.user.videoTrack:_.user.audioTrack)}return i.store.massSubscribe(p.filter(_=>!_.error).map(_=>({userId:_.user.uid,type:_.mediaType})),void 0,Date.now()),p.forEach(_=>{var v;pe.subscribe(i.store.sessionId,{succ:!!_.error,ec:(null===(v=_.error)||void 0===v?void 0:v.code)||null,video:_.mediaType===ut.VIDEO,audio:_.mediaType===ut.AUDIO,peerid:_.user.uid,subscribeRequestid:_.mediaType===ut.VIDEO?_.user._videoSSRC:_.user._audioSSRC,p2pid:i.store.p2pId,eventElapse:Math.floor(performance.now()-s)},!0)}),o.onSuccess(),N.info("[".concat(i._clientId,"] massSubscribe success ").concat(t.map(_=>{let{user:v,mediaType:y}=_;return"user: ".concat(v?.uid,", mediaType: ").concat(y)}).join("; "))),Ke("info",i,"massSubscribe",t,"success"),p}catch(A){throw yield i._p2pChannel.massUnsubscribeNoLock(t),o.onError(A),A}}finally{h(),l()}})()}unsubscribe(t,i){var o=this;return U(function*(){if(i&&si(i,"mediaType",["audio","video"]),!o._joinInfo)throw new V(L.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");const s=pe.reportApiInvoke(o._sessionId,{name:qe.UNSUBSCRIBE,options:[t.uid,i],tag:Ve.TRACER});if(!o._users.find(c=>c===t)){const c=new V(L.INVALID_REMOTE_USER,"user is not in the channel");throw N.error("[".concat(o._clientId,"] can not unsubscribe ").concat(t.uid,", user is not in the channel")),Ke("error",o,"unsubscribe",{uid:t.uid,mediaType:i},"user is not in the channel"),s.onError(c),c}N.info("[".concat(o._clientId,"] unsubscribe uid: ").concat(t.uid,", mediaType: ").concat(i)),Ke("info",o,"unsubscribe",{uid:t.uid,mediaType:i});try{const c=yield o._p2pChannel.unsubscribe(t,i);c&&(yield o._gateway.unsubscribe(c,t.uid)),N.info("[".concat(o._clientId,"] unsubscribe success uid: ").concat(t.uid,", mediaType: ").concat(i)),Ke("info",o,"unsubscribe",{uid:t.uid,mediaType:i},"success"),s.onSuccess()}catch(c){if(c.code===L.DISCONNECT_P2P)return N.warning("disconnecting p2p, abort unsubscribe request."),void s.onSuccess();throw N.error("[".concat(o._clientId,"] unsubscribe user ").concat(t.uid," error"),c.toString()),Ke("error",o,"unsubscribe",{uid:t.uid,mediaType:i},c.toString()),s.onError(c),c}})()}massUnsubscribe(t){var i=this;return U(function*(){fo(t,"unsubscribeList");const o=pe.reportApiInvoke(i._sessionId,{name:qe.UNSUBSCRIBE,options:t.map(c=>{let{user:l,mediaType:p}=c;return{uid:l?.uid,mediaType:p}}),tag:Ve.TRACER});if(!i._joinInfo){const c=new V(L.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");throw o.onError(c),c}N.info("[".concat(i._clientId,"] start massUnsubscribe ").concat(t.map(c=>{let{user:l,mediaType:p}=c;return"user: ".concat(l?.uid,", mediaType: ").concat(p,";")}).join())),Ke("info",i,"massUnsubscribe",t),t=[...t];const s=new Map;for(let c=t.length-1;c>=0;c--){const{user:l,mediaType:p}=t[c];if(!l){const g=new V(L.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw N.error("[".concat(i._clientId,"] user property does not exist in unsubscribeList item")),o.onError(g),g}if(si(p,"mediaType",["video","audio",void 0]),!i._users.find(g=>g===l)){N.warning("[".concat(i._clientId,"] can not unsubscribe ").concat(l.uid,", user is not in the channel")),Ke("error",i,"unsubscribe",{uid:l.uid,mediaType:p},"user is not in the channel"),t.splice(c,1);continue}const h=Jn.Video|Jn.LwoVideo;if(s.has(l)){const g=s.get(l);let f;switch(p){case"video":f=g&h;break;case"audio":f=g&Jn.Audio;break;default:f=g&(Jn.Audio|h)}if(f){N.warning("repeat massUnsubscribe user:".concat(l.uid,",mediaType:").concat(p," twice.")),t.splice(c,1);continue}p?"audio"===p?s.set(l,g|Jn.Audio):"video"===p&&s.set(l,g|h):s.set(l,g|Jn.Audio|h)}else p?"audio"===p?s.set(l,Jn.Audio):"video"===p&&s.set(l,h):s.set(l,Jn.Audio|h)}try{const c=yield i._p2pChannel.massUnsubscribe(t);c&&(yield i._gateway.massUnsubscribe(c)),N.info("[".concat(i._clientId,"] massUnsubscribe success ").concat(t.map(l=>{let{user:p,mediaType:h}=l;return"user: ".concat(p?.uid,", mediaType: ").concat(h,";")}).join())),Ke("info",i,"massUnsubscribe",t,"success"),o.onSuccess()}catch(c){if(c.code===L.DISCONNECT_P2P)return N.warning("disconnecting p2p, abort unsubscribe request."),void o.onSuccess();throw N.error("[".concat(i._clientId,"] massUnsubscribe error"),c.toString()),Ke("error",i,"massUnsubscribe",t,c.toString()),o.onError(c),c}})()}setLowStreamParameter(t){!function(s){if(!s)throw new V(L.INVALID_PARAMS);Cn(s.width)||aL(s.width,"streamParameter.width"),Cn(s.height)||aL(s.height,"streamParameter.height"),Cn(s.framerate)||aL(s.framerate,"streamParameter.framerate"),Cn(s.bitrate)||on(s.bitrate,"streamParameter.bitrate")}(t);const i=pe.reportApiInvoke(this._sessionId,{name:qe.SET_LOW_STREAM_PARAMETER,options:[t],tag:Ve.TRACER});(!t.width&&t.height||t.width&&!t.height)&&(N.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),Re("warning",this,"The width and height parameters take effect only when both are set")),N.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(t)),Ke("info",this,"setLowStreamParameter",t);const o=this._configDistribute.getLowStreamConfigDistribute();o&&o.bitrate&&t.bitrate&&o.bitrate<t.bitrate&&(t.bitrate=o.bitrate),this._lowStreamParameter=t,i.onSuccess()}enableDualStream(){var t=this;return U(function*(){const i=pe.reportApiInvoke(t._sessionId,{name:qe.ENABLE_DUAL_STREAM,options:[],tag:Ve.TRACER});if(!Vr().supportDualStream){pe.streamSwitch(t._sessionId,{lts:Date.now(),isdual:!0,succ:!1});const o=new V(L.NOT_SUPPORTED,"Your browser is not support dual stream");throw i.onError(o),o}if(t._isDualStreamEnabled){const o=new V(L.INVALID_OPERATION,"Dual stream is already enabled");throw i.onError(o),o}if(t._p2pChannel.canPublishLowStream())try{yield t._publishLowStream()}catch(o){throw pe.streamSwitch(t._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),i.onError(o),o}t._isDualStreamEnabled=!0,pe.streamSwitch(t._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),N.info("[".concat(t._clientId,"] enable dual stream")),Ke("info",t,"enableDualStream"),i.onSuccess()})()}disableDualStream(){var t=this;return U(function*(){if(!t._isDualStreamEnabled)return;if(!t._joinInfo)throw new V(L.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");const i=pe.reportApiInvoke(t._sessionId,{name:qe.DISABLE_DUAL_STREAM,options:[],tag:Ve.TRACER});if(t._p2pChannel.getLocalMedia(Pe.LocalVideoLowTrack))try{const o=yield t._p2pChannel.unpublishLowStream();o&&(yield t._gateway.unpublish(o,t._joinInfo.stringUid||t._joinInfo.uid))}catch(o){throw pe.streamSwitch(t._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),i.onError(o),o}t._isDualStreamEnabled=!1,pe.streamSwitch(t._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),N.info("[".concat(t._clientId,"] disable dual stream")),Ke("info",t,"disableDualStream"),i.onSuccess()})()}setClientRole(t,i){var o=this;return U(function*(){var c;si(c=t,"role",["audience","host"]),i&&hL(i);const s=pe.reportApiInvoke(o._sessionId,{name:qe.SET_CLIENT_ROLE,options:[t,i],tag:Ve.TRACER});if("rtc"===o._mode){N.warning("[".concat(o._clientId,"]rtc mode can not use setClientRole")),Ke("warning",o,"setClientRole",t,"rtc mode can not use setClientRole");const c=new V(L.INVALID_OPERATION,"rtc mode can not use setClientRole");return s.onError(c),c.throw()}if(i&&i.level&&"host"===t){const c=new V(L.INVALID_OPERATION,"host mode can not set audience latency level");return s.onError(c),c.throw()}try{if("audience"===t&&o._p2pChannel.hasLocalMedia()){const c=new V(L.INVALID_OPERATION,"can not set client role to audience when publishing stream");return s.onError(c),c.throw()}yield o._gateway.setClientRole(t,i),N.info("[".concat(o._clientId,"] set client role to ").concat(t,", level: ").concat(i&&i.level)),Ke("info",o,"setClientRole",{role:t,level:i&&i.level}),s.onSuccess()}catch(c){throw s.onError(c),c}})()}setProxyServer(t,i){if(ln(t,"proxyServer"),!i){if("DISCONNECTED"!==this.connectionState)throw new V(L.INVALID_OPERATION,"Set proxy server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new V(L.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=t,pe.setProxyServer(this._proxyServer),N.setProxyServer(this._proxyServer),k1(this._proxyServer),N.info("[".concat(this._clientId,"] Set proxy server ").concat(i?"by initialize call":""," success.")),Ke("info",this,"setProxyServer",[...arguments],"success")}setTurnServer(t,i){if(Array.isArray(t)||(t=[t]),!i){if("DISCONNECTED"!==this.connectionState)throw new V(L.INVALID_OPERATION,"Set turn server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new V(L.INVALID_OPERATION,"You have already set the proxy")}if(oh(t))return this._turnServer={servers:t,mode:"original-manual"},N.info("[".concat(this._clientId,"] Set original turnserver ").concat(i?"by initialize call":""," success: ").concat(t.map(o=>o.urls).join(","),".")),void Ke("info",this,"setOriginalTurnServer",[...arguments],"success");t.forEach(o=>hm(o)),this._turnServer={servers:t,mode:"manual"},N.info("[".concat(this._clientId,"] Set turnserver ").concat(i?"by initialize call":""," success.")),Ke("info",this,"setTurnServer",[...arguments],"success")}setLicense(t){if("DISCONNECTED"!==this.connectionState)throw new V(L.INVALID_OPERATION,"you should set license before join channel");if(ln(t,"license",32,32),!/^[A-Za-z\d]+$/.test(t))throw new V(L.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=t,N.info("[".concat(this._clientId,"] set license success"),t)}startProxyServer(t){const i=pe.reportApiInvoke(this._sessionId,{name:qe.START_PROXY_SERVER,options:[],tag:Ve.TRACER});if("DISCONNECTED"!==this.connectionState){const c=new V(L.INVALID_OPERATION,"Start proxy server before join channel");throw i.onError(c),c}if(this._proxyServer||"manual"===this._turnServer.mode||this._useLocalAccessPoint){const c=new V(L.INVALID_OPERATION,"You have already set the proxy");throw i.onError(c),c}const o=[3,4,5];let s;switch(void 0===t&&(t=3),t){case 1:case 2:throw new V(L.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:s="proxy3";break;case 4:s="proxy4";break;case 5:s="proxy5";break;default:{const c=new V(L.INVALID_PARAMS,"proxy server mode must be ".concat(o.join("|")));throw i.onError(c),c}}this._cloudProxyServerMode=s,this.store.cloudProxyServerMode=s,N.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),Ke("info",this,"startProxyServer",this._cloudProxyServerMode),i.onSuccess()}stopProxyServer(){const t=pe.reportApiInvoke(this._sessionId,{name:qe.STOP_PROXY_SERVER,options:[],tag:Ve.TRACER});if("DISCONNECTED"!==this.connectionState)throw new V(L.INVALID_OPERATION,"Stop proxy server after leave channel");pe.setProxyServer(),N.setProxyServer(),k1(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",N.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),Ke("info",this,"stopProxyServer",this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]},t.onSuccess()}setLocalAccessPointsV2(t){if(!t.accessPoints)throw new V(L.INVALID_PARAMS,"accessPoints is required.");fo(t.accessPoints.serverList,"accessPoints.serverList"),ln(t.accessPoints.domain,"accessPoints.domain");const i=(v,y)=>{on(v,y,0,65535,!0)};let o=443;if(t.accessPoints.port&&(i(t.accessPoints.port,"accessPoints.port"),o=t.accessPoints.port),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new V(L.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");J("CLOSE_AFB_FOR_LOCAL_AP")&&(hn("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),hn("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const s=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,c=t.accessPoints.domain,l=t.accessPoints.serverList.map(v=>s.test(v)?"".concat(v.replace(/\./g,"-"),".").concat(c):v),p=l.map(v=>"".concat(v,":").concat(o));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,hn("WEBCS_DOMAIN",p),hn("WEBCS_DOMAIN_BACKUP_LIST",p),hn("GATEWAY_DOMAINS",[c]),t.report&&t.report.hostname&&Array.isArray(t.report.hostname)&&t.report.hostname.length?(fo(t.report.hostname,"report.hostname"),hn("EVENT_REPORT_DOMAIN",t.report.hostname[0]),hn("EVENT_REPORT_BACKUP_DOMAIN",t.report.hostname[1]||t.report.hostname[0])):(hn("EVENT_REPORT_DOMAIN",l[0]),hn("EVENT_REPORT_BACKUP_DOMAIN",l[1]||l[0]));let h=6443;t.report&&t.report.port&&(i(t.report.port,"report.port"),h=t.report.port),hn("STATS_COLLECTOR_PORT",h),hn("ENABLE_EVENT_REPORT",!!t.report);let g="";t.log&&t.log.hostname&&Array.isArray(t.log.hostname)&&t.log.hostname.length?(fo(t.log.hostname,"log.hostname"),g=t.log.hostname[0]):g=l[0];let f=6444;t.log&&t.log.port&&(i(t.log.port,"log.port"),f=t.log.port),hn("LOG_UPLOAD_SERVER","".concat(g,":").concat(f));let A=[];t.cds&&t.cds.hostname&&Array.isArray(t.cds.hostname)&&t.cds.hostname.length?(fo(t.cds.hostname,"cds.hostname"),A=t.cds.hostname):A=l;let _=443;t.cds&&t.cds.port&&(i(t.cds.port,"cds.port"),_=t.cds.port),hn("CDS_AP",A.map(v=>"".concat(v,":").concat(_))),hn("ENABLE_CONFIG_DISTRIBUTE",!!t.cds),N.info("set local access point v2 success"),Ke("info",this,"setLocalAccessPointsV2")}setLocalAccessPoints(t,i){if(fo(t,"serverList"),ln(i,"domain"),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new V(L.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const o=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;t=t.map(s=>o.test(s)?"".concat(s.replace(/\./g,"-"),".").concat(i):s),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,hn("WEBCS_DOMAIN",t),hn("WEBCS_DOMAIN_BACKUP_LIST",t),hn("GATEWAY_DOMAINS",[i]),hn("EVENT_REPORT_DOMAIN",t[0]),hn("EVENT_REPORT_BACKUP_DOMAIN",t[1]||t[0]),hn("LOG_UPLOAD_SERVER","".concat(t[0],":6444")),N.info("set local access point success"),Ke("info",this,"setLocalAccessPoints")}setRemoteDefaultVideoStreamType(t){var i=this;return U(function*(){if(si(t,"streamType",[0,1]),i._remoteDefaultVideoStreamType=t,i._joinInfo)try{yield i._gateway.setDefaultRemoteVideoStreamType(t),i._joinInfo.defaultVideoStream=i._remoteDefaultVideoStreamType}catch(o){throw N.error("[".concat(i._clientId,"] set default remote video stream type error"),o.toString()),o}else N.debug("haven't joined yet, cache remoteDefaultVideoStreamType ".concat(t))})()}setRemoteVideoStreamType(t,i){var o=this;return U(function*(){si(i,"streamType",[0,1]);const s=pe.reportApiInvoke(o._sessionId,{name:qe.SET_REMOTE_VIDEO_STREAM_TYPE,options:[t,i],tag:Ve.TRACER});try{yield o._gateway.setRemoteVideoStreamType(t,i),setTimeout(()=>{const c=o._users.find(l=>l.uid===t);c&&c.videoTrack&&c.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(c){throw s.onError(c),N.error("[".concat(o._clientId,"] set remote video stream type error"),c.toString()),Ke("error",o,"setRemoteVideoStreamType",void 0,c.toString()),c}N.info("[".concat(o._clientId,"] set remote ").concat(t," video stream type to ").concat(i)),Ke("info",o,"setRemoteVideoStreamType",{uid:t,streamType:i}),o._remoteStreamTypeCacheMap.set(t,i),s.onSuccess()})()}setStreamFallbackOption(t,i){var o=this;return U(function*(){si(i,"fallbackType",[0,1,2]);const s=pe.reportApiInvoke(o._sessionId,{name:qe.SET_STREAM_FALLBACK_OPTION,options:["too long to show",i],tag:Ve.TRACER});try{yield o._gateway.setStreamFallbackOption(t,i)}catch(c){throw s.onError(c),N.error("[".concat(o._clientId,"] set stream fallback option"),c.toString()),Ke("error",o,"setStreamFallbackOption",void 0,c.toString()),c}N.info("[".concat(o._clientId,"] set remote ").concat(t," stream fallback type to ").concat(i)),Ke("info",o,"setStreamFallbackOption",{uid:t,fallbackType:i}),o._streamFallbackTypeCacheMap.set(t,i),s.onSuccess()})()}setEncryptionConfig(t,i,o){const s=pe.reportApiInvoke(this._sessionId,{name:qe.SET_ENCRYPTION_CONFIG,options:[t],tag:Ve.TRACER});try{if(si(c=t,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"]),ln(i,"secret"),["aes-128-gcm2","aes-256-gcm2"].includes(t)){if(!o||!(o instanceof Uint8Array&&32===o.length))throw new V(L.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(o)throw new V(L.INVALID_PARAMS,"current encrypt mode does not need salt");new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'\"|{}\\[\\]])(?=.{8,})").test(i)||(N.warning("The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer.\n      "),Re("warning",this,"The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer.\n      ")),this._encryptionMode=t,this._encryptionSecret=i,o&&(this._encryptionSalt=qa(o)),s.onSuccess()}catch(c){throw s.onError(c),c}var c}renewToken(t){var i=this;return U(function*(){ln(t,"token",1,2047);const o=pe.reportApiInvoke(i._sessionId,{name:qe.RENEW_TOKEN,options:[t],tag:Ve.TRACER});if(!i._key||!i._joinInfo){const l=new V(L.INVALID_OPERATION,"renewToken should not be called before user join");return o.onError(l),l.throw()}const s=i._key;i._key=t,i._joinInfo&&(i._joinInfo.token=t);const c=yield i._renewTokenMutex.lock();try{if(J("USE_NEW_TOKEN")){N.debug("start renew token with ticket from unilbs"),Ke("debug",i,"renewToken","unilbs");const l=yield function x9(t,i,o){return zD.apply(this,arguments)}(i._joinInfo,i._axiosCancelSource.token,i._config.httpRetryConfig||ur);N.debug("[".concat(i._clientId,"] get ticket from unilbs success")),Ke("debug",i,"renewToken","unilbs","success"),yield i._gateway.renewToken({token:t,ticket:l})}else N.debug("start renew token without ticket"),Ke("debug",i,"renewToken"),yield i._gateway.renewToken({token:t});N.debug("[".concat(i._clientId,"] renewToken success")),Ke("debug",i,"renewToken",void 0,"success"),o.onSuccess()}catch(l){throw i._key=s,i._joinInfo.token=s,o.onError(l),N.error("[".concat(i._clientId,"] renewToken failed"),l.toString()),Ke("error",i,"renewToken",void 0,l.toString()),l}finally{c()}})()}enableAudioVolumeIndicator(){const t=pe.reportApiInvoke(this._sessionId,{name:qe.ENABLE_AUDIO_VOLUME_INDICATOR,options:[],tag:Ve.TRACER});if(this._audioVolumeIndicationInterval)return N.warning("you have already enabled audio volume indicator!"),Ke("warning",this,"enableAudioVolumeIndicator","you have already enabled audio volume indicator!"),t.onSuccess();this._audioVolumeIndicationInterval=window.setInterval(()=>{const i=this._p2pChannel.getAudioLevels();this.emit(yt.VOLUME_INDICATOR,i)},J("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3),t.onSuccess()}getRTCStats(){const t=this._statsCollector.getRTCStats(),i=this._gateway.getInChannelInfo();return t.Duration=Math.round(i.duration/1e3),t}startLiveStreaming(t,i){const o=pe.reportApiInvoke(this._sessionId,{name:qe.START_LIVE_STREAMING,options:[t,i],tag:Ve.TRACER});if(!i){if("h264"!==this._codec){const c=new V(L.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");return o.onError(c),Ie.reject(c)}if(!this._p2pChannel.hasLocalMedia()){const c=new V(L.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming");return o.onError(c),Ie.reject(c)}}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(t)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(t)){const c=new V(L.LIVE_STREAMING_TASK_CONFLICT);return o.onError(c),Ie.reject(c)}const s=i?Un.TRANSCODE:Un.RAW;return this._createLiveStreamingClient(s).startLiveStreamingTask(t,s).then(()=>o.onSuccess()).catch(c=>{throw o.onError(c),c})}setLiveTranscoding(t){const i=pe.reportApiInvoke(this._sessionId,{name:qe.SET_LIVE_TRANSCODING,options:[t],tag:Ve.TRACER});return this._createLiveStreamingClient(Un.TRANSCODE).setTranscodingConfig(t).then(()=>i.onSuccess()).catch(o=>{throw i.onError(o),o})}stopLiveStreaming(t){const i=pe.reportApiInvoke(this._sessionId,{name:qe.STOP_LIVE_STREAMING,options:[t],tag:Ve.TRACER}),o=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(s=>s&&s.hasUrl(t));if(!o.length){const s=new V(L.INVALID_PARAMS,"can not find live streaming url to stop");return i.onError(s),Ie.reject(s)}return Ie.all(o.map(s=>s&&s.stopLiveStreamingTask(t))).then(()=>i.onSuccess()).catch(s=>{throw i.onError(s),s})}addInjectStreamUrl(t,i){var o=this;return U(function*(){const s=pe.reportApiInvoke(o._sessionId,{name:qe.ADD_INJECT_STREAM_URL,options:[t,i],tag:Ve.TRACER});try{if(!o._joinInfo)throw new V(L.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const c=o._createLiveStreamingClient(Un.INJECT);c.setInjectStreamConfig(i,0),yield c.startLiveStreamingTask(t,Un.INJECT)}catch(c){throw s.onError(c),c}s.onSuccess()})()}removeInjectStreamUrl(){var t=this;return U(function*(){const i=pe.reportApiInvoke(t._sessionId,{name:qe.REMOVE_INJECT_STREAM_URL,options:[],tag:Ve.TRACER});try{var o;const s=t._createLiveStreamingClient(Un.INJECT),c=Array.from(Ts(o=s.streamingTasks).call(o)).find(l=>l.mode===Un.INJECT);if(!t._joinInfo||!c)throw new V(L.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");yield s.stopLiveStreamingTask(c.url)}catch(s){throw i.onError(s),s}i.onSuccess()})()}startChannelMediaRelay(t){var i=this;return U(function*(){const o=pe.reportApiInvoke(i._sessionId,{name:qe.START_CHANNEL_MEDIA_RELAY,options:[t],tag:Ve.TRACER});try{fC(t),yield i._createChannelMediaRelayClient().startChannelMediaRelay(t)}catch(s){return o.onError(s),s.throw()}o.onSuccess()})()}updateChannelMediaRelay(t){var i=this;return U(function*(){const o=pe.reportApiInvoke(i._sessionId,{name:qe.UPDATE_CHANNEL_MEDIA_RELAY,options:[t],tag:Ve.TRACER});try{fC(t),yield i._createChannelMediaRelayClient().updateChannelMediaRelay(t)}catch(s){return o.onError(s),s.throw()}o.onSuccess()})()}stopChannelMediaRelay(){var t=this;return U(function*(){const i=pe.reportApiInvoke(t._sessionId,{name:qe.STOP_CHANNEL_MEDIA_RELAY,options:[],tag:Ve.TRACER});try{yield t._createChannelMediaRelayClient().stopChannelMediaRelay()}catch(o){return i.onError(o),o.throw()}i.onSuccess()})()}sendStreamMessage(t){let i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this._joinInfo)throw new V(L.INVALID_OPERATION,"can not send data stream, not joined");if("string"==typeof t&&(t=(new TextEncoder).encode(t)),new Blob([t]).size>1024)throw new V(L.INVALID_PARAMS,"stream message out of range.");return this._gateway.signal.request(Je.DATA_STREAM,{payload:qa(t)},!i)}sendMetadata(t){if(!this._joinInfo)throw new V(L.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([t]).size>1024)throw new V(L.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(Je.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:qa(t)})}sendCustomReportMessage(t){var i=this;return U(function*(){Array.isArray(t)||(t=[t]),t.forEach(H1);const o=pe.reportApiInvoke(i._sessionId,{name:qe.SEND_CUSTOM_REPORT_MESSAGE,options:[JSON.stringify(t)],tag:Ve.TRACER});if(!i._joinInfo){const s=new V(L.INVALID_OPERATION,"can not send custom report, not joined");return o.onError(s),s.throw()}yield pe.sendCustomReportMessage(i._joinInfo.sid,t),o.onSuccess()})()}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}pickSVCLayer(t,i){var o=this;return U(function*(){si(i.spatialLayer,"spatialLayer",[0,1,2,3]),si(i.temporalLayer,"temporalLayer",[0,1,2,3]);try{yield o._gateway.pickSVCLayer(t,i)}catch(s){throw N.error("[".concat(o._clientId,"] pick SVC layer failed"),s.toString()),le("error",o,"pickSVCLayer",i,s.toString()),s}})()}_reset(){if(N.debug("[".concat(this._clientId,"] reset client")),le("debug",this,"_reset"),this._axiosCancelSource.cancel(),this._axiosCancelSource=es.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._users.forEach(t=>{t._audioTrack&&t._audioTrack._destroy(),t._videoTrack&&t._videoTrack._destroy()}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),"fallback"===this._cloudProxyServerMode&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new eo("client-publish"),this._subscribeMutex=new eo("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}}_startSession(t,i){const o=t||Y0();N.debug(t?"[".concat(this._clientId,"] new Session ").concat(o):"[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(o)),le("debug",this,"_startSession",{newSid:o,sid:this._sessionId}),this._sessionId=o,this.store.sessionId=o,i?pe.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:i.channel,appid:i.appId,mode:this._mode}):this._joinInfo?pe.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:this._joinInfo.cname,appid:this._joinInfo.appId,mode:this._mode}):this._gateway.joinInfo&&pe.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId,mode:this._mode}),this._joinInfo&&(this._joinInfo.sid=o),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=o)}_publishHighStream(t){var i=this;return U(function*(){if(!i._joinInfo||void 0===i._uid)throw new V(L.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==i.connectionState&&"RECONNECTING"!==i.connectionState)throw new V(L.INVALID_OPERATION,"can not publish stream in ".concat(i.connectionState," state"));if("auto"===i._turnServer.mode&&J("FORCE_TURN")&&!J("TURN_ENABLE_TCP")&&!J("TURN_ENABLE_UDP"))throw new V(L.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");N.debug("[".concat(i._clientId,"] publish high stream")),le("debug",i,"_publishHighStream");try{const s=yield i._p2pChannel.publish(t,i._isDualStreamEnabled,i._lowStreamParameter),c=(yield s.next()).value;if(c){var o;let l;try{l=yield i._gateway.publish(i._uid,c,!0)}catch(p){if(p.code!==L.DISCONNECT_P2P)throw s.throw(p),p}yield s.next((null===(o=l)||void 0===o?void 0:o.ortc)||[])}i._p2pChannel.reportPublishEvent(!0,null);for(const l of t)l instanceof dr&&l._encoderConfig&&i._gateway.setVideoProfile(l._encoderConfig),!l.muted&&l.enabled||(yield i._p2pChannel.muteLocalTrack(l))}catch(s){if(i._p2pChannel.reportPublishEvent(!1,s?.code,t),s?.code===L.WS_ABORT)return;throw s}})()}_publishLowStream(){var t=this;return U(function*(){if(!t._joinInfo||void 0===t._uid)throw new V(L.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==t.connectionState&&"RECONNECTING"!==t.connectionState)throw new V(L.INVALID_OPERATION,"can not publish stream in ".concat(t.connectionState," state"));N.debug("[".concat(t._clientId,"] publish low stream")),le("debug",t,"_publishLowStream");const i=t._configDistribute.getLowStreamConfigDistribute();i&&i.bitrate&&(t._lowStreamParameter||(t._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),t._lowStreamParameter&&t._lowStreamParameter.bitrate&&i.bitrate<t._lowStreamParameter.bitrate&&(t._lowStreamParameter.bitrate=i.bitrate));try{const s=yield t._p2pChannel.publishLowStream(t._lowStreamParameter),c=(yield s.next()).value;if(c){var o;let l;try{l=yield t._gateway.publish(t._uid,c,!0)}catch(p){if(p.code!==L.DISCONNECT_P2P)throw s.throw(p),p}s.next((null===(o=l)||void 0===o?void 0:o.ortc)||[]),t._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(s){if(t._p2pChannel.reportPublishEvent(!1,s?.code,void 0,!0),s?.code===L.WS_ABORT)return;throw s}})()}_createLiveStreamingClient(t){if(!this._joinInfo||!this._appId)return new V(L.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const i=()=>new H3(this._joinInfo,this._config.websocketRetryConfig||ur,this._config.httpRetryConfig||ur),o=s=>{s.onLiveStreamError=(c,l)=>{pe.reportApiInvoke(this._sessionId,{name:qe.ON_LIVE_STREAM_ERROR,options:[c,l],tag:Ve.TRACER}).onSuccess(),this.emit(yt.LIVE_STREAMING_ERROR,c,l)},s.onLiveStreamWarning=(c,l)=>{pe.reportApiInvoke(this._sessionId,{name:qe.ON_LIVE_STREAM_WARNING,options:[c,l],tag:Ve.TRACER}).onSuccess(),this.emit(yt.LIVE_STREAMING_WARNING,c,l)},s.on(uf.REQUEST_WORKER_MANAGER_LIST,(c,l,p)=>{if(!this._joinInfo)return p(new V(L.INVALID_OPERATION,"can not find join info to get worker manager"));qD(c,this._joinInfo,this._axiosCancelSource.token,ur).then(l).catch(p)})};switch(t){case Un.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=i(),o(this._liveRawStreamingClient)),this._liveRawStreamingClient;case Un.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=i(),o(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case Un.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=i(),this._injectStreamingClient.on(uf.REQUEST_WORKER_MANAGER_LIST,(s,c,l)=>{if(!this._joinInfo)return l(new V(L.INVALID_OPERATION,"can not find join info to get worker manager"));qD(s,this._joinInfo,this._axiosCancelSource.token,ur).then(c).catch(l)}),this._injectStreamingClient.onInjectStatusChange=(s,c,l)=>{this.emit(yt.INJECT_STREAM_STATUS,s,c,l)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){return this._joinInfo?(this._channelMediaRelayClient||(this._channelMediaRelayClient=new W3(this._joinInfo,this._clientId,this._config.websocketRetryConfig||ur,this._config.httpRetryConfig||ur),this._channelMediaRelayClient.on("state",t=>{t===Zi.RELAY_STATE_FAILURE&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.emit(yt.CHANNEL_MEDIA_RELAY_STATE,t)}),this._channelMediaRelayClient.on("event",t=>{this.emit(yt.CHANNEL_MEDIA_RELAY_EVENT,t)})),this._channelMediaRelayClient):new V(L.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw()}_handleGatewayEvents(){var t=this;this._gateway.on(yn.DISCONNECT_P2P,U(function*(){yield t._p2pChannel.disconnectForReconnect()})),this._gateway.on(yn.CONNECTION_STATE_CHANGE,(i,o,s)=>{var c;if(s===Bt.FALLBACK)return;const l=()=>{this.emit(yt.CONNECTION_STATE_CHANGE,i,o,s)};if(pe.reportApiInvoke(this._sessionId||(null===(c=this._gateway.joinInfo)||void 0===c?void 0:c.sid)||null,{name:qe.CONNECTION_STATE_CHANGE,options:[i,o,s],tag:Ve.TRACER}).onSuccess(JSON.stringify({cur:i,prev:o,reason:s})),N.info("[".concat(this._clientId,"] connection state change: ").concat(o," -> ").concat(i)),vn("info",this,"connection-state-change","".concat(o," -> ").concat(i)),"DISCONNECTED"===i)return this._reset(),void l();if("RECONNECTING"===i)this._users.forEach(h=>{h._trust_in_room_=!1,h._trust_audio_enabled_state_=!1,h._trust_video_enabled_state_=!1,h._trust_audio_mute_state_=!1,h._trust_video_mute_state_=!1,h._trust_audio_stream_added_state_=!1,h._trust_video_stream_added_state_=!1,h._audioSSRC=void 0,h._videoSSRC=void 0,h._videoOrtc=void 0,h._audioOrtc=void 0,h._cname=void 0,h._rtxSsrcId=void 0}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if("CONNECTED"===i){var p;this._streamFallbackTypeCacheMap.forEach((h,g)=>{this._gateway.setStreamFallbackOption(g,h).catch(f=>{N.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),f),Re("warning",this,"auto set stream fallback option failed, ".concat(f.toString()))})}),this._remoteStreamTypeCacheMap.forEach((h,g)=>{this._gateway.setRemoteVideoStreamType(g,h).catch(f=>{N.warning("[".concat(this._clientId,"] auto set remote stream type failed"),f),Re("warning",this,"auto set remote stream type failed, ".concat(f.toString()))})}),void 0!==this._remoteDefaultVideoStreamType&&void 0===(null===(p=this._joinInfo)||void 0===p?void 0:p.defaultVideoStream)&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{N.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(h=>{N.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(h))}),this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{"CONNECTED"===this.connectionState&&(this._userOfflineTimeout=void 0,this._users.filter(h=>!h._trust_in_room_).forEach(h=>{N.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(h.uid)),Re("debug",this,"user offline timeout, emit user offline ".concat(h.uid)),this._handleUserOffline({uid:h.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{"CONNECTED"===this.connectionState&&(this._streamRemovedTimeout=void 0,this._users.forEach(h=>{h._trust_audio_mute_state_||(N.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(h.uid)),Re("debug",this,"auto dispatch audio unmute event ".concat(h.uid)),this._handleMuteStream(h.uid,"audio",!1)),h._trust_video_mute_state_||(N.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(h.uid)),Re("debug",this,"auto dispatch video unmute event ".concat(h.uid)),this._handleMuteStream(h.uid,"video",!1)),h._trust_audio_enabled_state_||(N.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(h.uid)),Re("debug",this,"auto dispatch enable local audio ".concat(h.uid)),this._handleSetStreamLocalEnable("audio",h.uid,!0)),h._trust_video_enabled_state_||(N.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(h.uid)),Re("debug",this,"auto dispatch enable local video ".concat(h.uid)),this._handleSetStreamLocalEnable("video",h.uid,!0)),h._trust_video_stream_added_state_||(N.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(h.uid)),this._handleResetAddStream(h,"video")),h._trust_audio_stream_added_state_||(N.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(h.uid)),this._handleResetAddStream(h,"audio")),h._video_added_||h._audio_added_||(N.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(h.uid)),Re("debug",this,"auto dispatch stream remove ".concat(h.uid)),this._handleRemoveStream({uid:h.uid,uint_id:h._uintid}))}))},1e3)}l()}),this._gateway.on(yn.REQUEST_NEW_GATEWAY_LIST,(i,o)=>{if(!this._joinInfo)return o(new V(L.UNEXPECTED_ERROR,"can not recover, no join info"));ai(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||ur,this.store).then(s=>{this._joinInfo&&(this._joinInfo.apResponse=s.gatewayInfo.res,this._joinInfo.gatewayAddrs=s.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=s.gatewayInfo.uni_lbs_ip),i(s.gatewayInfo.gatewayAddrs.map(c=>{if(this._joinInfo&&this._joinInfo.proxyServer){const l=c.address.split(":");return"wss://".concat(this._joinInfo.proxyServer,"/ws/?h=").concat(l[0],"&p=").concat(l[1])}return"wss://".concat(c.address)}))}).catch(o)}),this._gateway.on(yn.NETWORK_QUALITY,i=>{"normal"===this._networkQualitySensitivity&&this.emit(yt.NETWORK_QUALITY,i)}),this._gateway.on(yn.STREAM_TYPE_CHANGE,(i,o)=>{this.emit(yt.STREAM_TYPE_CHANGED,i,o),pe.reportApiInvoke(this._sessionId,{name:qe.STREAM_TYPE_CHANGE,options:[i,o],tag:Ve.TRACER}).onSuccess(JSON.stringify({uid:i,streamType:o}))}),this._gateway.on(yn.IS_P2P_DISCONNECTED,i=>{this._p2pChannel.isP2PDisconnected()?i(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?i(!1):i(!0)}),this._gateway.on(yn.NEED_RENEW_SESSION,()=>{this._startSession()}),this._gateway.on(yn.REQUEST_P2P_CONNECTION_PARAMS,function(){var i=U(function*(o,s,c){try{s(yield t._p2pChannel.startP2PConnection(o))}catch(l){c(l)}});return function(o,s,c){return i.apply(this,arguments)}}()),this._gateway.on(yn.JOIN_RESPONSE,(i,o)=>{const{dtlsParameters:s,iceParameters:c,candidates:l,rtpCapabilities:p,setup:h,cname:g}=QF(i.ortc,o);this._p2pChannel.connect(c,s,l,p,h,g)}),this._gateway.on(yn.REQUEST_DC_CONNECTION_PARAMS,i=>{i(this._p2pChannel.getEstablishParams())}),this._gateway.on(yn.RESET_CONNECTION_EVENTS,()=>{this._handleGatewaySignalEvents()}),this._gateway.on(yn.DATACHANNEL_FAILBACK,()=>{this._joinGateway()}),this._gateway.on(yn.DATACHANNEL_PRECONNECT,function(){var i=U(function*(o,s,c,l){var p,h,g,f,A,_;yield t._p2pChannel.startP2PConnection({turnServer:null===(p=t._joinInfo)||void 0===p?void 0:p.turnServer},!0);const v=function(y,S){let R;return S&&S.ip&&"number"==typeof S.port?(R=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:S.ip,port:S.port.toString(),type:"host",extension:{}}],N.debug("Using remote candidate from AP ".concat(S.ip,":").concat(S.port)),Re("debug",[],"Using remote candidate from AP ".concat(S.ip,":").concat(S.port)),S.ip6&&(R.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:S.ip6,port:S.port.toString(),type:"host",extension:{}}),N.debug("Using IPV6 remote candidate from AP ".concat(S.ip6,":").concat(S.port)),Re("debug",[],"Using IPV6 remote candidate from AP ".concat(S.ip6,":").concat(S.port)))):R=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:y.ip,port:y.port.toString(),type:"host",extension:{}}],R}(o,s);return t._p2pChannel.preConnect({iceUfrag:"".concat(null===(h=t._joinInfo)||void 0===h?void 0:h.apResponse.cid,"_").concat(null===(g=t._joinInfo)||void 0===g?void 0:g.apResponse.cert),icePwd:"".concat(null===(f=t._joinInfo)||void 0===f?void 0:f.apResponse.cid,"_").concat(null===(A=t._joinInfo)||void 0===A?void 0:A.apResponse.cert)},{fingerprints:[{hashFunction:"sha-256",fingerprint:null!==(_=J("FINGERPRINT"))&&void 0!==_?_:o.fingerprint}]},v,{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},"active","o/i14u9pJrxRKAsu").then(c).catch(l)});return function(o,s,c,l){return i.apply(this,arguments)}}())}_handleGatewaySignalEvents(){this._gateway.signal.on(mt.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(mt.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(mt.ON_ADD_AUDIO_STREAM,t=>this._handleAddAudioOrVideoStream("audio",t.uid,t.ssrcId,t.cname,t.uint_id,t.ortc)),this._gateway.signal.on(mt.ON_ADD_VIDEO_STREAM,t=>this._handleAddAudioOrVideoStream("video",t.uid,t.ssrcId,t.cname,t.uint_id,t.ortc,t.rtxSsrcId)),this._gateway.signal.on(mt.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(mt.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(mt.MUTE_AUDIO,t=>(vn("debug",["AgoraRTCGateway",this._clientId],"mute_audio",{uid:t.uid}),this._handleMuteStream(t.uid,"audio",!0))),this._gateway.signal.on(mt.UNMUTE_AUDIO,t=>(vn("debug",["AgoraRTCGateway",this._clientId],"unmute_audio",{uid:t.uid}),this._handleMuteStream(t.uid,"audio",!1))),this._gateway.signal.on(mt.MUTE_VIDEO,t=>(vn("debug",["AgoraRTCGateway",this._clientId],"mute_video",{uid:t.uid}),this._handleMuteStream(t.uid,"video",!0))),this._gateway.signal.on(mt.UNMUTE_VIDEO,t=>(vn("debug",["AgoraRTCGateway",this._clientId],"unmute_video",{uid:t.uid}),this._handleMuteStream(t.uid,"video",!1))),this._gateway.signal.on(mt.RECEIVE_METADATA,t=>{const i=Fm(t.metadata);this.emit(yt.RECEIVE_METADATA,t.uid,i)}),this._gateway.signal.on(mt.ON_DATA_STREAM,t=>{t.seq&&delete t.seq,t.payload=Fm(t.payload),this.emit(yt.STREAM_MESSAGE,t.uid,t.payload),this.onStreamMessage&&this.onStreamMessage(t)}),this._gateway.signal.on(mt.ON_CRYPT_ERROR,()=>{Co(()=>{N.warning("[".concat(this._clientId,"] on crypt error")),vn("warning",this,"crypt_error"),this.emit(yt.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(mt.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(mt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{N.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),vn("warning",this,"token_privilege_did_expire"),this._gateway.leave(!0),this.emit(yt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(mt.ON_STREAM_FALLBACK_UPDATE,t=>{N.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(t.stream_id,", attr: ").concat(t.stream_type)),vn("debug",this,"stream_fallback_update",{peerId:t.stream_id,attr:t.stream_type}),this.emit(yt.STREAM_FALLBACK,t.stream_id,1===t.stream_type?"fallback":"recover")}),this._gateway.signal.on(mt.ON_PUBLISH_STREAM,t=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:t.proxy})),N.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(t))),vn("info",this,"publish_stream",t))}),this._gateway.signal.on(mt.ENABLE_LOCAL_VIDEO,t=>{this._handleSetStreamLocalEnable("video",t.uid,!0)}),this._gateway.signal.on(mt.DISABLE_LOCAL_VIDEO,t=>{this._handleSetStreamLocalEnable("video",t.uid,!1)}),this._gateway.signal.on(Me.REQUEST_TIMEOUT,(t,i)=>{if(this._joinInfo)switch(t){case Je.PUBLISH:{if(!i)return;const p=i.ortc;if(p){var o,s,c,l;const h=p.some(A=>{let{stream_type:_}=A;return _===lr.Audio}),g=p.some(A=>{let{stream_type:_}=A;return _!==lr.Audio}),f=p.some(A=>{let{stream_type:_}=A;return _===lr.Screen||_===lr.ScreenLow});"offer"===i.state&&pe.publish(this._joinInfo.sid,{eventElapse:Uo.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:L.TIMEOUT,audio:h,video:g,p2pid:i.p2p_id,publishRequestid:this.store.pubId,screenshare:f,audioName:h?null===(o=p.find(A=>{let{stream_type:_}=A;return _===lr.Audio}))||void 0===o||null===(s=o.ssrcs[0])||void 0===s?void 0:s.ssrcId.toString():void 0,videoName:g?null===(c=p.find(A=>{let{stream_type:_}=A;return _!==lr.Audio}))||void 0===c||null===(l=c.ssrcs[0])||void 0===l?void 0:l.ssrcId.toString():void 0})}break}case Je.SUBSCRIBE:i&&pe.subscribe(this._joinInfo.sid,{succ:!1,ec:L.TIMEOUT,audio:i.stream_type===ut.AUDIO,video:i.stream_type===ut.VIDEO,peerid:i.stream_id,subscribeRequestid:i.ssrcId,p2pid:this.store.p2pId,eventElapse:Uo.measureFromSubscribeStart(this.store.clientId,i.ssrcId)})}}),this._gateway.signal.on(mt.ON_P2P_OK,t=>{}),this._gateway.signal.on(mt.ON_PUBLISHED_USER_LIST,t=>{if(null==t||!t.users)return;const i=[],o=[];for(const s of t.users){let c=this._users.find(f=>f.uid===s.stream_id);c?c._trust_in_room_=!0:(c=new AC(s.stream_id,s.stream_id),this._users.push(c),0===this.getListeners(yt.PUBLISHED_USER_LIST).length&&(N.debug("[".concat(this._clientId,"] user online"),s.stream_id),Is("info",this,"user-joined",{uid:s.stream_id}),this.emit(yt.USER_JOINED,c)));const l=Jn.Audio&s.stream_type,p=(Jn.Video|Jn.LwoVideo)&s.stream_type,h=l&&c.hasAudio,g=p&&c.hasVideo;p&&(c._trust_video_stream_added_state_=!0,c._video_added_=!0,c._videoSSRC=s.video_ssrc),l&&(c._trust_audio_stream_added_state_=!0,c._audio_added_=!0,c._audioSSRC=s.audio_ssrc),l&&!h&&0===this.getListeners(yt.PUBLISHED_USER_LIST).length&&(N.info("[".concat(this._clientId,"] remote user ").concat(c.uid," published audio")),Re("info",this,"remote user ".concat(c.uid," published audio")),this.emit(yt.USER_PUBLISHED,c,"audio")),p&&!g&&0===this.getListeners(yt.PUBLISHED_USER_LIST).length&&(N.info("[".concat(this._clientId,"] remote user ").concat(c.uid," published video")),Re("info",this,"remote user ".concat(c.uid," published video")),this.emit(yt.USER_PUBLISHED,c,"video")),(l&&!h||p&&!g)&&i.push(c),p&&this._p2pChannel.hasPendingRemoteMedia(c,"video")&&o.push({user:c,mediaType:"video"}),l&&this._p2pChannel.hasPendingRemoteMedia(c,"audio")&&o.push({user:c,mediaType:"audio"})}o.length>0&&(N.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(o.map(s=>"user: ".concat(s.user.uid,", mediaType: ").concat(s.mediaType)).join("; ")," ")),this.massSubscribe(o).catch(s=>{N.error("[".concat(this._clientId,"] mass resubscribe error"),s.toString())})),this.getListeners(yt.PUBLISHED_USER_LIST).length>0?(N.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(i.map(s=>s.uid).join(", "))),this.emit(yt.PUBLISHED_USER_LIST,i)):N.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(i.map(s=>s.uid).join(", ")))})}_handleP2PChannelEvents(){var t=this;this._p2pChannel.on(Nt.RequestMuteLocal,function(){var i=U(function*(o,s,c){if(t._joinInfo)try{yield t._gateway.muteLocal(o,t._joinInfo.stringUid||t._joinInfo.uid),s()}catch(l){l.code===L.DISCONNECT_P2P?s():c(l)}else s()});return function(o,s,c){return i.apply(this,arguments)}}()),this._p2pChannel.on(Nt.RequestUnmuteLocal,function(){var i=U(function*(o,s,c){if(t._joinInfo)try{yield t._gateway.unmuteLocal(o,t._joinInfo.stringUid||t._joinInfo.uid),s()}catch(l){l.code===L.DISCONNECT_P2P?s():c(l)}else s()});return function(o,s,c){return i.apply(this,arguments)}}()),this._p2pChannel.on(Nt.RequestRePublish,(i,o,s)=>{this.publish(i,!1).then(o).catch(s)}),this._p2pChannel.on(Nt.RequestReSubscribe,function(){var i=U(function*(o,s,c){try{for(const{user:l,kind:p}of o)p===ut.VIDEO?yield t.subscribe(l,"video"):yield t.subscribe(l,"audio");s()}catch(l){c(l)}});return function(o,s,c){return i.apply(this,arguments)}}()),this._p2pChannel.on(Nt.RequestUploadStats,(i,o)=>{this._gateway.uploadStats(i,o)}),this._p2pChannel.on(Nt.MediaReconnectStart,i=>{this.emit(yt.MEDIA_RECONNECT_START,i)}),this._p2pChannel.on(Nt.MediaReconnectEnd,i=>{this.emit(yt.MEDIA_RECONNECT_END,i)}),this._p2pChannel.on(Nt.NeedSignalRTT,i=>{i(this._gateway.getSignalRTT())}),this._p2pChannel.on(Nt.RequestRestartICE,U(function*(){const i=yield t._p2pChannel.restartICE(),o=yield i.next();if(o.done)return;const s=o.value;let c;try{c=yield t._gateway.restartICE({iceParameters:s})}catch(p){return void i.throw(p)}const{iceParameters:l}=function(p){const h=p.iceParameters;return{iceParameters:{iceUfrag:h.iceUfrag,icePwd:h.icePwd}}}(c);yield i.next({remoteIceParameters:l})})),this._p2pChannel.on(Nt.RequestReconnect,U(function*(){t._gateway.reconnect()})),this._p2pChannel.on(Nt.RequestReconnectPC,U(function*(){var i;const{iceParameters:o,dtlsParameters:s,rtpCapabilities:c}=yield t._p2pChannel.startP2PConnection({turnServer:null===(i=t._joinInfo)||void 0===i?void 0:i.turnServer}),{gatewayEstablishParams:l,gatewayAddress:p}=yield t._gateway.reconnectPC({iceParameters:o,dtlsParameters:s,rtpCapabilities:c}),{dtlsParameters:h,iceParameters:g,candidates:f,rtpCapabilities:A,setup:_,cname:v}=QF(l,p);yield t._p2pChannel.connect(g,h,f,A,_,v),yield t._p2pChannel.republish(),yield t._p2pChannel.reSubscribe()})),this._p2pChannel.on(Nt.RequestUnpublishForReconnectPC,function(){var i=U(function*(o,s,c){t._joinInfo&&void 0!==t._uid?(yield t._gateway.unpublish(o,t._uid),s()):c()});return function(o,s,c){return i.apply(this,arguments)}}()),this._p2pChannel.on(Nt.P2PLost,()=>{this.emit(yt.P2P_LOST,this.store.uid)}),this._p2pChannel.on(Nt.UpdateVideoEncoder,i=>{i._encoderConfig&&this._gateway.setVideoProfile(i._encoderConfig)}),this._p2pChannel.on(Nt.ConnectionTypeChange,i=>{this.emit(yt.IS_USING_CLOUD_PROXY,i)}),this._p2pChannel.on(Nt.RequestLowStreamParameter,i=>{i(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(Nt.QueryClientConnectionState,i=>{i(this.connectionState)})}getKeyMetrics(){return this.store.keyMetrics}enableContentInspect(t){var i=this;return U(function*(){if("CONNECTED"!==i.connectionState||!i._joinInfo)throw new V(L.INVALID_OPERATION,"[".concat(i._clientId,"] Client did not join channel"));if(i._inspect)throw new V(L.INVALID_OPERATION,"[".concat(i._clientId,"] Inspect content service already in connecting/connected state"));if(!t)throw new V(L.INVALID_PARAMS,"[".concat(i._clientId,"] inspectConfig is necessary"));if(!t.inspectType||!Array.isArray(t.inspectType))throw new V(L.INVALID_PARAMS,"[".concat(i._clientId,"] inspectConfig.inspectType is necessary and is an instance of Array."));{const o=[...new Set(t.inspectType)];o.forEach(s=>{if(!["supervise","moderation"].includes(s))throw new V(L.INVALID_PARAMS,"[".concat(i._clientId,"] ").concat(s," is not a valid inspect type."))}),t.inspectType=o}if(t&&t.extraInfo&&t.extraInfo.length>1024)throw new V(L.INVALID_PARAMS,"[".concat(i._clientId,"] inspectConfig.extraInfo length cannot exceed 1024 bytes"));try{const o=new ZF(t);i._inspect=o,i.handleVideoInspectEvents(i._inspect),yield o.init({appId:i._joinInfo.appId,areaCode:"",cname:i._joinInfo.cname,sid:i._joinInfo.sid,token:i._joinInfo.token,uid:i._joinInfo.uid,cid:i._joinInfo.cid,vid:i._joinInfo.vid?Number(i._joinInfo.vid):0},ur)}catch(o){throw Array.isArray(o)?o[0]:o}})()}disableContentInspect(){var t=this;return U(function*(){if(!t._inspect)throw new V(L.INVALID_OPERATION,"[".concat(t._clientId,"] inspectVideoContent not started"));try{t._inspect.close(),t._inspect=void 0}catch(i){throw Array.isArray(i)?i[0]:i}})()}handleVideoInspectEvents(t){t.on(zn.CONNECTION_STATE_CHANGE,(i,o)=>{if(this.emit(yt.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,i,o),o===Pi.CONNECTED){if("CONNECTED"!==this.connectionState)return void this.emit(yt.CONTENT_INSPECT_ERROR,new V(L.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));t.inspectImage()}}),t.on(zn.INSPECT_RESULT,(i,o)=>{var s;if(o?.code===L.INVALID_OPERATION&&"DISCONNECTED"===this.connectionState)return N.debug("Stop inspect content because that has left channel"),null==this||null===(s=this._inspect)||void 0===s||s.close(),void(this._inspect=void 0);this.emit(yt.CONTENT_INSPECT_RESULT,i,o)}),t.on(zn.CLIENT_LOCAL_VIDEO_TRACK,i=>{i(this.localTracks.filter(o=>"video"===o.trackMediaType)[0])})}getJoinChannelServiceRecords(){return N.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}setPublishAudioFilterEnabled(t){var i=this;return U(function*(){sf(t,"enabled"),hn("ENABLE_PUBLISH_AUDIO_FILTER",t),i._joinInfo&&(yield i._gateway.setPublishAudioFilterEnabled(t))})()}_handleResetAddStream(t,i){switch(i){case"audio":t._audio_added_=!1,t._trust_audio_stream_added_state_=!0;break;case"video":t._video_added_=!1,t._trust_video_stream_added_state_=!0}}}).prototype,"setProxyServer",[Aq],Object.getOwnPropertyDescriptor(Rn.prototype,"setProxyServer"),Rn.prototype),Te(Rn.prototype,"setTurnServer",[mq],Object.getOwnPropertyDescriptor(Rn.prototype,"setTurnServer"),Rn.prototype),Te(Rn.prototype,"setLicense",[_q],Object.getOwnPropertyDescriptor(Rn.prototype,"setLicense"),Rn.prototype),Te(Rn.prototype,"setLocalAccessPointsV2",[Eq],Object.getOwnPropertyDescriptor(Rn.prototype,"setLocalAccessPointsV2"),Rn.prototype),Te(Rn.prototype,"setLocalAccessPoints",[vq],Object.getOwnPropertyDescriptor(Rn.prototype,"setLocalAccessPoints"),Rn.prototype),Te(Rn.prototype,"setRemoteDefaultVideoStreamType",[Cq],Object.getOwnPropertyDescriptor(Rn.prototype,"setRemoteDefaultVideoStreamType"),Rn.prototype),Te(Rn.prototype,"pickSVCLayer",[yq],Object.getOwnPropertyDescriptor(Rn.prototype,"pickSVCLayer"),Rn.prototype),Te(Rn.prototype,"enableContentInspect",[Iq],Object.getOwnPropertyDescriptor(Rn.prototype,"enableContentInspect"),Rn.prototype),Te(Rn.prototype,"disableContentInspect",[Sq],Object.getOwnPropertyDescriptor(Rn.prototype,"disableContentInspect"),Rn.prototype),Te(Rn.prototype,"getJoinChannelServiceRecords",[bq],Object.getOwnPropertyDescriptor(Rn.prototype,"getJoinChannelServiceRecords"),Rn.prototype),Te(Rn.prototype,"setPublishAudioFilterEnabled",[Tq],Object.getOwnPropertyDescriptor(Rn.prototype,"setPublishAudioFilterEnabled"),Rn.prototype),Rq=Rn))||Rq);class zq extends nB{set currentState(i){i!==this._currentState&&(this._currentState=i,this.emit(go.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(i){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),b(this,"audioBuffer",void 0),b(this,"sourceNode",void 0),b(this,"startPlayTime",0),b(this,"startPlayOffset",0),b(this,"pausePlayTime",0),b(this,"options",void 0),b(this,"currentLoopCount",0),b(this,"_currentState","stopped"),this.audioBuffer=i,this.options=o,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer.duration}get currentTime(){return"stopped"===this.currentState?0:"paused"===this.currentState?this.pausePlayTime:(this.context.currentTime-this.startPlayTime+this.startPlayOffset)%this.audioBuffer.duration}updateOptions(i){"stopped"===this.currentState?(this.options=i,this.startPlayOffset=this.options.startPlayTime||0):N.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&"playing"===this.currentState&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(i){this.sourceNode&&(this.sourceNode.onended=null,"playing"===this.currentState&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),"playing"===this.currentState?(this.startPlayOffset=i,this.startSourceNode()):"paused"===this.currentState&&(this.pausePlayTime=i))}resumeProcessAudioBuffer(){"paused"===this.currentState&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const i=this.context.createBufferSource();return i.buffer=this.audioBuffer,i.loop=!!this.options.loop,i.connect(this.outputNode),i}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const wq=new Map;function XG(){return XG=U(function*(t,i){let o=null;if("string"==typeof t){const c=wq.get(t);if(c)return N.debug("use cached audio resource: ",t),c;try{o=(yield Va(()=>es.get(t,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(l){throw new V(L.FETCH_AUDIO_FILE_FAILED,l.toString())}}else o=yield new Ie((l,p)=>{const h=new FileReader;h.onload=g=>{g.target?l(g.target.result):p(new V(L.READ_LOCAL_AUDIO_FILE_ERROR))},h.onerror=()=>{p(new V(L.READ_LOCAL_AUDIO_FILE_ERROR))},h.readAsArrayBuffer(t)});const s=yield function(c){const l=wf();return new Ie((p,h)=>{l.decodeAudioData(c,g=>{p(g)},g=>{h(new V(L.DECODE_AUDIO_FILE_FAILED,g.toString()))})})}(o);return"string"==typeof t&&i&&wq.set(t,s),s}),XG.apply(this,arguments)}function Nq(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),o.push.apply(o,s)}return o}function eU(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?Nq(Object(o),!0).forEach(function(s){b(t,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Nq(Object(o)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(o,s))})}return t}function ZG(t,i,o,s){o.optimizationMode&&(s&&s.width&&s.height?(o.encoderConfig=eU(eU({},s),{},{bitrateMin:s.bitrateMin,bitrateMax:s.bitrateMax}),"motion"!==o.optimizationMode&&"detail"!==o.optimizationMode||(i.contentHint=o.optimizationMode,i.contentHint===o.optimizationMode?(N.debug("[".concat(t,"] set content hint to"),o.optimizationMode),Ke("debug",["AgoraRTC"],"videoTrackOptimizationModeProcess",[t,o,s])):(N.debug("[".concat(t,"] set content hint failed")),Ke("warning",["AgoraRTC"],"videoTrackOptimizationModeProcess",[t,o,s],"failed")))):(N.warning("[".concat(t,"] can not apply optimization mode bitrate config, no encoderConfig")),Re("warning",["AgoraRTC"],"[".concat(t,"] can not apply optimization mode bitrate config, no encoderConfig"))))}const Xq=zt().name;function Zq(t,i,o,s){let c,l=0,p=null;return new Ie((h,g)=>{setTimeout(()=>{c&&(c(),h(l))},i),c=L0(()=>{!function(){l>s&&c&&(c(),h(l));const f=o.getContext("2d");if(!f){const v=new V(L.UNEXPECTED_ERROR,"can not get canvas 2d context.");return N.error(v.toString()),void g(v)}f.drawImage(t,0,0,160,120);const A=f.getImageData(0,0,o.width,o.height),_=Math.floor(A.data.length/3);if(p){for(let v=0;v<_;v+=3)if(A.data[v]!==p[v])return l+=1,void(p=A.data);p=A.data}else p=A.data}()},30)})}class Rw{constructor(i,o){b(this,"id",0),b(this,"element",void 0),b(this,"peerPair",void 0),b(this,"context",void 0),b(this,"audioPlayerElement",void 0),b(this,"audioTrack",void 0),Rw.count+=1,this.id=Rw.count,this.element=i,this.context=o}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=i=>{const o=document.createElement("audio");o.srcObject=new MediaStream([i.track]),o.play(),this.audioPlayerElement=o}}switchSdp(){var i=this;return U(function*(){if(!i.peerPair)return;const o=function(){var c=U(function*(l,p){const h="offer"===p?yield l.createOffer():yield l.createAnswer();return yield l.setLocalDescription(h),"complete"===l.iceGatheringState?l.localDescription:new Ie(g=>{l.onicegatheringstatechange=()=>{"complete"===l.iceGatheringState&&g(l.localDescription)}})});return function(p,h){return c.apply(this,arguments)}}(),s=function(){var c=U(function*(l,p){return yield l.setRemoteDescription(p)});return function(p,h){return c.apply(this,arguments)}}();try{const c=yield o(i.peerPair[0],"offer");yield s(i.peerPair[1],c);const l=yield o(i.peerPair[1],"answer");yield s(i.peerPair[0],l)}catch(c){throw new V(L.LOCAL_AEC_ERROR,c.toString()).print()}})()}getTracksFromMediaElement(i){var o=this;return U(function*(){if(o.audioTrack)return o.audioTrack;let s;try{i instanceof HTMLVideoElement&&(i.captureStream?i.captureStream():i.mozCaptureStream()),s=o.context.createMediaStreamDestination(),o.context.createMediaElementSource(i).connect(s)}catch(l){throw new V(L.LOCAL_AEC_ERROR,l.toString()).print()}if(!s)throw new V(L.LOCAL_AEC_ERROR,"no dest node when local aec").print();const c=s.stream.getAudioTracks()[0];return o.audioTrack=c,c})()}getElement(){return this.element}startEchoCancellation(){var i=this;return U(function*(){i.context.resume(),i.peerPair&&i.close(),i.initPeers();const o=i.element,s=yield i.getTracksFromMediaElement(o);i.peerPair&&i.peerPair[0].addTrack(s),yield i.switchSdp()})()}close(){N.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(i=>{i.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var Oq,tU;b(Rw,"count",0);const eJ=window.AudioContext||window.webkitAudioContext,tJ=new(Oq=Df({report:pe}),Te((tU=class{constructor(){b(this,"units",[]),b(this,"context",void 0)}processExternalMediaAEC(t){if(!this._doesEnvironmentNeedAEC())return N.debug("the system does not need to process local aec"),-1;this.context||(this.context=new eJ);let i=this.units.find(o=>o&&o.getElement()===t);return i||(i=new Rw(t,this.context),this.units.push(i)),i.startEchoCancellation(),N.debug("start processing local audio echo cancellation, id is",i.id),i.id}_doesEnvironmentNeedAEC(){return zt().name!==nn.SAFARI}}).prototype,"processExternalMediaAEC",[Oq],Object.getOwnPropertyDescriptor(tU.prototype,"processExternalMediaAEC"),tU.prototype),tU);hn("PROCESS_ID","process-".concat(xn(8,""),"-").concat(xn(4,""),"-").concat(xn(4,""),"-").concat(xn(4,""),"-").concat(xn(12,""))),function(){const t=zt();Gi.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),Gi.getStreamFromExtension=t.name===nn.CHROME&&Number(t.version)>34,Gi.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const i=new RTCPeerConnection;let o=!1;try{i.addTransceiver("audio"),o=!0}catch{}return i.close(),o}(),Gi.supportMinBitrate=t.name===nn.CHROME||t.name===nn.EDGE,Gi.supportSetRtpSenderParameters=function(){const i=zt();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!eh()||!(!Di()&&!_1())||i.name===nn.FIREFOX&&Number(i.version)>=64)}(),t.name===nn.SAFARI&&(Gi.supportDualStream=Number(t.version)>=14),Gi.webAudioMediaStreamDest=function(){const i=zt();return!(i.name===nn.SAFARI&&Number(i.version)<12)}(),Gi.supportReplaceTrack=!!window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack,Gi.supportWebGL=typeof WebGLRenderingContext<"u",Gi.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,eh()||(Gi.webAudioWithAEC=!0),Gi.supportShareAudio=function(){const i=zt();return(i.os===oi.WIN_10||i.os===oi.WIN_81||i.os===oi.WIN_7||i.os===oi.LINUX||i.os===oi.MAC_OS)&&i.name===nn.CHROME&&Number(i.version)>=74}(),Gi.supportDualStreamEncoding=function(){const i=zt();return!!J("DISABLE_WEBAUDIO")||"Safari"===i.name&&Number(i.version)>=14||!!("Chrome"===i.name&&/Windows/i.test(i.os||"")&&Number(i.version)>=100&&J("CHROME_DUAL_STREAM_USE_ENCODING"))}(),Gi.supportDataChannel=!!(function(i){const o=zt();return!(o.name!==nn.CHROME||!o.osVersion)&&Number(o.version)>=76}()||function(i){const o=zt();return!(o.name!==nn.FIREFOX||!o.osVersion)&&Number(o.version)>=68}()||function(i){const o=zt();return!(o.name!==nn.SAFARI||!o.osVersion)&&Number(o.version)>=14}()),N.info("browser compatibility",JSON.stringify(Gi),JSON.stringify(t)),le("info",[],"updateAgoraRTCCompatibility",{browserCompatibility:Gi,browserInfo:t})}(),function(){let t;try{t=window.localStorage.getItem("websdk_ng_global_parameter")}catch(i){return void N.error("Error loading sdk config",i.message)}if(t)try{const i=JSON.parse(window.atob(t)),o=Date.now();N.debug("Loading global parameters from cache",i),le("debug",[],"loadConfigFromLocalStorage",i),Object.keys(i).forEach(s=>{if(Object.prototype.hasOwnProperty.call(Mo,s)){const{value:c,expires:l}=i[s];if(l&&l<=o)return;zk[s]=c,Mo[s]=c}})}catch(i){N.error("Error loading mutableParamsCache: ".concat(t),i.message)}}();const jo={__CLIENT_LIST__:cm,__TRACK_LIST__:ct,VERSION:po,BUILD:Zp,setParameter:hn,getParameter:J,getSupportedCodec:function(){var t=U(function*(){let i={audio:[],video:[]};try{let o=new RTCPeerConnection;o.addTransceiver("video",{direction:"recvonly"}),o.addTransceiver("audio",{direction:"recvonly"});const s=(yield o.createOffer()).sdp;if(!s)return i;o.close(),o=null,i=function(c){const l={video:[],audio:[]};return c.match(/ VP8/i)&&l.video.push("VP8"),c.match(/ VP9/i)&&l.video.push("VP9"),c.match(/ AV1/i)&&l.video.push("AV1"),c.match(/ H264/i)&&l.video.push("H264"),c.match(/ opus/i)&&l.audio.push("OPUS"),c.match(/ PCMU/i)&&l.audio.push("PCMU"),c.match(/ PCMA/i)&&l.audio.push("PCMA"),c.match(/ G722/i)&&l.audio.push("G722"),l}(s)}catch(o){throw new V(L.CREATE_OFFER_FAILED,o.toString&&o.toString()).print()}return i});return function(){return t.apply(this,arguments)}}(),checkSystemRequirements:function(){const t=pe.reportApiInvoke(null,{name:qe.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:Ve.TRACER});let i=!1;try{const l=window.RTCPeerConnection,p=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,h=window.WebSocket;i=!!(l&&p&&h)}catch(l){return N.error("check system requirement failed: ",l),!1}let o=!1;const s=zt();s.name===nn.CHROME&&Number(s.version)>=58&&(!function U6(){return"WebKit"===Ru.engine.name}()||function Sl(){const t=zt();if(_1()){if(t.os===oi.MAC_OS)return!0;if(t.os===oi.IOS){const i=Ru.os.version&&Ru.os.version.split(".");if(i&&14===Number(i[0])&&i[1]&&Number(i[1])>=3||i&&Number(i[0])>14)return!0}}return!1}())&&(o=!0),s.name===nn.FIREFOX&&Number(s.version)>=56&&(o=!0),s.name===nn.OPERA&&Number(s.version)>=45&&(o=!0),s.name===nn.SAFARI&&Number(s.version)>=11&&(o=!0),(ea()||zt().name===nn.QQ)&&(o=!0),N.debug("checkSystemRequirements, api:",i,"browser",o);const c=i&&o;return t.onSuccess(c),c},getDevices:function(t){return to.enumerateDevices(!0,!0,t)},getMicrophones:function(t){return to.getRecordingDevices(t)},getCameras:function(t){return to.getCamerasDevices(t)},getElectronScreenSources:WQ,getPlaybackDevices:function(t){return to.getSpeakers(t)},createClient:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const i=pe.reportApiInvoke(null,{name:qe.CREATE_CLIENT,options:[t],tag:Ve.TRACER});try{Cj(t)}catch(o){throw i.onError(o),o}return void 0===t.audioCodec&&(t.audioCodec="opus"),i.onSuccess(),new Jq(Tw(Tw({forceWaitGatewayResponse:!0},t),{},{role:"rtc"===t.mode?"host":t.role}))},createCameraVideoTrack:function(){var t=U(function*(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{encoderConfig:"480p_1"};const o=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.CREATE_CAM_VIDEO_TRACK,options:[eU({},i)]}),s=gC(i),c=xn(8,"track-cam-");let l=null;N.info("start create camera video track with config",JSON.stringify(i),"trackId",c),Ke("info",["AgoraRTC"],"createCameraVideoTrack",i);try{l=(yield vo({video:s},c)).getVideoTracks()[0]||null}catch(h){throw o.onError(h),h}if(!l){const h=new V(L.UNEXPECTED_ERROR,"can not find track in media stream");return o.onError(h),h.throw()}i.optimizationMode&&ZG(c,l,i,i.encoderConfig&&sm(i.encoderConfig));const p=new sG(l,i,s,i.scalabiltyMode?wT(i.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},i.optimizationMode,c);return o.onSuccess(p.getTrackId()),N.info("create camera video success, trackId:",c),Ke("info",["AgoraRTC"],"createCameraVideoTrack",void 0,c),p});return function(){return t.apply(this,arguments)}}(),createCustomVideoTrack:function(t){const i=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.CREATE_CUSTOM_VIDEO_TRACK,options:[t]}),o=new dr(t.mediaStreamTrack,{bitrateMax:t.bitrateMax,bitrateMin:t.bitrateMin},t.scalabiltyMode?wT(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode);return i.onSuccess(o.getTrackId()),N.info("create custom video track success with config",t,"trackId",o.getTrackId()),Ke("info",["AgoraRTC"],"createCustomVideoTrack",t,o.getTrackId()),o},createScreenVideoTrack:function(){var t=U(function*(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"disable";const s=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.CREATE_SCREEN_VIDEO_TRACK,options:[eU({},i),o]});i.encoderConfig?"string"==typeof i.encoderConfig||i.encoderConfig.width&&i.encoderConfig.height||(i.encoderConfig.width={max:1920},i.encoderConfig.height={max:1080}):i.encoderConfig="1080p_2";const c=ew(i),l=xn(8,"track-scr");let p=null,h=null;const g=Vr();if(!g.supportShareAudio&&"enable"===o){const _=new V(L.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return s.onError(_),_.throw()}N.info("start create screen video track with config",i,"withAudio",o,"trackId",l),Ke("info",["AgoraRTC"],"createScreenVideoTrack",[i,o]);try{const _=yield vo({screen:c,screenAudio:"auto"===o?g.supportShareAudio:"enable"===o},l);p=_.getVideoTracks()[0]||null,h=_.getAudioTracks()[0]||null}catch(_){throw s.onError(_),_}if(!p){const _=new V(L.UNEXPECTED_ERROR,"can not find track in media stream");return s.onError(_),_.throw()}if(!h&&"enable"===o){p&&p.stop();const _=new V(L.SHARE_AUDIO_NOT_ALLOWED);return s.onError(_),_.throw()}i.optimizationMode||(i.optimizationMode="detail"),i.optimizationMode&&(ZG(l,p,i,i.encoderConfig&&Jk(i.encoderConfig)),i.encoderConfig&&"string"!=typeof i.encoderConfig&&(i.encoderConfig.bitrateMin=i.encoderConfig.bitrateMax));const f=new dr(p,i.encoderConfig?Jk(i.encoderConfig):{},i.scalabiltyMode?wT(i.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},i.optimizationMode,l,[br.SCREEN_TRACK]);if(!h)return s.onSuccess(f.getTrackId()),N.info("create screen video track success","video:",f.getTrackId()),Ke("info",["AgoraRTC"],"createScreenVideoTrack",void 0,{videoTrack:f.getTrackId()}),f;const A=new Li(h);return s.onSuccess([f.getTrackId(),A.getTrackId()]),N.info("create screen video track success","video:",f.getTrackId(),"audio:",A.getTrackId()),Ke("info",["AgoraRTC"],"createScreenVideoTrack",void 0,{videoTrack:f.getTrackId(),audioTrack:A.getTrackId()}),[f,A]});return function(){return t.apply(this,arguments)}}(),createMicrophoneAndCameraTracks:function(){var t=U(function*(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{encoderConfig:"480p_1"};const s=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.CREATE_MIC_AND_CAM_TRACKS,options:[i,o]}),c=gC(o),l=q3(i),p=xn(8,"track-mic-"),h=xn(8,"track-cam-");let g=null,f=null;N.info("start create camera video track(".concat(h,") and microphone audio track(").concat(p,") with config, audio: ").concat(JSON.stringify(i),", video: ").concat(JSON.stringify(o))),Ke("info",["AgoraRTC"],"createMicrophoneAndCameraTracks",{videoConfig:o,audioConfig:i});try{const v=yield vo({audio:l,video:c},"".concat(p,"-").concat(h));g=v.getAudioTracks()[0],f=v.getVideoTracks()[0]}catch(v){throw s.onError(v),v}if(!g||!f){const v=new V(L.UNEXPECTED_ERROR,"can not find tracks in media stream");return s.onError(v),v.throw()}o.optimizationMode&&ZG(h,f,o,o.encoderConfig&&sm(o.encoderConfig));const A=new mh(g,i,l,p),_=new sG(f,o,c,o.scalabiltyMode?wT(o.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},o.optimizationMode,h);return s.onSuccess([A.getTrackId(),_.getTrackId()]),N.info("create camera video track(".concat(h,") and microphone audio track(").concat(p,") success")),Ke("info",["AgoraRTC"],"createMicrophoneAndCameraTracks",void 0,{videoTrackId:h,audioTrackId:p}),[A,_]});return function(){return t.apply(this,arguments)}}(),createMicrophoneAudioTrack:function(){var t=U(function*(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.CREATE_MIC_AUDIO_TRACK,options:[i]}),s=q3(i),c=xn(8,"track-mic-");let l=null;N.info("start create microphone audio track with config",JSON.stringify(i),"trackId",c),Ke("info",["AgoraRTC"],"createMicrophoneAudioTrack",i);try{l=(yield vo({audio:s},c)).getAudioTracks()[0]||null}catch(h){throw o.onError(h),h}if(!l){const h=new V(L.UNEXPECTED_ERROR,"can not find track in media stream");return o.onError(h),h.throw()}const p=new mh(l,i,s,c);return o.onSuccess(p.getTrackId()),N.info("create microphone audio track success, trackId:",c),Ke("info",["AgoraRTC"],"createMicrophoneAudioTrack",i,c),p});return function(){return t.apply(this,arguments)}}(),createCustomAudioTrack:function(t){const i=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.CREATE_CUSTOM_AUDIO_TRACK,options:[t]}),o=new Li(t.mediaStreamTrack,t.encoderConfig?x1(t.encoderConfig):{});return N.info("create custom audio track success with config",t,"trackId",o.getTrackId()),Ke("info",["AgoraRTC"],"createCustomAudioTrack",t,o.getTrackId()),i.onSuccess(o.getTrackId()),o},createBufferSourceAudioTrack:function(){var t=U(function*(i){const o=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.CREATE_BUFFER_AUDIO_TRACK,options:[i]});if(J("DISABLE_WEBAUDIO"))throw new V(L.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");const s=xn(8,"track-buf-");N.info("start create buffer source audio track with config",JSON.stringify(i),"trackId",s),Ke("info",[],"createBufferSourceAudioTrack",i);const c=i.source;if(!(i.source instanceof AudioBuffer))try{i.source=yield function $q(t,i){return XG.apply(this,arguments)}(i.source,i.cacheOnlineFile)}catch(h){return o.onError(h),h.throw()}const l=new zq(i.source),p=new c7(c,l,i.encoderConfig?x1(i.encoderConfig):{},s);return N.info("create buffer source audio track success, trackId:",s),Ke("info",["AgoraRTC"],"createBufferSourceAudioTrack",void 0,s),o.onSuccess(p.getTrackId()),p});return function(o){return t.apply(this,arguments)}}(),setAppType:function(t){if(N.debug("setAppType: ".concat(t)),!(Number.isInteger(t)&&t>=0))throw N.debug("Invalid appType"),new V(L.INVALID_PARAMS,"invalid app type",t);hn("APP_TYPE",Math.floor(t))},setLogLevel:function(t){J("USE_NEW_LOG")?function(i){i=Math.min(Math.max(0,i),4),Kk=i}(t):N.setLogLevel(t)},enableLogUpload:function(){J("USE_NEW_LOG")?hn("UPLOAD_LOG",!0):N.enableLogUpload()},disableLogUpload:function(){J("USE_NEW_LOG")?hn("UPLOAD_LOG",!1):N.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new $D},checkAudioTrackIsActive:function(){var t=U(function*(i){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const s=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[o]});if(!(i instanceof Li||i instanceof Zl)){const f=new V(L.INVALID_TRACK,"the parameter is not a audio track");return s.onError(f),f.throw()}o&&o<1e3&&(o=1e3);const c=i instanceof Li?i.getTrackLabel():"remote_track",l=i.getVolumeLevel();let p=l,h=l;const g=Date.now();return new Ie(f=>{const A=setInterval(()=>{const _=i.getVolumeLevel();p=_>p?_:p,h=_<h?_:h;const v=p-h>1e-4,y=Date.now()-g;if(v||y>o){clearInterval(A);const S=v,R={duration:y,deviceLabel:c,maxVolumeLevel:p,result:S};N.info("[track-".concat(i.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(R))),s.onSuccess(R),f(S)}},200)})});return function(o){return t.apply(this,arguments)}}(),checkVideoTrackIsActive:function(){var t=U(function*(i){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const s=pe.reportApiInvoke(null,{tag:Ve.TRACER,name:qe.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[o]});if(!(i instanceof dr||i instanceof eg)){const y=new V(L.INVALID_TRACK,"the parameter is not a video track");return s.onError(y),y.throw()}const c=4;o&&o<1e3&&(o=1e3);const l=i instanceof dr?i.getTrackLabel():"remote_track",p=i.getMediaStreamTrack(!0),h=document.createElement("video");h.style.width="1px",h.style.height="1px",h.setAttribute("muted",""),h.muted=!0,h.setAttribute("playsinline",""),h.controls=!1,(Di()||_1())&&(h.style.opacity="0.01",h.style.position="fixed",h.style.left="0",h.style.top="0",document.body.appendChild(h)),h.srcObject=new MediaStream([p]),h.play();const g=document.createElement("canvas");g.width=160,g.height=120;let f=0,A=0;try{const y=Date.now();f=yield Zq(h,o,g,c),A=Date.now()-y}catch(y){throw s.onError(y),y}Xq===nn.SAFARI&&(h.pause(),h.remove()),h.srcObject=null;const _=f>c,v={duration:A,changedPicNum:f,deviceLabel:l,result:_};return N.info("[track-".concat(i.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(v))),s.onSuccess(v),_});return function(o){return t.apply(this,arguments)}}(),setArea:function(t){const i=pe.reportApiInvoke(null,{name:qe.SET_AREA,options:t,tag:Ve.TRACER});try{let o=[];if("string"==typeof t&&(o=[t]),Array.isArray(t)&&(t.forEach(c=>{if(!Sj.includes(c))throw new V(L.INVALID_PARAMS,"invalid area code")}),o=t),"[object Object]"===Object.prototype.toString.call(t)){const{areaCode:c,excludedArea:l}=t;if(!c)throw new V(L.INVALID_PARAMS,"area code is needed");let p=c;"string"==typeof c&&(p=[c]),o=l?function(t,i){let o=[];if(t.includes(jt.GLOBAL)){const l=[jt.GLOBAL,jt.OVERSEA],p=Object.keys(VT);if(i===jt.GLOBAL)throw new V(L.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(i===jt.CHINA)o=[jt.OVERSEA];else if(k3.includes(i)){const h=hC[jt.GLOBAL][i]||[],g=[...l,i,...h];o=p.filter(f=>!g.includes(f))}else if(function(h){let g=!1;return k3.forEach(f=>{hC[jt.GLOBAL][f].includes(h)&&(g=!0)}),g}(i)){const h=function(f){let A;return k3.forEach(_=>{hC[jt.GLOBAL][_].includes(f)&&(A=_)}),A}(i),g=[...l,h,i];o=p.filter(f=>!g.includes(f))}else o=t;o=function(h){const g=[];return P9.forEach(f=>{h.includes(f)&&g.push(f)}),g.concat(h.filter(f=>!P9.includes(f)))}(o)}else o=t;return o}(p,l):p}hn("AREAS",o);const s=(c=>{const l={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return c.map(p=>{const h=VT[p],g=Object.keys(h);g&&g.map(f=>{"CODE"!==f&&(l[f]=l[f].concat(h[f]))})}),l})(o);Object.keys(s).map(c=>{hn(c,"LOG_UPLOAD_SERVER"===c||"EVENT_REPORT_DOMAIN"===c||"EVENT_REPORT_BACKUP_DOMAIN"===c||"PROXY_SERVER_TYPE3"===c?s[c][0]:s[c])}),N.debug("set area success:",o.join(","))}catch(o){throw i.onError(o),o}i.onSuccess()},audioElementPlayCenter:Fo,processExternalMediaAEC:function(t){tJ.processExternalMediaAEC(t)},registerExtensions:function(t){t.forEach(i=>{const o=i;o.__registered__=!0,o.logger.hookLog=N.extLog,o.reporter.hookApiInvoke=pe.extApiInvoke,o.parameters&&Object.keys(o.parameters).forEach(s=>{o.parameters[s]=J(s)})})},ChannelMediaRelayError:Tc,ChannelMediaRelayEvent:Lo,ChannelMediaRelayState:Zi,RemoteStreamFallbackType:lf,RemoteStreamType:xu,ConnectionDisconnectedReason:Bt,AudienceLatencyLevelType:dm,AREAS:jt},eH=window||document;return Object.defineProperties(jo,{onAudioAutoplayFailed:{get:()=>Bo.onAudioAutoplayFailed,set:t=>{Bo.onAudioAutoplayFailed=t}},onAutoplayFailed:{get:()=>Bo.onAutoplayFailed,set:t=>{Bo.onAutoplayFailed=t}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>jo._onSecurityPolicyViolation,set(t){if(jo._onSecurityPolicyViolation=t,!eH)return;const i=s=>{if(!(s&&s.blockedURI&&jo.onSecurityPolicyViolation))return;const c=s.blockedURI;J("CSP_DETECTED_HOSTNAME_LIST").some(l=>c.includes(l))&&jo.onSecurityPolicyViolation&&"function"==typeof jo.onSecurityPolicyViolation&&jo.onSecurityPolicyViolation(s)},o=jo._cspEventHandlerPointer;o&&eH.removeEventListener("securitypolicyviolation",o),t&&"function"==typeof t&&eH.addEventListener("securitypolicyviolation",i),jo._cspEventHandlerPointer=i}}}),to.on(Pu.CAMERA_DEVICE_CHANGED,t=>{N.info("camera device changed",JSON.stringify(t)),jo.onCameraChanged&&jo.onCameraChanged(t)}),to.on(Pu.RECORDING_DEVICE_CHANGED,t=>{N.info("microphone device changed",JSON.stringify(t)),jo.onMicrophoneChanged&&jo.onMicrophoneChanged(t)}),to.on(Pu.PLAYOUT_DEVICE_CHANGED,t=>{N.debug("playout device changed",JSON.stringify(t)),jo.onPlaybackDeviceChanged&&jo.onPlaybackDeviceChanged(t)}),Fo.onAutoplayFailed=()=>{N.info("detect audio element autoplay failed"),Bo.onAudioAutoplayFailed&&Bo.onAudioAutoplayFailed()},_t.on("autoplay-failed",()=>{N.info("detect webaudio autoplay failed"),Bo.onAudioAutoplayFailed&&Bo.onAudioAutoplayFailed()}),window&&(window.__ARTC__=jo),jo}()},156:$u=>{function m_(U,Go,xs,rt,Hr,An,_r){try{var Aa=U[An](_r),Ho=Aa.value}catch(qc){return void xs(qc)}Aa.done?Go(Ho):Promise.resolve(Ho).then(rt,Hr)}$u.exports=function ig(U){return function(){var Go=this,xs=arguments;return new Promise(function(rt,Hr){var An=U.apply(Go,xs);function _r(Ho){m_(An,rt,Hr,_r,Aa,"next",Ho)}function Aa(Ho){m_(An,rt,Hr,_r,Aa,"throw",Ho)}_r(void 0)})}},$u.exports.__esModule=!0,$u.exports.default=$u.exports}},$u=>{$u($u.s=937)}]);